########################## Synthetic DID Analysis #############################

##### Load Necessary Packages #####
#install.packages("remotes")
#remotes::install_github("synth-inference/synthdid")
#install.packages("ggplot2")
#install.packages("haven")
#install.packages("foreach")
#install.packages("xtable")
#install.packages("patchwork")
library(synthdid)
library(ggplot2)
library(haven) # used to import .dta files #
library(foreach) # for parallel execution #
library(xtable) # to export latex tables #
library(patchwork) # to combine multiple plots on a single page #


##### Set working directory #####
setwd(Sys.getenv("Combined_CON_Directory"))


##### Import Data #####
CON_Expenditure <- read_dta("CON_Expenditure.dta")
View(CON_Expenditure)
CON_NursingHome <- read_dta("CON_NursingHome.dta")
View(CON_NursingHome)


########## Pennsylvania ###########

##### Create 3D array of time-varying covariates for synthetic matching - CON_Expenditure #####
CON_Expenditure$treated_pa_aux <- ifelse(CON_Expenditure$name == "Pennsylvania", 1, 0)
covariates_pa_exp_df <- subset(CON_Expenditure, (alwaysconpa == 1 & id != 11) | name == "Pennsylvania")
covariates_pa_exp_df <- covariates_pa_exp_df[order(covariates_pa_exp_df$year, covariates_pa_exp_df$treated_pa_aux, covariates_pa_exp_df$name),]
covariates_pa_exp_df <- as.data.frame(subset(covariates_pa_exp_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_pa_exp_df$income_pcp_adj <- covariates_pa_exp_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_pa_exp_df$unemp_rate <- covariates_pa_exp_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_pa_exp_df$top1_adj <- covariates_pa_exp_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_exp_pa <- c(1980:2014)
row.names_exp_pa <- c(covariates_pa_exp_df[1:35,1])
matrix.names_exp_pa <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_exp_pa_array <- array(as.matrix(covariates_pa_exp_df[,3:14]), dim = c(35,35,12), dimnames = list(row.names_exp_pa, column.names_exp_pa, matrix.names_exp_pa))

##### Create 3D array of time-varying covariates for synthetic matching - CON_NursingHome #####
CON_NursingHome$treated_pa_aux <- ifelse(CON_NursingHome$name == "Pennsylvania", 1, 0)
covariates_pa_acc_df <- subset(CON_NursingHome, alwaysconpa == 1 | name == "Pennsylvania")
covariates_pa_acc_df <- covariates_pa_acc_df[order(covariates_pa_acc_df$year, covariates_pa_acc_df$treated_pa_aux, covariates_pa_acc_df$name),]
covariates_pa_acc_df <- as.data.frame(subset(covariates_pa_acc_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_pa_acc_df$income_pcp_adj <- covariates_pa_acc_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_pa_acc_df$unemp_rate <- covariates_pa_acc_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_pa_acc_df$top1_adj <- covariates_pa_acc_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_acc_pa <- c(1991:2014)
row.names_acc_pa <- c(covariates_pa_acc_df[1:36,1])
matrix.names_acc_pa <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_acc_pa_array <- array(as.matrix(covariates_pa_acc_df[,3:14]), dim = c(36,24,12), dimnames = list(row.names_acc_pa, column.names_acc_pa, matrix.names_acc_pa))


##### DID, SC, and SDID Estimates, SEs, and 95% CIs; Parallel Trends Plots; Control Unit Contribution Plots #####
### Quantity of Nursing Homes ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "Pennsylvania" & CON_NursingHome$year >= 1996, 1, 0))
q_nursing_homes_pa_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_pa_df <- q_nursing_homes_pa_df[order(q_nursing_homes_pa_df$year, q_nursing_homes_pa_df$treated_pa_aux, q_nursing_homes_pa_df$name),]
q_nursing_homes_pa_df <- subset(q_nursing_homes_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nursing_homes_pa <- panel.matrices(q_nursing_homes_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_homes_pa_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_homes_pa$Y, setup_q_nursing_homes_pa$N0, setup_q_nursing_homes_pa$T0, X = covariates_acc_pa_array)
})
names(q_nursing_homes_pa_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_homes_pa_estimates_rounded <- rbind(unlist(q_nursing_homes_pa_estimates))
q_nursing_homes_pa_estimates_rounded <- lapply(q_nursing_homes_pa_estimates,round,2)
q_nursing_homes_pa_se <- lapply(q_nursing_homes_pa_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_homes_pa_se_rounded <- lapply(q_nursing_homes_pa_se,round,2)
q_nursing_homes_pa_ci <- foreach(i = q_nursing_homes_pa_estimates, j = q_nursing_homes_pa_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_homes_pa_estimates.table <- rbind(unlist(q_nursing_homes_pa_estimates_rounded), unlist(q_nursing_homes_pa_se_rounded), unlist(q_nursing_homes_pa_ci))
rownames(q_nursing_homes_pa_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_homes_pa_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_homes_pa_estimates.table
q_nursing_homes_pa_estimates.latextable <- xtable(q_nursing_homes_pa_estimates.table, align = "lccc", caption = 'Quantity of Nursing Homes Per 100,000 - PA')
print(q_nursing_homes_pa_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_homes_estimates_PA.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_homes_plots_PA.pdf')
q_nursing_homes_plots_PA <- synthdid_plot(q_nursing_homes_pa_estimates, 
              facet.vertical=FALSE,
              control.name='Control', treated.name='Pennsylvania',
              lambda.comparable=TRUE, se.method = 'none',
              trajectory.linetype = 'solid', line.width=.5, 
              trajectory.alpha = .5, guide.linetype = 'dashed', 
              effect.curvature=.25, effect.alpha=.5, 
              diagram.alpha=1, onset.alpha=.5,
              point.size = 1) +
  labs(y= "Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_homes_control_plots_PA <- synthdid_units_plot(q_nursing_homes_pa_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_homes_plots_PA + q_nursing_homes_control_plots_PA + plot_layout(ncol=1)
dev.off()


### Quantity of Nursing Home Beds ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "Pennsylvania" & CON_NursingHome$year >= 1996, 1, 0))
q_nursing_home_beds_pa_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_pa_df <- q_nursing_home_beds_pa_df[order(q_nursing_home_beds_pa_df$year, q_nursing_home_beds_pa_df$treated_pa_aux, q_nursing_home_beds_pa_df$name),]
q_nursing_home_beds_pa_df <- subset(q_nursing_home_beds_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nursing_home_beds_pa <- panel.matrices(q_nursing_home_beds_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_home_beds_pa_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_home_beds_pa$Y, setup_q_nursing_home_beds_pa$N0, setup_q_nursing_home_beds_pa$T0, X = covariates_acc_pa_array)
})
names(q_nursing_home_beds_pa_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_home_beds_pa_estimates_rounded <- rbind(unlist(q_nursing_home_beds_pa_estimates))
q_nursing_home_beds_pa_estimates_rounded <- lapply(q_nursing_home_beds_pa_estimates,round,2)
q_nursing_home_beds_pa_se <- lapply(q_nursing_home_beds_pa_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_home_beds_pa_se_rounded <- lapply(q_nursing_home_beds_pa_se,round,2)
q_nursing_home_beds_pa_ci <- foreach(i = q_nursing_home_beds_pa_estimates, j = q_nursing_home_beds_pa_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_home_beds_pa_estimates.table <- rbind(unlist(q_nursing_home_beds_pa_estimates_rounded), unlist(q_nursing_home_beds_pa_se_rounded), unlist(q_nursing_home_beds_pa_ci))
rownames(q_nursing_home_beds_pa_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_home_beds_pa_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_home_beds_pa_estimates.table
q_nursing_home_beds_pa_estimates.latextable <- xtable(q_nursing_home_beds_pa_estimates.table, align = "lccc", caption = 'Quantity of Nursing Home Beds Per 100,000 - PA')
print(q_nursing_home_beds_pa_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_home_beds_estimates_PA.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_home_beds_plots_PA.pdf')
q_nursing_home_beds_plots_PA <- synthdid_plot(q_nursing_home_beds_pa_estimates, 
                                          facet.vertical=FALSE,
                                          control.name='Control', treated.name='Pennsylvania',
                                          lambda.comparable=TRUE, se.method = 'none',
                                          trajectory.linetype = 'solid', line.width=.5, 
                                          trajectory.alpha = .5, guide.linetype = 'dashed', 
                                          effect.curvature=.25, effect.alpha=.5, 
                                          diagram.alpha=1, onset.alpha=.5,
                                          point.size = 1) +
  labs(y= "Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_home_beds_control_plots_PA <- synthdid_units_plot(q_nursing_home_beds_pa_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_home_beds_plots_PA + q_nursing_home_beds_control_plots_PA + plot_layout(ncol=1)
dev.off()

### Total Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "Pennsylvania" & CON_Expenditure$year >= 1996, 1, 0))
total_exp_pa_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
total_exp_pa_df <- total_exp_pa_df[order(total_exp_pa_df$year, total_exp_pa_df$treated_pa_aux, total_exp_pa_df$name),]
total_exp_pa_df <- subset(total_exp_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, total_exp, treated))
setup_total_exp_pa <- panel.matrices(total_exp_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
total_exp_pa_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_total_exp_pa$Y, setup_total_exp_pa$N0, setup_total_exp_pa$T0, X = covariates_exp_pa_array)
  })
names(total_exp_pa_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
total_exp_pa_estimates_rounded <- rbind(unlist(total_exp_pa_estimates))
total_exp_pa_estimates_rounded <- lapply(total_exp_pa_estimates,round,2)
total_exp_pa_se <- lapply(total_exp_pa_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
  })
total_exp_pa_se_rounded <- lapply(total_exp_pa_se,round,2)
total_exp_pa_ci <- foreach(i = total_exp_pa_estimates, j = total_exp_pa_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
total_exp_pa_estimates.table <- rbind(unlist(total_exp_pa_estimates_rounded), unlist(total_exp_pa_se_rounded), unlist(total_exp_pa_ci))
rownames(total_exp_pa_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(total_exp_pa_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
total_exp_pa_estimates.table
total_exp_pa_estimates.latextable <- xtable(total_exp_pa_estimates.table, align = "lccc", caption = 'Total Expenditure - PA')
print(total_exp_pa_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/total_expenditure_estimates_PA.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/total_expenditure_plots_PA.pdf')
total_expenditure_plots_PA <- synthdid_plot(total_exp_pa_estimates, 
                                              facet.vertical=FALSE,
                                              control.name='Control', treated.name='Pennsylvania',
                                              lambda.comparable=TRUE, se.method = 'none',
                                              trajectory.linetype = 'solid', line.width=.5, 
                                              trajectory.alpha = .5, guide.linetype = 'dashed', 
                                              effect.curvature=.25, effect.alpha=.5, 
                                              diagram.alpha=1, onset.alpha=.5,
                                              point.size = 1) +
  labs(y= "Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
total_expenditure_control_plots_PA <- synthdid_units_plot(total_exp_pa_estimates, se.method='none') + 
  labs(y= "Difference in Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
total_expenditure_plots_PA + total_expenditure_control_plots_PA + plot_layout(ncol=1)
dev.off()


### Medicaid Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "Pennsylvania" & CON_Expenditure$year >= 1996, 1, 0))
medicaid_exp_pa_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
medicaid_exp_pa_df <- medicaid_exp_pa_df[order(medicaid_exp_pa_df$year, medicaid_exp_pa_df$treated_pa_aux, medicaid_exp_pa_df$name),]
medicaid_exp_pa_df <- subset(medicaid_exp_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, medicaid_exp, treated))
setup_medicaid_exp_pa <- panel.matrices(medicaid_exp_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
medicaid_exp_pa_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_medicaid_exp_pa$Y, setup_medicaid_exp_pa$N0, setup_medicaid_exp_pa$T0, X = covariates_exp_pa_array)
})
names(medicaid_exp_pa_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
medicaid_exp_pa_estimates_rounded <- rbind(unlist(medicaid_exp_pa_estimates))
medicaid_exp_pa_estimates_rounded <- lapply(medicaid_exp_pa_estimates,round,2)
medicaid_exp_pa_se <- lapply(medicaid_exp_pa_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
medicaid_exp_pa_se_rounded <- lapply(medicaid_exp_pa_se,round,2)
medicaid_exp_pa_ci <- foreach(i = medicaid_exp_pa_estimates, j = medicaid_exp_pa_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
medicaid_exp_pa_estimates.table <- rbind(unlist(medicaid_exp_pa_estimates_rounded), unlist(medicaid_exp_pa_se_rounded), unlist(medicaid_exp_pa_ci))
rownames(medicaid_exp_pa_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(medicaid_exp_pa_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
medicaid_exp_pa_estimates.table
medicaid_exp_pa_estimates.latextable <- xtable(medicaid_exp_pa_estimates.table, align = "lccc", caption = 'Medicaid Expenditure - PA')
print(medicaid_exp_pa_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/medicaid_expenditure_estimates_PA.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/medicaid_expenditure_plots_PA.pdf')
medicaid_expenditure_plots_PA <- synthdid_plot(medicaid_exp_pa_estimates, 
                                            facet.vertical=FALSE,
                                            control.name='Control', treated.name='Pennsylvania',
                                            lambda.comparable=TRUE, se.method = 'none',
                                            trajectory.linetype = 'solid', line.width=.5, 
                                            trajectory.alpha = .5, guide.linetype = 'dashed', 
                                            effect.curvature=.25, effect.alpha=.5, 
                                            diagram.alpha=1, onset.alpha=.5,
                                            point.size = 1) +
  labs(y= "Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
medicaid_expenditure_control_plots_PA <- synthdid_units_plot(medicaid_exp_pa_estimates, se.method='none') + 
  labs(y= "Difference in Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
medicaid_expenditure_plots_PA + medicaid_expenditure_control_plots_PA + plot_layout(ncol=1)
dev.off()



########## Indiana ###########

##### Create 3D array of time-varying covariates for synthetic matching - CON_Expenditure #####
CON_Expenditure$treated_in_aux <- ifelse(CON_Expenditure$name == "Indiana", 1, 0)
covariates_in_exp_df <- subset(CON_Expenditure, (alwaysconpa == 1 & id != 11) | name == "Indiana")
covariates_in_exp_df <- covariates_in_exp_df[order(covariates_in_exp_df$year, covariates_in_exp_df$treated_in_aux, covariates_in_exp_df$name),]
covariates_in_exp_df <- as.data.frame(subset(covariates_in_exp_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_in_exp_df$income_pcp_adj <- covariates_in_exp_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_in_exp_df$unemp_rate <- covariates_in_exp_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_in_exp_df$top1_adj <- covariates_in_exp_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_exp_in <- c(1980:2014)
row.names_exp_in <- c(covariates_in_exp_df[1:35,1])
matrix.names_exp_in <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_exp_in_array <- array(as.matrix(covariates_in_exp_df[,3:14]), dim = c(35,35,12), dimnames = list(row.names_exp_in, column.names_exp_in, matrix.names_exp_in))

##### Create 3D array of time-varying covariates for synthetic matching - CON_NursingHome #####
CON_NursingHome$treated_in_aux <- ifelse(CON_NursingHome$name == "Indiana", 1, 0)
covariates_in_acc_df <- subset(CON_NursingHome, alwaysconpa == 1 | name == "Indiana")
covariates_in_acc_df <- covariates_in_acc_df[order(covariates_in_acc_df$year, covariates_in_acc_df$treated_in_aux, covariates_in_acc_df$name),]
covariates_in_acc_df <- as.data.frame(subset(covariates_in_acc_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_in_acc_df$income_pcp_adj <- covariates_in_acc_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_in_acc_df$unemp_rate <- covariates_in_acc_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_in_acc_df$top1_adj <- covariates_in_acc_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_acc_in <- c(1991:2014)
row.names_acc_in <- c(covariates_in_acc_df[1:36,1])
matrix.names_acc_in <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_acc_in_array <- array(as.matrix(covariates_in_acc_df[,3:14]), dim = c(36,24,12), dimnames = list(row.names_acc_in, column.names_acc_in, matrix.names_acc_in))


##### DID, SC, and SDID Estimates, SEs, and 95% CIs; Parallel Trends Plots; Control Unit Contribution Plots #####
### Quantity of Nursing Homes ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "Indiana" & CON_NursingHome$year >= 1999, 1, 0))
q_nursing_homes_in_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_in_df <- q_nursing_homes_in_df[order(q_nursing_homes_in_df$year, q_nursing_homes_in_df$treated_in_aux, q_nursing_homes_in_df$name),]
q_nursing_homes_in_df <- subset(q_nursing_homes_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nursing_homes_in <- panel.matrices(q_nursing_homes_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_homes_in_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_homes_in$Y, setup_q_nursing_homes_in$N0, setup_q_nursing_homes_in$T0, X = covariates_acc_in_array)
})
names(q_nursing_homes_in_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_homes_in_estimates_rounded <- rbind(unlist(q_nursing_homes_in_estimates))
q_nursing_homes_in_estimates_rounded <- lapply(q_nursing_homes_in_estimates,round,2)
q_nursing_homes_in_se <- lapply(q_nursing_homes_in_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_homes_in_se_rounded <- lapply(q_nursing_homes_in_se,round,2)
q_nursing_homes_in_ci <- foreach(i = q_nursing_homes_in_estimates, j = q_nursing_homes_in_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_homes_in_estimates.table <- rbind(unlist(q_nursing_homes_in_estimates_rounded), unlist(q_nursing_homes_in_se_rounded), unlist(q_nursing_homes_in_ci))
rownames(q_nursing_homes_in_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_homes_in_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_homes_in_estimates.table
q_nursing_homes_in_estimates.latextable <- xtable(q_nursing_homes_in_estimates.table, align = "lccc", caption = 'Quantity of Nursing Homes Per 100,000 - IN')
print(q_nursing_homes_in_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_homes_estimates_IN.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_homes_plots_IN.pdf')
q_nursing_homes_plots_IN <- synthdid_plot(q_nursing_homes_in_estimates, 
                                          facet.vertical=FALSE,
                                          control.name='Control', treated.name='Indiana',
                                          lambda.comparable=TRUE, se.method = 'none',
                                          trajectory.linetype = 'solid', line.width=.5, 
                                          trajectory.alpha = .5, guide.linetype = 'dashed', 
                                          effect.curvature=.25, effect.alpha=.5, 
                                          diagram.alpha=1, onset.alpha=.5,
                                          point.size = 1) +
  labs(y= "Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_homes_control_plots_IN <- synthdid_units_plot(q_nursing_homes_in_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_homes_plots_IN + q_nursing_homes_control_plots_IN + plot_layout(ncol=1)
dev.off()

### Quantity of Nursing Home Beds ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "Indiana" & CON_NursingHome$year >= 1999, 1, 0))
q_nursing_home_beds_in_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_in_df <- q_nursing_home_beds_in_df[order(q_nursing_home_beds_in_df$year, q_nursing_home_beds_in_df$treated_in_aux, q_nursing_home_beds_in_df$name),]
q_nursing_home_beds_in_df <- subset(q_nursing_home_beds_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nursing_home_beds_in <- panel.matrices(q_nursing_home_beds_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_home_beds_in_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_home_beds_in$Y, setup_q_nursing_home_beds_in$N0, setup_q_nursing_home_beds_in$T0, X = covariates_acc_in_array)
})
names(q_nursing_home_beds_in_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_home_beds_in_estimates_rounded <- rbind(unlist(q_nursing_home_beds_in_estimates))
q_nursing_home_beds_in_estimates_rounded <- lapply(q_nursing_home_beds_in_estimates,round,2)
q_nursing_home_beds_in_se <- lapply(q_nursing_home_beds_in_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_home_beds_in_se_rounded <- lapply(q_nursing_home_beds_in_se,round,2)
q_nursing_home_beds_in_ci <- foreach(i = q_nursing_home_beds_in_estimates, j = q_nursing_home_beds_in_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_home_beds_in_estimates.table <- rbind(unlist(q_nursing_home_beds_in_estimates_rounded), unlist(q_nursing_home_beds_in_se_rounded), unlist(q_nursing_home_beds_in_ci))
rownames(q_nursing_home_beds_in_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_home_beds_in_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_home_beds_in_estimates.table
q_nursing_home_beds_in_estimates.latextable <- xtable(q_nursing_home_beds_in_estimates.table, align = "lccc", caption = 'Quantity of Nursing Home Beds Per 100,000 - IN')
print(q_nursing_home_beds_in_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_home_beds_estimates_IN.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_home_beds_plots_IN.pdf')
q_nursing_home_beds_plots_IN <- synthdid_plot(q_nursing_home_beds_in_estimates, 
                                              facet.vertical=FALSE,
                                              control.name='Control', treated.name='Indiana',
                                              lambda.comparable=TRUE, se.method = 'none',
                                              trajectory.linetype = 'solid', line.width=.5, 
                                              trajectory.alpha = .5, guide.linetype = 'dashed', 
                                              effect.curvature=.25, effect.alpha=.5, 
                                              diagram.alpha=1, onset.alpha=.5,
                                              point.size = 1) +
  labs(y= "Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_home_beds_control_plots_IN <- synthdid_units_plot(q_nursing_home_beds_in_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_home_beds_plots_IN + q_nursing_home_beds_control_plots_IN + plot_layout(ncol=1)
dev.off()

### Total Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "Indiana" & CON_Expenditure$year >= 1999, 1, 0))
total_exp_in_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
total_exp_in_df <- total_exp_in_df[order(total_exp_in_df$year, total_exp_in_df$treated_in_aux, total_exp_in_df$name),]
total_exp_in_df <- subset(total_exp_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, total_exp, treated))
setup_total_exp_in <- panel.matrices(total_exp_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
total_exp_in_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_total_exp_in$Y, setup_total_exp_in$N0, setup_total_exp_in$T0, X = covariates_exp_in_array)
})
names(total_exp_in_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
total_exp_in_estimates_rounded <- rbind(unlist(total_exp_in_estimates))
total_exp_in_estimates_rounded <- lapply(total_exp_in_estimates,round,2)
total_exp_in_se <- lapply(total_exp_in_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
total_exp_in_se_rounded <- lapply(total_exp_in_se,round,2)
total_exp_in_ci <- foreach(i = total_exp_in_estimates, j = total_exp_in_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
total_exp_in_estimates.table <- rbind(unlist(total_exp_in_estimates_rounded), unlist(total_exp_in_se_rounded), unlist(total_exp_in_ci))
rownames(total_exp_in_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(total_exp_in_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
total_exp_in_estimates.table
total_exp_in_estimates.latextable <- xtable(total_exp_in_estimates.table, align = "lccc", caption = 'Total Expenditure - IN')
print(total_exp_in_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/total_expenditure_estimates_IN.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/total_expenditure_plots_IN.pdf')
total_expenditure_plots_IN <- synthdid_plot(total_exp_in_estimates, 
                                            facet.vertical=FALSE,
                                            control.name='Control', treated.name='Indiana',
                                            lambda.comparable=TRUE, se.method = 'none',
                                            trajectory.linetype = 'solid', line.width=.5, 
                                            trajectory.alpha = .5, guide.linetype = 'dashed', 
                                            effect.curvature=.25, effect.alpha=.5, 
                                            diagram.alpha=1, onset.alpha=.5,
                                            point.size = 1) +
  labs(y= "Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
total_expenditure_control_plots_IN <- synthdid_units_plot(total_exp_in_estimates, se.method='none') + 
  labs(y= "Difference in Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
total_expenditure_plots_IN + total_expenditure_control_plots_IN + plot_layout(ncol=1)
dev.off()


### Medicaid Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "Indiana" & CON_Expenditure$year >= 1999, 1, 0))
medicaid_exp_in_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
medicaid_exp_in_df <- medicaid_exp_in_df[order(medicaid_exp_in_df$year, medicaid_exp_in_df$treated_in_aux, medicaid_exp_in_df$name),]
medicaid_exp_in_df <- subset(medicaid_exp_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, medicaid_exp, treated))
setup_medicaid_exp_in <- panel.matrices(medicaid_exp_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
medicaid_exp_in_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_medicaid_exp_in$Y, setup_medicaid_exp_in$N0, setup_medicaid_exp_in$T0, X = covariates_exp_in_array)
})
names(medicaid_exp_in_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
medicaid_exp_in_estimates_rounded <- rbind(unlist(medicaid_exp_in_estimates))
medicaid_exp_in_estimates_rounded <- lapply(medicaid_exp_in_estimates,round,2)
medicaid_exp_in_se <- lapply(medicaid_exp_in_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
medicaid_exp_in_se_rounded <- lapply(medicaid_exp_in_se,round,2)
medicaid_exp_in_ci <- foreach(i = medicaid_exp_in_estimates, j = medicaid_exp_in_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
medicaid_exp_in_estimates.table <- rbind(unlist(medicaid_exp_in_estimates_rounded), unlist(medicaid_exp_in_se_rounded), unlist(medicaid_exp_in_ci))
rownames(medicaid_exp_in_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(medicaid_exp_in_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
medicaid_exp_in_estimates.table
medicaid_exp_in_estimates.latextable <- xtable(medicaid_exp_in_estimates.table, align = "lccc", caption = 'Medicaid Expenditure - IN')
print(medicaid_exp_in_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/medicaid_expenditure_estimates_IN.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/medicaid_expenditure_plots_IN.pdf')
medicaid_expenditure_plots_IN <- synthdid_plot(medicaid_exp_in_estimates, 
                                               facet.vertical=FALSE,
                                               control.name='Control', treated.name='Indiana',
                                               lambda.comparable=TRUE, se.method = 'none',
                                               trajectory.linetype = 'solid', line.width=.5, 
                                               trajectory.alpha = .5, guide.linetype = 'dashed', 
                                               effect.curvature=.25, effect.alpha=.5, 
                                               diagram.alpha=1, onset.alpha=.5,
                                               point.size = 1) +
  labs(y= "Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
medicaid_expenditure_control_plots_IN <- synthdid_units_plot(medicaid_exp_in_estimates, se.method='none') + 
  labs(y= "Difference in Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
medicaid_expenditure_plots_IN + medicaid_expenditure_control_plots_IN + plot_layout(ncol=1)
dev.off()




########## North Dakota ###########

##### Create 3D array of time-varying covariates for synthetic matching - CON_Expenditure #####
CON_Expenditure$treated_nd_aux <- ifelse(CON_Expenditure$name == "North Dakota", 1, 0)
covariates_nd_exp_df <- subset(CON_Expenditure, (alwaysconpa == 1 & id != 11) | name == "North Dakota")
covariates_nd_exp_df <- covariates_nd_exp_df[order(covariates_nd_exp_df$year, covariates_nd_exp_df$treated_nd_aux, covariates_nd_exp_df$name),]
covariates_nd_exp_df <- as.data.frame(subset(covariates_nd_exp_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_nd_exp_df$income_pcp_adj <- covariates_nd_exp_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_nd_exp_df$unemp_rate <- covariates_nd_exp_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_nd_exp_df$top1_adj <- covariates_nd_exp_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_exp_nd <- c(1980:2014)
row.names_exp_nd <- c(covariates_nd_exp_df[1:35,1])
matrix.names_exp_nd <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_exp_nd_array <- array(as.matrix(covariates_nd_exp_df[,3:14]), dim = c(35,35,12), dimnames = list(row.names_exp_nd, column.names_exp_nd, matrix.names_exp_nd))

##### Create 3D array of time-varying covariates for synthetic matching - CON_NursingHome #####
CON_NursingHome$treated_nd_aux <- ifelse(CON_NursingHome$name == "North Dakota", 1, 0)
covariates_nd_acc_df <- subset(CON_NursingHome, alwaysconpa == 1 | name == "North Dakota")
covariates_nd_acc_df <- covariates_nd_acc_df[order(covariates_nd_acc_df$year, covariates_nd_acc_df$treated_nd_aux, covariates_nd_acc_df$name),]
covariates_nd_acc_df <- as.data.frame(subset(covariates_nd_acc_df, code == 10, select=c(name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
covariates_nd_acc_df$income_pcp_adj <- covariates_nd_acc_df$income_pcp_adj/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_nd_acc_df$unemp_rate <- covariates_nd_acc_df$unemp_rate/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
covariates_nd_acc_df$top1_adj <- covariates_nd_acc_df$top1_adj/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
column.names_acc_nd <- c(1991:2014)
row.names_acc_nd <- c(covariates_nd_acc_df[1:36,1])
matrix.names_acc_nd <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_acc_nd_array <- array(as.matrix(covariates_nd_acc_df[,3:14]), dim = c(36,24,12), dimnames = list(row.names_acc_nd, column.names_acc_nd, matrix.names_acc_nd))


##### DID, SC, and SDID Estimates, SEs, and 95% CIs; Parallel Trends Plots; Control Unit Contribution Plots #####
### Quantity of Nursing Homes ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "North Dakota" & CON_NursingHome$year >= 1995, 1, 0))
q_nursing_homes_nd_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_nd_df <- q_nursing_homes_nd_df[order(q_nursing_homes_nd_df$year, q_nursing_homes_nd_df$treated_nd_aux, q_nursing_homes_nd_df$name),]
q_nursing_homes_nd_df <- subset(q_nursing_homes_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nursing_homes_nd <- panel.matrices(q_nursing_homes_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_homes_nd_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_homes_nd$Y, setup_q_nursing_homes_nd$N0, setup_q_nursing_homes_nd$T0, X = covariates_acc_nd_array)
})
names(q_nursing_homes_nd_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_homes_nd_estimates_rounded <- rbind(unlist(q_nursing_homes_nd_estimates))
q_nursing_homes_nd_estimates_rounded <- lapply(q_nursing_homes_nd_estimates,round,2)
q_nursing_homes_nd_se <- lapply(q_nursing_homes_nd_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_homes_nd_se_rounded <- lapply(q_nursing_homes_nd_se,round,2)
q_nursing_homes_nd_ci <- foreach(i = q_nursing_homes_nd_estimates, j = q_nursing_homes_nd_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_homes_nd_estimates.table <- rbind(unlist(q_nursing_homes_nd_estimates_rounded), unlist(q_nursing_homes_nd_se_rounded), unlist(q_nursing_homes_nd_ci))
rownames(q_nursing_homes_nd_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_homes_nd_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_homes_nd_estimates.table
q_nursing_homes_nd_estimates.latextable <- xtable(q_nursing_homes_nd_estimates.table, align = "lccc", caption = 'Quantity of Nursing Homes Per 100,000 - ND')
print(q_nursing_homes_nd_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_homes_estimates_ND.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_homes_plots_ND.pdf')
q_nursing_homes_plots_ND <- synthdid_plot(q_nursing_homes_nd_estimates, 
                                          facet.vertical=FALSE,
                                          control.name='Control', treated.name='North Dakota',
                                          lambda.comparable=TRUE, se.method = 'none',
                                          trajectory.linetype = 'solid', line.width=.5, 
                                          trajectory.alpha = .5, guide.linetype = 'dashed', 
                                          effect.curvature=.25, effect.alpha=.5, 
                                          diagram.alpha=1, onset.alpha=.5,
                                          point.size = 1) +
  labs(y= "Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_homes_control_plots_ND <- synthdid_units_plot(q_nursing_homes_nd_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Homes\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_homes_plots_ND + q_nursing_homes_control_plots_ND + plot_layout(ncol=1)
dev.off()

### Quantity of Nursing Home Beds ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_NursingHome$treated <- as.integer(ifelse(CON_NursingHome$name == "North Dakota" & CON_NursingHome$year >= 1995, 1, 0))
q_nursing_home_beds_nd_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_nd_df <- q_nursing_home_beds_nd_df[order(q_nursing_home_beds_nd_df$year, q_nursing_home_beds_nd_df$treated_nd_aux, q_nursing_home_beds_nd_df$name),]
q_nursing_home_beds_nd_df <- subset(q_nursing_home_beds_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nursing_home_beds_nd <- panel.matrices(q_nursing_home_beds_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
q_nursing_home_beds_nd_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_q_nursing_home_beds_nd$Y, setup_q_nursing_home_beds_nd$N0, setup_q_nursing_home_beds_nd$T0, X = covariates_acc_nd_array)
})
names(q_nursing_home_beds_nd_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
q_nursing_home_beds_nd_estimates_rounded <- rbind(unlist(q_nursing_home_beds_nd_estimates))
q_nursing_home_beds_nd_estimates_rounded <- lapply(q_nursing_home_beds_nd_estimates,round,2)
q_nursing_home_beds_nd_se <- lapply(q_nursing_home_beds_nd_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
q_nursing_home_beds_nd_se_rounded <- lapply(q_nursing_home_beds_nd_se,round,2)
q_nursing_home_beds_nd_ci <- foreach(i = q_nursing_home_beds_nd_estimates, j = q_nursing_home_beds_nd_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
q_nursing_home_beds_nd_estimates.table <- rbind(unlist(q_nursing_home_beds_nd_estimates_rounded), unlist(q_nursing_home_beds_nd_se_rounded), unlist(q_nursing_home_beds_nd_ci))
rownames(q_nursing_home_beds_nd_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(q_nursing_home_beds_nd_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
q_nursing_home_beds_nd_estimates.table
q_nursing_home_beds_nd_estimates.latextable <- xtable(q_nursing_home_beds_nd_estimates.table, align = "lccc", caption = 'Quantity of Nursing Home Beds Per 100,000 - ND')
print(q_nursing_home_beds_nd_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/q_nursing_home_beds_estimates_ND.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/q_nursing_home_beds_plots_ND.pdf')
q_nursing_home_beds_plots_ND <- synthdid_plot(q_nursing_home_beds_nd_estimates, 
                                              facet.vertical=FALSE,
                                              control.name='Control', treated.name='North Dakota',
                                              lambda.comparable=TRUE, se.method = 'none',
                                              trajectory.linetype = 'solid', line.width=.5, 
                                              trajectory.alpha = .5, guide.linetype = 'dashed', 
                                              effect.curvature=.25, effect.alpha=.5, 
                                              diagram.alpha=1, onset.alpha=.5,
                                              point.size = 1) +
  labs(y= "Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
q_nursing_home_beds_control_plots_ND <- synthdid_units_plot(q_nursing_home_beds_nd_estimates, se.method='none') + 
  labs(y= "Difference in Quantity of Nursing Home Beds\n(Per 100,000)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
q_nursing_home_beds_plots_ND + q_nursing_home_beds_control_plots_ND + plot_layout(ncol=1)
dev.off()

### Total Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "North Dakota" & CON_Expenditure$year >= 1995, 1, 0))
total_exp_nd_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
total_exp_nd_df <- total_exp_nd_df[order(total_exp_nd_df$year, total_exp_nd_df$treated_nd_aux, total_exp_nd_df$name),]
total_exp_nd_df <- subset(total_exp_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, total_exp, treated))
setup_total_exp_nd <- panel.matrices(total_exp_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
total_exp_nd_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_total_exp_nd$Y, setup_total_exp_nd$N0, setup_total_exp_nd$T0, X = covariates_exp_nd_array)
})
names(total_exp_nd_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
total_exp_nd_estimates_rounded <- rbind(unlist(total_exp_nd_estimates))
total_exp_nd_estimates_rounded <- lapply(total_exp_nd_estimates,round,2)
total_exp_nd_se <- lapply(total_exp_nd_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
total_exp_nd_se_rounded <- lapply(total_exp_nd_se,round,2)
total_exp_nd_ci <- foreach(i = total_exp_nd_estimates, j = total_exp_nd_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
total_exp_nd_estimates.table <- rbind(unlist(total_exp_nd_estimates_rounded), unlist(total_exp_nd_se_rounded), unlist(total_exp_nd_ci))
rownames(total_exp_nd_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(total_exp_nd_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
total_exp_nd_estimates.table
total_exp_nd_estimates.latextable <- xtable(total_exp_nd_estimates.table, align = "lccc", caption = 'Total Expenditure - ND')
print(total_exp_nd_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/total_expenditure_estimates_ND.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/total_expenditure_plots_ND.pdf')
total_expenditure_plots_ND <- synthdid_plot(total_exp_nd_estimates, 
                                            facet.vertical=FALSE,
                                            control.name='Control', treated.name='North Dakota',
                                            lambda.comparable=TRUE, se.method = 'none',
                                            trajectory.linetype = 'solid', line.width=.5, 
                                            trajectory.alpha = .5, guide.linetype = 'dashed', 
                                            effect.curvature=.25, effect.alpha=.5, 
                                            diagram.alpha=1, onset.alpha=.5,
                                            point.size = 1) +
  labs(y= "Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
total_expenditure_control_plots_ND <- synthdid_units_plot(total_exp_nd_estimates, se.method='none') + 
  labs(y= "Difference in Total Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
total_expenditure_plots_ND + total_expenditure_control_plots_ND + plot_layout(ncol=1)
dev.off()

### Medicaid Expenditure ###
# Restrict to treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
CON_Expenditure$treated <- as.integer(ifelse(CON_Expenditure$name == "North Dakota" & CON_Expenditure$year >= 1995, 1, 0))
medicaid_exp_nd_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
medicaid_exp_nd_df <- medicaid_exp_nd_df[order(medicaid_exp_nd_df$year, medicaid_exp_nd_df$treated_nd_aux, medicaid_exp_nd_df$name),]
medicaid_exp_nd_df <- subset(medicaid_exp_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, medicaid_exp, treated))
setup_medicaid_exp_nd <- panel.matrices(medicaid_exp_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID, SC, and SDID Estimates, SEs, and 95% CIs #
estimators = list(did=did_estimate,
                  sc=sc_estimate,
                  sdid=synthdid_estimate)
medicaid_exp_nd_estimates <- lapply(estimators, function(estimator) {
  estimator(setup_medicaid_exp_nd$Y, setup_medicaid_exp_nd$N0, setup_medicaid_exp_nd$T0, X = covariates_exp_nd_array)
})
names(medicaid_exp_nd_estimates) = c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff')
medicaid_exp_nd_estimates_rounded <- rbind(unlist(medicaid_exp_nd_estimates))
medicaid_exp_nd_estimates_rounded <- lapply(medicaid_exp_nd_estimates,round,2)
medicaid_exp_nd_se <- lapply(medicaid_exp_nd_estimates, function(estimate) {
  set.seed(12345)
  sqrt(vcov(estimate, method='placebo'))
})
medicaid_exp_nd_se_rounded <- lapply(medicaid_exp_nd_se,round,2)
medicaid_exp_nd_ci <- foreach(i = medicaid_exp_nd_estimates, j = medicaid_exp_nd_se) %do% sprintf('(%1.2f, %1.2f)', i - 1.96*j, i + 1.96*j)
medicaid_exp_nd_estimates.table <- rbind(unlist(medicaid_exp_nd_estimates_rounded), unlist(medicaid_exp_nd_se_rounded), unlist(medicaid_exp_nd_ci))
rownames(medicaid_exp_nd_estimates.table) <- (c('estimate', 'standard error', '95% Confidence Interval'))
colnames(medicaid_exp_nd_estimates.table) <- (c('Diff-in-Diff', 'Synthetic Control', 'Synthetic Diff-in-Diff'))
medicaid_exp_nd_estimates.table
medicaid_exp_nd_estimates.latextable <- xtable(medicaid_exp_nd_estimates.table, align = "lccc", caption = 'Medicaid Expenditure - ND')
print(medicaid_exp_nd_estimates.latextable, type='latex', file='SynthDID_Figs_and_Tables/medicaid_expenditure_estimates_ND.tex')
# Parallel Trends and Control Contribution Plots #
pdf(file='SynthDID_Figs_and_Tables/medicaid_expenditure_plots_ND.pdf')
medicaid_expenditure_plots_ND <- synthdid_plot(medicaid_exp_nd_estimates, 
                                               facet.vertical=FALSE,
                                               control.name='Control', treated.name='North Dakota',
                                               lambda.comparable=TRUE, se.method = 'none',
                                               trajectory.linetype = 'solid', line.width=.5, 
                                               trajectory.alpha = .5, guide.linetype = 'dashed', 
                                               effect.curvature=.25, effect.alpha=.5, 
                                               diagram.alpha=1, onset.alpha=.5,
                                               point.size = 1) +
  labs(y= "Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.title.y = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold"),
        legend.position='top', 
        legend.text = element_text(size=8),
        legend.direction='horizontal')
medicaid_expenditure_control_plots_ND <- synthdid_units_plot(medicaid_exp_nd_estimates, se.method='none') + 
  labs(y= "Difference in Medicaid Nursing Home Expenditure\n(Per Capita)") +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(size=8),
        axis.text.x = element_text(size = 5, hjust=1, vjust=0.3),
        legend.background=element_blank(),
        legend.direction='horizontal', legend.position='bottom',
        strip.background=element_blank(), strip.text.x = element_blank(),
        legend.text = element_text(size=8),
        legend.title = element_text(size=8, face="bold"))
medicaid_expenditure_plots_ND + medicaid_expenditure_control_plots_ND + plot_layout(ncol=1)
dev.off()


############### Spaghetti and Placebo Distribution Plots ###############

##### Create 3D arrays of time-varying covariates for synthetic matching for all potential control states - CON_Expenditure #####
controls.df <- subset(CON_Expenditure, alwaysconpa == 1)
print(unique(controls.df$id))
for(i in unique(controls.df$id)) {
  assign(paste0("covariates_exp_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
covariates_exp_df1$treated_aux <- ifelse(covariates_exp_df1$id == 1, 1, 0)
covariates_exp_df2$treated_aux <- ifelse(covariates_exp_df2$id == 2, 1, 0)
covariates_exp_df5$treated_aux <- ifelse(covariates_exp_df5$id == 5, 1, 0)
covariates_exp_df10$treated_aux <- ifelse(covariates_exp_df10$id == 10, 1, 0)
covariates_exp_df11$treated_aux <- ifelse(covariates_exp_df11$id == 11, 1, 0)
covariates_exp_df12$treated_aux <- ifelse(covariates_exp_df12$id == 12, 1, 0)
covariates_exp_df13$treated_aux <- ifelse(covariates_exp_df13$id == 13, 1, 0)
covariates_exp_df15$treated_aux <- ifelse(covariates_exp_df15$id == 15, 1, 0)
covariates_exp_df17$treated_aux <- ifelse(covariates_exp_df17$id == 17, 1, 0)
covariates_exp_df19$treated_aux <- ifelse(covariates_exp_df19$id == 19, 1, 0)
covariates_exp_df21$treated_aux <- ifelse(covariates_exp_df21$id == 21, 1, 0)
covariates_exp_df23$treated_aux <- ifelse(covariates_exp_df23$id == 23, 1, 0)
covariates_exp_df24$treated_aux <- ifelse(covariates_exp_df24$id == 24, 1, 0)
covariates_exp_df25$treated_aux <- ifelse(covariates_exp_df25$id == 25, 1, 0)
covariates_exp_df26$treated_aux <- ifelse(covariates_exp_df26$id == 26, 1, 0)
covariates_exp_df28$treated_aux <- ifelse(covariates_exp_df28$id == 28, 1, 0)
covariates_exp_df29$treated_aux <- ifelse(covariates_exp_df29$id == 29, 1, 0)
covariates_exp_df30$treated_aux <- ifelse(covariates_exp_df30$id == 30, 1, 0)
covariates_exp_df31$treated_aux <- ifelse(covariates_exp_df31$id == 31, 1, 0)
covariates_exp_df32$treated_aux <- ifelse(covariates_exp_df32$id == 32, 1, 0)
covariates_exp_df33$treated_aux <- ifelse(covariates_exp_df33$id == 33, 1, 0)
covariates_exp_df34$treated_aux <- ifelse(covariates_exp_df34$id == 34, 1, 0)
covariates_exp_df36$treated_aux <- ifelse(covariates_exp_df36$id == 36, 1, 0)
covariates_exp_df37$treated_aux <- ifelse(covariates_exp_df37$id == 37, 1, 0)
covariates_exp_df39$treated_aux <- ifelse(covariates_exp_df39$id == 39, 1, 0)
covariates_exp_df40$treated_aux <- ifelse(covariates_exp_df40$id == 40, 1, 0)
covariates_exp_df41$treated_aux <- ifelse(covariates_exp_df41$id == 41, 1, 0)
covariates_exp_df44$treated_aux <- ifelse(covariates_exp_df44$id == 44, 1, 0)
covariates_exp_df45$treated_aux <- ifelse(covariates_exp_df45$id == 45, 1, 0)
covariates_exp_df47$treated_aux <- ifelse(covariates_exp_df47$id == 47, 1, 0)
covariates_exp_df50$treated_aux <- ifelse(covariates_exp_df50$id == 50, 1, 0)
covariates_exp_df51$treated_aux <- ifelse(covariates_exp_df51$id == 51, 1, 0)
covariates_exp_df53$treated_aux <- ifelse(covariates_exp_df53$id == 53, 1, 0)
covariates_exp_df54$treated_aux <- ifelse(covariates_exp_df54$id == 54, 1, 0)
covariates_exp_df55$treated_aux <- ifelse(covariates_exp_df55$id == 55, 1, 0)
covariates_exp_df_list <- list(covariates_exp_df1,covariates_exp_df2,covariates_exp_df5,
                               covariates_exp_df10,covariates_exp_df11,covariates_exp_df12,
                               covariates_exp_df13,covariates_exp_df15,covariates_exp_df17,
                               covariates_exp_df19,covariates_exp_df21,covariates_exp_df23,
                               covariates_exp_df24,covariates_exp_df25,covariates_exp_df26,
                               covariates_exp_df28,covariates_exp_df29,covariates_exp_df30,
                               covariates_exp_df31,covariates_exp_df32,covariates_exp_df33,
                               covariates_exp_df34,covariates_exp_df36,covariates_exp_df37,
                               covariates_exp_df39,covariates_exp_df40,covariates_exp_df41,
                               covariates_exp_df44,covariates_exp_df45,covariates_exp_df47,
                               covariates_exp_df50,covariates_exp_df51,covariates_exp_df53,
                               covariates_exp_df54,covariates_exp_df55)
rm(covariates_exp_df1,covariates_exp_df2,covariates_exp_df5,
   covariates_exp_df10,covariates_exp_df11,covariates_exp_df12,
   covariates_exp_df13,covariates_exp_df15,covariates_exp_df17,
   covariates_exp_df19,covariates_exp_df21,covariates_exp_df23,
   covariates_exp_df24,covariates_exp_df25,covariates_exp_df26,
   covariates_exp_df28,covariates_exp_df29,covariates_exp_df30,
   covariates_exp_df31,covariates_exp_df32,covariates_exp_df33,
   covariates_exp_df34,covariates_exp_df36,covariates_exp_df37,
   covariates_exp_df39,covariates_exp_df40,covariates_exp_df41,
   covariates_exp_df44,covariates_exp_df45,covariates_exp_df47,
   covariates_exp_df50,covariates_exp_df51,covariates_exp_df53,
   covariates_exp_df54,covariates_exp_df55)
covariates_exp_df_list <- lapply(covariates_exp_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
covariates_exp_df_list <- lapply(covariates_exp_df_list, function(x)
  x <- as.data.frame(subset(x, code == 10, select=c(id,name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
)
covariates_exp_df_list <- lapply(covariates_exp_df_list, function(x) {
  x["income_pcp_adj"] <- x["income_pcp_adj"]/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
  x["unemp_rate"] <- x["unemp_rate"]/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
  x["top1_adj"] <- x["top1_adj"]/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
  return(x)
}
)
column.names_exp <- c(1980:2014)
row.names_exp_1 <- c(covariates_exp_df_list[[1]][1:35,2])
row.names_exp_2 <- c(covariates_exp_df_list[[2]][1:35,2])
row.names_exp_5 <- c(covariates_exp_df_list[[3]][1:35,2])
row.names_exp_10 <- c(covariates_exp_df_list[[4]][1:35,2])
row.names_exp_11 <- c(covariates_exp_df_list[[5]][1:35,2])
row.names_exp_12 <- c(covariates_exp_df_list[[6]][1:35,2])
row.names_exp_13 <- c(covariates_exp_df_list[[7]][1:35,2])
row.names_exp_15 <- c(covariates_exp_df_list[[8]][1:35,2])
row.names_exp_17 <- c(covariates_exp_df_list[[9]][1:35,2])
row.names_exp_19 <- c(covariates_exp_df_list[[10]][1:35,2])
row.names_exp_21 <- c(covariates_exp_df_list[[11]][1:35,2])
row.names_exp_23 <- c(covariates_exp_df_list[[12]][1:35,2])
row.names_exp_24 <- c(covariates_exp_df_list[[13]][1:35,2])
row.names_exp_25 <- c(covariates_exp_df_list[[14]][1:35,2])
row.names_exp_26 <- c(covariates_exp_df_list[[15]][1:35,2])
row.names_exp_28 <- c(covariates_exp_df_list[[16]][1:35,2])
row.names_exp_29 <- c(covariates_exp_df_list[[17]][1:35,2])
row.names_exp_30 <- c(covariates_exp_df_list[[18]][1:35,2])
row.names_exp_31 <- c(covariates_exp_df_list[[19]][1:35,2])
row.names_exp_32 <- c(covariates_exp_df_list[[20]][1:35,2])
row.names_exp_33 <- c(covariates_exp_df_list[[21]][1:35,2])
row.names_exp_34 <- c(covariates_exp_df_list[[22]][1:35,2])
row.names_exp_36 <- c(covariates_exp_df_list[[23]][1:35,2])
row.names_exp_37 <- c(covariates_exp_df_list[[24]][1:35,2])
row.names_exp_39 <- c(covariates_exp_df_list[[25]][1:35,2])
row.names_exp_40 <- c(covariates_exp_df_list[[26]][1:35,2])
row.names_exp_41 <- c(covariates_exp_df_list[[27]][1:35,2])
row.names_exp_44 <- c(covariates_exp_df_list[[28]][1:35,2])
row.names_exp_45 <- c(covariates_exp_df_list[[29]][1:35,2])
row.names_exp_47 <- c(covariates_exp_df_list[[30]][1:35,2])
row.names_exp_50 <- c(covariates_exp_df_list[[31]][1:35,2])
row.names_exp_51 <- c(covariates_exp_df_list[[32]][1:35,2])
row.names_exp_53 <- c(covariates_exp_df_list[[33]][1:35,2])
row.names_exp_54 <- c(covariates_exp_df_list[[34]][1:35,2])
row.names_exp_55 <- c(covariates_exp_df_list[[35]][1:35,2])
row.names_exp_list <- list(row.names_exp_1,row.names_exp_2,row.names_exp_5,
                           row.names_exp_10,row.names_exp_11,row.names_exp_12,
                           row.names_exp_13,row.names_exp_15,row.names_exp_17,
                           row.names_exp_19,row.names_exp_21,row.names_exp_23,
                           row.names_exp_24,row.names_exp_25,row.names_exp_26,
                           row.names_exp_28,row.names_exp_29,row.names_exp_30,
                           row.names_exp_31,row.names_exp_32,row.names_exp_33,
                           row.names_exp_34,row.names_exp_36,row.names_exp_37,
                           row.names_exp_39,row.names_exp_40,row.names_exp_41,
                           row.names_exp_44,row.names_exp_45,row.names_exp_47,
                           row.names_exp_50,row.names_exp_51,row.names_exp_53,
                           row.names_exp_54,row.names_exp_55)
rm(row.names_exp_1,row.names_exp_2,row.names_exp_5,
   row.names_exp_10,row.names_exp_11,row.names_exp_12,
   row.names_exp_13,row.names_exp_15,row.names_exp_17,
   row.names_exp_19,row.names_exp_21,row.names_exp_23,
   row.names_exp_24,row.names_exp_25,row.names_exp_26,
   row.names_exp_28,row.names_exp_29,row.names_exp_30,
   row.names_exp_31,row.names_exp_32,row.names_exp_33,
   row.names_exp_34,row.names_exp_36,row.names_exp_37,
   row.names_exp_39,row.names_exp_40,row.names_exp_41,
   row.names_exp_44,row.names_exp_45,row.names_exp_47,
   row.names_exp_50,row.names_exp_51,row.names_exp_53,
   row.names_exp_54,row.names_exp_55)
matrix.names_exp <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_exp_array_1 <- array(as.matrix(covariates_exp_df_list[[1]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[1]], column.names_exp, matrix.names_exp))
covariates_exp_array_2 <- array(as.matrix(covariates_exp_df_list[[2]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[2]], column.names_exp, matrix.names_exp))
covariates_exp_array_5 <- array(as.matrix(covariates_exp_df_list[[3]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[3]], column.names_exp, matrix.names_exp))
covariates_exp_array_10 <- array(as.matrix(covariates_exp_df_list[[4]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[4]], column.names_exp, matrix.names_exp))
covariates_exp_array_11 <- array(as.matrix(covariates_exp_df_list[[5]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[5]], column.names_exp, matrix.names_exp))
covariates_exp_array_12 <- array(as.matrix(covariates_exp_df_list[[6]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[6]], column.names_exp, matrix.names_exp))
covariates_exp_array_13 <- array(as.matrix(covariates_exp_df_list[[7]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[7]], column.names_exp, matrix.names_exp))
covariates_exp_array_15 <- array(as.matrix(covariates_exp_df_list[[8]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[8]], column.names_exp, matrix.names_exp))
covariates_exp_array_17 <- array(as.matrix(covariates_exp_df_list[[9]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[9]], column.names_exp, matrix.names_exp))
covariates_exp_array_19 <- array(as.matrix(covariates_exp_df_list[[10]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[10]], column.names_exp, matrix.names_exp))
covariates_exp_array_21 <- array(as.matrix(covariates_exp_df_list[[11]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[11]], column.names_exp, matrix.names_exp))
covariates_exp_array_23 <- array(as.matrix(covariates_exp_df_list[[12]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[12]], column.names_exp, matrix.names_exp))
covariates_exp_array_24 <- array(as.matrix(covariates_exp_df_list[[13]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[13]], column.names_exp, matrix.names_exp))
covariates_exp_array_25 <- array(as.matrix(covariates_exp_df_list[[14]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[14]], column.names_exp, matrix.names_exp))
covariates_exp_array_26 <- array(as.matrix(covariates_exp_df_list[[15]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[15]], column.names_exp, matrix.names_exp))
covariates_exp_array_28 <- array(as.matrix(covariates_exp_df_list[[16]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[16]], column.names_exp, matrix.names_exp))
covariates_exp_array_29 <- array(as.matrix(covariates_exp_df_list[[17]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[17]], column.names_exp, matrix.names_exp))
covariates_exp_array_30 <- array(as.matrix(covariates_exp_df_list[[18]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[18]], column.names_exp, matrix.names_exp))
covariates_exp_array_31 <- array(as.matrix(covariates_exp_df_list[[19]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[19]], column.names_exp, matrix.names_exp))
covariates_exp_array_32 <- array(as.matrix(covariates_exp_df_list[[20]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[20]], column.names_exp, matrix.names_exp))
covariates_exp_array_33 <- array(as.matrix(covariates_exp_df_list[[21]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[21]], column.names_exp, matrix.names_exp))
covariates_exp_array_34 <- array(as.matrix(covariates_exp_df_list[[22]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[22]], column.names_exp, matrix.names_exp))
covariates_exp_array_36 <- array(as.matrix(covariates_exp_df_list[[23]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[23]], column.names_exp, matrix.names_exp))
covariates_exp_array_37 <- array(as.matrix(covariates_exp_df_list[[24]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[24]], column.names_exp, matrix.names_exp))
covariates_exp_array_39 <- array(as.matrix(covariates_exp_df_list[[25]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[25]], column.names_exp, matrix.names_exp))
covariates_exp_array_40 <- array(as.matrix(covariates_exp_df_list[[26]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[26]], column.names_exp, matrix.names_exp))
covariates_exp_array_41 <- array(as.matrix(covariates_exp_df_list[[27]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[27]], column.names_exp, matrix.names_exp))
covariates_exp_array_44 <- array(as.matrix(covariates_exp_df_list[[28]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[28]], column.names_exp, matrix.names_exp))
covariates_exp_array_45 <- array(as.matrix(covariates_exp_df_list[[29]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[29]], column.names_exp, matrix.names_exp))
covariates_exp_array_47 <- array(as.matrix(covariates_exp_df_list[[30]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[30]], column.names_exp, matrix.names_exp))
covariates_exp_array_50 <- array(as.matrix(covariates_exp_df_list[[31]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[31]], column.names_exp, matrix.names_exp))
covariates_exp_array_51 <- array(as.matrix(covariates_exp_df_list[[32]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[32]], column.names_exp, matrix.names_exp))
covariates_exp_array_53 <- array(as.matrix(covariates_exp_df_list[[33]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[33]], column.names_exp, matrix.names_exp))
covariates_exp_array_54 <- array(as.matrix(covariates_exp_df_list[[34]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[34]], column.names_exp, matrix.names_exp))
covariates_exp_array_55 <- array(as.matrix(covariates_exp_df_list[[35]][,4:15]), dim = c(35,35,12), dimnames = list(row.names_exp_list[[35]], column.names_exp, matrix.names_exp))

##### Create 3D arrays of time-varying covariates for synthetic matching for all potential control states - CON_NursingHome #####
controls.nh.df <- subset(CON_NursingHome, alwaysconpa == 1)
print(unique(controls.nh.df$id))
for(i in unique(controls.nh.df$id)) {
  assign(paste0("covariates_acc_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
covariates_acc_df1$treated_aux <- ifelse(covariates_acc_df1$id == 1, 1, 0)
covariates_acc_df2$treated_aux <- ifelse(covariates_acc_df2$id == 2, 1, 0)
covariates_acc_df5$treated_aux <- ifelse(covariates_acc_df5$id == 5, 1, 0)
covariates_acc_df10$treated_aux <- ifelse(covariates_acc_df10$id == 10, 1, 0)
covariates_acc_df11$treated_aux <- ifelse(covariates_acc_df11$id == 11, 1, 0)
covariates_acc_df12$treated_aux <- ifelse(covariates_acc_df12$id == 12, 1, 0)
covariates_acc_df13$treated_aux <- ifelse(covariates_acc_df13$id == 13, 1, 0)
covariates_acc_df15$treated_aux <- ifelse(covariates_acc_df15$id == 15, 1, 0)
covariates_acc_df17$treated_aux <- ifelse(covariates_acc_df17$id == 17, 1, 0)
covariates_acc_df19$treated_aux <- ifelse(covariates_acc_df19$id == 19, 1, 0)
covariates_acc_df21$treated_aux <- ifelse(covariates_acc_df21$id == 21, 1, 0)
covariates_acc_df23$treated_aux <- ifelse(covariates_acc_df23$id == 23, 1, 0)
covariates_acc_df24$treated_aux <- ifelse(covariates_acc_df24$id == 24, 1, 0)
covariates_acc_df25$treated_aux <- ifelse(covariates_acc_df25$id == 25, 1, 0)
covariates_acc_df26$treated_aux <- ifelse(covariates_acc_df26$id == 26, 1, 0)
covariates_acc_df28$treated_aux <- ifelse(covariates_acc_df28$id == 28, 1, 0)
covariates_acc_df29$treated_aux <- ifelse(covariates_acc_df29$id == 29, 1, 0)
covariates_acc_df30$treated_aux <- ifelse(covariates_acc_df30$id == 30, 1, 0)
covariates_acc_df31$treated_aux <- ifelse(covariates_acc_df31$id == 31, 1, 0)
covariates_acc_df32$treated_aux <- ifelse(covariates_acc_df32$id == 32, 1, 0)
covariates_acc_df33$treated_aux <- ifelse(covariates_acc_df33$id == 33, 1, 0)
covariates_acc_df34$treated_aux <- ifelse(covariates_acc_df34$id == 34, 1, 0)
covariates_acc_df36$treated_aux <- ifelse(covariates_acc_df36$id == 36, 1, 0)
covariates_acc_df37$treated_aux <- ifelse(covariates_acc_df37$id == 37, 1, 0)
covariates_acc_df39$treated_aux <- ifelse(covariates_acc_df39$id == 39, 1, 0)
covariates_acc_df40$treated_aux <- ifelse(covariates_acc_df40$id == 40, 1, 0)
covariates_acc_df41$treated_aux <- ifelse(covariates_acc_df41$id == 41, 1, 0)
covariates_acc_df44$treated_aux <- ifelse(covariates_acc_df44$id == 44, 1, 0)
covariates_acc_df45$treated_aux <- ifelse(covariates_acc_df45$id == 45, 1, 0)
covariates_acc_df47$treated_aux <- ifelse(covariates_acc_df47$id == 47, 1, 0)
covariates_acc_df50$treated_aux <- ifelse(covariates_acc_df50$id == 50, 1, 0)
covariates_acc_df51$treated_aux <- ifelse(covariates_acc_df51$id == 51, 1, 0)
covariates_acc_df53$treated_aux <- ifelse(covariates_acc_df53$id == 53, 1, 0)
covariates_acc_df54$treated_aux <- ifelse(covariates_acc_df54$id == 54, 1, 0)
covariates_acc_df55$treated_aux <- ifelse(covariates_acc_df55$id == 55, 1, 0)
covariates_acc_df_list <- list(covariates_acc_df1,covariates_acc_df2,covariates_acc_df5,
                               covariates_acc_df10,covariates_acc_df11,covariates_acc_df12,
                               covariates_acc_df13,covariates_acc_df15,covariates_acc_df17,
                               covariates_acc_df19,covariates_acc_df21,covariates_acc_df23,
                               covariates_acc_df24,covariates_acc_df25,covariates_acc_df26,
                               covariates_acc_df28,covariates_acc_df29,covariates_acc_df30,
                               covariates_acc_df31,covariates_acc_df32,covariates_acc_df33,
                               covariates_acc_df34,covariates_acc_df36,covariates_acc_df37,
                               covariates_acc_df39,covariates_acc_df40,covariates_acc_df41,
                               covariates_acc_df44,covariates_acc_df45,covariates_acc_df47,
                               covariates_acc_df50,covariates_acc_df51,covariates_acc_df53,
                               covariates_acc_df54,covariates_acc_df55)
rm(covariates_acc_df1,covariates_acc_df2,covariates_acc_df5,
   covariates_acc_df10,covariates_acc_df11,covariates_acc_df12,
   covariates_acc_df13,covariates_acc_df15,covariates_acc_df17,
   covariates_acc_df19,covariates_acc_df21,covariates_acc_df23,
   covariates_acc_df24,covariates_acc_df25,covariates_acc_df26,
   covariates_acc_df28,covariates_acc_df29,covariates_acc_df30,
   covariates_acc_df31,covariates_acc_df32,covariates_acc_df33,
   covariates_acc_df34,covariates_acc_df36,covariates_acc_df37,
   covariates_acc_df39,covariates_acc_df40,covariates_acc_df41,
   covariates_acc_df44,covariates_acc_df45,covariates_acc_df47,
   covariates_acc_df50,covariates_acc_df51,covariates_acc_df53,
   covariates_acc_df54,covariates_acc_df55)
covariates_acc_df_list <- lapply(covariates_acc_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
covariates_acc_df_list <- lapply(covariates_acc_df_list, function(x)
  x <- as.data.frame(subset(x, code == 10, select=c(id,name, year, income_pcp_adj, pop_density, unemp_rate, top1_adj, gini, prop_age_25to45_bsy, prop_age_45to65_bsy, prop_age_over65_bsy, prop_bach_degree_bsy, prop_male_bsy, prop_married_bsy, prop_white_bsy)))
)
covariates_acc_df_list <- lapply(covariates_acc_df_list, function(x) {
  x["income_pcp_adj"] <- x["income_pcp_adj"]/100000    # there seems to be a problem with the scalability of covariates - see Github issues page #
  x["unemp_rate"] <- x["unemp_rate"]/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
  x["top1_adj"] <- x["top1_adj"]/100    # there seems to be a problem with the scalability of covariates - see Github issues page #
  return(x)
}
)
column.names_acc <- c(1991:2014)
row.names_acc_1 <- c(covariates_acc_df_list[[1]][1:35,2])
row.names_acc_2 <- c(covariates_acc_df_list[[2]][1:35,2])
row.names_acc_5 <- c(covariates_acc_df_list[[3]][1:35,2])
row.names_acc_10 <- c(covariates_acc_df_list[[4]][1:35,2])
row.names_acc_11 <- c(covariates_acc_df_list[[5]][1:35,2])
row.names_acc_12 <- c(covariates_acc_df_list[[6]][1:35,2])
row.names_acc_13 <- c(covariates_acc_df_list[[7]][1:35,2])
row.names_acc_15 <- c(covariates_acc_df_list[[8]][1:35,2])
row.names_acc_17 <- c(covariates_acc_df_list[[9]][1:35,2])
row.names_acc_19 <- c(covariates_acc_df_list[[10]][1:35,2])
row.names_acc_21 <- c(covariates_acc_df_list[[11]][1:35,2])
row.names_acc_23 <- c(covariates_acc_df_list[[12]][1:35,2])
row.names_acc_24 <- c(covariates_acc_df_list[[13]][1:35,2])
row.names_acc_25 <- c(covariates_acc_df_list[[14]][1:35,2])
row.names_acc_26 <- c(covariates_acc_df_list[[15]][1:35,2])
row.names_acc_28 <- c(covariates_acc_df_list[[16]][1:35,2])
row.names_acc_29 <- c(covariates_acc_df_list[[17]][1:35,2])
row.names_acc_30 <- c(covariates_acc_df_list[[18]][1:35,2])
row.names_acc_31 <- c(covariates_acc_df_list[[19]][1:35,2])
row.names_acc_32 <- c(covariates_acc_df_list[[20]][1:35,2])
row.names_acc_33 <- c(covariates_acc_df_list[[21]][1:35,2])
row.names_acc_34 <- c(covariates_acc_df_list[[22]][1:35,2])
row.names_acc_36 <- c(covariates_acc_df_list[[23]][1:35,2])
row.names_acc_37 <- c(covariates_acc_df_list[[24]][1:35,2])
row.names_acc_39 <- c(covariates_acc_df_list[[25]][1:35,2])
row.names_acc_40 <- c(covariates_acc_df_list[[26]][1:35,2])
row.names_acc_41 <- c(covariates_acc_df_list[[27]][1:35,2])
row.names_acc_44 <- c(covariates_acc_df_list[[28]][1:35,2])
row.names_acc_45 <- c(covariates_acc_df_list[[29]][1:35,2])
row.names_acc_47 <- c(covariates_acc_df_list[[30]][1:35,2])
row.names_acc_50 <- c(covariates_acc_df_list[[31]][1:35,2])
row.names_acc_51 <- c(covariates_acc_df_list[[32]][1:35,2])
row.names_acc_53 <- c(covariates_acc_df_list[[33]][1:35,2])
row.names_acc_54 <- c(covariates_acc_df_list[[34]][1:35,2])
row.names_acc_55 <- c(covariates_acc_df_list[[35]][1:35,2])
row.names_acc_list <- list(row.names_acc_1,row.names_acc_2,row.names_acc_5,
                           row.names_acc_10,row.names_acc_11,row.names_acc_12,
                           row.names_acc_13,row.names_acc_15,row.names_acc_17,
                           row.names_acc_19,row.names_acc_21,row.names_acc_23,
                           row.names_acc_24,row.names_acc_25,row.names_acc_26,
                           row.names_acc_28,row.names_acc_29,row.names_acc_30,
                           row.names_acc_31,row.names_acc_32,row.names_acc_33,
                           row.names_acc_34,row.names_acc_36,row.names_acc_37,
                           row.names_acc_39,row.names_acc_40,row.names_acc_41,
                           row.names_acc_44,row.names_acc_45,row.names_acc_47,
                           row.names_acc_50,row.names_acc_51,row.names_acc_53,
                           row.names_acc_54,row.names_acc_55)
rm(row.names_acc_1,row.names_acc_2,row.names_acc_5,
   row.names_acc_10,row.names_acc_11,row.names_acc_12,
   row.names_acc_13,row.names_acc_15,row.names_acc_17,
   row.names_acc_19,row.names_acc_21,row.names_acc_23,
   row.names_acc_24,row.names_acc_25,row.names_acc_26,
   row.names_acc_28,row.names_acc_29,row.names_acc_30,
   row.names_acc_31,row.names_acc_32,row.names_acc_33,
   row.names_acc_34,row.names_acc_36,row.names_acc_37,
   row.names_acc_39,row.names_acc_40,row.names_acc_41,
   row.names_acc_44,row.names_acc_45,row.names_acc_47,
   row.names_acc_50,row.names_acc_51,row.names_acc_53,
   row.names_acc_54,row.names_acc_55)
matrix.names_acc <- c("income_pcp_adj", "pop_density", "unemp_rate", "top1_adj", "gini", "prop_age_25to45_bsy", "prop_age_45to65_bsy", "prop_age_over65_bsy", "prop_bach_degree_bsy", "prop_male_bsy", "prop_married_bsy", "prop_white_bsy")
covariates_acc_array_1 <- array(as.matrix(covariates_acc_df_list[[1]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[1]], column.names_acc, matrix.names_acc))
covariates_acc_array_2 <- array(as.matrix(covariates_acc_df_list[[2]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[2]], column.names_acc, matrix.names_acc))
covariates_acc_array_5 <- array(as.matrix(covariates_acc_df_list[[3]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[3]], column.names_acc, matrix.names_acc))
covariates_acc_array_10 <- array(as.matrix(covariates_acc_df_list[[4]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[4]], column.names_acc, matrix.names_acc))
covariates_acc_array_11 <- array(as.matrix(covariates_acc_df_list[[5]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[5]], column.names_acc, matrix.names_acc))
covariates_acc_array_12 <- array(as.matrix(covariates_acc_df_list[[6]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[6]], column.names_acc, matrix.names_acc))
covariates_acc_array_13 <- array(as.matrix(covariates_acc_df_list[[7]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[7]], column.names_acc, matrix.names_acc))
covariates_acc_array_15 <- array(as.matrix(covariates_acc_df_list[[8]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[8]], column.names_acc, matrix.names_acc))
covariates_acc_array_17 <- array(as.matrix(covariates_acc_df_list[[9]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[9]], column.names_acc, matrix.names_acc))
covariates_acc_array_19 <- array(as.matrix(covariates_acc_df_list[[10]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[10]], column.names_acc, matrix.names_acc))
covariates_acc_array_21 <- array(as.matrix(covariates_acc_df_list[[11]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[11]], column.names_acc, matrix.names_acc))
covariates_acc_array_23 <- array(as.matrix(covariates_acc_df_list[[12]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[12]], column.names_acc, matrix.names_acc))
covariates_acc_array_24 <- array(as.matrix(covariates_acc_df_list[[13]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[13]], column.names_acc, matrix.names_acc))
covariates_acc_array_25 <- array(as.matrix(covariates_acc_df_list[[14]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[14]], column.names_acc, matrix.names_acc))
covariates_acc_array_26 <- array(as.matrix(covariates_acc_df_list[[15]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[15]], column.names_acc, matrix.names_acc))
covariates_acc_array_28 <- array(as.matrix(covariates_acc_df_list[[16]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[16]], column.names_acc, matrix.names_acc))
covariates_acc_array_29 <- array(as.matrix(covariates_acc_df_list[[17]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[17]], column.names_acc, matrix.names_acc))
covariates_acc_array_30 <- array(as.matrix(covariates_acc_df_list[[18]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[18]], column.names_acc, matrix.names_acc))
covariates_acc_array_31 <- array(as.matrix(covariates_acc_df_list[[19]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[19]], column.names_acc, matrix.names_acc))
covariates_acc_array_32 <- array(as.matrix(covariates_acc_df_list[[20]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[20]], column.names_acc, matrix.names_acc))
covariates_acc_array_33 <- array(as.matrix(covariates_acc_df_list[[21]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[21]], column.names_acc, matrix.names_acc))
covariates_acc_array_34 <- array(as.matrix(covariates_acc_df_list[[22]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[22]], column.names_acc, matrix.names_acc))
covariates_acc_array_36 <- array(as.matrix(covariates_acc_df_list[[23]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[23]], column.names_acc, matrix.names_acc))
covariates_acc_array_37 <- array(as.matrix(covariates_acc_df_list[[24]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[24]], column.names_acc, matrix.names_acc))
covariates_acc_array_39 <- array(as.matrix(covariates_acc_df_list[[25]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[25]], column.names_acc, matrix.names_acc))
covariates_acc_array_40 <- array(as.matrix(covariates_acc_df_list[[26]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[26]], column.names_acc, matrix.names_acc))
covariates_acc_array_41 <- array(as.matrix(covariates_acc_df_list[[27]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[27]], column.names_acc, matrix.names_acc))
covariates_acc_array_44 <- array(as.matrix(covariates_acc_df_list[[28]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[28]], column.names_acc, matrix.names_acc))
covariates_acc_array_45 <- array(as.matrix(covariates_acc_df_list[[29]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[29]], column.names_acc, matrix.names_acc))
covariates_acc_array_47 <- array(as.matrix(covariates_acc_df_list[[30]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[30]], column.names_acc, matrix.names_acc))
covariates_acc_array_50 <- array(as.matrix(covariates_acc_df_list[[31]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[31]], column.names_acc, matrix.names_acc))
covariates_acc_array_51 <- array(as.matrix(covariates_acc_df_list[[32]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[32]], column.names_acc, matrix.names_acc))
covariates_acc_array_53 <- array(as.matrix(covariates_acc_df_list[[33]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[33]], column.names_acc, matrix.names_acc))
covariates_acc_array_54 <- array(as.matrix(covariates_acc_df_list[[34]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[34]], column.names_acc, matrix.names_acc))
covariates_acc_array_55 <- array(as.matrix(covariates_acc_df_list[[35]][,4:15]), dim = c(35,24,12), dimnames = list(row.names_acc_list[[35]], column.names_acc, matrix.names_acc))


########## Pennsylvania ##########

##### Quantity of Nursing Homes #####
### PA - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_homes_pa_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_pa_df$treated <- as.integer(ifelse(q_nursing_homes_pa_df$name == "Pennsylvania" & q_nursing_homes_pa_df$year >= 1996, 1, 0))
q_nursing_homes_pa_df <- q_nursing_homes_pa_df[order(q_nursing_homes_pa_df$year, q_nursing_homes_pa_df$treated_pa_aux, q_nursing_homes_pa_df$name),]
q_nursing_homes_pa_df <- subset(q_nursing_homes_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nh_pa <- panel.matrices(q_nursing_homes_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nh_est_did_pa <- did_estimate(setup_q_nh_pa$Y, setup_q_nh_pa$N0, setup_q_nh_pa$T0, X = covariates_acc_pa_array)
q_nh_est_did_plot_pa <- synthdid_plot(q_nh_est_did_pa)
q_nh_est_did_plot_data_aux_pa <- ggplot_build(q_nh_est_did_plot_pa)
q_nh_est_did_plot_data_long_pa <- data.frame(q_nh_est_did_plot_data_aux_pa$data[[1]]$x, q_nh_est_did_plot_data_aux_pa$data[[1]]$y, q_nh_est_did_plot_data_aux_pa$data[[1]]$group)
colnames(q_nh_est_did_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nh_est_did_plot_data_long_pa$treated <- q_nh_est_did_plot_data_long_pa$treated - 1
q_nh_est_did_plot_data_wide_pa <- reshape(data=q_nh_est_did_plot_data_long_pa,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nh_est_did_plot_data_wide_pa$diff <- q_nh_est_did_plot_data_wide_pa$outcome.1 - q_nh_est_did_plot_data_wide_pa$outcome.0
# SC #
q_nh_est_sc_pa <- sc_estimate(setup_q_nh_pa$Y, setup_q_nh_pa$N0, setup_q_nh_pa$T0, X = covariates_acc_pa_array)
q_nh_est_sc_plot_pa <- synthdid_plot(q_nh_est_sc_pa)
q_nh_est_sc_plot_data_aux_pa <- ggplot_build(q_nh_est_sc_plot_pa)
q_nh_est_sc_plot_data_long_pa <- data.frame(q_nh_est_sc_plot_data_aux_pa$data[[1]]$x, q_nh_est_sc_plot_data_aux_pa$data[[1]]$y, q_nh_est_sc_plot_data_aux_pa$data[[1]]$group)
colnames(q_nh_est_sc_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nh_est_sc_plot_data_long_pa$treated <- q_nh_est_sc_plot_data_long_pa$treated - 1
q_nh_est_sc_plot_data_wide_pa <- reshape(data=q_nh_est_sc_plot_data_long_pa,
                                         idvar = "year",
                                         v.names = "outcome",
                                         timevar = "treated",
                                         direction = "wide")
q_nh_est_sc_plot_data_wide_pa$diff <- q_nh_est_sc_plot_data_wide_pa$outcome.1 - q_nh_est_sc_plot_data_wide_pa$outcome.0
# SDID #
q_nh_est_sdid_pa <- synthdid_estimate(setup_q_nh_pa$Y, setup_q_nh_pa$N0, setup_q_nh_pa$T0, X = covariates_acc_pa_array)
q_nh_est_sdid_plot_pa <- synthdid_plot(q_nh_est_sdid_pa)
q_nh_est_sdid_plot_data_aux_pa <- ggplot_build(q_nh_est_sdid_plot_pa)
q_nh_est_sdid_plot_data_long_pa <- data.frame(q_nh_est_sdid_plot_data_aux_pa$data[[1]]$x, q_nh_est_sdid_plot_data_aux_pa$data[[1]]$y, q_nh_est_sdid_plot_data_aux_pa$data[[1]]$group)
colnames(q_nh_est_sdid_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nh_est_sdid_plot_data_long_pa$treated <- q_nh_est_sdid_plot_data_long_pa$treated - 1
q_nh_est_sdid_plot_data_wide_pa <- reshape(data=q_nh_est_sdid_plot_data_long_pa,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nh_est_sdid_plot_data_wide_pa$diff <- q_nh_est_sdid_plot_data_wide_pa$outcome.1 - q_nh_est_sdid_plot_data_wide_pa$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nh_pa_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nh_pa_df1$treated_aux <- ifelse(q_nh_pa_df1$id == 1, 1, 0)
q_nh_pa_df2$treated_aux <- ifelse(q_nh_pa_df2$id == 2, 1, 0)
q_nh_pa_df5$treated_aux <- ifelse(q_nh_pa_df5$id == 5, 1, 0)
q_nh_pa_df10$treated_aux <- ifelse(q_nh_pa_df10$id == 10, 1, 0)
q_nh_pa_df11$treated_aux <- ifelse(q_nh_pa_df11$id == 11, 1, 0)
q_nh_pa_df12$treated_aux <- ifelse(q_nh_pa_df12$id == 12, 1, 0)
q_nh_pa_df13$treated_aux <- ifelse(q_nh_pa_df13$id == 13, 1, 0)
q_nh_pa_df15$treated_aux <- ifelse(q_nh_pa_df15$id == 15, 1, 0)
q_nh_pa_df17$treated_aux <- ifelse(q_nh_pa_df17$id == 17, 1, 0)
q_nh_pa_df19$treated_aux <- ifelse(q_nh_pa_df19$id == 19, 1, 0)
q_nh_pa_df21$treated_aux <- ifelse(q_nh_pa_df21$id == 21, 1, 0)
q_nh_pa_df23$treated_aux <- ifelse(q_nh_pa_df23$id == 23, 1, 0)
q_nh_pa_df24$treated_aux <- ifelse(q_nh_pa_df24$id == 24, 1, 0)
q_nh_pa_df25$treated_aux <- ifelse(q_nh_pa_df25$id == 25, 1, 0)
q_nh_pa_df26$treated_aux <- ifelse(q_nh_pa_df26$id == 26, 1, 0)
q_nh_pa_df28$treated_aux <- ifelse(q_nh_pa_df28$id == 28, 1, 0)
q_nh_pa_df29$treated_aux <- ifelse(q_nh_pa_df29$id == 29, 1, 0)
q_nh_pa_df30$treated_aux <- ifelse(q_nh_pa_df30$id == 30, 1, 0)
q_nh_pa_df31$treated_aux <- ifelse(q_nh_pa_df31$id == 31, 1, 0)
q_nh_pa_df32$treated_aux <- ifelse(q_nh_pa_df32$id == 32, 1, 0)
q_nh_pa_df33$treated_aux <- ifelse(q_nh_pa_df33$id == 33, 1, 0)
q_nh_pa_df34$treated_aux <- ifelse(q_nh_pa_df34$id == 34, 1, 0)
q_nh_pa_df36$treated_aux <- ifelse(q_nh_pa_df36$id == 36, 1, 0)
q_nh_pa_df37$treated_aux <- ifelse(q_nh_pa_df37$id == 37, 1, 0)
q_nh_pa_df39$treated_aux <- ifelse(q_nh_pa_df39$id == 39, 1, 0)
q_nh_pa_df40$treated_aux <- ifelse(q_nh_pa_df40$id == 40, 1, 0)
q_nh_pa_df41$treated_aux <- ifelse(q_nh_pa_df41$id == 41, 1, 0)
q_nh_pa_df44$treated_aux <- ifelse(q_nh_pa_df44$id == 44, 1, 0)
q_nh_pa_df45$treated_aux <- ifelse(q_nh_pa_df45$id == 45, 1, 0)
q_nh_pa_df47$treated_aux <- ifelse(q_nh_pa_df47$id == 47, 1, 0)
q_nh_pa_df50$treated_aux <- ifelse(q_nh_pa_df50$id == 50, 1, 0)
q_nh_pa_df51$treated_aux <- ifelse(q_nh_pa_df51$id == 51, 1, 0)
q_nh_pa_df53$treated_aux <- ifelse(q_nh_pa_df53$id == 53, 1, 0)
q_nh_pa_df54$treated_aux <- ifelse(q_nh_pa_df54$id == 54, 1, 0)
q_nh_pa_df55$treated_aux <- ifelse(q_nh_pa_df55$id == 55, 1, 0)
q_nh_pa_df1$treated <- as.integer(ifelse(q_nh_pa_df1$id == 1 & q_nh_pa_df1$year >= 1996, 1, 0))
q_nh_pa_df2$treated <- as.integer(ifelse(q_nh_pa_df2$id == 2 & q_nh_pa_df2$year >= 1996, 1, 0))
q_nh_pa_df5$treated <- as.integer(ifelse(q_nh_pa_df5$id == 5 & q_nh_pa_df5$year >= 1996, 1, 0))
q_nh_pa_df10$treated <- as.integer(ifelse(q_nh_pa_df10$id == 10 & q_nh_pa_df10$year >= 1996, 1, 0))
q_nh_pa_df11$treated <- as.integer(ifelse(q_nh_pa_df11$id == 11 & q_nh_pa_df11$year >= 1996, 1, 0))
q_nh_pa_df12$treated <- as.integer(ifelse(q_nh_pa_df12$id == 12 & q_nh_pa_df12$year >= 1996, 1, 0))
q_nh_pa_df13$treated <- as.integer(ifelse(q_nh_pa_df13$id == 13 & q_nh_pa_df13$year >= 1996, 1, 0))
q_nh_pa_df15$treated <- as.integer(ifelse(q_nh_pa_df15$id == 15 & q_nh_pa_df15$year >= 1996, 1, 0))
q_nh_pa_df17$treated <- as.integer(ifelse(q_nh_pa_df17$id == 17 & q_nh_pa_df17$year >= 1996, 1, 0))
q_nh_pa_df19$treated <- as.integer(ifelse(q_nh_pa_df19$id == 19 & q_nh_pa_df19$year >= 1996, 1, 0))
q_nh_pa_df21$treated <- as.integer(ifelse(q_nh_pa_df21$id == 21 & q_nh_pa_df21$year >= 1996, 1, 0))
q_nh_pa_df23$treated <- as.integer(ifelse(q_nh_pa_df23$id == 23 & q_nh_pa_df23$year >= 1996, 1, 0))
q_nh_pa_df24$treated <- as.integer(ifelse(q_nh_pa_df24$id == 24 & q_nh_pa_df24$year >= 1996, 1, 0))
q_nh_pa_df25$treated <- as.integer(ifelse(q_nh_pa_df25$id == 25 & q_nh_pa_df25$year >= 1996, 1, 0))
q_nh_pa_df26$treated <- as.integer(ifelse(q_nh_pa_df26$id == 26 & q_nh_pa_df26$year >= 1996, 1, 0))
q_nh_pa_df28$treated <- as.integer(ifelse(q_nh_pa_df28$id == 28 & q_nh_pa_df28$year >= 1996, 1, 0))
q_nh_pa_df29$treated <- as.integer(ifelse(q_nh_pa_df29$id == 29 & q_nh_pa_df29$year >= 1996, 1, 0))
q_nh_pa_df30$treated <- as.integer(ifelse(q_nh_pa_df30$id == 30 & q_nh_pa_df30$year >= 1996, 1, 0))
q_nh_pa_df31$treated <- as.integer(ifelse(q_nh_pa_df31$id == 31 & q_nh_pa_df31$year >= 1996, 1, 0))
q_nh_pa_df32$treated <- as.integer(ifelse(q_nh_pa_df32$id == 32 & q_nh_pa_df32$year >= 1996, 1, 0))
q_nh_pa_df33$treated <- as.integer(ifelse(q_nh_pa_df33$id == 33 & q_nh_pa_df33$year >= 1996, 1, 0))
q_nh_pa_df34$treated <- as.integer(ifelse(q_nh_pa_df34$id == 34 & q_nh_pa_df34$year >= 1996, 1, 0))
q_nh_pa_df36$treated <- as.integer(ifelse(q_nh_pa_df36$id == 36 & q_nh_pa_df36$year >= 1996, 1, 0))
q_nh_pa_df37$treated <- as.integer(ifelse(q_nh_pa_df37$id == 37 & q_nh_pa_df37$year >= 1996, 1, 0))
q_nh_pa_df39$treated <- as.integer(ifelse(q_nh_pa_df39$id == 39 & q_nh_pa_df39$year >= 1996, 1, 0))
q_nh_pa_df40$treated <- as.integer(ifelse(q_nh_pa_df40$id == 40 & q_nh_pa_df40$year >= 1996, 1, 0))
q_nh_pa_df41$treated <- as.integer(ifelse(q_nh_pa_df41$id == 41 & q_nh_pa_df41$year >= 1996, 1, 0))
q_nh_pa_df44$treated <- as.integer(ifelse(q_nh_pa_df44$id == 44 & q_nh_pa_df44$year >= 1996, 1, 0))
q_nh_pa_df45$treated <- as.integer(ifelse(q_nh_pa_df45$id == 45 & q_nh_pa_df45$year >= 1996, 1, 0))
q_nh_pa_df47$treated <- as.integer(ifelse(q_nh_pa_df47$id == 47 & q_nh_pa_df47$year >= 1996, 1, 0))
q_nh_pa_df50$treated <- as.integer(ifelse(q_nh_pa_df50$id == 50 & q_nh_pa_df50$year >= 1996, 1, 0))
q_nh_pa_df51$treated <- as.integer(ifelse(q_nh_pa_df51$id == 51 & q_nh_pa_df51$year >= 1996, 1, 0))
q_nh_pa_df53$treated <- as.integer(ifelse(q_nh_pa_df53$id == 53 & q_nh_pa_df53$year >= 1996, 1, 0))
q_nh_pa_df54$treated <- as.integer(ifelse(q_nh_pa_df54$id == 54 & q_nh_pa_df54$year >= 1996, 1, 0))
q_nh_pa_df55$treated <- as.integer(ifelse(q_nh_pa_df55$id == 55 & q_nh_pa_df55$year >= 1996, 1, 0))
q_nh_pa_df_list <- list(q_nh_pa_df1,q_nh_pa_df2,q_nh_pa_df5,
                     q_nh_pa_df10,q_nh_pa_df11,q_nh_pa_df12,
                     q_nh_pa_df13,q_nh_pa_df15,q_nh_pa_df17,
                     q_nh_pa_df19,q_nh_pa_df21,q_nh_pa_df23,
                     q_nh_pa_df24,q_nh_pa_df25,q_nh_pa_df26,
                     q_nh_pa_df28,q_nh_pa_df29,q_nh_pa_df30,
                     q_nh_pa_df31,q_nh_pa_df32,q_nh_pa_df33,
                     q_nh_pa_df34,q_nh_pa_df36,q_nh_pa_df37,
                     q_nh_pa_df39,q_nh_pa_df40,q_nh_pa_df41,
                     q_nh_pa_df44,q_nh_pa_df45,q_nh_pa_df47,
                     q_nh_pa_df50,q_nh_pa_df51,q_nh_pa_df53,
                     q_nh_pa_df54,q_nh_pa_df55)
rm(q_nh_pa_df1,q_nh_pa_df2,q_nh_pa_df5,
   q_nh_pa_df10,q_nh_pa_df11,q_nh_pa_df12,
   q_nh_pa_df13,q_nh_pa_df15,q_nh_pa_df17,
   q_nh_pa_df19,q_nh_pa_df21,q_nh_pa_df23,
   q_nh_pa_df24,q_nh_pa_df25,q_nh_pa_df26,
   q_nh_pa_df28,q_nh_pa_df29,q_nh_pa_df30,
   q_nh_pa_df31,q_nh_pa_df32,q_nh_pa_df33,
   q_nh_pa_df34,q_nh_pa_df36,q_nh_pa_df37,
   q_nh_pa_df39,q_nh_pa_df40,q_nh_pa_df41,
   q_nh_pa_df44,q_nh_pa_df45,q_nh_pa_df47,
   q_nh_pa_df50,q_nh_pa_df51,q_nh_pa_df53,
   q_nh_pa_df54,q_nh_pa_df55)
q_nh_pa_df_list <- lapply(q_nh_pa_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nh_pa_df_list <- lapply(q_nh_pa_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomes_pcp, treated)))
}
)
setup_q_nh_pa1 <- panel.matrices(q_nh_pa_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa2 <- panel.matrices(q_nh_pa_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa5 <- panel.matrices(q_nh_pa_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa10 <- panel.matrices(q_nh_pa_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa11 <- panel.matrices(q_nh_pa_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa12 <- panel.matrices(q_nh_pa_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa13 <- panel.matrices(q_nh_pa_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa15 <- panel.matrices(q_nh_pa_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa17 <- panel.matrices(q_nh_pa_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa19 <- panel.matrices(q_nh_pa_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa21 <- panel.matrices(q_nh_pa_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa23 <- panel.matrices(q_nh_pa_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa24 <- panel.matrices(q_nh_pa_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa25 <- panel.matrices(q_nh_pa_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa26 <- panel.matrices(q_nh_pa_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa28 <- panel.matrices(q_nh_pa_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa29 <- panel.matrices(q_nh_pa_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa30 <- panel.matrices(q_nh_pa_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa31 <- panel.matrices(q_nh_pa_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa32 <- panel.matrices(q_nh_pa_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa33 <- panel.matrices(q_nh_pa_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa34 <- panel.matrices(q_nh_pa_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa36 <- panel.matrices(q_nh_pa_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa37 <- panel.matrices(q_nh_pa_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa39 <- panel.matrices(q_nh_pa_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa40 <- panel.matrices(q_nh_pa_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa41 <- panel.matrices(q_nh_pa_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa44 <- panel.matrices(q_nh_pa_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa45 <- panel.matrices(q_nh_pa_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa47 <- panel.matrices(q_nh_pa_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa50 <- panel.matrices(q_nh_pa_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa51 <- panel.matrices(q_nh_pa_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa53 <- panel.matrices(q_nh_pa_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa54 <- panel.matrices(q_nh_pa_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa55 <- panel.matrices(q_nh_pa_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_pa_list <- list(setup_q_nh_pa1,setup_q_nh_pa2,setup_q_nh_pa5,
                        setup_q_nh_pa10,setup_q_nh_pa11,setup_q_nh_pa12,
                        setup_q_nh_pa13,setup_q_nh_pa15,setup_q_nh_pa17,
                        setup_q_nh_pa19,setup_q_nh_pa21,setup_q_nh_pa23,
                        setup_q_nh_pa24,setup_q_nh_pa25,setup_q_nh_pa26,
                        setup_q_nh_pa28,setup_q_nh_pa29,setup_q_nh_pa30,
                        setup_q_nh_pa31,setup_q_nh_pa32,setup_q_nh_pa33,
                        setup_q_nh_pa34,setup_q_nh_pa36,setup_q_nh_pa37,
                        setup_q_nh_pa39,setup_q_nh_pa40,setup_q_nh_pa41,
                        setup_q_nh_pa44,setup_q_nh_pa45,setup_q_nh_pa47,
                        setup_q_nh_pa50,setup_q_nh_pa51,setup_q_nh_pa53,
                        setup_q_nh_pa54,setup_q_nh_pa55)
rm(setup_q_nh_pa1,setup_q_nh_pa2,setup_q_nh_pa5,
   setup_q_nh_pa10,setup_q_nh_pa11,setup_q_nh_pa12,
   setup_q_nh_pa13,setup_q_nh_pa15,setup_q_nh_pa17,
   setup_q_nh_pa19,setup_q_nh_pa21,setup_q_nh_pa23,
   setup_q_nh_pa24,setup_q_nh_pa25,setup_q_nh_pa26,
   setup_q_nh_pa28,setup_q_nh_pa29,setup_q_nh_pa30,
   setup_q_nh_pa31,setup_q_nh_pa32,setup_q_nh_pa33,
   setup_q_nh_pa34,setup_q_nh_pa36,setup_q_nh_pa37,
   setup_q_nh_pa39,setup_q_nh_pa40,setup_q_nh_pa41,
   setup_q_nh_pa44,setup_q_nh_pa45,setup_q_nh_pa47,
   setup_q_nh_pa50,setup_q_nh_pa51,setup_q_nh_pa53,
   setup_q_nh_pa54,setup_q_nh_pa55)
# DID #
q_nh_pa_est_did1 <- did_estimate(setup_q_nh_pa_list[[1]]$Y, setup_q_nh_pa_list[[1]]$N0, setup_q_nh_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_pa_est_did2 <- did_estimate(setup_q_nh_pa_list[[2]]$Y, setup_q_nh_pa_list[[2]]$N0, setup_q_nh_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_pa_est_did5 <- did_estimate(setup_q_nh_pa_list[[3]]$Y, setup_q_nh_pa_list[[3]]$N0, setup_q_nh_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_pa_est_did10 <- did_estimate(setup_q_nh_pa_list[[4]]$Y, setup_q_nh_pa_list[[4]]$N0, setup_q_nh_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_pa_est_did11 <- did_estimate(setup_q_nh_pa_list[[5]]$Y, setup_q_nh_pa_list[[5]]$N0, setup_q_nh_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_pa_est_did12 <- did_estimate(setup_q_nh_pa_list[[6]]$Y, setup_q_nh_pa_list[[6]]$N0, setup_q_nh_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_pa_est_did13 <- did_estimate(setup_q_nh_pa_list[[7]]$Y, setup_q_nh_pa_list[[7]]$N0, setup_q_nh_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_pa_est_did15 <- did_estimate(setup_q_nh_pa_list[[8]]$Y, setup_q_nh_pa_list[[8]]$N0, setup_q_nh_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_pa_est_did17 <- did_estimate(setup_q_nh_pa_list[[9]]$Y, setup_q_nh_pa_list[[9]]$N0, setup_q_nh_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_pa_est_did19 <- did_estimate(setup_q_nh_pa_list[[10]]$Y, setup_q_nh_pa_list[[10]]$N0, setup_q_nh_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_pa_est_did21 <- did_estimate(setup_q_nh_pa_list[[11]]$Y, setup_q_nh_pa_list[[11]]$N0, setup_q_nh_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_pa_est_did23 <- did_estimate(setup_q_nh_pa_list[[12]]$Y, setup_q_nh_pa_list[[12]]$N0, setup_q_nh_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_pa_est_did24 <- did_estimate(setup_q_nh_pa_list[[13]]$Y, setup_q_nh_pa_list[[13]]$N0, setup_q_nh_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_pa_est_did25 <- did_estimate(setup_q_nh_pa_list[[14]]$Y, setup_q_nh_pa_list[[14]]$N0, setup_q_nh_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_pa_est_did26 <- did_estimate(setup_q_nh_pa_list[[15]]$Y, setup_q_nh_pa_list[[15]]$N0, setup_q_nh_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_pa_est_did28 <- did_estimate(setup_q_nh_pa_list[[16]]$Y, setup_q_nh_pa_list[[16]]$N0, setup_q_nh_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_pa_est_did29 <- did_estimate(setup_q_nh_pa_list[[17]]$Y, setup_q_nh_pa_list[[17]]$N0, setup_q_nh_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_pa_est_did30 <- did_estimate(setup_q_nh_pa_list[[18]]$Y, setup_q_nh_pa_list[[18]]$N0, setup_q_nh_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_pa_est_did31 <- did_estimate(setup_q_nh_pa_list[[19]]$Y, setup_q_nh_pa_list[[19]]$N0, setup_q_nh_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_pa_est_did32 <- did_estimate(setup_q_nh_pa_list[[20]]$Y, setup_q_nh_pa_list[[20]]$N0, setup_q_nh_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_pa_est_did33 <- did_estimate(setup_q_nh_pa_list[[21]]$Y, setup_q_nh_pa_list[[21]]$N0, setup_q_nh_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_pa_est_did34 <- did_estimate(setup_q_nh_pa_list[[22]]$Y, setup_q_nh_pa_list[[22]]$N0, setup_q_nh_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_pa_est_did36 <- did_estimate(setup_q_nh_pa_list[[23]]$Y, setup_q_nh_pa_list[[23]]$N0, setup_q_nh_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_pa_est_did37 <- did_estimate(setup_q_nh_pa_list[[24]]$Y, setup_q_nh_pa_list[[24]]$N0, setup_q_nh_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_pa_est_did39 <- did_estimate(setup_q_nh_pa_list[[25]]$Y, setup_q_nh_pa_list[[25]]$N0, setup_q_nh_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_pa_est_did40 <- did_estimate(setup_q_nh_pa_list[[26]]$Y, setup_q_nh_pa_list[[26]]$N0, setup_q_nh_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_pa_est_did41 <- did_estimate(setup_q_nh_pa_list[[27]]$Y, setup_q_nh_pa_list[[27]]$N0, setup_q_nh_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_pa_est_did44 <- did_estimate(setup_q_nh_pa_list[[28]]$Y, setup_q_nh_pa_list[[28]]$N0, setup_q_nh_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_pa_est_did45 <- did_estimate(setup_q_nh_pa_list[[29]]$Y, setup_q_nh_pa_list[[29]]$N0, setup_q_nh_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_pa_est_did47 <- did_estimate(setup_q_nh_pa_list[[30]]$Y, setup_q_nh_pa_list[[30]]$N0, setup_q_nh_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_pa_est_did50 <- did_estimate(setup_q_nh_pa_list[[31]]$Y, setup_q_nh_pa_list[[31]]$N0, setup_q_nh_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_pa_est_did51 <- did_estimate(setup_q_nh_pa_list[[32]]$Y, setup_q_nh_pa_list[[32]]$N0, setup_q_nh_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_pa_est_did53 <- did_estimate(setup_q_nh_pa_list[[33]]$Y, setup_q_nh_pa_list[[33]]$N0, setup_q_nh_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_pa_est_did54 <- did_estimate(setup_q_nh_pa_list[[34]]$Y, setup_q_nh_pa_list[[34]]$N0, setup_q_nh_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_pa_est_did55 <- did_estimate(setup_q_nh_pa_list[[35]]$Y, setup_q_nh_pa_list[[35]]$N0, setup_q_nh_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_pa_est_did_list <- list(q_nh_pa_est_did1,q_nh_pa_est_did2,q_nh_pa_est_did5,
                          q_nh_pa_est_did10,q_nh_pa_est_did11,q_nh_pa_est_did12,
                          q_nh_pa_est_did13,q_nh_pa_est_did15,q_nh_pa_est_did17,
                          q_nh_pa_est_did19,q_nh_pa_est_did21,q_nh_pa_est_did23,
                          q_nh_pa_est_did24,q_nh_pa_est_did25,q_nh_pa_est_did26,
                          q_nh_pa_est_did28,q_nh_pa_est_did29,q_nh_pa_est_did30,
                          q_nh_pa_est_did31,q_nh_pa_est_did32,q_nh_pa_est_did33,
                          q_nh_pa_est_did34,q_nh_pa_est_did36,q_nh_pa_est_did37,
                          q_nh_pa_est_did39,q_nh_pa_est_did40,q_nh_pa_est_did41,
                          q_nh_pa_est_did44,q_nh_pa_est_did45,q_nh_pa_est_did47,
                          q_nh_pa_est_did50,q_nh_pa_est_did51,q_nh_pa_est_did53,
                          q_nh_pa_est_did54,q_nh_pa_est_did55)
rm(q_nh_pa_est_did1,q_nh_pa_est_did2,q_nh_pa_est_did5,
   q_nh_pa_est_did10,q_nh_pa_est_did11,q_nh_pa_est_did12,
   q_nh_pa_est_did13,q_nh_pa_est_did15,q_nh_pa_est_did17,
   q_nh_pa_est_did19,q_nh_pa_est_did21,q_nh_pa_est_did23,
   q_nh_pa_est_did24,q_nh_pa_est_did25,q_nh_pa_est_did26,
   q_nh_pa_est_did28,q_nh_pa_est_did29,q_nh_pa_est_did30,
   q_nh_pa_est_did31,q_nh_pa_est_did32,q_nh_pa_est_did33,
   q_nh_pa_est_did34,q_nh_pa_est_did36,q_nh_pa_est_did37,
   q_nh_pa_est_did39,q_nh_pa_est_did40,q_nh_pa_est_did41,
   q_nh_pa_est_did44,q_nh_pa_est_did45,q_nh_pa_est_did47,
   q_nh_pa_est_did50,q_nh_pa_est_did51,q_nh_pa_est_did53,
   q_nh_pa_est_did54,q_nh_pa_est_did55)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_did_plot", i), synthdid_plot(q_nh_pa_est_did_list[i]))
}
q_nh_pa_est_did_plot_data_aux1 <- ggplot_build(q_nh_pa_est_did_plot1)
q_nh_pa_est_did_plot_data_aux2 <- ggplot_build(q_nh_pa_est_did_plot2)
q_nh_pa_est_did_plot_data_aux3 <- ggplot_build(q_nh_pa_est_did_plot3)
q_nh_pa_est_did_plot_data_aux4 <- ggplot_build(q_nh_pa_est_did_plot4)
q_nh_pa_est_did_plot_data_aux5 <- ggplot_build(q_nh_pa_est_did_plot5)
q_nh_pa_est_did_plot_data_aux6 <- ggplot_build(q_nh_pa_est_did_plot6)
q_nh_pa_est_did_plot_data_aux7 <- ggplot_build(q_nh_pa_est_did_plot7)
q_nh_pa_est_did_plot_data_aux8 <- ggplot_build(q_nh_pa_est_did_plot8)
q_nh_pa_est_did_plot_data_aux9 <- ggplot_build(q_nh_pa_est_did_plot9)
q_nh_pa_est_did_plot_data_aux10 <- ggplot_build(q_nh_pa_est_did_plot10)
q_nh_pa_est_did_plot_data_aux11 <- ggplot_build(q_nh_pa_est_did_plot11)
q_nh_pa_est_did_plot_data_aux12 <- ggplot_build(q_nh_pa_est_did_plot12)
q_nh_pa_est_did_plot_data_aux13 <- ggplot_build(q_nh_pa_est_did_plot13)
q_nh_pa_est_did_plot_data_aux14 <- ggplot_build(q_nh_pa_est_did_plot14)
q_nh_pa_est_did_plot_data_aux15 <- ggplot_build(q_nh_pa_est_did_plot15)
q_nh_pa_est_did_plot_data_aux16 <- ggplot_build(q_nh_pa_est_did_plot16)
q_nh_pa_est_did_plot_data_aux17 <- ggplot_build(q_nh_pa_est_did_plot17)
q_nh_pa_est_did_plot_data_aux18 <- ggplot_build(q_nh_pa_est_did_plot18)
q_nh_pa_est_did_plot_data_aux19 <- ggplot_build(q_nh_pa_est_did_plot19)
q_nh_pa_est_did_plot_data_aux20 <- ggplot_build(q_nh_pa_est_did_plot20)
q_nh_pa_est_did_plot_data_aux21 <- ggplot_build(q_nh_pa_est_did_plot21)
q_nh_pa_est_did_plot_data_aux22 <- ggplot_build(q_nh_pa_est_did_plot22)
q_nh_pa_est_did_plot_data_aux23 <- ggplot_build(q_nh_pa_est_did_plot23)
q_nh_pa_est_did_plot_data_aux24 <- ggplot_build(q_nh_pa_est_did_plot24)
q_nh_pa_est_did_plot_data_aux25 <- ggplot_build(q_nh_pa_est_did_plot25)
q_nh_pa_est_did_plot_data_aux26 <- ggplot_build(q_nh_pa_est_did_plot26)
q_nh_pa_est_did_plot_data_aux27 <- ggplot_build(q_nh_pa_est_did_plot27)
q_nh_pa_est_did_plot_data_aux28 <- ggplot_build(q_nh_pa_est_did_plot28)
q_nh_pa_est_did_plot_data_aux29 <- ggplot_build(q_nh_pa_est_did_plot29)
q_nh_pa_est_did_plot_data_aux30 <- ggplot_build(q_nh_pa_est_did_plot30)
q_nh_pa_est_did_plot_data_aux31 <- ggplot_build(q_nh_pa_est_did_plot31)
q_nh_pa_est_did_plot_data_aux32 <- ggplot_build(q_nh_pa_est_did_plot32)
q_nh_pa_est_did_plot_data_aux33 <- ggplot_build(q_nh_pa_est_did_plot33)
q_nh_pa_est_did_plot_data_aux34 <- ggplot_build(q_nh_pa_est_did_plot34)
q_nh_pa_est_did_plot_data_aux35 <- ggplot_build(q_nh_pa_est_did_plot35)
q_nh_pa_est_did_plot_data_aux_list <- list(q_nh_pa_est_did_plot_data_aux1,q_nh_pa_est_did_plot_data_aux2,q_nh_pa_est_did_plot_data_aux3,
                                        q_nh_pa_est_did_plot_data_aux4,q_nh_pa_est_did_plot_data_aux5,q_nh_pa_est_did_plot_data_aux6,
                                        q_nh_pa_est_did_plot_data_aux7,q_nh_pa_est_did_plot_data_aux8,q_nh_pa_est_did_plot_data_aux9,
                                        q_nh_pa_est_did_plot_data_aux10,q_nh_pa_est_did_plot_data_aux11,q_nh_pa_est_did_plot_data_aux12,
                                        q_nh_pa_est_did_plot_data_aux13,q_nh_pa_est_did_plot_data_aux14,q_nh_pa_est_did_plot_data_aux15,
                                        q_nh_pa_est_did_plot_data_aux16,q_nh_pa_est_did_plot_data_aux17,q_nh_pa_est_did_plot_data_aux18,
                                        q_nh_pa_est_did_plot_data_aux19,q_nh_pa_est_did_plot_data_aux20,q_nh_pa_est_did_plot_data_aux21,
                                        q_nh_pa_est_did_plot_data_aux22,q_nh_pa_est_did_plot_data_aux23,q_nh_pa_est_did_plot_data_aux24,
                                        q_nh_pa_est_did_plot_data_aux25,q_nh_pa_est_did_plot_data_aux26,q_nh_pa_est_did_plot_data_aux27,
                                        q_nh_pa_est_did_plot_data_aux28,q_nh_pa_est_did_plot_data_aux29,q_nh_pa_est_did_plot_data_aux30,
                                        q_nh_pa_est_did_plot_data_aux31,q_nh_pa_est_did_plot_data_aux32,q_nh_pa_est_did_plot_data_aux33,
                                        q_nh_pa_est_did_plot_data_aux34,q_nh_pa_est_did_plot_data_aux35)
rm(q_nh_pa_est_did_plot_data_aux1,q_nh_pa_est_did_plot_data_aux2,q_nh_pa_est_did_plot_data_aux3,
   q_nh_pa_est_did_plot_data_aux4,q_nh_pa_est_did_plot_data_aux5,q_nh_pa_est_did_plot_data_aux6,
   q_nh_pa_est_did_plot_data_aux7,q_nh_pa_est_did_plot_data_aux8,q_nh_pa_est_did_plot_data_aux9,
   q_nh_pa_est_did_plot_data_aux10,q_nh_pa_est_did_plot_data_aux11,q_nh_pa_est_did_plot_data_aux12,
   q_nh_pa_est_did_plot_data_aux13,q_nh_pa_est_did_plot_data_aux14,q_nh_pa_est_did_plot_data_aux15,
   q_nh_pa_est_did_plot_data_aux16,q_nh_pa_est_did_plot_data_aux17,q_nh_pa_est_did_plot_data_aux18,
   q_nh_pa_est_did_plot_data_aux19,q_nh_pa_est_did_plot_data_aux20,q_nh_pa_est_did_plot_data_aux21,
   q_nh_pa_est_did_plot_data_aux22,q_nh_pa_est_did_plot_data_aux23,q_nh_pa_est_did_plot_data_aux24,
   q_nh_pa_est_did_plot_data_aux25,q_nh_pa_est_did_plot_data_aux26,q_nh_pa_est_did_plot_data_aux27,
   q_nh_pa_est_did_plot_data_aux28,q_nh_pa_est_did_plot_data_aux29,q_nh_pa_est_did_plot_data_aux30,
   q_nh_pa_est_did_plot_data_aux31,q_nh_pa_est_did_plot_data_aux32,q_nh_pa_est_did_plot_data_aux33,
   q_nh_pa_est_did_plot_data_aux34,q_nh_pa_est_did_plot_data_aux35)
rm(q_nh_pa_est_did_plot1,q_nh_pa_est_did_plot2,q_nh_pa_est_did_plot3,
   q_nh_pa_est_did_plot4,q_nh_pa_est_did_plot5,q_nh_pa_est_did_plot6,
   q_nh_pa_est_did_plot7,q_nh_pa_est_did_plot8,q_nh_pa_est_did_plot9,
   q_nh_pa_est_did_plot10,q_nh_pa_est_did_plot11,q_nh_pa_est_did_plot12,
   q_nh_pa_est_did_plot13,q_nh_pa_est_did_plot14,q_nh_pa_est_did_plot15,
   q_nh_pa_est_did_plot16,q_nh_pa_est_did_plot17,q_nh_pa_est_did_plot18,
   q_nh_pa_est_did_plot19,q_nh_pa_est_did_plot20,q_nh_pa_est_did_plot21,
   q_nh_pa_est_did_plot22,q_nh_pa_est_did_plot23,q_nh_pa_est_did_plot24,
   q_nh_pa_est_did_plot25,q_nh_pa_est_did_plot26,q_nh_pa_est_did_plot27,
   q_nh_pa_est_did_plot28,q_nh_pa_est_did_plot29,q_nh_pa_est_did_plot30,
   q_nh_pa_est_did_plot31,q_nh_pa_est_did_plot32,q_nh_pa_est_did_plot33,
   q_nh_pa_est_did_plot34,q_nh_pa_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_did_plot_data_long", i), data.frame(q_nh_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_pa_est_did_plot_data_long_list <- list(q_nh_pa_est_did_plot_data_long1,q_nh_pa_est_did_plot_data_long2,q_nh_pa_est_did_plot_data_long3,
                                         q_nh_pa_est_did_plot_data_long4,q_nh_pa_est_did_plot_data_long5,q_nh_pa_est_did_plot_data_long6,
                                         q_nh_pa_est_did_plot_data_long7,q_nh_pa_est_did_plot_data_long8,q_nh_pa_est_did_plot_data_long9,
                                         q_nh_pa_est_did_plot_data_long10,q_nh_pa_est_did_plot_data_long11,q_nh_pa_est_did_plot_data_long12,
                                         q_nh_pa_est_did_plot_data_long13,q_nh_pa_est_did_plot_data_long14,q_nh_pa_est_did_plot_data_long15,
                                         q_nh_pa_est_did_plot_data_long16,q_nh_pa_est_did_plot_data_long17,q_nh_pa_est_did_plot_data_long18,
                                         q_nh_pa_est_did_plot_data_long19,q_nh_pa_est_did_plot_data_long20,q_nh_pa_est_did_plot_data_long21,
                                         q_nh_pa_est_did_plot_data_long22,q_nh_pa_est_did_plot_data_long23,q_nh_pa_est_did_plot_data_long24,
                                         q_nh_pa_est_did_plot_data_long25,q_nh_pa_est_did_plot_data_long26,q_nh_pa_est_did_plot_data_long27,
                                         q_nh_pa_est_did_plot_data_long28,q_nh_pa_est_did_plot_data_long29,q_nh_pa_est_did_plot_data_long30,
                                         q_nh_pa_est_did_plot_data_long31,q_nh_pa_est_did_plot_data_long32,q_nh_pa_est_did_plot_data_long33,
                                         q_nh_pa_est_did_plot_data_long34,q_nh_pa_est_did_plot_data_long35)
rm(q_nh_pa_est_did_plot_data_long1,q_nh_pa_est_did_plot_data_long2,q_nh_pa_est_did_plot_data_long3,
   q_nh_pa_est_did_plot_data_long4,q_nh_pa_est_did_plot_data_long5,q_nh_pa_est_did_plot_data_long6,
   q_nh_pa_est_did_plot_data_long7,q_nh_pa_est_did_plot_data_long8,q_nh_pa_est_did_plot_data_long9,
   q_nh_pa_est_did_plot_data_long10,q_nh_pa_est_did_plot_data_long11,q_nh_pa_est_did_plot_data_long12,
   q_nh_pa_est_did_plot_data_long13,q_nh_pa_est_did_plot_data_long14,q_nh_pa_est_did_plot_data_long15,
   q_nh_pa_est_did_plot_data_long16,q_nh_pa_est_did_plot_data_long17,q_nh_pa_est_did_plot_data_long18,
   q_nh_pa_est_did_plot_data_long19,q_nh_pa_est_did_plot_data_long20,q_nh_pa_est_did_plot_data_long21,
   q_nh_pa_est_did_plot_data_long22,q_nh_pa_est_did_plot_data_long23,q_nh_pa_est_did_plot_data_long24,
   q_nh_pa_est_did_plot_data_long25,q_nh_pa_est_did_plot_data_long26,q_nh_pa_est_did_plot_data_long27,
   q_nh_pa_est_did_plot_data_long28,q_nh_pa_est_did_plot_data_long29,q_nh_pa_est_did_plot_data_long30,
   q_nh_pa_est_did_plot_data_long31,q_nh_pa_est_did_plot_data_long32,q_nh_pa_est_did_plot_data_long33,
   q_nh_pa_est_did_plot_data_long34,q_nh_pa_est_did_plot_data_long35)
q_nh_pa_est_did_plot_data_long_list <- lapply(q_nh_pa_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_did_plot_data_wide", i), reshape(data=q_nh_pa_est_did_plot_data_long_list[[i]],
                                                           idvar = "year",
                                                           v.names = "outcome",
                                                           timevar = "treated",
                                                           direction = "wide"))
}
q_nh_pa_est_did_plot_data_wide_list <- list(q_nh_pa_est_did_plot_data_wide1,q_nh_pa_est_did_plot_data_wide2,q_nh_pa_est_did_plot_data_wide3,
                                         q_nh_pa_est_did_plot_data_wide4,q_nh_pa_est_did_plot_data_wide5,q_nh_pa_est_did_plot_data_wide6,
                                         q_nh_pa_est_did_plot_data_wide7,q_nh_pa_est_did_plot_data_wide8,q_nh_pa_est_did_plot_data_wide9,
                                         q_nh_pa_est_did_plot_data_wide10,q_nh_pa_est_did_plot_data_wide11,q_nh_pa_est_did_plot_data_wide12,
                                         q_nh_pa_est_did_plot_data_wide13,q_nh_pa_est_did_plot_data_wide14,q_nh_pa_est_did_plot_data_wide15,
                                         q_nh_pa_est_did_plot_data_wide16,q_nh_pa_est_did_plot_data_wide17,q_nh_pa_est_did_plot_data_wide18,
                                         q_nh_pa_est_did_plot_data_wide19,q_nh_pa_est_did_plot_data_wide20,q_nh_pa_est_did_plot_data_wide21,
                                         q_nh_pa_est_did_plot_data_wide22,q_nh_pa_est_did_plot_data_wide23,q_nh_pa_est_did_plot_data_wide24,
                                         q_nh_pa_est_did_plot_data_wide25,q_nh_pa_est_did_plot_data_wide26,q_nh_pa_est_did_plot_data_wide27,
                                         q_nh_pa_est_did_plot_data_wide28,q_nh_pa_est_did_plot_data_wide29,q_nh_pa_est_did_plot_data_wide30,
                                         q_nh_pa_est_did_plot_data_wide31,q_nh_pa_est_did_plot_data_wide32,q_nh_pa_est_did_plot_data_wide33,
                                         q_nh_pa_est_did_plot_data_wide34,q_nh_pa_est_did_plot_data_wide35)
rm(q_nh_pa_est_did_plot_data_wide1,q_nh_pa_est_did_plot_data_wide2,q_nh_pa_est_did_plot_data_wide3,
   q_nh_pa_est_did_plot_data_wide4,q_nh_pa_est_did_plot_data_wide5,q_nh_pa_est_did_plot_data_wide6,
   q_nh_pa_est_did_plot_data_wide7,q_nh_pa_est_did_plot_data_wide8,q_nh_pa_est_did_plot_data_wide9,
   q_nh_pa_est_did_plot_data_wide10,q_nh_pa_est_did_plot_data_wide11,q_nh_pa_est_did_plot_data_wide12,
   q_nh_pa_est_did_plot_data_wide13,q_nh_pa_est_did_plot_data_wide14,q_nh_pa_est_did_plot_data_wide15,
   q_nh_pa_est_did_plot_data_wide16,q_nh_pa_est_did_plot_data_wide17,q_nh_pa_est_did_plot_data_wide18,
   q_nh_pa_est_did_plot_data_wide19,q_nh_pa_est_did_plot_data_wide20,q_nh_pa_est_did_plot_data_wide21,
   q_nh_pa_est_did_plot_data_wide22,q_nh_pa_est_did_plot_data_wide23,q_nh_pa_est_did_plot_data_wide24,
   q_nh_pa_est_did_plot_data_wide25,q_nh_pa_est_did_plot_data_wide26,q_nh_pa_est_did_plot_data_wide27,
   q_nh_pa_est_did_plot_data_wide28,q_nh_pa_est_did_plot_data_wide29,q_nh_pa_est_did_plot_data_wide30,
   q_nh_pa_est_did_plot_data_wide31,q_nh_pa_est_did_plot_data_wide32,q_nh_pa_est_did_plot_data_wide33,
   q_nh_pa_est_did_plot_data_wide34,q_nh_pa_est_did_plot_data_wide35)
q_nh_pa_est_did_plot_data_wide_list <- lapply(q_nh_pa_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nh_pa_est_sc1 <- sc_estimate(setup_q_nh_pa_list[[1]]$Y, setup_q_nh_pa_list[[1]]$N0, setup_q_nh_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_pa_est_sc2 <- sc_estimate(setup_q_nh_pa_list[[2]]$Y, setup_q_nh_pa_list[[2]]$N0, setup_q_nh_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_pa_est_sc5 <- sc_estimate(setup_q_nh_pa_list[[3]]$Y, setup_q_nh_pa_list[[3]]$N0, setup_q_nh_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_pa_est_sc10 <- sc_estimate(setup_q_nh_pa_list[[4]]$Y, setup_q_nh_pa_list[[4]]$N0, setup_q_nh_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_pa_est_sc11 <- sc_estimate(setup_q_nh_pa_list[[5]]$Y, setup_q_nh_pa_list[[5]]$N0, setup_q_nh_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_pa_est_sc12 <- sc_estimate(setup_q_nh_pa_list[[6]]$Y, setup_q_nh_pa_list[[6]]$N0, setup_q_nh_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_pa_est_sc13 <- sc_estimate(setup_q_nh_pa_list[[7]]$Y, setup_q_nh_pa_list[[7]]$N0, setup_q_nh_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_pa_est_sc15 <- sc_estimate(setup_q_nh_pa_list[[8]]$Y, setup_q_nh_pa_list[[8]]$N0, setup_q_nh_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_pa_est_sc17 <- sc_estimate(setup_q_nh_pa_list[[9]]$Y, setup_q_nh_pa_list[[9]]$N0, setup_q_nh_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_pa_est_sc19 <- sc_estimate(setup_q_nh_pa_list[[10]]$Y, setup_q_nh_pa_list[[10]]$N0, setup_q_nh_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_pa_est_sc21 <- sc_estimate(setup_q_nh_pa_list[[11]]$Y, setup_q_nh_pa_list[[11]]$N0, setup_q_nh_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_pa_est_sc23 <- sc_estimate(setup_q_nh_pa_list[[12]]$Y, setup_q_nh_pa_list[[12]]$N0, setup_q_nh_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_pa_est_sc24 <- sc_estimate(setup_q_nh_pa_list[[13]]$Y, setup_q_nh_pa_list[[13]]$N0, setup_q_nh_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_pa_est_sc25 <- sc_estimate(setup_q_nh_pa_list[[14]]$Y, setup_q_nh_pa_list[[14]]$N0, setup_q_nh_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_pa_est_sc26 <- sc_estimate(setup_q_nh_pa_list[[15]]$Y, setup_q_nh_pa_list[[15]]$N0, setup_q_nh_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_pa_est_sc28 <- sc_estimate(setup_q_nh_pa_list[[16]]$Y, setup_q_nh_pa_list[[16]]$N0, setup_q_nh_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_pa_est_sc29 <- sc_estimate(setup_q_nh_pa_list[[17]]$Y, setup_q_nh_pa_list[[17]]$N0, setup_q_nh_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_pa_est_sc30 <- sc_estimate(setup_q_nh_pa_list[[18]]$Y, setup_q_nh_pa_list[[18]]$N0, setup_q_nh_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_pa_est_sc31 <- sc_estimate(setup_q_nh_pa_list[[19]]$Y, setup_q_nh_pa_list[[19]]$N0, setup_q_nh_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_pa_est_sc32 <- sc_estimate(setup_q_nh_pa_list[[20]]$Y, setup_q_nh_pa_list[[20]]$N0, setup_q_nh_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_pa_est_sc33 <- sc_estimate(setup_q_nh_pa_list[[21]]$Y, setup_q_nh_pa_list[[21]]$N0, setup_q_nh_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_pa_est_sc34 <- sc_estimate(setup_q_nh_pa_list[[22]]$Y, setup_q_nh_pa_list[[22]]$N0, setup_q_nh_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_pa_est_sc36 <- sc_estimate(setup_q_nh_pa_list[[23]]$Y, setup_q_nh_pa_list[[23]]$N0, setup_q_nh_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_pa_est_sc37 <- sc_estimate(setup_q_nh_pa_list[[24]]$Y, setup_q_nh_pa_list[[24]]$N0, setup_q_nh_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_pa_est_sc39 <- sc_estimate(setup_q_nh_pa_list[[25]]$Y, setup_q_nh_pa_list[[25]]$N0, setup_q_nh_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_pa_est_sc40 <- sc_estimate(setup_q_nh_pa_list[[26]]$Y, setup_q_nh_pa_list[[26]]$N0, setup_q_nh_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_pa_est_sc41 <- sc_estimate(setup_q_nh_pa_list[[27]]$Y, setup_q_nh_pa_list[[27]]$N0, setup_q_nh_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_pa_est_sc44 <- sc_estimate(setup_q_nh_pa_list[[28]]$Y, setup_q_nh_pa_list[[28]]$N0, setup_q_nh_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_pa_est_sc45 <- sc_estimate(setup_q_nh_pa_list[[29]]$Y, setup_q_nh_pa_list[[29]]$N0, setup_q_nh_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_pa_est_sc47 <- sc_estimate(setup_q_nh_pa_list[[30]]$Y, setup_q_nh_pa_list[[30]]$N0, setup_q_nh_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_pa_est_sc50 <- sc_estimate(setup_q_nh_pa_list[[31]]$Y, setup_q_nh_pa_list[[31]]$N0, setup_q_nh_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_pa_est_sc51 <- sc_estimate(setup_q_nh_pa_list[[32]]$Y, setup_q_nh_pa_list[[32]]$N0, setup_q_nh_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_pa_est_sc53 <- sc_estimate(setup_q_nh_pa_list[[33]]$Y, setup_q_nh_pa_list[[33]]$N0, setup_q_nh_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_pa_est_sc54 <- sc_estimate(setup_q_nh_pa_list[[34]]$Y, setup_q_nh_pa_list[[34]]$N0, setup_q_nh_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_pa_est_sc55 <- sc_estimate(setup_q_nh_pa_list[[35]]$Y, setup_q_nh_pa_list[[35]]$N0, setup_q_nh_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_pa_est_sc_list <- list(q_nh_pa_est_sc1,q_nh_pa_est_sc2,q_nh_pa_est_sc5,
                         q_nh_pa_est_sc10,q_nh_pa_est_sc11,q_nh_pa_est_sc12,
                         q_nh_pa_est_sc13,q_nh_pa_est_sc15,q_nh_pa_est_sc17,
                         q_nh_pa_est_sc19,q_nh_pa_est_sc21,q_nh_pa_est_sc23,
                         q_nh_pa_est_sc24,q_nh_pa_est_sc25,q_nh_pa_est_sc26,
                         q_nh_pa_est_sc28,q_nh_pa_est_sc29,q_nh_pa_est_sc30,
                         q_nh_pa_est_sc31,q_nh_pa_est_sc32,q_nh_pa_est_sc33,
                         q_nh_pa_est_sc34,q_nh_pa_est_sc36,q_nh_pa_est_sc37,
                         q_nh_pa_est_sc39,q_nh_pa_est_sc40,q_nh_pa_est_sc41,
                         q_nh_pa_est_sc44,q_nh_pa_est_sc45,q_nh_pa_est_sc47,
                         q_nh_pa_est_sc50,q_nh_pa_est_sc51,q_nh_pa_est_sc53,
                         q_nh_pa_est_sc54,q_nh_pa_est_sc55)
rm(q_nh_pa_est_sc1,q_nh_pa_est_sc2,q_nh_pa_est_sc5,
   q_nh_pa_est_sc10,q_nh_pa_est_sc11,q_nh_pa_est_sc12,
   q_nh_pa_est_sc13,q_nh_pa_est_sc15,q_nh_pa_est_sc17,
   q_nh_pa_est_sc19,q_nh_pa_est_sc21,q_nh_pa_est_sc23,
   q_nh_pa_est_sc24,q_nh_pa_est_sc25,q_nh_pa_est_sc26,
   q_nh_pa_est_sc28,q_nh_pa_est_sc29,q_nh_pa_est_sc30,
   q_nh_pa_est_sc31,q_nh_pa_est_sc32,q_nh_pa_est_sc33,
   q_nh_pa_est_sc34,q_nh_pa_est_sc36,q_nh_pa_est_sc37,
   q_nh_pa_est_sc39,q_nh_pa_est_sc40,q_nh_pa_est_sc41,
   q_nh_pa_est_sc44,q_nh_pa_est_sc45,q_nh_pa_est_sc47,
   q_nh_pa_est_sc50,q_nh_pa_est_sc51,q_nh_pa_est_sc53,
   q_nh_pa_est_sc54,q_nh_pa_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sc_plot", i), synthdid_plot(q_nh_pa_est_sc_list[i]))
}
q_nh_pa_est_sc_plot_data_aux1 <- ggplot_build(q_nh_pa_est_sc_plot1)
q_nh_pa_est_sc_plot_data_aux2 <- ggplot_build(q_nh_pa_est_sc_plot2)
q_nh_pa_est_sc_plot_data_aux3 <- ggplot_build(q_nh_pa_est_sc_plot3)
q_nh_pa_est_sc_plot_data_aux4 <- ggplot_build(q_nh_pa_est_sc_plot4)
q_nh_pa_est_sc_plot_data_aux5 <- ggplot_build(q_nh_pa_est_sc_plot5)
q_nh_pa_est_sc_plot_data_aux6 <- ggplot_build(q_nh_pa_est_sc_plot6)
q_nh_pa_est_sc_plot_data_aux7 <- ggplot_build(q_nh_pa_est_sc_plot7)
q_nh_pa_est_sc_plot_data_aux8 <- ggplot_build(q_nh_pa_est_sc_plot8)
q_nh_pa_est_sc_plot_data_aux9 <- ggplot_build(q_nh_pa_est_sc_plot9)
q_nh_pa_est_sc_plot_data_aux10 <- ggplot_build(q_nh_pa_est_sc_plot10)
q_nh_pa_est_sc_plot_data_aux11 <- ggplot_build(q_nh_pa_est_sc_plot11)
q_nh_pa_est_sc_plot_data_aux12 <- ggplot_build(q_nh_pa_est_sc_plot12)
q_nh_pa_est_sc_plot_data_aux13 <- ggplot_build(q_nh_pa_est_sc_plot13)
q_nh_pa_est_sc_plot_data_aux14 <- ggplot_build(q_nh_pa_est_sc_plot14)
q_nh_pa_est_sc_plot_data_aux15 <- ggplot_build(q_nh_pa_est_sc_plot15)
q_nh_pa_est_sc_plot_data_aux16 <- ggplot_build(q_nh_pa_est_sc_plot16)
q_nh_pa_est_sc_plot_data_aux17 <- ggplot_build(q_nh_pa_est_sc_plot17)
q_nh_pa_est_sc_plot_data_aux18 <- ggplot_build(q_nh_pa_est_sc_plot18)
q_nh_pa_est_sc_plot_data_aux19 <- ggplot_build(q_nh_pa_est_sc_plot19)
q_nh_pa_est_sc_plot_data_aux20 <- ggplot_build(q_nh_pa_est_sc_plot20)
q_nh_pa_est_sc_plot_data_aux21 <- ggplot_build(q_nh_pa_est_sc_plot21)
q_nh_pa_est_sc_plot_data_aux22 <- ggplot_build(q_nh_pa_est_sc_plot22)
q_nh_pa_est_sc_plot_data_aux23 <- ggplot_build(q_nh_pa_est_sc_plot23)
q_nh_pa_est_sc_plot_data_aux24 <- ggplot_build(q_nh_pa_est_sc_plot24)
q_nh_pa_est_sc_plot_data_aux25 <- ggplot_build(q_nh_pa_est_sc_plot25)
q_nh_pa_est_sc_plot_data_aux26 <- ggplot_build(q_nh_pa_est_sc_plot26)
q_nh_pa_est_sc_plot_data_aux27 <- ggplot_build(q_nh_pa_est_sc_plot27)
q_nh_pa_est_sc_plot_data_aux28 <- ggplot_build(q_nh_pa_est_sc_plot28)
q_nh_pa_est_sc_plot_data_aux29 <- ggplot_build(q_nh_pa_est_sc_plot29)
q_nh_pa_est_sc_plot_data_aux30 <- ggplot_build(q_nh_pa_est_sc_plot30)
q_nh_pa_est_sc_plot_data_aux31 <- ggplot_build(q_nh_pa_est_sc_plot31)
q_nh_pa_est_sc_plot_data_aux32 <- ggplot_build(q_nh_pa_est_sc_plot32)
q_nh_pa_est_sc_plot_data_aux33 <- ggplot_build(q_nh_pa_est_sc_plot33)
q_nh_pa_est_sc_plot_data_aux34 <- ggplot_build(q_nh_pa_est_sc_plot34)
q_nh_pa_est_sc_plot_data_aux35 <- ggplot_build(q_nh_pa_est_sc_plot35)
q_nh_pa_est_sc_plot_data_aux_list <- list(q_nh_pa_est_sc_plot_data_aux1,q_nh_pa_est_sc_plot_data_aux2,q_nh_pa_est_sc_plot_data_aux3,
                                       q_nh_pa_est_sc_plot_data_aux4,q_nh_pa_est_sc_plot_data_aux5,q_nh_pa_est_sc_plot_data_aux6,
                                       q_nh_pa_est_sc_plot_data_aux7,q_nh_pa_est_sc_plot_data_aux8,q_nh_pa_est_sc_plot_data_aux9,
                                       q_nh_pa_est_sc_plot_data_aux10,q_nh_pa_est_sc_plot_data_aux11,q_nh_pa_est_sc_plot_data_aux12,
                                       q_nh_pa_est_sc_plot_data_aux13,q_nh_pa_est_sc_plot_data_aux14,q_nh_pa_est_sc_plot_data_aux15,
                                       q_nh_pa_est_sc_plot_data_aux16,q_nh_pa_est_sc_plot_data_aux17,q_nh_pa_est_sc_plot_data_aux18,
                                       q_nh_pa_est_sc_plot_data_aux19,q_nh_pa_est_sc_plot_data_aux20,q_nh_pa_est_sc_plot_data_aux21,
                                       q_nh_pa_est_sc_plot_data_aux22,q_nh_pa_est_sc_plot_data_aux23,q_nh_pa_est_sc_plot_data_aux24,
                                       q_nh_pa_est_sc_plot_data_aux25,q_nh_pa_est_sc_plot_data_aux26,q_nh_pa_est_sc_plot_data_aux27,
                                       q_nh_pa_est_sc_plot_data_aux28,q_nh_pa_est_sc_plot_data_aux29,q_nh_pa_est_sc_plot_data_aux30,
                                       q_nh_pa_est_sc_plot_data_aux31,q_nh_pa_est_sc_plot_data_aux32,q_nh_pa_est_sc_plot_data_aux33,
                                       q_nh_pa_est_sc_plot_data_aux34,q_nh_pa_est_sc_plot_data_aux35)
rm(q_nh_pa_est_sc_plot_data_aux1,q_nh_pa_est_sc_plot_data_aux2,q_nh_pa_est_sc_plot_data_aux3,
   q_nh_pa_est_sc_plot_data_aux4,q_nh_pa_est_sc_plot_data_aux5,q_nh_pa_est_sc_plot_data_aux6,
   q_nh_pa_est_sc_plot_data_aux7,q_nh_pa_est_sc_plot_data_aux8,q_nh_pa_est_sc_plot_data_aux9,
   q_nh_pa_est_sc_plot_data_aux10,q_nh_pa_est_sc_plot_data_aux11,q_nh_pa_est_sc_plot_data_aux12,
   q_nh_pa_est_sc_plot_data_aux13,q_nh_pa_est_sc_plot_data_aux14,q_nh_pa_est_sc_plot_data_aux15,
   q_nh_pa_est_sc_plot_data_aux16,q_nh_pa_est_sc_plot_data_aux17,q_nh_pa_est_sc_plot_data_aux18,
   q_nh_pa_est_sc_plot_data_aux19,q_nh_pa_est_sc_plot_data_aux20,q_nh_pa_est_sc_plot_data_aux21,
   q_nh_pa_est_sc_plot_data_aux22,q_nh_pa_est_sc_plot_data_aux23,q_nh_pa_est_sc_plot_data_aux24,
   q_nh_pa_est_sc_plot_data_aux25,q_nh_pa_est_sc_plot_data_aux26,q_nh_pa_est_sc_plot_data_aux27,
   q_nh_pa_est_sc_plot_data_aux28,q_nh_pa_est_sc_plot_data_aux29,q_nh_pa_est_sc_plot_data_aux30,
   q_nh_pa_est_sc_plot_data_aux31,q_nh_pa_est_sc_plot_data_aux32,q_nh_pa_est_sc_plot_data_aux33,
   q_nh_pa_est_sc_plot_data_aux34,q_nh_pa_est_sc_plot_data_aux35)
rm(q_nh_pa_est_sc_plot1,q_nh_pa_est_sc_plot2,q_nh_pa_est_sc_plot3,
   q_nh_pa_est_sc_plot4,q_nh_pa_est_sc_plot5,q_nh_pa_est_sc_plot6,
   q_nh_pa_est_sc_plot7,q_nh_pa_est_sc_plot8,q_nh_pa_est_sc_plot9,
   q_nh_pa_est_sc_plot10,q_nh_pa_est_sc_plot11,q_nh_pa_est_sc_plot12,
   q_nh_pa_est_sc_plot13,q_nh_pa_est_sc_plot14,q_nh_pa_est_sc_plot15,
   q_nh_pa_est_sc_plot16,q_nh_pa_est_sc_plot17,q_nh_pa_est_sc_plot18,
   q_nh_pa_est_sc_plot19,q_nh_pa_est_sc_plot20,q_nh_pa_est_sc_plot21,
   q_nh_pa_est_sc_plot22,q_nh_pa_est_sc_plot23,q_nh_pa_est_sc_plot24,
   q_nh_pa_est_sc_plot25,q_nh_pa_est_sc_plot26,q_nh_pa_est_sc_plot27,
   q_nh_pa_est_sc_plot28,q_nh_pa_est_sc_plot29,q_nh_pa_est_sc_plot30,
   q_nh_pa_est_sc_plot31,q_nh_pa_est_sc_plot32,q_nh_pa_est_sc_plot33,
   q_nh_pa_est_sc_plot34,q_nh_pa_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sc_plot_data_long", i), data.frame(q_nh_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_pa_est_sc_plot_data_long_list <- list(q_nh_pa_est_sc_plot_data_long1,q_nh_pa_est_sc_plot_data_long2,q_nh_pa_est_sc_plot_data_long3,
                                        q_nh_pa_est_sc_plot_data_long4,q_nh_pa_est_sc_plot_data_long5,q_nh_pa_est_sc_plot_data_long6,
                                        q_nh_pa_est_sc_plot_data_long7,q_nh_pa_est_sc_plot_data_long8,q_nh_pa_est_sc_plot_data_long9,
                                        q_nh_pa_est_sc_plot_data_long10,q_nh_pa_est_sc_plot_data_long11,q_nh_pa_est_sc_plot_data_long12,
                                        q_nh_pa_est_sc_plot_data_long13,q_nh_pa_est_sc_plot_data_long14,q_nh_pa_est_sc_plot_data_long15,
                                        q_nh_pa_est_sc_plot_data_long16,q_nh_pa_est_sc_plot_data_long17,q_nh_pa_est_sc_plot_data_long18,
                                        q_nh_pa_est_sc_plot_data_long19,q_nh_pa_est_sc_plot_data_long20,q_nh_pa_est_sc_plot_data_long21,
                                        q_nh_pa_est_sc_plot_data_long22,q_nh_pa_est_sc_plot_data_long23,q_nh_pa_est_sc_plot_data_long24,
                                        q_nh_pa_est_sc_plot_data_long25,q_nh_pa_est_sc_plot_data_long26,q_nh_pa_est_sc_plot_data_long27,
                                        q_nh_pa_est_sc_plot_data_long28,q_nh_pa_est_sc_plot_data_long29,q_nh_pa_est_sc_plot_data_long30,
                                        q_nh_pa_est_sc_plot_data_long31,q_nh_pa_est_sc_plot_data_long32,q_nh_pa_est_sc_plot_data_long33,
                                        q_nh_pa_est_sc_plot_data_long34,q_nh_pa_est_sc_plot_data_long35)
rm(q_nh_pa_est_sc_plot_data_long1,q_nh_pa_est_sc_plot_data_long2,q_nh_pa_est_sc_plot_data_long3,
   q_nh_pa_est_sc_plot_data_long4,q_nh_pa_est_sc_plot_data_long5,q_nh_pa_est_sc_plot_data_long6,
   q_nh_pa_est_sc_plot_data_long7,q_nh_pa_est_sc_plot_data_long8,q_nh_pa_est_sc_plot_data_long9,
   q_nh_pa_est_sc_plot_data_long10,q_nh_pa_est_sc_plot_data_long11,q_nh_pa_est_sc_plot_data_long12,
   q_nh_pa_est_sc_plot_data_long13,q_nh_pa_est_sc_plot_data_long14,q_nh_pa_est_sc_plot_data_long15,
   q_nh_pa_est_sc_plot_data_long16,q_nh_pa_est_sc_plot_data_long17,q_nh_pa_est_sc_plot_data_long18,
   q_nh_pa_est_sc_plot_data_long19,q_nh_pa_est_sc_plot_data_long20,q_nh_pa_est_sc_plot_data_long21,
   q_nh_pa_est_sc_plot_data_long22,q_nh_pa_est_sc_plot_data_long23,q_nh_pa_est_sc_plot_data_long24,
   q_nh_pa_est_sc_plot_data_long25,q_nh_pa_est_sc_plot_data_long26,q_nh_pa_est_sc_plot_data_long27,
   q_nh_pa_est_sc_plot_data_long28,q_nh_pa_est_sc_plot_data_long29,q_nh_pa_est_sc_plot_data_long30,
   q_nh_pa_est_sc_plot_data_long31,q_nh_pa_est_sc_plot_data_long32,q_nh_pa_est_sc_plot_data_long33,
   q_nh_pa_est_sc_plot_data_long34,q_nh_pa_est_sc_plot_data_long35)
q_nh_pa_est_sc_plot_data_long_list <- lapply(q_nh_pa_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sc_plot_data_wide", i), reshape(data=q_nh_pa_est_sc_plot_data_long_list[[i]],
                                                          idvar = "year",
                                                          v.names = "outcome",
                                                          timevar = "treated",
                                                          direction = "wide"))
}
q_nh_pa_est_sc_plot_data_wide_list <- list(q_nh_pa_est_sc_plot_data_wide1,q_nh_pa_est_sc_plot_data_wide2,q_nh_pa_est_sc_plot_data_wide3,
                                        q_nh_pa_est_sc_plot_data_wide4,q_nh_pa_est_sc_plot_data_wide5,q_nh_pa_est_sc_plot_data_wide6,
                                        q_nh_pa_est_sc_plot_data_wide7,q_nh_pa_est_sc_plot_data_wide8,q_nh_pa_est_sc_plot_data_wide9,
                                        q_nh_pa_est_sc_plot_data_wide10,q_nh_pa_est_sc_plot_data_wide11,q_nh_pa_est_sc_plot_data_wide12,
                                        q_nh_pa_est_sc_plot_data_wide13,q_nh_pa_est_sc_plot_data_wide14,q_nh_pa_est_sc_plot_data_wide15,
                                        q_nh_pa_est_sc_plot_data_wide16,q_nh_pa_est_sc_plot_data_wide17,q_nh_pa_est_sc_plot_data_wide18,
                                        q_nh_pa_est_sc_plot_data_wide19,q_nh_pa_est_sc_plot_data_wide20,q_nh_pa_est_sc_plot_data_wide21,
                                        q_nh_pa_est_sc_plot_data_wide22,q_nh_pa_est_sc_plot_data_wide23,q_nh_pa_est_sc_plot_data_wide24,
                                        q_nh_pa_est_sc_plot_data_wide25,q_nh_pa_est_sc_plot_data_wide26,q_nh_pa_est_sc_plot_data_wide27,
                                        q_nh_pa_est_sc_plot_data_wide28,q_nh_pa_est_sc_plot_data_wide29,q_nh_pa_est_sc_plot_data_wide30,
                                        q_nh_pa_est_sc_plot_data_wide31,q_nh_pa_est_sc_plot_data_wide32,q_nh_pa_est_sc_plot_data_wide33,
                                        q_nh_pa_est_sc_plot_data_wide34,q_nh_pa_est_sc_plot_data_wide35)
rm(q_nh_pa_est_sc_plot_data_wide1,q_nh_pa_est_sc_plot_data_wide2,q_nh_pa_est_sc_plot_data_wide3,
   q_nh_pa_est_sc_plot_data_wide4,q_nh_pa_est_sc_plot_data_wide5,q_nh_pa_est_sc_plot_data_wide6,
   q_nh_pa_est_sc_plot_data_wide7,q_nh_pa_est_sc_plot_data_wide8,q_nh_pa_est_sc_plot_data_wide9,
   q_nh_pa_est_sc_plot_data_wide10,q_nh_pa_est_sc_plot_data_wide11,q_nh_pa_est_sc_plot_data_wide12,
   q_nh_pa_est_sc_plot_data_wide13,q_nh_pa_est_sc_plot_data_wide14,q_nh_pa_est_sc_plot_data_wide15,
   q_nh_pa_est_sc_plot_data_wide16,q_nh_pa_est_sc_plot_data_wide17,q_nh_pa_est_sc_plot_data_wide18,
   q_nh_pa_est_sc_plot_data_wide19,q_nh_pa_est_sc_plot_data_wide20,q_nh_pa_est_sc_plot_data_wide21,
   q_nh_pa_est_sc_plot_data_wide22,q_nh_pa_est_sc_plot_data_wide23,q_nh_pa_est_sc_plot_data_wide24,
   q_nh_pa_est_sc_plot_data_wide25,q_nh_pa_est_sc_plot_data_wide26,q_nh_pa_est_sc_plot_data_wide27,
   q_nh_pa_est_sc_plot_data_wide28,q_nh_pa_est_sc_plot_data_wide29,q_nh_pa_est_sc_plot_data_wide30,
   q_nh_pa_est_sc_plot_data_wide31,q_nh_pa_est_sc_plot_data_wide32,q_nh_pa_est_sc_plot_data_wide33,
   q_nh_pa_est_sc_plot_data_wide34,q_nh_pa_est_sc_plot_data_wide35)
q_nh_pa_est_sc_plot_data_wide_list <- lapply(q_nh_pa_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nh_pa_est_sdid1 <- synthdid_estimate(setup_q_nh_pa_list[[1]]$Y, setup_q_nh_pa_list[[1]]$N0, setup_q_nh_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_pa_est_sdid2 <- synthdid_estimate(setup_q_nh_pa_list[[2]]$Y, setup_q_nh_pa_list[[2]]$N0, setup_q_nh_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_pa_est_sdid5 <- synthdid_estimate(setup_q_nh_pa_list[[3]]$Y, setup_q_nh_pa_list[[3]]$N0, setup_q_nh_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_pa_est_sdid10 <- synthdid_estimate(setup_q_nh_pa_list[[4]]$Y, setup_q_nh_pa_list[[4]]$N0, setup_q_nh_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_pa_est_sdid11 <- synthdid_estimate(setup_q_nh_pa_list[[5]]$Y, setup_q_nh_pa_list[[5]]$N0, setup_q_nh_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_pa_est_sdid12 <- synthdid_estimate(setup_q_nh_pa_list[[6]]$Y, setup_q_nh_pa_list[[6]]$N0, setup_q_nh_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_pa_est_sdid13 <- synthdid_estimate(setup_q_nh_pa_list[[7]]$Y, setup_q_nh_pa_list[[7]]$N0, setup_q_nh_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_pa_est_sdid15 <- synthdid_estimate(setup_q_nh_pa_list[[8]]$Y, setup_q_nh_pa_list[[8]]$N0, setup_q_nh_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_pa_est_sdid17 <- synthdid_estimate(setup_q_nh_pa_list[[9]]$Y, setup_q_nh_pa_list[[9]]$N0, setup_q_nh_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_pa_est_sdid19 <- synthdid_estimate(setup_q_nh_pa_list[[10]]$Y, setup_q_nh_pa_list[[10]]$N0, setup_q_nh_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_pa_est_sdid21 <- synthdid_estimate(setup_q_nh_pa_list[[11]]$Y, setup_q_nh_pa_list[[11]]$N0, setup_q_nh_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_pa_est_sdid23 <- synthdid_estimate(setup_q_nh_pa_list[[12]]$Y, setup_q_nh_pa_list[[12]]$N0, setup_q_nh_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_pa_est_sdid24 <- synthdid_estimate(setup_q_nh_pa_list[[13]]$Y, setup_q_nh_pa_list[[13]]$N0, setup_q_nh_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_pa_est_sdid25 <- synthdid_estimate(setup_q_nh_pa_list[[14]]$Y, setup_q_nh_pa_list[[14]]$N0, setup_q_nh_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_pa_est_sdid26 <- synthdid_estimate(setup_q_nh_pa_list[[15]]$Y, setup_q_nh_pa_list[[15]]$N0, setup_q_nh_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_pa_est_sdid28 <- synthdid_estimate(setup_q_nh_pa_list[[16]]$Y, setup_q_nh_pa_list[[16]]$N0, setup_q_nh_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_pa_est_sdid29 <- synthdid_estimate(setup_q_nh_pa_list[[17]]$Y, setup_q_nh_pa_list[[17]]$N0, setup_q_nh_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_pa_est_sdid30 <- synthdid_estimate(setup_q_nh_pa_list[[18]]$Y, setup_q_nh_pa_list[[18]]$N0, setup_q_nh_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_pa_est_sdid31 <- synthdid_estimate(setup_q_nh_pa_list[[19]]$Y, setup_q_nh_pa_list[[19]]$N0, setup_q_nh_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_pa_est_sdid32 <- synthdid_estimate(setup_q_nh_pa_list[[20]]$Y, setup_q_nh_pa_list[[20]]$N0, setup_q_nh_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_pa_est_sdid33 <- synthdid_estimate(setup_q_nh_pa_list[[21]]$Y, setup_q_nh_pa_list[[21]]$N0, setup_q_nh_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_pa_est_sdid34 <- synthdid_estimate(setup_q_nh_pa_list[[22]]$Y, setup_q_nh_pa_list[[22]]$N0, setup_q_nh_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_pa_est_sdid36 <- synthdid_estimate(setup_q_nh_pa_list[[23]]$Y, setup_q_nh_pa_list[[23]]$N0, setup_q_nh_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_pa_est_sdid37 <- synthdid_estimate(setup_q_nh_pa_list[[24]]$Y, setup_q_nh_pa_list[[24]]$N0, setup_q_nh_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_pa_est_sdid39 <- synthdid_estimate(setup_q_nh_pa_list[[25]]$Y, setup_q_nh_pa_list[[25]]$N0, setup_q_nh_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_pa_est_sdid40 <- synthdid_estimate(setup_q_nh_pa_list[[26]]$Y, setup_q_nh_pa_list[[26]]$N0, setup_q_nh_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_pa_est_sdid41 <- synthdid_estimate(setup_q_nh_pa_list[[27]]$Y, setup_q_nh_pa_list[[27]]$N0, setup_q_nh_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_pa_est_sdid44 <- synthdid_estimate(setup_q_nh_pa_list[[28]]$Y, setup_q_nh_pa_list[[28]]$N0, setup_q_nh_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_pa_est_sdid45 <- synthdid_estimate(setup_q_nh_pa_list[[29]]$Y, setup_q_nh_pa_list[[29]]$N0, setup_q_nh_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_pa_est_sdid47 <- synthdid_estimate(setup_q_nh_pa_list[[30]]$Y, setup_q_nh_pa_list[[30]]$N0, setup_q_nh_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_pa_est_sdid50 <- synthdid_estimate(setup_q_nh_pa_list[[31]]$Y, setup_q_nh_pa_list[[31]]$N0, setup_q_nh_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_pa_est_sdid51 <- synthdid_estimate(setup_q_nh_pa_list[[32]]$Y, setup_q_nh_pa_list[[32]]$N0, setup_q_nh_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_pa_est_sdid53 <- synthdid_estimate(setup_q_nh_pa_list[[33]]$Y, setup_q_nh_pa_list[[33]]$N0, setup_q_nh_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_pa_est_sdid54 <- synthdid_estimate(setup_q_nh_pa_list[[34]]$Y, setup_q_nh_pa_list[[34]]$N0, setup_q_nh_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_pa_est_sdid55 <- synthdid_estimate(setup_q_nh_pa_list[[35]]$Y, setup_q_nh_pa_list[[35]]$N0, setup_q_nh_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_pa_est_sdid_list <- list(q_nh_pa_est_sdid1,q_nh_pa_est_sdid2,q_nh_pa_est_sdid5,
                           q_nh_pa_est_sdid10,q_nh_pa_est_sdid11,q_nh_pa_est_sdid12,
                           q_nh_pa_est_sdid13,q_nh_pa_est_sdid15,q_nh_pa_est_sdid17,
                           q_nh_pa_est_sdid19,q_nh_pa_est_sdid21,q_nh_pa_est_sdid23,
                           q_nh_pa_est_sdid24,q_nh_pa_est_sdid25,q_nh_pa_est_sdid26,
                           q_nh_pa_est_sdid28,q_nh_pa_est_sdid29,q_nh_pa_est_sdid30,
                           q_nh_pa_est_sdid31,q_nh_pa_est_sdid32,q_nh_pa_est_sdid33,
                           q_nh_pa_est_sdid34,q_nh_pa_est_sdid36,q_nh_pa_est_sdid37,
                           q_nh_pa_est_sdid39,q_nh_pa_est_sdid40,q_nh_pa_est_sdid41,
                           q_nh_pa_est_sdid44,q_nh_pa_est_sdid45,q_nh_pa_est_sdid47,
                           q_nh_pa_est_sdid50,q_nh_pa_est_sdid51,q_nh_pa_est_sdid53,
                           q_nh_pa_est_sdid54,q_nh_pa_est_sdid55)
rm(q_nh_pa_est_sdid1,q_nh_pa_est_sdid2,q_nh_pa_est_sdid5,
   q_nh_pa_est_sdid10,q_nh_pa_est_sdid11,q_nh_pa_est_sdid12,
   q_nh_pa_est_sdid13,q_nh_pa_est_sdid15,q_nh_pa_est_sdid17,
   q_nh_pa_est_sdid19,q_nh_pa_est_sdid21,q_nh_pa_est_sdid23,
   q_nh_pa_est_sdid24,q_nh_pa_est_sdid25,q_nh_pa_est_sdid26,
   q_nh_pa_est_sdid28,q_nh_pa_est_sdid29,q_nh_pa_est_sdid30,
   q_nh_pa_est_sdid31,q_nh_pa_est_sdid32,q_nh_pa_est_sdid33,
   q_nh_pa_est_sdid34,q_nh_pa_est_sdid36,q_nh_pa_est_sdid37,
   q_nh_pa_est_sdid39,q_nh_pa_est_sdid40,q_nh_pa_est_sdid41,
   q_nh_pa_est_sdid44,q_nh_pa_est_sdid45,q_nh_pa_est_sdid47,
   q_nh_pa_est_sdid50,q_nh_pa_est_sdid51,q_nh_pa_est_sdid53,
   q_nh_pa_est_sdid54,q_nh_pa_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sdid_plot", i), synthdid_plot(q_nh_pa_est_sdid_list[i]))
}
q_nh_pa_est_sdid_plot_data_aux1 <- ggplot_build(q_nh_pa_est_sdid_plot1)
q_nh_pa_est_sdid_plot_data_aux2 <- ggplot_build(q_nh_pa_est_sdid_plot2)
q_nh_pa_est_sdid_plot_data_aux3 <- ggplot_build(q_nh_pa_est_sdid_plot3)
q_nh_pa_est_sdid_plot_data_aux4 <- ggplot_build(q_nh_pa_est_sdid_plot4)
q_nh_pa_est_sdid_plot_data_aux5 <- ggplot_build(q_nh_pa_est_sdid_plot5)
q_nh_pa_est_sdid_plot_data_aux6 <- ggplot_build(q_nh_pa_est_sdid_plot6)
q_nh_pa_est_sdid_plot_data_aux7 <- ggplot_build(q_nh_pa_est_sdid_plot7)
q_nh_pa_est_sdid_plot_data_aux8 <- ggplot_build(q_nh_pa_est_sdid_plot8)
q_nh_pa_est_sdid_plot_data_aux9 <- ggplot_build(q_nh_pa_est_sdid_plot9)
q_nh_pa_est_sdid_plot_data_aux10 <- ggplot_build(q_nh_pa_est_sdid_plot10)
q_nh_pa_est_sdid_plot_data_aux11 <- ggplot_build(q_nh_pa_est_sdid_plot11)
q_nh_pa_est_sdid_plot_data_aux12 <- ggplot_build(q_nh_pa_est_sdid_plot12)
q_nh_pa_est_sdid_plot_data_aux13 <- ggplot_build(q_nh_pa_est_sdid_plot13)
q_nh_pa_est_sdid_plot_data_aux14 <- ggplot_build(q_nh_pa_est_sdid_plot14)
q_nh_pa_est_sdid_plot_data_aux15 <- ggplot_build(q_nh_pa_est_sdid_plot15)
q_nh_pa_est_sdid_plot_data_aux16 <- ggplot_build(q_nh_pa_est_sdid_plot16)
q_nh_pa_est_sdid_plot_data_aux17 <- ggplot_build(q_nh_pa_est_sdid_plot17)
q_nh_pa_est_sdid_plot_data_aux18 <- ggplot_build(q_nh_pa_est_sdid_plot18)
q_nh_pa_est_sdid_plot_data_aux19 <- ggplot_build(q_nh_pa_est_sdid_plot19)
q_nh_pa_est_sdid_plot_data_aux20 <- ggplot_build(q_nh_pa_est_sdid_plot20)
q_nh_pa_est_sdid_plot_data_aux21 <- ggplot_build(q_nh_pa_est_sdid_plot21)
q_nh_pa_est_sdid_plot_data_aux22 <- ggplot_build(q_nh_pa_est_sdid_plot22)
q_nh_pa_est_sdid_plot_data_aux23 <- ggplot_build(q_nh_pa_est_sdid_plot23)
q_nh_pa_est_sdid_plot_data_aux24 <- ggplot_build(q_nh_pa_est_sdid_plot24)
q_nh_pa_est_sdid_plot_data_aux25 <- ggplot_build(q_nh_pa_est_sdid_plot25)
q_nh_pa_est_sdid_plot_data_aux26 <- ggplot_build(q_nh_pa_est_sdid_plot26)
q_nh_pa_est_sdid_plot_data_aux27 <- ggplot_build(q_nh_pa_est_sdid_plot27)
q_nh_pa_est_sdid_plot_data_aux28 <- ggplot_build(q_nh_pa_est_sdid_plot28)
q_nh_pa_est_sdid_plot_data_aux29 <- ggplot_build(q_nh_pa_est_sdid_plot29)
q_nh_pa_est_sdid_plot_data_aux30 <- ggplot_build(q_nh_pa_est_sdid_plot30)
q_nh_pa_est_sdid_plot_data_aux31 <- ggplot_build(q_nh_pa_est_sdid_plot31)
q_nh_pa_est_sdid_plot_data_aux32 <- ggplot_build(q_nh_pa_est_sdid_plot32)
q_nh_pa_est_sdid_plot_data_aux33 <- ggplot_build(q_nh_pa_est_sdid_plot33)
q_nh_pa_est_sdid_plot_data_aux34 <- ggplot_build(q_nh_pa_est_sdid_plot34)
q_nh_pa_est_sdid_plot_data_aux35 <- ggplot_build(q_nh_pa_est_sdid_plot35)
q_nh_pa_est_sdid_plot_data_aux_list <- list(q_nh_pa_est_sdid_plot_data_aux1,q_nh_pa_est_sdid_plot_data_aux2,q_nh_pa_est_sdid_plot_data_aux3,
                                         q_nh_pa_est_sdid_plot_data_aux4,q_nh_pa_est_sdid_plot_data_aux5,q_nh_pa_est_sdid_plot_data_aux6,
                                         q_nh_pa_est_sdid_plot_data_aux7,q_nh_pa_est_sdid_plot_data_aux8,q_nh_pa_est_sdid_plot_data_aux9,
                                         q_nh_pa_est_sdid_plot_data_aux10,q_nh_pa_est_sdid_plot_data_aux11,q_nh_pa_est_sdid_plot_data_aux12,
                                         q_nh_pa_est_sdid_plot_data_aux13,q_nh_pa_est_sdid_plot_data_aux14,q_nh_pa_est_sdid_plot_data_aux15,
                                         q_nh_pa_est_sdid_plot_data_aux16,q_nh_pa_est_sdid_plot_data_aux17,q_nh_pa_est_sdid_plot_data_aux18,
                                         q_nh_pa_est_sdid_plot_data_aux19,q_nh_pa_est_sdid_plot_data_aux20,q_nh_pa_est_sdid_plot_data_aux21,
                                         q_nh_pa_est_sdid_plot_data_aux22,q_nh_pa_est_sdid_plot_data_aux23,q_nh_pa_est_sdid_plot_data_aux24,
                                         q_nh_pa_est_sdid_plot_data_aux25,q_nh_pa_est_sdid_plot_data_aux26,q_nh_pa_est_sdid_plot_data_aux27,
                                         q_nh_pa_est_sdid_plot_data_aux28,q_nh_pa_est_sdid_plot_data_aux29,q_nh_pa_est_sdid_plot_data_aux30,
                                         q_nh_pa_est_sdid_plot_data_aux31,q_nh_pa_est_sdid_plot_data_aux32,q_nh_pa_est_sdid_plot_data_aux33,
                                         q_nh_pa_est_sdid_plot_data_aux34,q_nh_pa_est_sdid_plot_data_aux35)
rm(q_nh_pa_est_sdid_plot_data_aux1,q_nh_pa_est_sdid_plot_data_aux2,q_nh_pa_est_sdid_plot_data_aux3,
   q_nh_pa_est_sdid_plot_data_aux4,q_nh_pa_est_sdid_plot_data_aux5,q_nh_pa_est_sdid_plot_data_aux6,
   q_nh_pa_est_sdid_plot_data_aux7,q_nh_pa_est_sdid_plot_data_aux8,q_nh_pa_est_sdid_plot_data_aux9,
   q_nh_pa_est_sdid_plot_data_aux10,q_nh_pa_est_sdid_plot_data_aux11,q_nh_pa_est_sdid_plot_data_aux12,
   q_nh_pa_est_sdid_plot_data_aux13,q_nh_pa_est_sdid_plot_data_aux14,q_nh_pa_est_sdid_plot_data_aux15,
   q_nh_pa_est_sdid_plot_data_aux16,q_nh_pa_est_sdid_plot_data_aux17,q_nh_pa_est_sdid_plot_data_aux18,
   q_nh_pa_est_sdid_plot_data_aux19,q_nh_pa_est_sdid_plot_data_aux20,q_nh_pa_est_sdid_plot_data_aux21,
   q_nh_pa_est_sdid_plot_data_aux22,q_nh_pa_est_sdid_plot_data_aux23,q_nh_pa_est_sdid_plot_data_aux24,
   q_nh_pa_est_sdid_plot_data_aux25,q_nh_pa_est_sdid_plot_data_aux26,q_nh_pa_est_sdid_plot_data_aux27,
   q_nh_pa_est_sdid_plot_data_aux28,q_nh_pa_est_sdid_plot_data_aux29,q_nh_pa_est_sdid_plot_data_aux30,
   q_nh_pa_est_sdid_plot_data_aux31,q_nh_pa_est_sdid_plot_data_aux32,q_nh_pa_est_sdid_plot_data_aux33,
   q_nh_pa_est_sdid_plot_data_aux34,q_nh_pa_est_sdid_plot_data_aux35)
rm(q_nh_pa_est_sdid_plot1,q_nh_pa_est_sdid_plot2,q_nh_pa_est_sdid_plot3,
   q_nh_pa_est_sdid_plot4,q_nh_pa_est_sdid_plot5,q_nh_pa_est_sdid_plot6,
   q_nh_pa_est_sdid_plot7,q_nh_pa_est_sdid_plot8,q_nh_pa_est_sdid_plot9,
   q_nh_pa_est_sdid_plot10,q_nh_pa_est_sdid_plot11,q_nh_pa_est_sdid_plot12,
   q_nh_pa_est_sdid_plot13,q_nh_pa_est_sdid_plot14,q_nh_pa_est_sdid_plot15,
   q_nh_pa_est_sdid_plot16,q_nh_pa_est_sdid_plot17,q_nh_pa_est_sdid_plot18,
   q_nh_pa_est_sdid_plot19,q_nh_pa_est_sdid_plot20,q_nh_pa_est_sdid_plot21,
   q_nh_pa_est_sdid_plot22,q_nh_pa_est_sdid_plot23,q_nh_pa_est_sdid_plot24,
   q_nh_pa_est_sdid_plot25,q_nh_pa_est_sdid_plot26,q_nh_pa_est_sdid_plot27,
   q_nh_pa_est_sdid_plot28,q_nh_pa_est_sdid_plot29,q_nh_pa_est_sdid_plot30,
   q_nh_pa_est_sdid_plot31,q_nh_pa_est_sdid_plot32,q_nh_pa_est_sdid_plot33,
   q_nh_pa_est_sdid_plot34,q_nh_pa_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sdid_plot_data_long", i), data.frame(q_nh_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_pa_est_sdid_plot_data_long_list <- list(q_nh_pa_est_sdid_plot_data_long1,q_nh_pa_est_sdid_plot_data_long2,q_nh_pa_est_sdid_plot_data_long3,
                                          q_nh_pa_est_sdid_plot_data_long4,q_nh_pa_est_sdid_plot_data_long5,q_nh_pa_est_sdid_plot_data_long6,
                                          q_nh_pa_est_sdid_plot_data_long7,q_nh_pa_est_sdid_plot_data_long8,q_nh_pa_est_sdid_plot_data_long9,
                                          q_nh_pa_est_sdid_plot_data_long10,q_nh_pa_est_sdid_plot_data_long11,q_nh_pa_est_sdid_plot_data_long12,
                                          q_nh_pa_est_sdid_plot_data_long13,q_nh_pa_est_sdid_plot_data_long14,q_nh_pa_est_sdid_plot_data_long15,
                                          q_nh_pa_est_sdid_plot_data_long16,q_nh_pa_est_sdid_plot_data_long17,q_nh_pa_est_sdid_plot_data_long18,
                                          q_nh_pa_est_sdid_plot_data_long19,q_nh_pa_est_sdid_plot_data_long20,q_nh_pa_est_sdid_plot_data_long21,
                                          q_nh_pa_est_sdid_plot_data_long22,q_nh_pa_est_sdid_plot_data_long23,q_nh_pa_est_sdid_plot_data_long24,
                                          q_nh_pa_est_sdid_plot_data_long25,q_nh_pa_est_sdid_plot_data_long26,q_nh_pa_est_sdid_plot_data_long27,
                                          q_nh_pa_est_sdid_plot_data_long28,q_nh_pa_est_sdid_plot_data_long29,q_nh_pa_est_sdid_plot_data_long30,
                                          q_nh_pa_est_sdid_plot_data_long31,q_nh_pa_est_sdid_plot_data_long32,q_nh_pa_est_sdid_plot_data_long33,
                                          q_nh_pa_est_sdid_plot_data_long34,q_nh_pa_est_sdid_plot_data_long35)
rm(q_nh_pa_est_sdid_plot_data_long1,q_nh_pa_est_sdid_plot_data_long2,q_nh_pa_est_sdid_plot_data_long3,
   q_nh_pa_est_sdid_plot_data_long4,q_nh_pa_est_sdid_plot_data_long5,q_nh_pa_est_sdid_plot_data_long6,
   q_nh_pa_est_sdid_plot_data_long7,q_nh_pa_est_sdid_plot_data_long8,q_nh_pa_est_sdid_plot_data_long9,
   q_nh_pa_est_sdid_plot_data_long10,q_nh_pa_est_sdid_plot_data_long11,q_nh_pa_est_sdid_plot_data_long12,
   q_nh_pa_est_sdid_plot_data_long13,q_nh_pa_est_sdid_plot_data_long14,q_nh_pa_est_sdid_plot_data_long15,
   q_nh_pa_est_sdid_plot_data_long16,q_nh_pa_est_sdid_plot_data_long17,q_nh_pa_est_sdid_plot_data_long18,
   q_nh_pa_est_sdid_plot_data_long19,q_nh_pa_est_sdid_plot_data_long20,q_nh_pa_est_sdid_plot_data_long21,
   q_nh_pa_est_sdid_plot_data_long22,q_nh_pa_est_sdid_plot_data_long23,q_nh_pa_est_sdid_plot_data_long24,
   q_nh_pa_est_sdid_plot_data_long25,q_nh_pa_est_sdid_plot_data_long26,q_nh_pa_est_sdid_plot_data_long27,
   q_nh_pa_est_sdid_plot_data_long28,q_nh_pa_est_sdid_plot_data_long29,q_nh_pa_est_sdid_plot_data_long30,
   q_nh_pa_est_sdid_plot_data_long31,q_nh_pa_est_sdid_plot_data_long32,q_nh_pa_est_sdid_plot_data_long33,
   q_nh_pa_est_sdid_plot_data_long34,q_nh_pa_est_sdid_plot_data_long35)
q_nh_pa_est_sdid_plot_data_long_list <- lapply(q_nh_pa_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_pa_est_sdid_plot_data_wide", i), reshape(data=q_nh_pa_est_sdid_plot_data_long_list[[i]],
                                                            idvar = "year",
                                                            v.names = "outcome",
                                                            timevar = "treated",
                                                            direction = "wide"))
}
q_nh_pa_est_sdid_plot_data_wide_list <- list(q_nh_pa_est_sdid_plot_data_wide1,q_nh_pa_est_sdid_plot_data_wide2,q_nh_pa_est_sdid_plot_data_wide3,
                                          q_nh_pa_est_sdid_plot_data_wide4,q_nh_pa_est_sdid_plot_data_wide5,q_nh_pa_est_sdid_plot_data_wide6,
                                          q_nh_pa_est_sdid_plot_data_wide7,q_nh_pa_est_sdid_plot_data_wide8,q_nh_pa_est_sdid_plot_data_wide9,
                                          q_nh_pa_est_sdid_plot_data_wide10,q_nh_pa_est_sdid_plot_data_wide11,q_nh_pa_est_sdid_plot_data_wide12,
                                          q_nh_pa_est_sdid_plot_data_wide13,q_nh_pa_est_sdid_plot_data_wide14,q_nh_pa_est_sdid_plot_data_wide15,
                                          q_nh_pa_est_sdid_plot_data_wide16,q_nh_pa_est_sdid_plot_data_wide17,q_nh_pa_est_sdid_plot_data_wide18,
                                          q_nh_pa_est_sdid_plot_data_wide19,q_nh_pa_est_sdid_plot_data_wide20,q_nh_pa_est_sdid_plot_data_wide21,
                                          q_nh_pa_est_sdid_plot_data_wide22,q_nh_pa_est_sdid_plot_data_wide23,q_nh_pa_est_sdid_plot_data_wide24,
                                          q_nh_pa_est_sdid_plot_data_wide25,q_nh_pa_est_sdid_plot_data_wide26,q_nh_pa_est_sdid_plot_data_wide27,
                                          q_nh_pa_est_sdid_plot_data_wide28,q_nh_pa_est_sdid_plot_data_wide29,q_nh_pa_est_sdid_plot_data_wide30,
                                          q_nh_pa_est_sdid_plot_data_wide31,q_nh_pa_est_sdid_plot_data_wide32,q_nh_pa_est_sdid_plot_data_wide33,
                                          q_nh_pa_est_sdid_plot_data_wide34,q_nh_pa_est_sdid_plot_data_wide35)
rm(q_nh_pa_est_sdid_plot_data_wide1,q_nh_pa_est_sdid_plot_data_wide2,q_nh_pa_est_sdid_plot_data_wide3,
   q_nh_pa_est_sdid_plot_data_wide4,q_nh_pa_est_sdid_plot_data_wide5,q_nh_pa_est_sdid_plot_data_wide6,
   q_nh_pa_est_sdid_plot_data_wide7,q_nh_pa_est_sdid_plot_data_wide8,q_nh_pa_est_sdid_plot_data_wide9,
   q_nh_pa_est_sdid_plot_data_wide10,q_nh_pa_est_sdid_plot_data_wide11,q_nh_pa_est_sdid_plot_data_wide12,
   q_nh_pa_est_sdid_plot_data_wide13,q_nh_pa_est_sdid_plot_data_wide14,q_nh_pa_est_sdid_plot_data_wide15,
   q_nh_pa_est_sdid_plot_data_wide16,q_nh_pa_est_sdid_plot_data_wide17,q_nh_pa_est_sdid_plot_data_wide18,
   q_nh_pa_est_sdid_plot_data_wide19,q_nh_pa_est_sdid_plot_data_wide20,q_nh_pa_est_sdid_plot_data_wide21,
   q_nh_pa_est_sdid_plot_data_wide22,q_nh_pa_est_sdid_plot_data_wide23,q_nh_pa_est_sdid_plot_data_wide24,
   q_nh_pa_est_sdid_plot_data_wide25,q_nh_pa_est_sdid_plot_data_wide26,q_nh_pa_est_sdid_plot_data_wide27,
   q_nh_pa_est_sdid_plot_data_wide28,q_nh_pa_est_sdid_plot_data_wide29,q_nh_pa_est_sdid_plot_data_wide30,
   q_nh_pa_est_sdid_plot_data_wide31,q_nh_pa_est_sdid_plot_data_wide32,q_nh_pa_est_sdid_plot_data_wide33,
   q_nh_pa_est_sdid_plot_data_wide34,q_nh_pa_est_sdid_plot_data_wide35)
q_nh_pa_est_sdid_plot_data_wide_list <- lapply(q_nh_pa_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nh_est_did_plot_data_wide_pa$did_facet_title <- "Diff-in-Diff"
q_nh_est_sc_plot_data_wide_pa$sc_facet_title <- "Synthetic Control"
q_nh_est_sdid_plot_data_wide_pa$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nh_est_did_plot_data_wide_pa$diff_relative <- q_nh_est_did_plot_data_wide_pa$diff - q_nh_est_did_plot_data_wide_pa$diff[5]
for(i in 1:35) {
  q_nh_pa_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nh_pa_est_did_plot_data_wide_list[[i]]$diff - q_nh_pa_est_did_plot_data_wide_list[[i]]$diff[5]
}
q_nh_pa_spag_did_plot <- ggplot(q_nh_est_did_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Homes \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_pa_spag_sc_plot <- ggplot(q_nh_est_sc_plot_data_wide_pa, aes(year,diff)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nh_pa_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Pennsylvania"),data = q_nh_est_sc_plot_data_wide_pa, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Pennsylvania" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_est_sdid_plot_data_wide_pa$diff_relative <- q_nh_est_sdid_plot_data_wide_pa$diff - q_nh_est_sdid_plot_data_wide_pa$diff[5]
for(i in 1:35) {
  q_nh_pa_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nh_pa_est_sdid_plot_data_wide_list[[i]]$diff - q_nh_pa_est_sdid_plot_data_wide_list[[i]]$diff[5]
}
q_nh_pa_spag_sdid_plot <- ggplot(q_nh_est_sdid_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_pa_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nh_pa_est_did_vec <- c(q_nh_est_did_pa)
for (i in 1:35) {
  q_nh_pa_est_did_vec_aux <- q_nh_pa_est_did_list[[i]][1]
  q_nh_pa_est_did_vec <- c(q_nh_pa_est_did_vec,q_nh_pa_est_did_vec_aux)
}
q_nh_pa_est_did_df <- data.frame(q_nh_pa_est_did_vec)
q_nh_pa_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nh_pa_est_did_vec)) +
  geom_histogram(data = q_nh_pa_est_did_df, aes(x = q_nh_pa_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_pa_hist_did_plot1_ylim <- ggplot_build(q_nh_pa_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_pa_hist_did_plot <- q_nh_pa_hist_did_plot_aux +
  expand_limits(y=q_nh_pa_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_pa_est_did_vec[1], mean(q_nh_pa_est_did_vec[2:36])), xend = c(q_nh_pa_est_did_vec[1],mean(q_nh_pa_est_did_vec[2:36])), y = c(0,0), yend = c(q_nh_pa_hist_did_plot1_ylim,q_nh_pa_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_pa_est_did_vec[1], mean(q_nh_pa_est_did_vec[2:36])), y = c(q_nh_pa_hist_did_plot1_ylim,q_nh_pa_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_pa_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_pa_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_pa_est_sc_vec <- c(q_nh_est_sc_pa)
for (i in 1:35) {
  q_nh_pa_est_sc_vec_aux <- q_nh_pa_est_sc_list[[i]][1]
  q_nh_pa_est_sc_vec <- c(q_nh_pa_est_sc_vec,q_nh_pa_est_sc_vec_aux)
}
q_nh_pa_est_sc_df <- data.frame(q_nh_pa_est_sc_vec)
q_nh_pa_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nh_pa_est_sc_vec)) +
  geom_histogram(data = q_nh_pa_est_sc_df, aes(x = q_nh_pa_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_pa_hist_sc_plot1_ylim <- ggplot_build(q_nh_pa_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_pa_hist_sc_plot <- q_nh_pa_hist_sc_plot_aux +
  expand_limits(y=q_nh_pa_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_pa_est_sc_vec[1], mean(q_nh_pa_est_sc_vec[2:36])), xend = c(q_nh_pa_est_sc_vec[1],mean(q_nh_pa_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nh_pa_hist_sc_plot1_ylim,q_nh_pa_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_pa_est_sc_vec[1], mean(q_nh_pa_est_sc_vec[2:36])), y = c(q_nh_pa_hist_sc_plot1_ylim,q_nh_pa_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_pa_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_pa_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_pa_est_sdid_vec <- c(q_nh_est_sdid_pa)
for (i in 1:35) {
  q_nh_pa_est_sdid_vec_aux <- q_nh_pa_est_sdid_list[[i]][1]
  q_nh_pa_est_sdid_vec <- c(q_nh_pa_est_sdid_vec,q_nh_pa_est_sdid_vec_aux)
}
q_nh_pa_est_sdid_df <- data.frame(q_nh_pa_est_sdid_vec)
q_nh_pa_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nh_pa_est_sdid_vec)) +
  geom_histogram(data = q_nh_pa_est_sdid_df, aes(x = q_nh_pa_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_pa_hist_sdid_plot1_ylim <- ggplot_build(q_nh_pa_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_pa_hist_sdid_plot <- q_nh_pa_hist_sdid_plot_aux +
  expand_limits(y=q_nh_pa_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_pa_est_sdid_vec[1], mean(q_nh_pa_est_sdid_vec[2:36])), xend = c(q_nh_pa_est_sdid_vec[1],mean(q_nh_pa_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nh_pa_hist_sdid_plot1_ylim,q_nh_pa_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_pa_est_sdid_vec[1], mean(q_nh_pa_est_sdid_vec[2:36])), y = c(q_nh_pa_hist_sdid_plot1_ylim,q_nh_pa_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_pa_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_pa_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nh_spag_dist_plots_PA.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nh_pa_spag_dist_plots_PA <- q_nh_pa_spag_did_plot + q_nh_pa_spag_sc_plot + q_nh_pa_spag_sdid_plot + q_nh_pa_hist_did_plot + q_nh_pa_hist_sc_plot + q_nh_pa_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Quantity of Nursing Home Beds #####
### PA - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_home_beds_pa_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_pa_df$treated <- as.integer(ifelse(q_nursing_home_beds_pa_df$name == "Pennsylvania" & q_nursing_home_beds_pa_df$year >= 1996, 1, 0))
q_nursing_home_beds_pa_df <- q_nursing_home_beds_pa_df[order(q_nursing_home_beds_pa_df$year, q_nursing_home_beds_pa_df$treated_pa_aux, q_nursing_home_beds_pa_df$name),]
q_nursing_home_beds_pa_df <- subset(q_nursing_home_beds_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nhb_pa <- panel.matrices(q_nursing_home_beds_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nhb_est_did_pa <- did_estimate(setup_q_nhb_pa$Y, setup_q_nhb_pa$N0, setup_q_nhb_pa$T0, X = covariates_acc_pa_array)
q_nhb_est_did_plot_pa <- synthdid_plot(q_nhb_est_did_pa)
q_nhb_est_did_plot_data_aux_pa <- ggplot_build(q_nhb_est_did_plot_pa)
q_nhb_est_did_plot_data_long_pa <- data.frame(q_nhb_est_did_plot_data_aux_pa$data[[1]]$x, q_nhb_est_did_plot_data_aux_pa$data[[1]]$y, q_nhb_est_did_plot_data_aux_pa$data[[1]]$group)
colnames(q_nhb_est_did_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nhb_est_did_plot_data_long_pa$treated <- q_nhb_est_did_plot_data_long_pa$treated - 1
q_nhb_est_did_plot_data_wide_pa <- reshape(data=q_nhb_est_did_plot_data_long_pa,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nhb_est_did_plot_data_wide_pa$diff <- q_nhb_est_did_plot_data_wide_pa$outcome.1 - q_nhb_est_did_plot_data_wide_pa$outcome.0
# SC #
q_nhb_est_sc_pa <- sc_estimate(setup_q_nhb_pa$Y, setup_q_nhb_pa$N0, setup_q_nhb_pa$T0, X = covariates_acc_pa_array)
q_nhb_est_sc_plot_pa <- synthdid_plot(q_nhb_est_sc_pa)
q_nhb_est_sc_plot_data_aux_pa <- ggplot_build(q_nhb_est_sc_plot_pa)
q_nhb_est_sc_plot_data_long_pa <- data.frame(q_nhb_est_sc_plot_data_aux_pa$data[[1]]$x, q_nhb_est_sc_plot_data_aux_pa$data[[1]]$y, q_nhb_est_sc_plot_data_aux_pa$data[[1]]$group)
colnames(q_nhb_est_sc_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nhb_est_sc_plot_data_long_pa$treated <- q_nhb_est_sc_plot_data_long_pa$treated - 1
q_nhb_est_sc_plot_data_wide_pa <- reshape(data=q_nhb_est_sc_plot_data_long_pa,
                                         idvar = "year",
                                         v.names = "outcome",
                                         timevar = "treated",
                                         direction = "wide")
q_nhb_est_sc_plot_data_wide_pa$diff <- q_nhb_est_sc_plot_data_wide_pa$outcome.1 - q_nhb_est_sc_plot_data_wide_pa$outcome.0
# SDID #
q_nhb_est_sdid_pa <- synthdid_estimate(setup_q_nhb_pa$Y, setup_q_nhb_pa$N0, setup_q_nhb_pa$T0, X = covariates_acc_pa_array)
q_nhb_est_sdid_plot_pa <- synthdid_plot(q_nhb_est_sdid_pa)
q_nhb_est_sdid_plot_data_aux_pa <- ggplot_build(q_nhb_est_sdid_plot_pa)
q_nhb_est_sdid_plot_data_long_pa <- data.frame(q_nhb_est_sdid_plot_data_aux_pa$data[[1]]$x, q_nhb_est_sdid_plot_data_aux_pa$data[[1]]$y, q_nhb_est_sdid_plot_data_aux_pa$data[[1]]$group)
colnames(q_nhb_est_sdid_plot_data_long_pa) <- c('year', 'outcome', 'treated')
q_nhb_est_sdid_plot_data_long_pa$treated <- q_nhb_est_sdid_plot_data_long_pa$treated - 1
q_nhb_est_sdid_plot_data_wide_pa <- reshape(data=q_nhb_est_sdid_plot_data_long_pa,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nhb_est_sdid_plot_data_wide_pa$diff <- q_nhb_est_sdid_plot_data_wide_pa$outcome.1 - q_nhb_est_sdid_plot_data_wide_pa$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nhb_pa_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nhb_pa_df1$treated_aux <- ifelse(q_nhb_pa_df1$id == 1, 1, 0)
q_nhb_pa_df2$treated_aux <- ifelse(q_nhb_pa_df2$id == 2, 1, 0)
q_nhb_pa_df5$treated_aux <- ifelse(q_nhb_pa_df5$id == 5, 1, 0)
q_nhb_pa_df10$treated_aux <- ifelse(q_nhb_pa_df10$id == 10, 1, 0)
q_nhb_pa_df11$treated_aux <- ifelse(q_nhb_pa_df11$id == 11, 1, 0)
q_nhb_pa_df12$treated_aux <- ifelse(q_nhb_pa_df12$id == 12, 1, 0)
q_nhb_pa_df13$treated_aux <- ifelse(q_nhb_pa_df13$id == 13, 1, 0)
q_nhb_pa_df15$treated_aux <- ifelse(q_nhb_pa_df15$id == 15, 1, 0)
q_nhb_pa_df17$treated_aux <- ifelse(q_nhb_pa_df17$id == 17, 1, 0)
q_nhb_pa_df19$treated_aux <- ifelse(q_nhb_pa_df19$id == 19, 1, 0)
q_nhb_pa_df21$treated_aux <- ifelse(q_nhb_pa_df21$id == 21, 1, 0)
q_nhb_pa_df23$treated_aux <- ifelse(q_nhb_pa_df23$id == 23, 1, 0)
q_nhb_pa_df24$treated_aux <- ifelse(q_nhb_pa_df24$id == 24, 1, 0)
q_nhb_pa_df25$treated_aux <- ifelse(q_nhb_pa_df25$id == 25, 1, 0)
q_nhb_pa_df26$treated_aux <- ifelse(q_nhb_pa_df26$id == 26, 1, 0)
q_nhb_pa_df28$treated_aux <- ifelse(q_nhb_pa_df28$id == 28, 1, 0)
q_nhb_pa_df29$treated_aux <- ifelse(q_nhb_pa_df29$id == 29, 1, 0)
q_nhb_pa_df30$treated_aux <- ifelse(q_nhb_pa_df30$id == 30, 1, 0)
q_nhb_pa_df31$treated_aux <- ifelse(q_nhb_pa_df31$id == 31, 1, 0)
q_nhb_pa_df32$treated_aux <- ifelse(q_nhb_pa_df32$id == 32, 1, 0)
q_nhb_pa_df33$treated_aux <- ifelse(q_nhb_pa_df33$id == 33, 1, 0)
q_nhb_pa_df34$treated_aux <- ifelse(q_nhb_pa_df34$id == 34, 1, 0)
q_nhb_pa_df36$treated_aux <- ifelse(q_nhb_pa_df36$id == 36, 1, 0)
q_nhb_pa_df37$treated_aux <- ifelse(q_nhb_pa_df37$id == 37, 1, 0)
q_nhb_pa_df39$treated_aux <- ifelse(q_nhb_pa_df39$id == 39, 1, 0)
q_nhb_pa_df40$treated_aux <- ifelse(q_nhb_pa_df40$id == 40, 1, 0)
q_nhb_pa_df41$treated_aux <- ifelse(q_nhb_pa_df41$id == 41, 1, 0)
q_nhb_pa_df44$treated_aux <- ifelse(q_nhb_pa_df44$id == 44, 1, 0)
q_nhb_pa_df45$treated_aux <- ifelse(q_nhb_pa_df45$id == 45, 1, 0)
q_nhb_pa_df47$treated_aux <- ifelse(q_nhb_pa_df47$id == 47, 1, 0)
q_nhb_pa_df50$treated_aux <- ifelse(q_nhb_pa_df50$id == 50, 1, 0)
q_nhb_pa_df51$treated_aux <- ifelse(q_nhb_pa_df51$id == 51, 1, 0)
q_nhb_pa_df53$treated_aux <- ifelse(q_nhb_pa_df53$id == 53, 1, 0)
q_nhb_pa_df54$treated_aux <- ifelse(q_nhb_pa_df54$id == 54, 1, 0)
q_nhb_pa_df55$treated_aux <- ifelse(q_nhb_pa_df55$id == 55, 1, 0)
q_nhb_pa_df1$treated <- as.integer(ifelse(q_nhb_pa_df1$id == 1 & q_nhb_pa_df1$year >= 1996, 1, 0))
q_nhb_pa_df2$treated <- as.integer(ifelse(q_nhb_pa_df2$id == 2 & q_nhb_pa_df2$year >= 1996, 1, 0))
q_nhb_pa_df5$treated <- as.integer(ifelse(q_nhb_pa_df5$id == 5 & q_nhb_pa_df5$year >= 1996, 1, 0))
q_nhb_pa_df10$treated <- as.integer(ifelse(q_nhb_pa_df10$id == 10 & q_nhb_pa_df10$year >= 1996, 1, 0))
q_nhb_pa_df11$treated <- as.integer(ifelse(q_nhb_pa_df11$id == 11 & q_nhb_pa_df11$year >= 1996, 1, 0))
q_nhb_pa_df12$treated <- as.integer(ifelse(q_nhb_pa_df12$id == 12 & q_nhb_pa_df12$year >= 1996, 1, 0))
q_nhb_pa_df13$treated <- as.integer(ifelse(q_nhb_pa_df13$id == 13 & q_nhb_pa_df13$year >= 1996, 1, 0))
q_nhb_pa_df15$treated <- as.integer(ifelse(q_nhb_pa_df15$id == 15 & q_nhb_pa_df15$year >= 1996, 1, 0))
q_nhb_pa_df17$treated <- as.integer(ifelse(q_nhb_pa_df17$id == 17 & q_nhb_pa_df17$year >= 1996, 1, 0))
q_nhb_pa_df19$treated <- as.integer(ifelse(q_nhb_pa_df19$id == 19 & q_nhb_pa_df19$year >= 1996, 1, 0))
q_nhb_pa_df21$treated <- as.integer(ifelse(q_nhb_pa_df21$id == 21 & q_nhb_pa_df21$year >= 1996, 1, 0))
q_nhb_pa_df23$treated <- as.integer(ifelse(q_nhb_pa_df23$id == 23 & q_nhb_pa_df23$year >= 1996, 1, 0))
q_nhb_pa_df24$treated <- as.integer(ifelse(q_nhb_pa_df24$id == 24 & q_nhb_pa_df24$year >= 1996, 1, 0))
q_nhb_pa_df25$treated <- as.integer(ifelse(q_nhb_pa_df25$id == 25 & q_nhb_pa_df25$year >= 1996, 1, 0))
q_nhb_pa_df26$treated <- as.integer(ifelse(q_nhb_pa_df26$id == 26 & q_nhb_pa_df26$year >= 1996, 1, 0))
q_nhb_pa_df28$treated <- as.integer(ifelse(q_nhb_pa_df28$id == 28 & q_nhb_pa_df28$year >= 1996, 1, 0))
q_nhb_pa_df29$treated <- as.integer(ifelse(q_nhb_pa_df29$id == 29 & q_nhb_pa_df29$year >= 1996, 1, 0))
q_nhb_pa_df30$treated <- as.integer(ifelse(q_nhb_pa_df30$id == 30 & q_nhb_pa_df30$year >= 1996, 1, 0))
q_nhb_pa_df31$treated <- as.integer(ifelse(q_nhb_pa_df31$id == 31 & q_nhb_pa_df31$year >= 1996, 1, 0))
q_nhb_pa_df32$treated <- as.integer(ifelse(q_nhb_pa_df32$id == 32 & q_nhb_pa_df32$year >= 1996, 1, 0))
q_nhb_pa_df33$treated <- as.integer(ifelse(q_nhb_pa_df33$id == 33 & q_nhb_pa_df33$year >= 1996, 1, 0))
q_nhb_pa_df34$treated <- as.integer(ifelse(q_nhb_pa_df34$id == 34 & q_nhb_pa_df34$year >= 1996, 1, 0))
q_nhb_pa_df36$treated <- as.integer(ifelse(q_nhb_pa_df36$id == 36 & q_nhb_pa_df36$year >= 1996, 1, 0))
q_nhb_pa_df37$treated <- as.integer(ifelse(q_nhb_pa_df37$id == 37 & q_nhb_pa_df37$year >= 1996, 1, 0))
q_nhb_pa_df39$treated <- as.integer(ifelse(q_nhb_pa_df39$id == 39 & q_nhb_pa_df39$year >= 1996, 1, 0))
q_nhb_pa_df40$treated <- as.integer(ifelse(q_nhb_pa_df40$id == 40 & q_nhb_pa_df40$year >= 1996, 1, 0))
q_nhb_pa_df41$treated <- as.integer(ifelse(q_nhb_pa_df41$id == 41 & q_nhb_pa_df41$year >= 1996, 1, 0))
q_nhb_pa_df44$treated <- as.integer(ifelse(q_nhb_pa_df44$id == 44 & q_nhb_pa_df44$year >= 1996, 1, 0))
q_nhb_pa_df45$treated <- as.integer(ifelse(q_nhb_pa_df45$id == 45 & q_nhb_pa_df45$year >= 1996, 1, 0))
q_nhb_pa_df47$treated <- as.integer(ifelse(q_nhb_pa_df47$id == 47 & q_nhb_pa_df47$year >= 1996, 1, 0))
q_nhb_pa_df50$treated <- as.integer(ifelse(q_nhb_pa_df50$id == 50 & q_nhb_pa_df50$year >= 1996, 1, 0))
q_nhb_pa_df51$treated <- as.integer(ifelse(q_nhb_pa_df51$id == 51 & q_nhb_pa_df51$year >= 1996, 1, 0))
q_nhb_pa_df53$treated <- as.integer(ifelse(q_nhb_pa_df53$id == 53 & q_nhb_pa_df53$year >= 1996, 1, 0))
q_nhb_pa_df54$treated <- as.integer(ifelse(q_nhb_pa_df54$id == 54 & q_nhb_pa_df54$year >= 1996, 1, 0))
q_nhb_pa_df55$treated <- as.integer(ifelse(q_nhb_pa_df55$id == 55 & q_nhb_pa_df55$year >= 1996, 1, 0))
q_nhb_pa_df_list <- list(q_nhb_pa_df1,q_nhb_pa_df2,q_nhb_pa_df5,
                        q_nhb_pa_df10,q_nhb_pa_df11,q_nhb_pa_df12,
                        q_nhb_pa_df13,q_nhb_pa_df15,q_nhb_pa_df17,
                        q_nhb_pa_df19,q_nhb_pa_df21,q_nhb_pa_df23,
                        q_nhb_pa_df24,q_nhb_pa_df25,q_nhb_pa_df26,
                        q_nhb_pa_df28,q_nhb_pa_df29,q_nhb_pa_df30,
                        q_nhb_pa_df31,q_nhb_pa_df32,q_nhb_pa_df33,
                        q_nhb_pa_df34,q_nhb_pa_df36,q_nhb_pa_df37,
                        q_nhb_pa_df39,q_nhb_pa_df40,q_nhb_pa_df41,
                        q_nhb_pa_df44,q_nhb_pa_df45,q_nhb_pa_df47,
                        q_nhb_pa_df50,q_nhb_pa_df51,q_nhb_pa_df53,
                        q_nhb_pa_df54,q_nhb_pa_df55)
rm(q_nhb_pa_df1,q_nhb_pa_df2,q_nhb_pa_df5,
   q_nhb_pa_df10,q_nhb_pa_df11,q_nhb_pa_df12,
   q_nhb_pa_df13,q_nhb_pa_df15,q_nhb_pa_df17,
   q_nhb_pa_df19,q_nhb_pa_df21,q_nhb_pa_df23,
   q_nhb_pa_df24,q_nhb_pa_df25,q_nhb_pa_df26,
   q_nhb_pa_df28,q_nhb_pa_df29,q_nhb_pa_df30,
   q_nhb_pa_df31,q_nhb_pa_df32,q_nhb_pa_df33,
   q_nhb_pa_df34,q_nhb_pa_df36,q_nhb_pa_df37,
   q_nhb_pa_df39,q_nhb_pa_df40,q_nhb_pa_df41,
   q_nhb_pa_df44,q_nhb_pa_df45,q_nhb_pa_df47,
   q_nhb_pa_df50,q_nhb_pa_df51,q_nhb_pa_df53,
   q_nhb_pa_df54,q_nhb_pa_df55)
q_nhb_pa_df_list <- lapply(q_nhb_pa_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nhb_pa_df_list <- lapply(q_nhb_pa_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated)))
}
)
setup_q_nhb_pa1 <- panel.matrices(q_nhb_pa_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa2 <- panel.matrices(q_nhb_pa_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa5 <- panel.matrices(q_nhb_pa_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa10 <- panel.matrices(q_nhb_pa_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa11 <- panel.matrices(q_nhb_pa_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa12 <- panel.matrices(q_nhb_pa_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa13 <- panel.matrices(q_nhb_pa_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa15 <- panel.matrices(q_nhb_pa_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa17 <- panel.matrices(q_nhb_pa_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa19 <- panel.matrices(q_nhb_pa_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa21 <- panel.matrices(q_nhb_pa_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa23 <- panel.matrices(q_nhb_pa_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa24 <- panel.matrices(q_nhb_pa_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa25 <- panel.matrices(q_nhb_pa_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa26 <- panel.matrices(q_nhb_pa_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa28 <- panel.matrices(q_nhb_pa_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa29 <- panel.matrices(q_nhb_pa_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa30 <- panel.matrices(q_nhb_pa_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa31 <- panel.matrices(q_nhb_pa_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa32 <- panel.matrices(q_nhb_pa_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa33 <- panel.matrices(q_nhb_pa_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa34 <- panel.matrices(q_nhb_pa_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa36 <- panel.matrices(q_nhb_pa_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa37 <- panel.matrices(q_nhb_pa_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa39 <- panel.matrices(q_nhb_pa_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa40 <- panel.matrices(q_nhb_pa_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa41 <- panel.matrices(q_nhb_pa_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa44 <- panel.matrices(q_nhb_pa_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa45 <- panel.matrices(q_nhb_pa_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa47 <- panel.matrices(q_nhb_pa_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa50 <- panel.matrices(q_nhb_pa_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa51 <- panel.matrices(q_nhb_pa_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa53 <- panel.matrices(q_nhb_pa_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa54 <- panel.matrices(q_nhb_pa_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa55 <- panel.matrices(q_nhb_pa_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_pa_list <- list(setup_q_nhb_pa1,setup_q_nhb_pa2,setup_q_nhb_pa5,
                           setup_q_nhb_pa10,setup_q_nhb_pa11,setup_q_nhb_pa12,
                           setup_q_nhb_pa13,setup_q_nhb_pa15,setup_q_nhb_pa17,
                           setup_q_nhb_pa19,setup_q_nhb_pa21,setup_q_nhb_pa23,
                           setup_q_nhb_pa24,setup_q_nhb_pa25,setup_q_nhb_pa26,
                           setup_q_nhb_pa28,setup_q_nhb_pa29,setup_q_nhb_pa30,
                           setup_q_nhb_pa31,setup_q_nhb_pa32,setup_q_nhb_pa33,
                           setup_q_nhb_pa34,setup_q_nhb_pa36,setup_q_nhb_pa37,
                           setup_q_nhb_pa39,setup_q_nhb_pa40,setup_q_nhb_pa41,
                           setup_q_nhb_pa44,setup_q_nhb_pa45,setup_q_nhb_pa47,
                           setup_q_nhb_pa50,setup_q_nhb_pa51,setup_q_nhb_pa53,
                           setup_q_nhb_pa54,setup_q_nhb_pa55)
rm(setup_q_nhb_pa1,setup_q_nhb_pa2,setup_q_nhb_pa5,
   setup_q_nhb_pa10,setup_q_nhb_pa11,setup_q_nhb_pa12,
   setup_q_nhb_pa13,setup_q_nhb_pa15,setup_q_nhb_pa17,
   setup_q_nhb_pa19,setup_q_nhb_pa21,setup_q_nhb_pa23,
   setup_q_nhb_pa24,setup_q_nhb_pa25,setup_q_nhb_pa26,
   setup_q_nhb_pa28,setup_q_nhb_pa29,setup_q_nhb_pa30,
   setup_q_nhb_pa31,setup_q_nhb_pa32,setup_q_nhb_pa33,
   setup_q_nhb_pa34,setup_q_nhb_pa36,setup_q_nhb_pa37,
   setup_q_nhb_pa39,setup_q_nhb_pa40,setup_q_nhb_pa41,
   setup_q_nhb_pa44,setup_q_nhb_pa45,setup_q_nhb_pa47,
   setup_q_nhb_pa50,setup_q_nhb_pa51,setup_q_nhb_pa53,
   setup_q_nhb_pa54,setup_q_nhb_pa55)
# DID #
q_nhb_pa_est_did1 <- did_estimate(setup_q_nhb_pa_list[[1]]$Y, setup_q_nhb_pa_list[[1]]$N0, setup_q_nhb_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_pa_est_did2 <- did_estimate(setup_q_nhb_pa_list[[2]]$Y, setup_q_nhb_pa_list[[2]]$N0, setup_q_nhb_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_pa_est_did5 <- did_estimate(setup_q_nhb_pa_list[[3]]$Y, setup_q_nhb_pa_list[[3]]$N0, setup_q_nhb_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_pa_est_did10 <- did_estimate(setup_q_nhb_pa_list[[4]]$Y, setup_q_nhb_pa_list[[4]]$N0, setup_q_nhb_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_pa_est_did11 <- did_estimate(setup_q_nhb_pa_list[[5]]$Y, setup_q_nhb_pa_list[[5]]$N0, setup_q_nhb_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_pa_est_did12 <- did_estimate(setup_q_nhb_pa_list[[6]]$Y, setup_q_nhb_pa_list[[6]]$N0, setup_q_nhb_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_pa_est_did13 <- did_estimate(setup_q_nhb_pa_list[[7]]$Y, setup_q_nhb_pa_list[[7]]$N0, setup_q_nhb_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_pa_est_did15 <- did_estimate(setup_q_nhb_pa_list[[8]]$Y, setup_q_nhb_pa_list[[8]]$N0, setup_q_nhb_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_pa_est_did17 <- did_estimate(setup_q_nhb_pa_list[[9]]$Y, setup_q_nhb_pa_list[[9]]$N0, setup_q_nhb_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_pa_est_did19 <- did_estimate(setup_q_nhb_pa_list[[10]]$Y, setup_q_nhb_pa_list[[10]]$N0, setup_q_nhb_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_pa_est_did21 <- did_estimate(setup_q_nhb_pa_list[[11]]$Y, setup_q_nhb_pa_list[[11]]$N0, setup_q_nhb_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_pa_est_did23 <- did_estimate(setup_q_nhb_pa_list[[12]]$Y, setup_q_nhb_pa_list[[12]]$N0, setup_q_nhb_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_pa_est_did24 <- did_estimate(setup_q_nhb_pa_list[[13]]$Y, setup_q_nhb_pa_list[[13]]$N0, setup_q_nhb_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_pa_est_did25 <- did_estimate(setup_q_nhb_pa_list[[14]]$Y, setup_q_nhb_pa_list[[14]]$N0, setup_q_nhb_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_pa_est_did26 <- did_estimate(setup_q_nhb_pa_list[[15]]$Y, setup_q_nhb_pa_list[[15]]$N0, setup_q_nhb_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_pa_est_did28 <- did_estimate(setup_q_nhb_pa_list[[16]]$Y, setup_q_nhb_pa_list[[16]]$N0, setup_q_nhb_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_pa_est_did29 <- did_estimate(setup_q_nhb_pa_list[[17]]$Y, setup_q_nhb_pa_list[[17]]$N0, setup_q_nhb_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_pa_est_did30 <- did_estimate(setup_q_nhb_pa_list[[18]]$Y, setup_q_nhb_pa_list[[18]]$N0, setup_q_nhb_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_pa_est_did31 <- did_estimate(setup_q_nhb_pa_list[[19]]$Y, setup_q_nhb_pa_list[[19]]$N0, setup_q_nhb_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_pa_est_did32 <- did_estimate(setup_q_nhb_pa_list[[20]]$Y, setup_q_nhb_pa_list[[20]]$N0, setup_q_nhb_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_pa_est_did33 <- did_estimate(setup_q_nhb_pa_list[[21]]$Y, setup_q_nhb_pa_list[[21]]$N0, setup_q_nhb_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_pa_est_did34 <- did_estimate(setup_q_nhb_pa_list[[22]]$Y, setup_q_nhb_pa_list[[22]]$N0, setup_q_nhb_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_pa_est_did36 <- did_estimate(setup_q_nhb_pa_list[[23]]$Y, setup_q_nhb_pa_list[[23]]$N0, setup_q_nhb_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_pa_est_did37 <- did_estimate(setup_q_nhb_pa_list[[24]]$Y, setup_q_nhb_pa_list[[24]]$N0, setup_q_nhb_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_pa_est_did39 <- did_estimate(setup_q_nhb_pa_list[[25]]$Y, setup_q_nhb_pa_list[[25]]$N0, setup_q_nhb_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_pa_est_did40 <- did_estimate(setup_q_nhb_pa_list[[26]]$Y, setup_q_nhb_pa_list[[26]]$N0, setup_q_nhb_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_pa_est_did41 <- did_estimate(setup_q_nhb_pa_list[[27]]$Y, setup_q_nhb_pa_list[[27]]$N0, setup_q_nhb_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_pa_est_did44 <- did_estimate(setup_q_nhb_pa_list[[28]]$Y, setup_q_nhb_pa_list[[28]]$N0, setup_q_nhb_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_pa_est_did45 <- did_estimate(setup_q_nhb_pa_list[[29]]$Y, setup_q_nhb_pa_list[[29]]$N0, setup_q_nhb_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_pa_est_did47 <- did_estimate(setup_q_nhb_pa_list[[30]]$Y, setup_q_nhb_pa_list[[30]]$N0, setup_q_nhb_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_pa_est_did50 <- did_estimate(setup_q_nhb_pa_list[[31]]$Y, setup_q_nhb_pa_list[[31]]$N0, setup_q_nhb_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_pa_est_did51 <- did_estimate(setup_q_nhb_pa_list[[32]]$Y, setup_q_nhb_pa_list[[32]]$N0, setup_q_nhb_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_pa_est_did53 <- did_estimate(setup_q_nhb_pa_list[[33]]$Y, setup_q_nhb_pa_list[[33]]$N0, setup_q_nhb_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_pa_est_did54 <- did_estimate(setup_q_nhb_pa_list[[34]]$Y, setup_q_nhb_pa_list[[34]]$N0, setup_q_nhb_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_pa_est_did55 <- did_estimate(setup_q_nhb_pa_list[[35]]$Y, setup_q_nhb_pa_list[[35]]$N0, setup_q_nhb_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_pa_est_did_list <- list(q_nhb_pa_est_did1,q_nhb_pa_est_did2,q_nhb_pa_est_did5,
                             q_nhb_pa_est_did10,q_nhb_pa_est_did11,q_nhb_pa_est_did12,
                             q_nhb_pa_est_did13,q_nhb_pa_est_did15,q_nhb_pa_est_did17,
                             q_nhb_pa_est_did19,q_nhb_pa_est_did21,q_nhb_pa_est_did23,
                             q_nhb_pa_est_did24,q_nhb_pa_est_did25,q_nhb_pa_est_did26,
                             q_nhb_pa_est_did28,q_nhb_pa_est_did29,q_nhb_pa_est_did30,
                             q_nhb_pa_est_did31,q_nhb_pa_est_did32,q_nhb_pa_est_did33,
                             q_nhb_pa_est_did34,q_nhb_pa_est_did36,q_nhb_pa_est_did37,
                             q_nhb_pa_est_did39,q_nhb_pa_est_did40,q_nhb_pa_est_did41,
                             q_nhb_pa_est_did44,q_nhb_pa_est_did45,q_nhb_pa_est_did47,
                             q_nhb_pa_est_did50,q_nhb_pa_est_did51,q_nhb_pa_est_did53,
                             q_nhb_pa_est_did54,q_nhb_pa_est_did55)
rm(q_nhb_pa_est_did1,q_nhb_pa_est_did2,q_nhb_pa_est_did5,
   q_nhb_pa_est_did10,q_nhb_pa_est_did11,q_nhb_pa_est_did12,
   q_nhb_pa_est_did13,q_nhb_pa_est_did15,q_nhb_pa_est_did17,
   q_nhb_pa_est_did19,q_nhb_pa_est_did21,q_nhb_pa_est_did23,
   q_nhb_pa_est_did24,q_nhb_pa_est_did25,q_nhb_pa_est_did26,
   q_nhb_pa_est_did28,q_nhb_pa_est_did29,q_nhb_pa_est_did30,
   q_nhb_pa_est_did31,q_nhb_pa_est_did32,q_nhb_pa_est_did33,
   q_nhb_pa_est_did34,q_nhb_pa_est_did36,q_nhb_pa_est_did37,
   q_nhb_pa_est_did39,q_nhb_pa_est_did40,q_nhb_pa_est_did41,
   q_nhb_pa_est_did44,q_nhb_pa_est_did45,q_nhb_pa_est_did47,
   q_nhb_pa_est_did50,q_nhb_pa_est_did51,q_nhb_pa_est_did53,
   q_nhb_pa_est_did54,q_nhb_pa_est_did55)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_did_plot", i), synthdid_plot(q_nhb_pa_est_did_list[i]))
}
q_nhb_pa_est_did_plot_data_aux1 <- ggplot_build(q_nhb_pa_est_did_plot1)
q_nhb_pa_est_did_plot_data_aux2 <- ggplot_build(q_nhb_pa_est_did_plot2)
q_nhb_pa_est_did_plot_data_aux3 <- ggplot_build(q_nhb_pa_est_did_plot3)
q_nhb_pa_est_did_plot_data_aux4 <- ggplot_build(q_nhb_pa_est_did_plot4)
q_nhb_pa_est_did_plot_data_aux5 <- ggplot_build(q_nhb_pa_est_did_plot5)
q_nhb_pa_est_did_plot_data_aux6 <- ggplot_build(q_nhb_pa_est_did_plot6)
q_nhb_pa_est_did_plot_data_aux7 <- ggplot_build(q_nhb_pa_est_did_plot7)
q_nhb_pa_est_did_plot_data_aux8 <- ggplot_build(q_nhb_pa_est_did_plot8)
q_nhb_pa_est_did_plot_data_aux9 <- ggplot_build(q_nhb_pa_est_did_plot9)
q_nhb_pa_est_did_plot_data_aux10 <- ggplot_build(q_nhb_pa_est_did_plot10)
q_nhb_pa_est_did_plot_data_aux11 <- ggplot_build(q_nhb_pa_est_did_plot11)
q_nhb_pa_est_did_plot_data_aux12 <- ggplot_build(q_nhb_pa_est_did_plot12)
q_nhb_pa_est_did_plot_data_aux13 <- ggplot_build(q_nhb_pa_est_did_plot13)
q_nhb_pa_est_did_plot_data_aux14 <- ggplot_build(q_nhb_pa_est_did_plot14)
q_nhb_pa_est_did_plot_data_aux15 <- ggplot_build(q_nhb_pa_est_did_plot15)
q_nhb_pa_est_did_plot_data_aux16 <- ggplot_build(q_nhb_pa_est_did_plot16)
q_nhb_pa_est_did_plot_data_aux17 <- ggplot_build(q_nhb_pa_est_did_plot17)
q_nhb_pa_est_did_plot_data_aux18 <- ggplot_build(q_nhb_pa_est_did_plot18)
q_nhb_pa_est_did_plot_data_aux19 <- ggplot_build(q_nhb_pa_est_did_plot19)
q_nhb_pa_est_did_plot_data_aux20 <- ggplot_build(q_nhb_pa_est_did_plot20)
q_nhb_pa_est_did_plot_data_aux21 <- ggplot_build(q_nhb_pa_est_did_plot21)
q_nhb_pa_est_did_plot_data_aux22 <- ggplot_build(q_nhb_pa_est_did_plot22)
q_nhb_pa_est_did_plot_data_aux23 <- ggplot_build(q_nhb_pa_est_did_plot23)
q_nhb_pa_est_did_plot_data_aux24 <- ggplot_build(q_nhb_pa_est_did_plot24)
q_nhb_pa_est_did_plot_data_aux25 <- ggplot_build(q_nhb_pa_est_did_plot25)
q_nhb_pa_est_did_plot_data_aux26 <- ggplot_build(q_nhb_pa_est_did_plot26)
q_nhb_pa_est_did_plot_data_aux27 <- ggplot_build(q_nhb_pa_est_did_plot27)
q_nhb_pa_est_did_plot_data_aux28 <- ggplot_build(q_nhb_pa_est_did_plot28)
q_nhb_pa_est_did_plot_data_aux29 <- ggplot_build(q_nhb_pa_est_did_plot29)
q_nhb_pa_est_did_plot_data_aux30 <- ggplot_build(q_nhb_pa_est_did_plot30)
q_nhb_pa_est_did_plot_data_aux31 <- ggplot_build(q_nhb_pa_est_did_plot31)
q_nhb_pa_est_did_plot_data_aux32 <- ggplot_build(q_nhb_pa_est_did_plot32)
q_nhb_pa_est_did_plot_data_aux33 <- ggplot_build(q_nhb_pa_est_did_plot33)
q_nhb_pa_est_did_plot_data_aux34 <- ggplot_build(q_nhb_pa_est_did_plot34)
q_nhb_pa_est_did_plot_data_aux35 <- ggplot_build(q_nhb_pa_est_did_plot35)
q_nhb_pa_est_did_plot_data_aux_list <- list(q_nhb_pa_est_did_plot_data_aux1,q_nhb_pa_est_did_plot_data_aux2,q_nhb_pa_est_did_plot_data_aux3,
                                           q_nhb_pa_est_did_plot_data_aux4,q_nhb_pa_est_did_plot_data_aux5,q_nhb_pa_est_did_plot_data_aux6,
                                           q_nhb_pa_est_did_plot_data_aux7,q_nhb_pa_est_did_plot_data_aux8,q_nhb_pa_est_did_plot_data_aux9,
                                           q_nhb_pa_est_did_plot_data_aux10,q_nhb_pa_est_did_plot_data_aux11,q_nhb_pa_est_did_plot_data_aux12,
                                           q_nhb_pa_est_did_plot_data_aux13,q_nhb_pa_est_did_plot_data_aux14,q_nhb_pa_est_did_plot_data_aux15,
                                           q_nhb_pa_est_did_plot_data_aux16,q_nhb_pa_est_did_plot_data_aux17,q_nhb_pa_est_did_plot_data_aux18,
                                           q_nhb_pa_est_did_plot_data_aux19,q_nhb_pa_est_did_plot_data_aux20,q_nhb_pa_est_did_plot_data_aux21,
                                           q_nhb_pa_est_did_plot_data_aux22,q_nhb_pa_est_did_plot_data_aux23,q_nhb_pa_est_did_plot_data_aux24,
                                           q_nhb_pa_est_did_plot_data_aux25,q_nhb_pa_est_did_plot_data_aux26,q_nhb_pa_est_did_plot_data_aux27,
                                           q_nhb_pa_est_did_plot_data_aux28,q_nhb_pa_est_did_plot_data_aux29,q_nhb_pa_est_did_plot_data_aux30,
                                           q_nhb_pa_est_did_plot_data_aux31,q_nhb_pa_est_did_plot_data_aux32,q_nhb_pa_est_did_plot_data_aux33,
                                           q_nhb_pa_est_did_plot_data_aux34,q_nhb_pa_est_did_plot_data_aux35)
rm(q_nhb_pa_est_did_plot_data_aux1,q_nhb_pa_est_did_plot_data_aux2,q_nhb_pa_est_did_plot_data_aux3,
   q_nhb_pa_est_did_plot_data_aux4,q_nhb_pa_est_did_plot_data_aux5,q_nhb_pa_est_did_plot_data_aux6,
   q_nhb_pa_est_did_plot_data_aux7,q_nhb_pa_est_did_plot_data_aux8,q_nhb_pa_est_did_plot_data_aux9,
   q_nhb_pa_est_did_plot_data_aux10,q_nhb_pa_est_did_plot_data_aux11,q_nhb_pa_est_did_plot_data_aux12,
   q_nhb_pa_est_did_plot_data_aux13,q_nhb_pa_est_did_plot_data_aux14,q_nhb_pa_est_did_plot_data_aux15,
   q_nhb_pa_est_did_plot_data_aux16,q_nhb_pa_est_did_plot_data_aux17,q_nhb_pa_est_did_plot_data_aux18,
   q_nhb_pa_est_did_plot_data_aux19,q_nhb_pa_est_did_plot_data_aux20,q_nhb_pa_est_did_plot_data_aux21,
   q_nhb_pa_est_did_plot_data_aux22,q_nhb_pa_est_did_plot_data_aux23,q_nhb_pa_est_did_plot_data_aux24,
   q_nhb_pa_est_did_plot_data_aux25,q_nhb_pa_est_did_plot_data_aux26,q_nhb_pa_est_did_plot_data_aux27,
   q_nhb_pa_est_did_plot_data_aux28,q_nhb_pa_est_did_plot_data_aux29,q_nhb_pa_est_did_plot_data_aux30,
   q_nhb_pa_est_did_plot_data_aux31,q_nhb_pa_est_did_plot_data_aux32,q_nhb_pa_est_did_plot_data_aux33,
   q_nhb_pa_est_did_plot_data_aux34,q_nhb_pa_est_did_plot_data_aux35)
rm(q_nhb_pa_est_did_plot1,q_nhb_pa_est_did_plot2,q_nhb_pa_est_did_plot3,
   q_nhb_pa_est_did_plot4,q_nhb_pa_est_did_plot5,q_nhb_pa_est_did_plot6,
   q_nhb_pa_est_did_plot7,q_nhb_pa_est_did_plot8,q_nhb_pa_est_did_plot9,
   q_nhb_pa_est_did_plot10,q_nhb_pa_est_did_plot11,q_nhb_pa_est_did_plot12,
   q_nhb_pa_est_did_plot13,q_nhb_pa_est_did_plot14,q_nhb_pa_est_did_plot15,
   q_nhb_pa_est_did_plot16,q_nhb_pa_est_did_plot17,q_nhb_pa_est_did_plot18,
   q_nhb_pa_est_did_plot19,q_nhb_pa_est_did_plot20,q_nhb_pa_est_did_plot21,
   q_nhb_pa_est_did_plot22,q_nhb_pa_est_did_plot23,q_nhb_pa_est_did_plot24,
   q_nhb_pa_est_did_plot25,q_nhb_pa_est_did_plot26,q_nhb_pa_est_did_plot27,
   q_nhb_pa_est_did_plot28,q_nhb_pa_est_did_plot29,q_nhb_pa_est_did_plot30,
   q_nhb_pa_est_did_plot31,q_nhb_pa_est_did_plot32,q_nhb_pa_est_did_plot33,
   q_nhb_pa_est_did_plot34,q_nhb_pa_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_did_plot_data_long", i), data.frame(q_nhb_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_pa_est_did_plot_data_long_list <- list(q_nhb_pa_est_did_plot_data_long1,q_nhb_pa_est_did_plot_data_long2,q_nhb_pa_est_did_plot_data_long3,
                                            q_nhb_pa_est_did_plot_data_long4,q_nhb_pa_est_did_plot_data_long5,q_nhb_pa_est_did_plot_data_long6,
                                            q_nhb_pa_est_did_plot_data_long7,q_nhb_pa_est_did_plot_data_long8,q_nhb_pa_est_did_plot_data_long9,
                                            q_nhb_pa_est_did_plot_data_long10,q_nhb_pa_est_did_plot_data_long11,q_nhb_pa_est_did_plot_data_long12,
                                            q_nhb_pa_est_did_plot_data_long13,q_nhb_pa_est_did_plot_data_long14,q_nhb_pa_est_did_plot_data_long15,
                                            q_nhb_pa_est_did_plot_data_long16,q_nhb_pa_est_did_plot_data_long17,q_nhb_pa_est_did_plot_data_long18,
                                            q_nhb_pa_est_did_plot_data_long19,q_nhb_pa_est_did_plot_data_long20,q_nhb_pa_est_did_plot_data_long21,
                                            q_nhb_pa_est_did_plot_data_long22,q_nhb_pa_est_did_plot_data_long23,q_nhb_pa_est_did_plot_data_long24,
                                            q_nhb_pa_est_did_plot_data_long25,q_nhb_pa_est_did_plot_data_long26,q_nhb_pa_est_did_plot_data_long27,
                                            q_nhb_pa_est_did_plot_data_long28,q_nhb_pa_est_did_plot_data_long29,q_nhb_pa_est_did_plot_data_long30,
                                            q_nhb_pa_est_did_plot_data_long31,q_nhb_pa_est_did_plot_data_long32,q_nhb_pa_est_did_plot_data_long33,
                                            q_nhb_pa_est_did_plot_data_long34,q_nhb_pa_est_did_plot_data_long35)
rm(q_nhb_pa_est_did_plot_data_long1,q_nhb_pa_est_did_plot_data_long2,q_nhb_pa_est_did_plot_data_long3,
   q_nhb_pa_est_did_plot_data_long4,q_nhb_pa_est_did_plot_data_long5,q_nhb_pa_est_did_plot_data_long6,
   q_nhb_pa_est_did_plot_data_long7,q_nhb_pa_est_did_plot_data_long8,q_nhb_pa_est_did_plot_data_long9,
   q_nhb_pa_est_did_plot_data_long10,q_nhb_pa_est_did_plot_data_long11,q_nhb_pa_est_did_plot_data_long12,
   q_nhb_pa_est_did_plot_data_long13,q_nhb_pa_est_did_plot_data_long14,q_nhb_pa_est_did_plot_data_long15,
   q_nhb_pa_est_did_plot_data_long16,q_nhb_pa_est_did_plot_data_long17,q_nhb_pa_est_did_plot_data_long18,
   q_nhb_pa_est_did_plot_data_long19,q_nhb_pa_est_did_plot_data_long20,q_nhb_pa_est_did_plot_data_long21,
   q_nhb_pa_est_did_plot_data_long22,q_nhb_pa_est_did_plot_data_long23,q_nhb_pa_est_did_plot_data_long24,
   q_nhb_pa_est_did_plot_data_long25,q_nhb_pa_est_did_plot_data_long26,q_nhb_pa_est_did_plot_data_long27,
   q_nhb_pa_est_did_plot_data_long28,q_nhb_pa_est_did_plot_data_long29,q_nhb_pa_est_did_plot_data_long30,
   q_nhb_pa_est_did_plot_data_long31,q_nhb_pa_est_did_plot_data_long32,q_nhb_pa_est_did_plot_data_long33,
   q_nhb_pa_est_did_plot_data_long34,q_nhb_pa_est_did_plot_data_long35)
q_nhb_pa_est_did_plot_data_long_list <- lapply(q_nhb_pa_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_did_plot_data_wide", i), reshape(data=q_nhb_pa_est_did_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
q_nhb_pa_est_did_plot_data_wide_list <- list(q_nhb_pa_est_did_plot_data_wide1,q_nhb_pa_est_did_plot_data_wide2,q_nhb_pa_est_did_plot_data_wide3,
                                            q_nhb_pa_est_did_plot_data_wide4,q_nhb_pa_est_did_plot_data_wide5,q_nhb_pa_est_did_plot_data_wide6,
                                            q_nhb_pa_est_did_plot_data_wide7,q_nhb_pa_est_did_plot_data_wide8,q_nhb_pa_est_did_plot_data_wide9,
                                            q_nhb_pa_est_did_plot_data_wide10,q_nhb_pa_est_did_plot_data_wide11,q_nhb_pa_est_did_plot_data_wide12,
                                            q_nhb_pa_est_did_plot_data_wide13,q_nhb_pa_est_did_plot_data_wide14,q_nhb_pa_est_did_plot_data_wide15,
                                            q_nhb_pa_est_did_plot_data_wide16,q_nhb_pa_est_did_plot_data_wide17,q_nhb_pa_est_did_plot_data_wide18,
                                            q_nhb_pa_est_did_plot_data_wide19,q_nhb_pa_est_did_plot_data_wide20,q_nhb_pa_est_did_plot_data_wide21,
                                            q_nhb_pa_est_did_plot_data_wide22,q_nhb_pa_est_did_plot_data_wide23,q_nhb_pa_est_did_plot_data_wide24,
                                            q_nhb_pa_est_did_plot_data_wide25,q_nhb_pa_est_did_plot_data_wide26,q_nhb_pa_est_did_plot_data_wide27,
                                            q_nhb_pa_est_did_plot_data_wide28,q_nhb_pa_est_did_plot_data_wide29,q_nhb_pa_est_did_plot_data_wide30,
                                            q_nhb_pa_est_did_plot_data_wide31,q_nhb_pa_est_did_plot_data_wide32,q_nhb_pa_est_did_plot_data_wide33,
                                            q_nhb_pa_est_did_plot_data_wide34,q_nhb_pa_est_did_plot_data_wide35)
rm(q_nhb_pa_est_did_plot_data_wide1,q_nhb_pa_est_did_plot_data_wide2,q_nhb_pa_est_did_plot_data_wide3,
   q_nhb_pa_est_did_plot_data_wide4,q_nhb_pa_est_did_plot_data_wide5,q_nhb_pa_est_did_plot_data_wide6,
   q_nhb_pa_est_did_plot_data_wide7,q_nhb_pa_est_did_plot_data_wide8,q_nhb_pa_est_did_plot_data_wide9,
   q_nhb_pa_est_did_plot_data_wide10,q_nhb_pa_est_did_plot_data_wide11,q_nhb_pa_est_did_plot_data_wide12,
   q_nhb_pa_est_did_plot_data_wide13,q_nhb_pa_est_did_plot_data_wide14,q_nhb_pa_est_did_plot_data_wide15,
   q_nhb_pa_est_did_plot_data_wide16,q_nhb_pa_est_did_plot_data_wide17,q_nhb_pa_est_did_plot_data_wide18,
   q_nhb_pa_est_did_plot_data_wide19,q_nhb_pa_est_did_plot_data_wide20,q_nhb_pa_est_did_plot_data_wide21,
   q_nhb_pa_est_did_plot_data_wide22,q_nhb_pa_est_did_plot_data_wide23,q_nhb_pa_est_did_plot_data_wide24,
   q_nhb_pa_est_did_plot_data_wide25,q_nhb_pa_est_did_plot_data_wide26,q_nhb_pa_est_did_plot_data_wide27,
   q_nhb_pa_est_did_plot_data_wide28,q_nhb_pa_est_did_plot_data_wide29,q_nhb_pa_est_did_plot_data_wide30,
   q_nhb_pa_est_did_plot_data_wide31,q_nhb_pa_est_did_plot_data_wide32,q_nhb_pa_est_did_plot_data_wide33,
   q_nhb_pa_est_did_plot_data_wide34,q_nhb_pa_est_did_plot_data_wide35)
q_nhb_pa_est_did_plot_data_wide_list <- lapply(q_nhb_pa_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nhb_pa_est_sc1 <- sc_estimate(setup_q_nhb_pa_list[[1]]$Y, setup_q_nhb_pa_list[[1]]$N0, setup_q_nhb_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_pa_est_sc2 <- sc_estimate(setup_q_nhb_pa_list[[2]]$Y, setup_q_nhb_pa_list[[2]]$N0, setup_q_nhb_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_pa_est_sc5 <- sc_estimate(setup_q_nhb_pa_list[[3]]$Y, setup_q_nhb_pa_list[[3]]$N0, setup_q_nhb_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_pa_est_sc10 <- sc_estimate(setup_q_nhb_pa_list[[4]]$Y, setup_q_nhb_pa_list[[4]]$N0, setup_q_nhb_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_pa_est_sc11 <- sc_estimate(setup_q_nhb_pa_list[[5]]$Y, setup_q_nhb_pa_list[[5]]$N0, setup_q_nhb_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_pa_est_sc12 <- sc_estimate(setup_q_nhb_pa_list[[6]]$Y, setup_q_nhb_pa_list[[6]]$N0, setup_q_nhb_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_pa_est_sc13 <- sc_estimate(setup_q_nhb_pa_list[[7]]$Y, setup_q_nhb_pa_list[[7]]$N0, setup_q_nhb_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_pa_est_sc15 <- sc_estimate(setup_q_nhb_pa_list[[8]]$Y, setup_q_nhb_pa_list[[8]]$N0, setup_q_nhb_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_pa_est_sc17 <- sc_estimate(setup_q_nhb_pa_list[[9]]$Y, setup_q_nhb_pa_list[[9]]$N0, setup_q_nhb_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_pa_est_sc19 <- sc_estimate(setup_q_nhb_pa_list[[10]]$Y, setup_q_nhb_pa_list[[10]]$N0, setup_q_nhb_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_pa_est_sc21 <- sc_estimate(setup_q_nhb_pa_list[[11]]$Y, setup_q_nhb_pa_list[[11]]$N0, setup_q_nhb_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_pa_est_sc23 <- sc_estimate(setup_q_nhb_pa_list[[12]]$Y, setup_q_nhb_pa_list[[12]]$N0, setup_q_nhb_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_pa_est_sc24 <- sc_estimate(setup_q_nhb_pa_list[[13]]$Y, setup_q_nhb_pa_list[[13]]$N0, setup_q_nhb_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_pa_est_sc25 <- sc_estimate(setup_q_nhb_pa_list[[14]]$Y, setup_q_nhb_pa_list[[14]]$N0, setup_q_nhb_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_pa_est_sc26 <- sc_estimate(setup_q_nhb_pa_list[[15]]$Y, setup_q_nhb_pa_list[[15]]$N0, setup_q_nhb_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_pa_est_sc28 <- sc_estimate(setup_q_nhb_pa_list[[16]]$Y, setup_q_nhb_pa_list[[16]]$N0, setup_q_nhb_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_pa_est_sc29 <- sc_estimate(setup_q_nhb_pa_list[[17]]$Y, setup_q_nhb_pa_list[[17]]$N0, setup_q_nhb_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_pa_est_sc30 <- sc_estimate(setup_q_nhb_pa_list[[18]]$Y, setup_q_nhb_pa_list[[18]]$N0, setup_q_nhb_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_pa_est_sc31 <- sc_estimate(setup_q_nhb_pa_list[[19]]$Y, setup_q_nhb_pa_list[[19]]$N0, setup_q_nhb_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_pa_est_sc32 <- sc_estimate(setup_q_nhb_pa_list[[20]]$Y, setup_q_nhb_pa_list[[20]]$N0, setup_q_nhb_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_pa_est_sc33 <- sc_estimate(setup_q_nhb_pa_list[[21]]$Y, setup_q_nhb_pa_list[[21]]$N0, setup_q_nhb_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_pa_est_sc34 <- sc_estimate(setup_q_nhb_pa_list[[22]]$Y, setup_q_nhb_pa_list[[22]]$N0, setup_q_nhb_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_pa_est_sc36 <- sc_estimate(setup_q_nhb_pa_list[[23]]$Y, setup_q_nhb_pa_list[[23]]$N0, setup_q_nhb_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_pa_est_sc37 <- sc_estimate(setup_q_nhb_pa_list[[24]]$Y, setup_q_nhb_pa_list[[24]]$N0, setup_q_nhb_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_pa_est_sc39 <- sc_estimate(setup_q_nhb_pa_list[[25]]$Y, setup_q_nhb_pa_list[[25]]$N0, setup_q_nhb_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_pa_est_sc40 <- sc_estimate(setup_q_nhb_pa_list[[26]]$Y, setup_q_nhb_pa_list[[26]]$N0, setup_q_nhb_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_pa_est_sc41 <- sc_estimate(setup_q_nhb_pa_list[[27]]$Y, setup_q_nhb_pa_list[[27]]$N0, setup_q_nhb_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_pa_est_sc44 <- sc_estimate(setup_q_nhb_pa_list[[28]]$Y, setup_q_nhb_pa_list[[28]]$N0, setup_q_nhb_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_pa_est_sc45 <- sc_estimate(setup_q_nhb_pa_list[[29]]$Y, setup_q_nhb_pa_list[[29]]$N0, setup_q_nhb_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_pa_est_sc47 <- sc_estimate(setup_q_nhb_pa_list[[30]]$Y, setup_q_nhb_pa_list[[30]]$N0, setup_q_nhb_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_pa_est_sc50 <- sc_estimate(setup_q_nhb_pa_list[[31]]$Y, setup_q_nhb_pa_list[[31]]$N0, setup_q_nhb_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_pa_est_sc51 <- sc_estimate(setup_q_nhb_pa_list[[32]]$Y, setup_q_nhb_pa_list[[32]]$N0, setup_q_nhb_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_pa_est_sc53 <- sc_estimate(setup_q_nhb_pa_list[[33]]$Y, setup_q_nhb_pa_list[[33]]$N0, setup_q_nhb_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_pa_est_sc54 <- sc_estimate(setup_q_nhb_pa_list[[34]]$Y, setup_q_nhb_pa_list[[34]]$N0, setup_q_nhb_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_pa_est_sc55 <- sc_estimate(setup_q_nhb_pa_list[[35]]$Y, setup_q_nhb_pa_list[[35]]$N0, setup_q_nhb_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_pa_est_sc_list <- list(q_nhb_pa_est_sc1,q_nhb_pa_est_sc2,q_nhb_pa_est_sc5,
                            q_nhb_pa_est_sc10,q_nhb_pa_est_sc11,q_nhb_pa_est_sc12,
                            q_nhb_pa_est_sc13,q_nhb_pa_est_sc15,q_nhb_pa_est_sc17,
                            q_nhb_pa_est_sc19,q_nhb_pa_est_sc21,q_nhb_pa_est_sc23,
                            q_nhb_pa_est_sc24,q_nhb_pa_est_sc25,q_nhb_pa_est_sc26,
                            q_nhb_pa_est_sc28,q_nhb_pa_est_sc29,q_nhb_pa_est_sc30,
                            q_nhb_pa_est_sc31,q_nhb_pa_est_sc32,q_nhb_pa_est_sc33,
                            q_nhb_pa_est_sc34,q_nhb_pa_est_sc36,q_nhb_pa_est_sc37,
                            q_nhb_pa_est_sc39,q_nhb_pa_est_sc40,q_nhb_pa_est_sc41,
                            q_nhb_pa_est_sc44,q_nhb_pa_est_sc45,q_nhb_pa_est_sc47,
                            q_nhb_pa_est_sc50,q_nhb_pa_est_sc51,q_nhb_pa_est_sc53,
                            q_nhb_pa_est_sc54,q_nhb_pa_est_sc55)
rm(q_nhb_pa_est_sc1,q_nhb_pa_est_sc2,q_nhb_pa_est_sc5,
   q_nhb_pa_est_sc10,q_nhb_pa_est_sc11,q_nhb_pa_est_sc12,
   q_nhb_pa_est_sc13,q_nhb_pa_est_sc15,q_nhb_pa_est_sc17,
   q_nhb_pa_est_sc19,q_nhb_pa_est_sc21,q_nhb_pa_est_sc23,
   q_nhb_pa_est_sc24,q_nhb_pa_est_sc25,q_nhb_pa_est_sc26,
   q_nhb_pa_est_sc28,q_nhb_pa_est_sc29,q_nhb_pa_est_sc30,
   q_nhb_pa_est_sc31,q_nhb_pa_est_sc32,q_nhb_pa_est_sc33,
   q_nhb_pa_est_sc34,q_nhb_pa_est_sc36,q_nhb_pa_est_sc37,
   q_nhb_pa_est_sc39,q_nhb_pa_est_sc40,q_nhb_pa_est_sc41,
   q_nhb_pa_est_sc44,q_nhb_pa_est_sc45,q_nhb_pa_est_sc47,
   q_nhb_pa_est_sc50,q_nhb_pa_est_sc51,q_nhb_pa_est_sc53,
   q_nhb_pa_est_sc54,q_nhb_pa_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sc_plot", i), synthdid_plot(q_nhb_pa_est_sc_list[i]))
}
q_nhb_pa_est_sc_plot_data_aux1 <- ggplot_build(q_nhb_pa_est_sc_plot1)
q_nhb_pa_est_sc_plot_data_aux2 <- ggplot_build(q_nhb_pa_est_sc_plot2)
q_nhb_pa_est_sc_plot_data_aux3 <- ggplot_build(q_nhb_pa_est_sc_plot3)
q_nhb_pa_est_sc_plot_data_aux4 <- ggplot_build(q_nhb_pa_est_sc_plot4)
q_nhb_pa_est_sc_plot_data_aux5 <- ggplot_build(q_nhb_pa_est_sc_plot5)
q_nhb_pa_est_sc_plot_data_aux6 <- ggplot_build(q_nhb_pa_est_sc_plot6)
q_nhb_pa_est_sc_plot_data_aux7 <- ggplot_build(q_nhb_pa_est_sc_plot7)
q_nhb_pa_est_sc_plot_data_aux8 <- ggplot_build(q_nhb_pa_est_sc_plot8)
q_nhb_pa_est_sc_plot_data_aux9 <- ggplot_build(q_nhb_pa_est_sc_plot9)
q_nhb_pa_est_sc_plot_data_aux10 <- ggplot_build(q_nhb_pa_est_sc_plot10)
q_nhb_pa_est_sc_plot_data_aux11 <- ggplot_build(q_nhb_pa_est_sc_plot11)
q_nhb_pa_est_sc_plot_data_aux12 <- ggplot_build(q_nhb_pa_est_sc_plot12)
q_nhb_pa_est_sc_plot_data_aux13 <- ggplot_build(q_nhb_pa_est_sc_plot13)
q_nhb_pa_est_sc_plot_data_aux14 <- ggplot_build(q_nhb_pa_est_sc_plot14)
q_nhb_pa_est_sc_plot_data_aux15 <- ggplot_build(q_nhb_pa_est_sc_plot15)
q_nhb_pa_est_sc_plot_data_aux16 <- ggplot_build(q_nhb_pa_est_sc_plot16)
q_nhb_pa_est_sc_plot_data_aux17 <- ggplot_build(q_nhb_pa_est_sc_plot17)
q_nhb_pa_est_sc_plot_data_aux18 <- ggplot_build(q_nhb_pa_est_sc_plot18)
q_nhb_pa_est_sc_plot_data_aux19 <- ggplot_build(q_nhb_pa_est_sc_plot19)
q_nhb_pa_est_sc_plot_data_aux20 <- ggplot_build(q_nhb_pa_est_sc_plot20)
q_nhb_pa_est_sc_plot_data_aux21 <- ggplot_build(q_nhb_pa_est_sc_plot21)
q_nhb_pa_est_sc_plot_data_aux22 <- ggplot_build(q_nhb_pa_est_sc_plot22)
q_nhb_pa_est_sc_plot_data_aux23 <- ggplot_build(q_nhb_pa_est_sc_plot23)
q_nhb_pa_est_sc_plot_data_aux24 <- ggplot_build(q_nhb_pa_est_sc_plot24)
q_nhb_pa_est_sc_plot_data_aux25 <- ggplot_build(q_nhb_pa_est_sc_plot25)
q_nhb_pa_est_sc_plot_data_aux26 <- ggplot_build(q_nhb_pa_est_sc_plot26)
q_nhb_pa_est_sc_plot_data_aux27 <- ggplot_build(q_nhb_pa_est_sc_plot27)
q_nhb_pa_est_sc_plot_data_aux28 <- ggplot_build(q_nhb_pa_est_sc_plot28)
q_nhb_pa_est_sc_plot_data_aux29 <- ggplot_build(q_nhb_pa_est_sc_plot29)
q_nhb_pa_est_sc_plot_data_aux30 <- ggplot_build(q_nhb_pa_est_sc_plot30)
q_nhb_pa_est_sc_plot_data_aux31 <- ggplot_build(q_nhb_pa_est_sc_plot31)
q_nhb_pa_est_sc_plot_data_aux32 <- ggplot_build(q_nhb_pa_est_sc_plot32)
q_nhb_pa_est_sc_plot_data_aux33 <- ggplot_build(q_nhb_pa_est_sc_plot33)
q_nhb_pa_est_sc_plot_data_aux34 <- ggplot_build(q_nhb_pa_est_sc_plot34)
q_nhb_pa_est_sc_plot_data_aux35 <- ggplot_build(q_nhb_pa_est_sc_plot35)
q_nhb_pa_est_sc_plot_data_aux_list <- list(q_nhb_pa_est_sc_plot_data_aux1,q_nhb_pa_est_sc_plot_data_aux2,q_nhb_pa_est_sc_plot_data_aux3,
                                          q_nhb_pa_est_sc_plot_data_aux4,q_nhb_pa_est_sc_plot_data_aux5,q_nhb_pa_est_sc_plot_data_aux6,
                                          q_nhb_pa_est_sc_plot_data_aux7,q_nhb_pa_est_sc_plot_data_aux8,q_nhb_pa_est_sc_plot_data_aux9,
                                          q_nhb_pa_est_sc_plot_data_aux10,q_nhb_pa_est_sc_plot_data_aux11,q_nhb_pa_est_sc_plot_data_aux12,
                                          q_nhb_pa_est_sc_plot_data_aux13,q_nhb_pa_est_sc_plot_data_aux14,q_nhb_pa_est_sc_plot_data_aux15,
                                          q_nhb_pa_est_sc_plot_data_aux16,q_nhb_pa_est_sc_plot_data_aux17,q_nhb_pa_est_sc_plot_data_aux18,
                                          q_nhb_pa_est_sc_plot_data_aux19,q_nhb_pa_est_sc_plot_data_aux20,q_nhb_pa_est_sc_plot_data_aux21,
                                          q_nhb_pa_est_sc_plot_data_aux22,q_nhb_pa_est_sc_plot_data_aux23,q_nhb_pa_est_sc_plot_data_aux24,
                                          q_nhb_pa_est_sc_plot_data_aux25,q_nhb_pa_est_sc_plot_data_aux26,q_nhb_pa_est_sc_plot_data_aux27,
                                          q_nhb_pa_est_sc_plot_data_aux28,q_nhb_pa_est_sc_plot_data_aux29,q_nhb_pa_est_sc_plot_data_aux30,
                                          q_nhb_pa_est_sc_plot_data_aux31,q_nhb_pa_est_sc_plot_data_aux32,q_nhb_pa_est_sc_plot_data_aux33,
                                          q_nhb_pa_est_sc_plot_data_aux34,q_nhb_pa_est_sc_plot_data_aux35)
rm(q_nhb_pa_est_sc_plot_data_aux1,q_nhb_pa_est_sc_plot_data_aux2,q_nhb_pa_est_sc_plot_data_aux3,
   q_nhb_pa_est_sc_plot_data_aux4,q_nhb_pa_est_sc_plot_data_aux5,q_nhb_pa_est_sc_plot_data_aux6,
   q_nhb_pa_est_sc_plot_data_aux7,q_nhb_pa_est_sc_plot_data_aux8,q_nhb_pa_est_sc_plot_data_aux9,
   q_nhb_pa_est_sc_plot_data_aux10,q_nhb_pa_est_sc_plot_data_aux11,q_nhb_pa_est_sc_plot_data_aux12,
   q_nhb_pa_est_sc_plot_data_aux13,q_nhb_pa_est_sc_plot_data_aux14,q_nhb_pa_est_sc_plot_data_aux15,
   q_nhb_pa_est_sc_plot_data_aux16,q_nhb_pa_est_sc_plot_data_aux17,q_nhb_pa_est_sc_plot_data_aux18,
   q_nhb_pa_est_sc_plot_data_aux19,q_nhb_pa_est_sc_plot_data_aux20,q_nhb_pa_est_sc_plot_data_aux21,
   q_nhb_pa_est_sc_plot_data_aux22,q_nhb_pa_est_sc_plot_data_aux23,q_nhb_pa_est_sc_plot_data_aux24,
   q_nhb_pa_est_sc_plot_data_aux25,q_nhb_pa_est_sc_plot_data_aux26,q_nhb_pa_est_sc_plot_data_aux27,
   q_nhb_pa_est_sc_plot_data_aux28,q_nhb_pa_est_sc_plot_data_aux29,q_nhb_pa_est_sc_plot_data_aux30,
   q_nhb_pa_est_sc_plot_data_aux31,q_nhb_pa_est_sc_plot_data_aux32,q_nhb_pa_est_sc_plot_data_aux33,
   q_nhb_pa_est_sc_plot_data_aux34,q_nhb_pa_est_sc_plot_data_aux35)
rm(q_nhb_pa_est_sc_plot1,q_nhb_pa_est_sc_plot2,q_nhb_pa_est_sc_plot3,
   q_nhb_pa_est_sc_plot4,q_nhb_pa_est_sc_plot5,q_nhb_pa_est_sc_plot6,
   q_nhb_pa_est_sc_plot7,q_nhb_pa_est_sc_plot8,q_nhb_pa_est_sc_plot9,
   q_nhb_pa_est_sc_plot10,q_nhb_pa_est_sc_plot11,q_nhb_pa_est_sc_plot12,
   q_nhb_pa_est_sc_plot13,q_nhb_pa_est_sc_plot14,q_nhb_pa_est_sc_plot15,
   q_nhb_pa_est_sc_plot16,q_nhb_pa_est_sc_plot17,q_nhb_pa_est_sc_plot18,
   q_nhb_pa_est_sc_plot19,q_nhb_pa_est_sc_plot20,q_nhb_pa_est_sc_plot21,
   q_nhb_pa_est_sc_plot22,q_nhb_pa_est_sc_plot23,q_nhb_pa_est_sc_plot24,
   q_nhb_pa_est_sc_plot25,q_nhb_pa_est_sc_plot26,q_nhb_pa_est_sc_plot27,
   q_nhb_pa_est_sc_plot28,q_nhb_pa_est_sc_plot29,q_nhb_pa_est_sc_plot30,
   q_nhb_pa_est_sc_plot31,q_nhb_pa_est_sc_plot32,q_nhb_pa_est_sc_plot33,
   q_nhb_pa_est_sc_plot34,q_nhb_pa_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sc_plot_data_long", i), data.frame(q_nhb_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_pa_est_sc_plot_data_long_list <- list(q_nhb_pa_est_sc_plot_data_long1,q_nhb_pa_est_sc_plot_data_long2,q_nhb_pa_est_sc_plot_data_long3,
                                           q_nhb_pa_est_sc_plot_data_long4,q_nhb_pa_est_sc_plot_data_long5,q_nhb_pa_est_sc_plot_data_long6,
                                           q_nhb_pa_est_sc_plot_data_long7,q_nhb_pa_est_sc_plot_data_long8,q_nhb_pa_est_sc_plot_data_long9,
                                           q_nhb_pa_est_sc_plot_data_long10,q_nhb_pa_est_sc_plot_data_long11,q_nhb_pa_est_sc_plot_data_long12,
                                           q_nhb_pa_est_sc_plot_data_long13,q_nhb_pa_est_sc_plot_data_long14,q_nhb_pa_est_sc_plot_data_long15,
                                           q_nhb_pa_est_sc_plot_data_long16,q_nhb_pa_est_sc_plot_data_long17,q_nhb_pa_est_sc_plot_data_long18,
                                           q_nhb_pa_est_sc_plot_data_long19,q_nhb_pa_est_sc_plot_data_long20,q_nhb_pa_est_sc_plot_data_long21,
                                           q_nhb_pa_est_sc_plot_data_long22,q_nhb_pa_est_sc_plot_data_long23,q_nhb_pa_est_sc_plot_data_long24,
                                           q_nhb_pa_est_sc_plot_data_long25,q_nhb_pa_est_sc_plot_data_long26,q_nhb_pa_est_sc_plot_data_long27,
                                           q_nhb_pa_est_sc_plot_data_long28,q_nhb_pa_est_sc_plot_data_long29,q_nhb_pa_est_sc_plot_data_long30,
                                           q_nhb_pa_est_sc_plot_data_long31,q_nhb_pa_est_sc_plot_data_long32,q_nhb_pa_est_sc_plot_data_long33,
                                           q_nhb_pa_est_sc_plot_data_long34,q_nhb_pa_est_sc_plot_data_long35)
rm(q_nhb_pa_est_sc_plot_data_long1,q_nhb_pa_est_sc_plot_data_long2,q_nhb_pa_est_sc_plot_data_long3,
   q_nhb_pa_est_sc_plot_data_long4,q_nhb_pa_est_sc_plot_data_long5,q_nhb_pa_est_sc_plot_data_long6,
   q_nhb_pa_est_sc_plot_data_long7,q_nhb_pa_est_sc_plot_data_long8,q_nhb_pa_est_sc_plot_data_long9,
   q_nhb_pa_est_sc_plot_data_long10,q_nhb_pa_est_sc_plot_data_long11,q_nhb_pa_est_sc_plot_data_long12,
   q_nhb_pa_est_sc_plot_data_long13,q_nhb_pa_est_sc_plot_data_long14,q_nhb_pa_est_sc_plot_data_long15,
   q_nhb_pa_est_sc_plot_data_long16,q_nhb_pa_est_sc_plot_data_long17,q_nhb_pa_est_sc_plot_data_long18,
   q_nhb_pa_est_sc_plot_data_long19,q_nhb_pa_est_sc_plot_data_long20,q_nhb_pa_est_sc_plot_data_long21,
   q_nhb_pa_est_sc_plot_data_long22,q_nhb_pa_est_sc_plot_data_long23,q_nhb_pa_est_sc_plot_data_long24,
   q_nhb_pa_est_sc_plot_data_long25,q_nhb_pa_est_sc_plot_data_long26,q_nhb_pa_est_sc_plot_data_long27,
   q_nhb_pa_est_sc_plot_data_long28,q_nhb_pa_est_sc_plot_data_long29,q_nhb_pa_est_sc_plot_data_long30,
   q_nhb_pa_est_sc_plot_data_long31,q_nhb_pa_est_sc_plot_data_long32,q_nhb_pa_est_sc_plot_data_long33,
   q_nhb_pa_est_sc_plot_data_long34,q_nhb_pa_est_sc_plot_data_long35)
q_nhb_pa_est_sc_plot_data_long_list <- lapply(q_nhb_pa_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sc_plot_data_wide", i), reshape(data=q_nhb_pa_est_sc_plot_data_long_list[[i]],
                                                             idvar = "year",
                                                             v.names = "outcome",
                                                             timevar = "treated",
                                                             direction = "wide"))
}
q_nhb_pa_est_sc_plot_data_wide_list <- list(q_nhb_pa_est_sc_plot_data_wide1,q_nhb_pa_est_sc_plot_data_wide2,q_nhb_pa_est_sc_plot_data_wide3,
                                           q_nhb_pa_est_sc_plot_data_wide4,q_nhb_pa_est_sc_plot_data_wide5,q_nhb_pa_est_sc_plot_data_wide6,
                                           q_nhb_pa_est_sc_plot_data_wide7,q_nhb_pa_est_sc_plot_data_wide8,q_nhb_pa_est_sc_plot_data_wide9,
                                           q_nhb_pa_est_sc_plot_data_wide10,q_nhb_pa_est_sc_plot_data_wide11,q_nhb_pa_est_sc_plot_data_wide12,
                                           q_nhb_pa_est_sc_plot_data_wide13,q_nhb_pa_est_sc_plot_data_wide14,q_nhb_pa_est_sc_plot_data_wide15,
                                           q_nhb_pa_est_sc_plot_data_wide16,q_nhb_pa_est_sc_plot_data_wide17,q_nhb_pa_est_sc_plot_data_wide18,
                                           q_nhb_pa_est_sc_plot_data_wide19,q_nhb_pa_est_sc_plot_data_wide20,q_nhb_pa_est_sc_plot_data_wide21,
                                           q_nhb_pa_est_sc_plot_data_wide22,q_nhb_pa_est_sc_plot_data_wide23,q_nhb_pa_est_sc_plot_data_wide24,
                                           q_nhb_pa_est_sc_plot_data_wide25,q_nhb_pa_est_sc_plot_data_wide26,q_nhb_pa_est_sc_plot_data_wide27,
                                           q_nhb_pa_est_sc_plot_data_wide28,q_nhb_pa_est_sc_plot_data_wide29,q_nhb_pa_est_sc_plot_data_wide30,
                                           q_nhb_pa_est_sc_plot_data_wide31,q_nhb_pa_est_sc_plot_data_wide32,q_nhb_pa_est_sc_plot_data_wide33,
                                           q_nhb_pa_est_sc_plot_data_wide34,q_nhb_pa_est_sc_plot_data_wide35)
rm(q_nhb_pa_est_sc_plot_data_wide1,q_nhb_pa_est_sc_plot_data_wide2,q_nhb_pa_est_sc_plot_data_wide3,
   q_nhb_pa_est_sc_plot_data_wide4,q_nhb_pa_est_sc_plot_data_wide5,q_nhb_pa_est_sc_plot_data_wide6,
   q_nhb_pa_est_sc_plot_data_wide7,q_nhb_pa_est_sc_plot_data_wide8,q_nhb_pa_est_sc_plot_data_wide9,
   q_nhb_pa_est_sc_plot_data_wide10,q_nhb_pa_est_sc_plot_data_wide11,q_nhb_pa_est_sc_plot_data_wide12,
   q_nhb_pa_est_sc_plot_data_wide13,q_nhb_pa_est_sc_plot_data_wide14,q_nhb_pa_est_sc_plot_data_wide15,
   q_nhb_pa_est_sc_plot_data_wide16,q_nhb_pa_est_sc_plot_data_wide17,q_nhb_pa_est_sc_plot_data_wide18,
   q_nhb_pa_est_sc_plot_data_wide19,q_nhb_pa_est_sc_plot_data_wide20,q_nhb_pa_est_sc_plot_data_wide21,
   q_nhb_pa_est_sc_plot_data_wide22,q_nhb_pa_est_sc_plot_data_wide23,q_nhb_pa_est_sc_plot_data_wide24,
   q_nhb_pa_est_sc_plot_data_wide25,q_nhb_pa_est_sc_plot_data_wide26,q_nhb_pa_est_sc_plot_data_wide27,
   q_nhb_pa_est_sc_plot_data_wide28,q_nhb_pa_est_sc_plot_data_wide29,q_nhb_pa_est_sc_plot_data_wide30,
   q_nhb_pa_est_sc_plot_data_wide31,q_nhb_pa_est_sc_plot_data_wide32,q_nhb_pa_est_sc_plot_data_wide33,
   q_nhb_pa_est_sc_plot_data_wide34,q_nhb_pa_est_sc_plot_data_wide35)
q_nhb_pa_est_sc_plot_data_wide_list <- lapply(q_nhb_pa_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nhb_pa_est_sdid1 <- synthdid_estimate(setup_q_nhb_pa_list[[1]]$Y, setup_q_nhb_pa_list[[1]]$N0, setup_q_nhb_pa_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_pa_est_sdid2 <- synthdid_estimate(setup_q_nhb_pa_list[[2]]$Y, setup_q_nhb_pa_list[[2]]$N0, setup_q_nhb_pa_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_pa_est_sdid5 <- synthdid_estimate(setup_q_nhb_pa_list[[3]]$Y, setup_q_nhb_pa_list[[3]]$N0, setup_q_nhb_pa_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_pa_est_sdid10 <- synthdid_estimate(setup_q_nhb_pa_list[[4]]$Y, setup_q_nhb_pa_list[[4]]$N0, setup_q_nhb_pa_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_pa_est_sdid11 <- synthdid_estimate(setup_q_nhb_pa_list[[5]]$Y, setup_q_nhb_pa_list[[5]]$N0, setup_q_nhb_pa_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_pa_est_sdid12 <- synthdid_estimate(setup_q_nhb_pa_list[[6]]$Y, setup_q_nhb_pa_list[[6]]$N0, setup_q_nhb_pa_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_pa_est_sdid13 <- synthdid_estimate(setup_q_nhb_pa_list[[7]]$Y, setup_q_nhb_pa_list[[7]]$N0, setup_q_nhb_pa_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_pa_est_sdid15 <- synthdid_estimate(setup_q_nhb_pa_list[[8]]$Y, setup_q_nhb_pa_list[[8]]$N0, setup_q_nhb_pa_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_pa_est_sdid17 <- synthdid_estimate(setup_q_nhb_pa_list[[9]]$Y, setup_q_nhb_pa_list[[9]]$N0, setup_q_nhb_pa_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_pa_est_sdid19 <- synthdid_estimate(setup_q_nhb_pa_list[[10]]$Y, setup_q_nhb_pa_list[[10]]$N0, setup_q_nhb_pa_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_pa_est_sdid21 <- synthdid_estimate(setup_q_nhb_pa_list[[11]]$Y, setup_q_nhb_pa_list[[11]]$N0, setup_q_nhb_pa_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_pa_est_sdid23 <- synthdid_estimate(setup_q_nhb_pa_list[[12]]$Y, setup_q_nhb_pa_list[[12]]$N0, setup_q_nhb_pa_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_pa_est_sdid24 <- synthdid_estimate(setup_q_nhb_pa_list[[13]]$Y, setup_q_nhb_pa_list[[13]]$N0, setup_q_nhb_pa_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_pa_est_sdid25 <- synthdid_estimate(setup_q_nhb_pa_list[[14]]$Y, setup_q_nhb_pa_list[[14]]$N0, setup_q_nhb_pa_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_pa_est_sdid26 <- synthdid_estimate(setup_q_nhb_pa_list[[15]]$Y, setup_q_nhb_pa_list[[15]]$N0, setup_q_nhb_pa_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_pa_est_sdid28 <- synthdid_estimate(setup_q_nhb_pa_list[[16]]$Y, setup_q_nhb_pa_list[[16]]$N0, setup_q_nhb_pa_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_pa_est_sdid29 <- synthdid_estimate(setup_q_nhb_pa_list[[17]]$Y, setup_q_nhb_pa_list[[17]]$N0, setup_q_nhb_pa_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_pa_est_sdid30 <- synthdid_estimate(setup_q_nhb_pa_list[[18]]$Y, setup_q_nhb_pa_list[[18]]$N0, setup_q_nhb_pa_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_pa_est_sdid31 <- synthdid_estimate(setup_q_nhb_pa_list[[19]]$Y, setup_q_nhb_pa_list[[19]]$N0, setup_q_nhb_pa_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_pa_est_sdid32 <- synthdid_estimate(setup_q_nhb_pa_list[[20]]$Y, setup_q_nhb_pa_list[[20]]$N0, setup_q_nhb_pa_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_pa_est_sdid33 <- synthdid_estimate(setup_q_nhb_pa_list[[21]]$Y, setup_q_nhb_pa_list[[21]]$N0, setup_q_nhb_pa_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_pa_est_sdid34 <- synthdid_estimate(setup_q_nhb_pa_list[[22]]$Y, setup_q_nhb_pa_list[[22]]$N0, setup_q_nhb_pa_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_pa_est_sdid36 <- synthdid_estimate(setup_q_nhb_pa_list[[23]]$Y, setup_q_nhb_pa_list[[23]]$N0, setup_q_nhb_pa_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_pa_est_sdid37 <- synthdid_estimate(setup_q_nhb_pa_list[[24]]$Y, setup_q_nhb_pa_list[[24]]$N0, setup_q_nhb_pa_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_pa_est_sdid39 <- synthdid_estimate(setup_q_nhb_pa_list[[25]]$Y, setup_q_nhb_pa_list[[25]]$N0, setup_q_nhb_pa_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_pa_est_sdid40 <- synthdid_estimate(setup_q_nhb_pa_list[[26]]$Y, setup_q_nhb_pa_list[[26]]$N0, setup_q_nhb_pa_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_pa_est_sdid41 <- synthdid_estimate(setup_q_nhb_pa_list[[27]]$Y, setup_q_nhb_pa_list[[27]]$N0, setup_q_nhb_pa_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_pa_est_sdid44 <- synthdid_estimate(setup_q_nhb_pa_list[[28]]$Y, setup_q_nhb_pa_list[[28]]$N0, setup_q_nhb_pa_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_pa_est_sdid45 <- synthdid_estimate(setup_q_nhb_pa_list[[29]]$Y, setup_q_nhb_pa_list[[29]]$N0, setup_q_nhb_pa_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_pa_est_sdid47 <- synthdid_estimate(setup_q_nhb_pa_list[[30]]$Y, setup_q_nhb_pa_list[[30]]$N0, setup_q_nhb_pa_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_pa_est_sdid50 <- synthdid_estimate(setup_q_nhb_pa_list[[31]]$Y, setup_q_nhb_pa_list[[31]]$N0, setup_q_nhb_pa_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_pa_est_sdid51 <- synthdid_estimate(setup_q_nhb_pa_list[[32]]$Y, setup_q_nhb_pa_list[[32]]$N0, setup_q_nhb_pa_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_pa_est_sdid53 <- synthdid_estimate(setup_q_nhb_pa_list[[33]]$Y, setup_q_nhb_pa_list[[33]]$N0, setup_q_nhb_pa_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_pa_est_sdid54 <- synthdid_estimate(setup_q_nhb_pa_list[[34]]$Y, setup_q_nhb_pa_list[[34]]$N0, setup_q_nhb_pa_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_pa_est_sdid55 <- synthdid_estimate(setup_q_nhb_pa_list[[35]]$Y, setup_q_nhb_pa_list[[35]]$N0, setup_q_nhb_pa_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_pa_est_sdid_list <- list(q_nhb_pa_est_sdid1,q_nhb_pa_est_sdid2,q_nhb_pa_est_sdid5,
                              q_nhb_pa_est_sdid10,q_nhb_pa_est_sdid11,q_nhb_pa_est_sdid12,
                              q_nhb_pa_est_sdid13,q_nhb_pa_est_sdid15,q_nhb_pa_est_sdid17,
                              q_nhb_pa_est_sdid19,q_nhb_pa_est_sdid21,q_nhb_pa_est_sdid23,
                              q_nhb_pa_est_sdid24,q_nhb_pa_est_sdid25,q_nhb_pa_est_sdid26,
                              q_nhb_pa_est_sdid28,q_nhb_pa_est_sdid29,q_nhb_pa_est_sdid30,
                              q_nhb_pa_est_sdid31,q_nhb_pa_est_sdid32,q_nhb_pa_est_sdid33,
                              q_nhb_pa_est_sdid34,q_nhb_pa_est_sdid36,q_nhb_pa_est_sdid37,
                              q_nhb_pa_est_sdid39,q_nhb_pa_est_sdid40,q_nhb_pa_est_sdid41,
                              q_nhb_pa_est_sdid44,q_nhb_pa_est_sdid45,q_nhb_pa_est_sdid47,
                              q_nhb_pa_est_sdid50,q_nhb_pa_est_sdid51,q_nhb_pa_est_sdid53,
                              q_nhb_pa_est_sdid54,q_nhb_pa_est_sdid55)
rm(q_nhb_pa_est_sdid1,q_nhb_pa_est_sdid2,q_nhb_pa_est_sdid5,
   q_nhb_pa_est_sdid10,q_nhb_pa_est_sdid11,q_nhb_pa_est_sdid12,
   q_nhb_pa_est_sdid13,q_nhb_pa_est_sdid15,q_nhb_pa_est_sdid17,
   q_nhb_pa_est_sdid19,q_nhb_pa_est_sdid21,q_nhb_pa_est_sdid23,
   q_nhb_pa_est_sdid24,q_nhb_pa_est_sdid25,q_nhb_pa_est_sdid26,
   q_nhb_pa_est_sdid28,q_nhb_pa_est_sdid29,q_nhb_pa_est_sdid30,
   q_nhb_pa_est_sdid31,q_nhb_pa_est_sdid32,q_nhb_pa_est_sdid33,
   q_nhb_pa_est_sdid34,q_nhb_pa_est_sdid36,q_nhb_pa_est_sdid37,
   q_nhb_pa_est_sdid39,q_nhb_pa_est_sdid40,q_nhb_pa_est_sdid41,
   q_nhb_pa_est_sdid44,q_nhb_pa_est_sdid45,q_nhb_pa_est_sdid47,
   q_nhb_pa_est_sdid50,q_nhb_pa_est_sdid51,q_nhb_pa_est_sdid53,
   q_nhb_pa_est_sdid54,q_nhb_pa_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sdid_plot", i), synthdid_plot(q_nhb_pa_est_sdid_list[i]))
}
q_nhb_pa_est_sdid_plot_data_aux1 <- ggplot_build(q_nhb_pa_est_sdid_plot1)
q_nhb_pa_est_sdid_plot_data_aux2 <- ggplot_build(q_nhb_pa_est_sdid_plot2)
q_nhb_pa_est_sdid_plot_data_aux3 <- ggplot_build(q_nhb_pa_est_sdid_plot3)
q_nhb_pa_est_sdid_plot_data_aux4 <- ggplot_build(q_nhb_pa_est_sdid_plot4)
q_nhb_pa_est_sdid_plot_data_aux5 <- ggplot_build(q_nhb_pa_est_sdid_plot5)
q_nhb_pa_est_sdid_plot_data_aux6 <- ggplot_build(q_nhb_pa_est_sdid_plot6)
q_nhb_pa_est_sdid_plot_data_aux7 <- ggplot_build(q_nhb_pa_est_sdid_plot7)
q_nhb_pa_est_sdid_plot_data_aux8 <- ggplot_build(q_nhb_pa_est_sdid_plot8)
q_nhb_pa_est_sdid_plot_data_aux9 <- ggplot_build(q_nhb_pa_est_sdid_plot9)
q_nhb_pa_est_sdid_plot_data_aux10 <- ggplot_build(q_nhb_pa_est_sdid_plot10)
q_nhb_pa_est_sdid_plot_data_aux11 <- ggplot_build(q_nhb_pa_est_sdid_plot11)
q_nhb_pa_est_sdid_plot_data_aux12 <- ggplot_build(q_nhb_pa_est_sdid_plot12)
q_nhb_pa_est_sdid_plot_data_aux13 <- ggplot_build(q_nhb_pa_est_sdid_plot13)
q_nhb_pa_est_sdid_plot_data_aux14 <- ggplot_build(q_nhb_pa_est_sdid_plot14)
q_nhb_pa_est_sdid_plot_data_aux15 <- ggplot_build(q_nhb_pa_est_sdid_plot15)
q_nhb_pa_est_sdid_plot_data_aux16 <- ggplot_build(q_nhb_pa_est_sdid_plot16)
q_nhb_pa_est_sdid_plot_data_aux17 <- ggplot_build(q_nhb_pa_est_sdid_plot17)
q_nhb_pa_est_sdid_plot_data_aux18 <- ggplot_build(q_nhb_pa_est_sdid_plot18)
q_nhb_pa_est_sdid_plot_data_aux19 <- ggplot_build(q_nhb_pa_est_sdid_plot19)
q_nhb_pa_est_sdid_plot_data_aux20 <- ggplot_build(q_nhb_pa_est_sdid_plot20)
q_nhb_pa_est_sdid_plot_data_aux21 <- ggplot_build(q_nhb_pa_est_sdid_plot21)
q_nhb_pa_est_sdid_plot_data_aux22 <- ggplot_build(q_nhb_pa_est_sdid_plot22)
q_nhb_pa_est_sdid_plot_data_aux23 <- ggplot_build(q_nhb_pa_est_sdid_plot23)
q_nhb_pa_est_sdid_plot_data_aux24 <- ggplot_build(q_nhb_pa_est_sdid_plot24)
q_nhb_pa_est_sdid_plot_data_aux25 <- ggplot_build(q_nhb_pa_est_sdid_plot25)
q_nhb_pa_est_sdid_plot_data_aux26 <- ggplot_build(q_nhb_pa_est_sdid_plot26)
q_nhb_pa_est_sdid_plot_data_aux27 <- ggplot_build(q_nhb_pa_est_sdid_plot27)
q_nhb_pa_est_sdid_plot_data_aux28 <- ggplot_build(q_nhb_pa_est_sdid_plot28)
q_nhb_pa_est_sdid_plot_data_aux29 <- ggplot_build(q_nhb_pa_est_sdid_plot29)
q_nhb_pa_est_sdid_plot_data_aux30 <- ggplot_build(q_nhb_pa_est_sdid_plot30)
q_nhb_pa_est_sdid_plot_data_aux31 <- ggplot_build(q_nhb_pa_est_sdid_plot31)
q_nhb_pa_est_sdid_plot_data_aux32 <- ggplot_build(q_nhb_pa_est_sdid_plot32)
q_nhb_pa_est_sdid_plot_data_aux33 <- ggplot_build(q_nhb_pa_est_sdid_plot33)
q_nhb_pa_est_sdid_plot_data_aux34 <- ggplot_build(q_nhb_pa_est_sdid_plot34)
q_nhb_pa_est_sdid_plot_data_aux35 <- ggplot_build(q_nhb_pa_est_sdid_plot35)
q_nhb_pa_est_sdid_plot_data_aux_list <- list(q_nhb_pa_est_sdid_plot_data_aux1,q_nhb_pa_est_sdid_plot_data_aux2,q_nhb_pa_est_sdid_plot_data_aux3,
                                            q_nhb_pa_est_sdid_plot_data_aux4,q_nhb_pa_est_sdid_plot_data_aux5,q_nhb_pa_est_sdid_plot_data_aux6,
                                            q_nhb_pa_est_sdid_plot_data_aux7,q_nhb_pa_est_sdid_plot_data_aux8,q_nhb_pa_est_sdid_plot_data_aux9,
                                            q_nhb_pa_est_sdid_plot_data_aux10,q_nhb_pa_est_sdid_plot_data_aux11,q_nhb_pa_est_sdid_plot_data_aux12,
                                            q_nhb_pa_est_sdid_plot_data_aux13,q_nhb_pa_est_sdid_plot_data_aux14,q_nhb_pa_est_sdid_plot_data_aux15,
                                            q_nhb_pa_est_sdid_plot_data_aux16,q_nhb_pa_est_sdid_plot_data_aux17,q_nhb_pa_est_sdid_plot_data_aux18,
                                            q_nhb_pa_est_sdid_plot_data_aux19,q_nhb_pa_est_sdid_plot_data_aux20,q_nhb_pa_est_sdid_plot_data_aux21,
                                            q_nhb_pa_est_sdid_plot_data_aux22,q_nhb_pa_est_sdid_plot_data_aux23,q_nhb_pa_est_sdid_plot_data_aux24,
                                            q_nhb_pa_est_sdid_plot_data_aux25,q_nhb_pa_est_sdid_plot_data_aux26,q_nhb_pa_est_sdid_plot_data_aux27,
                                            q_nhb_pa_est_sdid_plot_data_aux28,q_nhb_pa_est_sdid_plot_data_aux29,q_nhb_pa_est_sdid_plot_data_aux30,
                                            q_nhb_pa_est_sdid_plot_data_aux31,q_nhb_pa_est_sdid_plot_data_aux32,q_nhb_pa_est_sdid_plot_data_aux33,
                                            q_nhb_pa_est_sdid_plot_data_aux34,q_nhb_pa_est_sdid_plot_data_aux35)
rm(q_nhb_pa_est_sdid_plot_data_aux1,q_nhb_pa_est_sdid_plot_data_aux2,q_nhb_pa_est_sdid_plot_data_aux3,
   q_nhb_pa_est_sdid_plot_data_aux4,q_nhb_pa_est_sdid_plot_data_aux5,q_nhb_pa_est_sdid_plot_data_aux6,
   q_nhb_pa_est_sdid_plot_data_aux7,q_nhb_pa_est_sdid_plot_data_aux8,q_nhb_pa_est_sdid_plot_data_aux9,
   q_nhb_pa_est_sdid_plot_data_aux10,q_nhb_pa_est_sdid_plot_data_aux11,q_nhb_pa_est_sdid_plot_data_aux12,
   q_nhb_pa_est_sdid_plot_data_aux13,q_nhb_pa_est_sdid_plot_data_aux14,q_nhb_pa_est_sdid_plot_data_aux15,
   q_nhb_pa_est_sdid_plot_data_aux16,q_nhb_pa_est_sdid_plot_data_aux17,q_nhb_pa_est_sdid_plot_data_aux18,
   q_nhb_pa_est_sdid_plot_data_aux19,q_nhb_pa_est_sdid_plot_data_aux20,q_nhb_pa_est_sdid_plot_data_aux21,
   q_nhb_pa_est_sdid_plot_data_aux22,q_nhb_pa_est_sdid_plot_data_aux23,q_nhb_pa_est_sdid_plot_data_aux24,
   q_nhb_pa_est_sdid_plot_data_aux25,q_nhb_pa_est_sdid_plot_data_aux26,q_nhb_pa_est_sdid_plot_data_aux27,
   q_nhb_pa_est_sdid_plot_data_aux28,q_nhb_pa_est_sdid_plot_data_aux29,q_nhb_pa_est_sdid_plot_data_aux30,
   q_nhb_pa_est_sdid_plot_data_aux31,q_nhb_pa_est_sdid_plot_data_aux32,q_nhb_pa_est_sdid_plot_data_aux33,
   q_nhb_pa_est_sdid_plot_data_aux34,q_nhb_pa_est_sdid_plot_data_aux35)
rm(q_nhb_pa_est_sdid_plot1,q_nhb_pa_est_sdid_plot2,q_nhb_pa_est_sdid_plot3,
   q_nhb_pa_est_sdid_plot4,q_nhb_pa_est_sdid_plot5,q_nhb_pa_est_sdid_plot6,
   q_nhb_pa_est_sdid_plot7,q_nhb_pa_est_sdid_plot8,q_nhb_pa_est_sdid_plot9,
   q_nhb_pa_est_sdid_plot10,q_nhb_pa_est_sdid_plot11,q_nhb_pa_est_sdid_plot12,
   q_nhb_pa_est_sdid_plot13,q_nhb_pa_est_sdid_plot14,q_nhb_pa_est_sdid_plot15,
   q_nhb_pa_est_sdid_plot16,q_nhb_pa_est_sdid_plot17,q_nhb_pa_est_sdid_plot18,
   q_nhb_pa_est_sdid_plot19,q_nhb_pa_est_sdid_plot20,q_nhb_pa_est_sdid_plot21,
   q_nhb_pa_est_sdid_plot22,q_nhb_pa_est_sdid_plot23,q_nhb_pa_est_sdid_plot24,
   q_nhb_pa_est_sdid_plot25,q_nhb_pa_est_sdid_plot26,q_nhb_pa_est_sdid_plot27,
   q_nhb_pa_est_sdid_plot28,q_nhb_pa_est_sdid_plot29,q_nhb_pa_est_sdid_plot30,
   q_nhb_pa_est_sdid_plot31,q_nhb_pa_est_sdid_plot32,q_nhb_pa_est_sdid_plot33,
   q_nhb_pa_est_sdid_plot34,q_nhb_pa_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sdid_plot_data_long", i), data.frame(q_nhb_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_pa_est_sdid_plot_data_long_list <- list(q_nhb_pa_est_sdid_plot_data_long1,q_nhb_pa_est_sdid_plot_data_long2,q_nhb_pa_est_sdid_plot_data_long3,
                                             q_nhb_pa_est_sdid_plot_data_long4,q_nhb_pa_est_sdid_plot_data_long5,q_nhb_pa_est_sdid_plot_data_long6,
                                             q_nhb_pa_est_sdid_plot_data_long7,q_nhb_pa_est_sdid_plot_data_long8,q_nhb_pa_est_sdid_plot_data_long9,
                                             q_nhb_pa_est_sdid_plot_data_long10,q_nhb_pa_est_sdid_plot_data_long11,q_nhb_pa_est_sdid_plot_data_long12,
                                             q_nhb_pa_est_sdid_plot_data_long13,q_nhb_pa_est_sdid_plot_data_long14,q_nhb_pa_est_sdid_plot_data_long15,
                                             q_nhb_pa_est_sdid_plot_data_long16,q_nhb_pa_est_sdid_plot_data_long17,q_nhb_pa_est_sdid_plot_data_long18,
                                             q_nhb_pa_est_sdid_plot_data_long19,q_nhb_pa_est_sdid_plot_data_long20,q_nhb_pa_est_sdid_plot_data_long21,
                                             q_nhb_pa_est_sdid_plot_data_long22,q_nhb_pa_est_sdid_plot_data_long23,q_nhb_pa_est_sdid_plot_data_long24,
                                             q_nhb_pa_est_sdid_plot_data_long25,q_nhb_pa_est_sdid_plot_data_long26,q_nhb_pa_est_sdid_plot_data_long27,
                                             q_nhb_pa_est_sdid_plot_data_long28,q_nhb_pa_est_sdid_plot_data_long29,q_nhb_pa_est_sdid_plot_data_long30,
                                             q_nhb_pa_est_sdid_plot_data_long31,q_nhb_pa_est_sdid_plot_data_long32,q_nhb_pa_est_sdid_plot_data_long33,
                                             q_nhb_pa_est_sdid_plot_data_long34,q_nhb_pa_est_sdid_plot_data_long35)
rm(q_nhb_pa_est_sdid_plot_data_long1,q_nhb_pa_est_sdid_plot_data_long2,q_nhb_pa_est_sdid_plot_data_long3,
   q_nhb_pa_est_sdid_plot_data_long4,q_nhb_pa_est_sdid_plot_data_long5,q_nhb_pa_est_sdid_plot_data_long6,
   q_nhb_pa_est_sdid_plot_data_long7,q_nhb_pa_est_sdid_plot_data_long8,q_nhb_pa_est_sdid_plot_data_long9,
   q_nhb_pa_est_sdid_plot_data_long10,q_nhb_pa_est_sdid_plot_data_long11,q_nhb_pa_est_sdid_plot_data_long12,
   q_nhb_pa_est_sdid_plot_data_long13,q_nhb_pa_est_sdid_plot_data_long14,q_nhb_pa_est_sdid_plot_data_long15,
   q_nhb_pa_est_sdid_plot_data_long16,q_nhb_pa_est_sdid_plot_data_long17,q_nhb_pa_est_sdid_plot_data_long18,
   q_nhb_pa_est_sdid_plot_data_long19,q_nhb_pa_est_sdid_plot_data_long20,q_nhb_pa_est_sdid_plot_data_long21,
   q_nhb_pa_est_sdid_plot_data_long22,q_nhb_pa_est_sdid_plot_data_long23,q_nhb_pa_est_sdid_plot_data_long24,
   q_nhb_pa_est_sdid_plot_data_long25,q_nhb_pa_est_sdid_plot_data_long26,q_nhb_pa_est_sdid_plot_data_long27,
   q_nhb_pa_est_sdid_plot_data_long28,q_nhb_pa_est_sdid_plot_data_long29,q_nhb_pa_est_sdid_plot_data_long30,
   q_nhb_pa_est_sdid_plot_data_long31,q_nhb_pa_est_sdid_plot_data_long32,q_nhb_pa_est_sdid_plot_data_long33,
   q_nhb_pa_est_sdid_plot_data_long34,q_nhb_pa_est_sdid_plot_data_long35)
q_nhb_pa_est_sdid_plot_data_long_list <- lapply(q_nhb_pa_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_pa_est_sdid_plot_data_wide", i), reshape(data=q_nhb_pa_est_sdid_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
q_nhb_pa_est_sdid_plot_data_wide_list <- list(q_nhb_pa_est_sdid_plot_data_wide1,q_nhb_pa_est_sdid_plot_data_wide2,q_nhb_pa_est_sdid_plot_data_wide3,
                                             q_nhb_pa_est_sdid_plot_data_wide4,q_nhb_pa_est_sdid_plot_data_wide5,q_nhb_pa_est_sdid_plot_data_wide6,
                                             q_nhb_pa_est_sdid_plot_data_wide7,q_nhb_pa_est_sdid_plot_data_wide8,q_nhb_pa_est_sdid_plot_data_wide9,
                                             q_nhb_pa_est_sdid_plot_data_wide10,q_nhb_pa_est_sdid_plot_data_wide11,q_nhb_pa_est_sdid_plot_data_wide12,
                                             q_nhb_pa_est_sdid_plot_data_wide13,q_nhb_pa_est_sdid_plot_data_wide14,q_nhb_pa_est_sdid_plot_data_wide15,
                                             q_nhb_pa_est_sdid_plot_data_wide16,q_nhb_pa_est_sdid_plot_data_wide17,q_nhb_pa_est_sdid_plot_data_wide18,
                                             q_nhb_pa_est_sdid_plot_data_wide19,q_nhb_pa_est_sdid_plot_data_wide20,q_nhb_pa_est_sdid_plot_data_wide21,
                                             q_nhb_pa_est_sdid_plot_data_wide22,q_nhb_pa_est_sdid_plot_data_wide23,q_nhb_pa_est_sdid_plot_data_wide24,
                                             q_nhb_pa_est_sdid_plot_data_wide25,q_nhb_pa_est_sdid_plot_data_wide26,q_nhb_pa_est_sdid_plot_data_wide27,
                                             q_nhb_pa_est_sdid_plot_data_wide28,q_nhb_pa_est_sdid_plot_data_wide29,q_nhb_pa_est_sdid_plot_data_wide30,
                                             q_nhb_pa_est_sdid_plot_data_wide31,q_nhb_pa_est_sdid_plot_data_wide32,q_nhb_pa_est_sdid_plot_data_wide33,
                                             q_nhb_pa_est_sdid_plot_data_wide34,q_nhb_pa_est_sdid_plot_data_wide35)
rm(q_nhb_pa_est_sdid_plot_data_wide1,q_nhb_pa_est_sdid_plot_data_wide2,q_nhb_pa_est_sdid_plot_data_wide3,
   q_nhb_pa_est_sdid_plot_data_wide4,q_nhb_pa_est_sdid_plot_data_wide5,q_nhb_pa_est_sdid_plot_data_wide6,
   q_nhb_pa_est_sdid_plot_data_wide7,q_nhb_pa_est_sdid_plot_data_wide8,q_nhb_pa_est_sdid_plot_data_wide9,
   q_nhb_pa_est_sdid_plot_data_wide10,q_nhb_pa_est_sdid_plot_data_wide11,q_nhb_pa_est_sdid_plot_data_wide12,
   q_nhb_pa_est_sdid_plot_data_wide13,q_nhb_pa_est_sdid_plot_data_wide14,q_nhb_pa_est_sdid_plot_data_wide15,
   q_nhb_pa_est_sdid_plot_data_wide16,q_nhb_pa_est_sdid_plot_data_wide17,q_nhb_pa_est_sdid_plot_data_wide18,
   q_nhb_pa_est_sdid_plot_data_wide19,q_nhb_pa_est_sdid_plot_data_wide20,q_nhb_pa_est_sdid_plot_data_wide21,
   q_nhb_pa_est_sdid_plot_data_wide22,q_nhb_pa_est_sdid_plot_data_wide23,q_nhb_pa_est_sdid_plot_data_wide24,
   q_nhb_pa_est_sdid_plot_data_wide25,q_nhb_pa_est_sdid_plot_data_wide26,q_nhb_pa_est_sdid_plot_data_wide27,
   q_nhb_pa_est_sdid_plot_data_wide28,q_nhb_pa_est_sdid_plot_data_wide29,q_nhb_pa_est_sdid_plot_data_wide30,
   q_nhb_pa_est_sdid_plot_data_wide31,q_nhb_pa_est_sdid_plot_data_wide32,q_nhb_pa_est_sdid_plot_data_wide33,
   q_nhb_pa_est_sdid_plot_data_wide34,q_nhb_pa_est_sdid_plot_data_wide35)
q_nhb_pa_est_sdid_plot_data_wide_list <- lapply(q_nhb_pa_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nhb_est_did_plot_data_wide_pa$did_facet_title <- "Diff-in-Diff"
q_nhb_est_sc_plot_data_wide_pa$sc_facet_title <- "Synthetic Control"
q_nhb_est_sdid_plot_data_wide_pa$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nhb_est_did_plot_data_wide_pa$diff_relative <- q_nhb_est_did_plot_data_wide_pa$diff - q_nhb_est_did_plot_data_wide_pa$diff[5]
for(i in 1:35) {
  q_nhb_pa_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nhb_pa_est_did_plot_data_wide_list[[i]]$diff - q_nhb_pa_est_did_plot_data_wide_list[[i]]$diff[5]
}
q_nhb_pa_spag_did_plot <- ggplot(q_nhb_est_did_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Home Beds \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_pa_spag_sc_plot <- ggplot(q_nhb_est_sc_plot_data_wide_pa, aes(year,diff)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nhb_pa_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Pennsylvania"),data = q_nhb_est_sc_plot_data_wide_pa, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Pennsylvania" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_est_sdid_plot_data_wide_pa$diff_relative <- q_nhb_est_sdid_plot_data_wide_pa$diff - q_nhb_est_sdid_plot_data_wide_pa$diff[5]
for(i in 1:35) {
  q_nhb_pa_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nhb_pa_est_sdid_plot_data_wide_list[[i]]$diff - q_nhb_pa_est_sdid_plot_data_wide_list[[i]]$diff[5]
}
q_nhb_pa_spag_sdid_plot <- ggplot(q_nhb_est_sdid_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_pa_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nhb_pa_est_did_vec <- c(q_nhb_est_did_pa)
for (i in 1:35) {
  q_nhb_pa_est_did_vec_aux <- q_nhb_pa_est_did_list[[i]][1]
  q_nhb_pa_est_did_vec <- c(q_nhb_pa_est_did_vec,q_nhb_pa_est_did_vec_aux)
}
q_nhb_pa_est_did_df <- data.frame(q_nhb_pa_est_did_vec)
q_nhb_pa_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_pa_est_did_vec)) +
  geom_histogram(data = q_nhb_pa_est_did_df, aes(x = q_nhb_pa_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_pa_hist_did_plot1_ylim <- ggplot_build(q_nhb_pa_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_pa_hist_did_plot <- q_nhb_pa_hist_did_plot_aux +
  expand_limits(y=q_nhb_pa_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_pa_est_did_vec[1], mean(q_nhb_pa_est_did_vec[2:36])), xend = c(q_nhb_pa_est_did_vec[1],mean(q_nhb_pa_est_did_vec[2:36])), y = c(0,0), yend = c(q_nhb_pa_hist_did_plot1_ylim,q_nhb_pa_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_pa_est_did_vec[1], mean(q_nhb_pa_est_did_vec[2:36])), y = c(q_nhb_pa_hist_did_plot1_ylim,q_nhb_pa_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_pa_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_pa_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0.25,0.75), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_pa_est_sc_vec <- c(q_nhb_est_sc_pa)
for (i in 1:35) {
  q_nhb_pa_est_sc_vec_aux <- q_nhb_pa_est_sc_list[[i]][1]
  q_nhb_pa_est_sc_vec <- c(q_nhb_pa_est_sc_vec,q_nhb_pa_est_sc_vec_aux)
}
q_nhb_pa_est_sc_df <- data.frame(q_nhb_pa_est_sc_vec)
q_nhb_pa_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_pa_est_sc_vec)) +
  geom_histogram(data = q_nhb_pa_est_sc_df, aes(x = q_nhb_pa_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_pa_hist_sc_plot1_ylim <- ggplot_build(q_nhb_pa_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_pa_hist_sc_plot <- q_nhb_pa_hist_sc_plot_aux +
  expand_limits(y=q_nhb_pa_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_pa_est_sc_vec[1], mean(q_nhb_pa_est_sc_vec[2:36])), xend = c(q_nhb_pa_est_sc_vec[1],mean(q_nhb_pa_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nhb_pa_hist_sc_plot1_ylim,q_nhb_pa_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_pa_est_sc_vec[1], mean(q_nhb_pa_est_sc_vec[2:36])), y = c(q_nhb_pa_hist_sc_plot1_ylim,q_nhb_pa_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_pa_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(q_nhb_pa_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0,1), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_pa_est_sdid_vec <- c(q_nhb_est_sdid_pa)
for (i in 1:35) {
  q_nhb_pa_est_sdid_vec_aux <- q_nhb_pa_est_sdid_list[[i]][1]
  q_nhb_pa_est_sdid_vec <- c(q_nhb_pa_est_sdid_vec,q_nhb_pa_est_sdid_vec_aux)
}
q_nhb_pa_est_sdid_df <- data.frame(q_nhb_pa_est_sdid_vec)
q_nhb_pa_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_pa_est_sdid_vec)) +
  geom_histogram(data = q_nhb_pa_est_sdid_df, aes(x = q_nhb_pa_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_pa_hist_sdid_plot1_ylim <- ggplot_build(q_nhb_pa_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_pa_hist_sdid_plot <- q_nhb_pa_hist_sdid_plot_aux +
  expand_limits(y=q_nhb_pa_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_pa_est_sdid_vec[1], mean(q_nhb_pa_est_sdid_vec[2:36])), xend = c(q_nhb_pa_est_sdid_vec[1],mean(q_nhb_pa_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nhb_pa_hist_sdid_plot1_ylim,q_nhb_pa_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_pa_est_sdid_vec[1], mean(q_nhb_pa_est_sdid_vec[2:36])), y = c(q_nhb_pa_hist_sdid_plot1_ylim,q_nhb_pa_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_pa_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_pa_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0.4,0.6), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nhb_spag_dist_plots_PA.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nhb_pa_spag_dist_plots_PA <- q_nhb_pa_spag_did_plot + q_nhb_pa_spag_sc_plot + q_nhb_pa_spag_sdid_plot + q_nhb_pa_hist_did_plot + q_nhb_pa_hist_sc_plot + q_nhb_pa_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Total Expenditure #####
### PA - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
tot_exp_pa_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
tot_exp_pa_df$treated <- as.integer(ifelse(tot_exp_pa_df$name == "Pennsylvania" & tot_exp_pa_df$year >= 1996, 1, 0))
tot_exp_pa_df <- tot_exp_pa_df[order(tot_exp_pa_df$year, tot_exp_pa_df$treated_pa_aux, tot_exp_pa_df$name),]
tot_exp_pa_df <- subset(tot_exp_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, total_exp, treated))
setup_tot_exp_pa <- panel.matrices(tot_exp_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
tot_exp_est_did_pa <- did_estimate(setup_tot_exp_pa$Y, setup_tot_exp_pa$N0, setup_tot_exp_pa$T0, X = covariates_exp_pa_array)
tot_exp_est_did_plot_pa <- synthdid_plot(tot_exp_est_did_pa)
tot_exp_est_did_plot_data_aux_pa <- ggplot_build(tot_exp_est_did_plot_pa)
tot_exp_est_did_plot_data_long_pa <- data.frame(tot_exp_est_did_plot_data_aux_pa$data[[1]]$x, tot_exp_est_did_plot_data_aux_pa$data[[1]]$y, tot_exp_est_did_plot_data_aux_pa$data[[1]]$group)
colnames(tot_exp_est_did_plot_data_long_pa) <- c('year', 'outcome', 'treated')
tot_exp_est_did_plot_data_long_pa$treated <- tot_exp_est_did_plot_data_long_pa$treated - 1
tot_exp_est_did_plot_data_wide_pa <- reshape(data=tot_exp_est_did_plot_data_long_pa,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
tot_exp_est_did_plot_data_wide_pa$diff <- tot_exp_est_did_plot_data_wide_pa$outcome.1 - tot_exp_est_did_plot_data_wide_pa$outcome.0
# SC #
tot_exp_est_sc_pa <- sc_estimate(setup_tot_exp_pa$Y, setup_tot_exp_pa$N0, setup_tot_exp_pa$T0, X = covariates_exp_pa_array)
tot_exp_est_sc_plot_pa <- synthdid_plot(tot_exp_est_sc_pa)
tot_exp_est_sc_plot_data_aux_pa <- ggplot_build(tot_exp_est_sc_plot_pa)
tot_exp_est_sc_plot_data_long_pa <- data.frame(tot_exp_est_sc_plot_data_aux_pa$data[[1]]$x, tot_exp_est_sc_plot_data_aux_pa$data[[1]]$y, tot_exp_est_sc_plot_data_aux_pa$data[[1]]$group)
colnames(tot_exp_est_sc_plot_data_long_pa) <- c('year', 'outcome', 'treated')
tot_exp_est_sc_plot_data_long_pa$treated <- tot_exp_est_sc_plot_data_long_pa$treated - 1
tot_exp_est_sc_plot_data_wide_pa <- reshape(data=tot_exp_est_sc_plot_data_long_pa,
                                         idvar = "year",
                                         v.names = "outcome",
                                         timevar = "treated",
                                         direction = "wide")
tot_exp_est_sc_plot_data_wide_pa$diff <- tot_exp_est_sc_plot_data_wide_pa$outcome.1 - tot_exp_est_sc_plot_data_wide_pa$outcome.0
# SDID #
tot_exp_est_sdid_pa <- synthdid_estimate(setup_tot_exp_pa$Y, setup_tot_exp_pa$N0, setup_tot_exp_pa$T0, X = covariates_exp_pa_array)
tot_exp_est_sdid_plot_pa <- synthdid_plot(tot_exp_est_sdid_pa)
tot_exp_est_sdid_plot_data_aux_pa <- ggplot_build(tot_exp_est_sdid_plot_pa)
tot_exp_est_sdid_plot_data_long_pa <- data.frame(tot_exp_est_sdid_plot_data_aux_pa$data[[1]]$x, tot_exp_est_sdid_plot_data_aux_pa$data[[1]]$y, tot_exp_est_sdid_plot_data_aux_pa$data[[1]]$group)
colnames(tot_exp_est_sdid_plot_data_long_pa) <- c('year', 'outcome', 'treated')
tot_exp_est_sdid_plot_data_long_pa$treated <- tot_exp_est_sdid_plot_data_long_pa$treated - 1
tot_exp_est_sdid_plot_data_wide_pa <- reshape(data=tot_exp_est_sdid_plot_data_long_pa,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
tot_exp_est_sdid_plot_data_wide_pa$diff <- tot_exp_est_sdid_plot_data_wide_pa$outcome.1 - tot_exp_est_sdid_plot_data_wide_pa$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("tot_exp_pa_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
tot_exp_pa_df1$treated_aux <- ifelse(tot_exp_pa_df1$id == 1, 1, 0)
tot_exp_pa_df2$treated_aux <- ifelse(tot_exp_pa_df2$id == 2, 1, 0)
tot_exp_pa_df5$treated_aux <- ifelse(tot_exp_pa_df5$id == 5, 1, 0)
tot_exp_pa_df10$treated_aux <- ifelse(tot_exp_pa_df10$id == 10, 1, 0)
tot_exp_pa_df11$treated_aux <- ifelse(tot_exp_pa_df11$id == 11, 1, 0)
tot_exp_pa_df12$treated_aux <- ifelse(tot_exp_pa_df12$id == 12, 1, 0)
tot_exp_pa_df13$treated_aux <- ifelse(tot_exp_pa_df13$id == 13, 1, 0)
tot_exp_pa_df15$treated_aux <- ifelse(tot_exp_pa_df15$id == 15, 1, 0)
tot_exp_pa_df17$treated_aux <- ifelse(tot_exp_pa_df17$id == 17, 1, 0)
tot_exp_pa_df19$treated_aux <- ifelse(tot_exp_pa_df19$id == 19, 1, 0)
tot_exp_pa_df21$treated_aux <- ifelse(tot_exp_pa_df21$id == 21, 1, 0)
tot_exp_pa_df23$treated_aux <- ifelse(tot_exp_pa_df23$id == 23, 1, 0)
tot_exp_pa_df24$treated_aux <- ifelse(tot_exp_pa_df24$id == 24, 1, 0)
tot_exp_pa_df25$treated_aux <- ifelse(tot_exp_pa_df25$id == 25, 1, 0)
tot_exp_pa_df26$treated_aux <- ifelse(tot_exp_pa_df26$id == 26, 1, 0)
tot_exp_pa_df28$treated_aux <- ifelse(tot_exp_pa_df28$id == 28, 1, 0)
tot_exp_pa_df29$treated_aux <- ifelse(tot_exp_pa_df29$id == 29, 1, 0)
tot_exp_pa_df30$treated_aux <- ifelse(tot_exp_pa_df30$id == 30, 1, 0)
tot_exp_pa_df31$treated_aux <- ifelse(tot_exp_pa_df31$id == 31, 1, 0)
tot_exp_pa_df32$treated_aux <- ifelse(tot_exp_pa_df32$id == 32, 1, 0)
tot_exp_pa_df33$treated_aux <- ifelse(tot_exp_pa_df33$id == 33, 1, 0)
tot_exp_pa_df34$treated_aux <- ifelse(tot_exp_pa_df34$id == 34, 1, 0)
tot_exp_pa_df36$treated_aux <- ifelse(tot_exp_pa_df36$id == 36, 1, 0)
tot_exp_pa_df37$treated_aux <- ifelse(tot_exp_pa_df37$id == 37, 1, 0)
tot_exp_pa_df39$treated_aux <- ifelse(tot_exp_pa_df39$id == 39, 1, 0)
tot_exp_pa_df40$treated_aux <- ifelse(tot_exp_pa_df40$id == 40, 1, 0)
tot_exp_pa_df41$treated_aux <- ifelse(tot_exp_pa_df41$id == 41, 1, 0)
tot_exp_pa_df44$treated_aux <- ifelse(tot_exp_pa_df44$id == 44, 1, 0)
tot_exp_pa_df45$treated_aux <- ifelse(tot_exp_pa_df45$id == 45, 1, 0)
tot_exp_pa_df47$treated_aux <- ifelse(tot_exp_pa_df47$id == 47, 1, 0)
tot_exp_pa_df50$treated_aux <- ifelse(tot_exp_pa_df50$id == 50, 1, 0)
tot_exp_pa_df51$treated_aux <- ifelse(tot_exp_pa_df51$id == 51, 1, 0)
tot_exp_pa_df53$treated_aux <- ifelse(tot_exp_pa_df53$id == 53, 1, 0)
tot_exp_pa_df54$treated_aux <- ifelse(tot_exp_pa_df54$id == 54, 1, 0)
tot_exp_pa_df55$treated_aux <- ifelse(tot_exp_pa_df55$id == 55, 1, 0)
tot_exp_pa_df1$treated <- as.integer(ifelse(tot_exp_pa_df1$id == 1 & tot_exp_pa_df1$year >= 1996, 1, 0))
tot_exp_pa_df2$treated <- as.integer(ifelse(tot_exp_pa_df2$id == 2 & tot_exp_pa_df2$year >= 1996, 1, 0))
tot_exp_pa_df5$treated <- as.integer(ifelse(tot_exp_pa_df5$id == 5 & tot_exp_pa_df5$year >= 1996, 1, 0))
tot_exp_pa_df10$treated <- as.integer(ifelse(tot_exp_pa_df10$id == 10 & tot_exp_pa_df10$year >= 1996, 1, 0))
tot_exp_pa_df11$treated <- as.integer(ifelse(tot_exp_pa_df11$id == 11 & tot_exp_pa_df11$year >= 1996, 1, 0))
tot_exp_pa_df12$treated <- as.integer(ifelse(tot_exp_pa_df12$id == 12 & tot_exp_pa_df12$year >= 1996, 1, 0))
tot_exp_pa_df13$treated <- as.integer(ifelse(tot_exp_pa_df13$id == 13 & tot_exp_pa_df13$year >= 1996, 1, 0))
tot_exp_pa_df15$treated <- as.integer(ifelse(tot_exp_pa_df15$id == 15 & tot_exp_pa_df15$year >= 1996, 1, 0))
tot_exp_pa_df17$treated <- as.integer(ifelse(tot_exp_pa_df17$id == 17 & tot_exp_pa_df17$year >= 1996, 1, 0))
tot_exp_pa_df19$treated <- as.integer(ifelse(tot_exp_pa_df19$id == 19 & tot_exp_pa_df19$year >= 1996, 1, 0))
tot_exp_pa_df21$treated <- as.integer(ifelse(tot_exp_pa_df21$id == 21 & tot_exp_pa_df21$year >= 1996, 1, 0))
tot_exp_pa_df23$treated <- as.integer(ifelse(tot_exp_pa_df23$id == 23 & tot_exp_pa_df23$year >= 1996, 1, 0))
tot_exp_pa_df24$treated <- as.integer(ifelse(tot_exp_pa_df24$id == 24 & tot_exp_pa_df24$year >= 1996, 1, 0))
tot_exp_pa_df25$treated <- as.integer(ifelse(tot_exp_pa_df25$id == 25 & tot_exp_pa_df25$year >= 1996, 1, 0))
tot_exp_pa_df26$treated <- as.integer(ifelse(tot_exp_pa_df26$id == 26 & tot_exp_pa_df26$year >= 1996, 1, 0))
tot_exp_pa_df28$treated <- as.integer(ifelse(tot_exp_pa_df28$id == 28 & tot_exp_pa_df28$year >= 1996, 1, 0))
tot_exp_pa_df29$treated <- as.integer(ifelse(tot_exp_pa_df29$id == 29 & tot_exp_pa_df29$year >= 1996, 1, 0))
tot_exp_pa_df30$treated <- as.integer(ifelse(tot_exp_pa_df30$id == 30 & tot_exp_pa_df30$year >= 1996, 1, 0))
tot_exp_pa_df31$treated <- as.integer(ifelse(tot_exp_pa_df31$id == 31 & tot_exp_pa_df31$year >= 1996, 1, 0))
tot_exp_pa_df32$treated <- as.integer(ifelse(tot_exp_pa_df32$id == 32 & tot_exp_pa_df32$year >= 1996, 1, 0))
tot_exp_pa_df33$treated <- as.integer(ifelse(tot_exp_pa_df33$id == 33 & tot_exp_pa_df33$year >= 1996, 1, 0))
tot_exp_pa_df34$treated <- as.integer(ifelse(tot_exp_pa_df34$id == 34 & tot_exp_pa_df34$year >= 1996, 1, 0))
tot_exp_pa_df36$treated <- as.integer(ifelse(tot_exp_pa_df36$id == 36 & tot_exp_pa_df36$year >= 1996, 1, 0))
tot_exp_pa_df37$treated <- as.integer(ifelse(tot_exp_pa_df37$id == 37 & tot_exp_pa_df37$year >= 1996, 1, 0))
tot_exp_pa_df39$treated <- as.integer(ifelse(tot_exp_pa_df39$id == 39 & tot_exp_pa_df39$year >= 1996, 1, 0))
tot_exp_pa_df40$treated <- as.integer(ifelse(tot_exp_pa_df40$id == 40 & tot_exp_pa_df40$year >= 1996, 1, 0))
tot_exp_pa_df41$treated <- as.integer(ifelse(tot_exp_pa_df41$id == 41 & tot_exp_pa_df41$year >= 1996, 1, 0))
tot_exp_pa_df44$treated <- as.integer(ifelse(tot_exp_pa_df44$id == 44 & tot_exp_pa_df44$year >= 1996, 1, 0))
tot_exp_pa_df45$treated <- as.integer(ifelse(tot_exp_pa_df45$id == 45 & tot_exp_pa_df45$year >= 1996, 1, 0))
tot_exp_pa_df47$treated <- as.integer(ifelse(tot_exp_pa_df47$id == 47 & tot_exp_pa_df47$year >= 1996, 1, 0))
tot_exp_pa_df50$treated <- as.integer(ifelse(tot_exp_pa_df50$id == 50 & tot_exp_pa_df50$year >= 1996, 1, 0))
tot_exp_pa_df51$treated <- as.integer(ifelse(tot_exp_pa_df51$id == 51 & tot_exp_pa_df51$year >= 1996, 1, 0))
tot_exp_pa_df53$treated <- as.integer(ifelse(tot_exp_pa_df53$id == 53 & tot_exp_pa_df53$year >= 1996, 1, 0))
tot_exp_pa_df54$treated <- as.integer(ifelse(tot_exp_pa_df54$id == 54 & tot_exp_pa_df54$year >= 1996, 1, 0))
tot_exp_pa_df55$treated <- as.integer(ifelse(tot_exp_pa_df55$id == 55 & tot_exp_pa_df55$year >= 1996, 1, 0))
tot_exp_pa_df_list <- list(tot_exp_pa_df1,tot_exp_pa_df2,tot_exp_pa_df5,
                        tot_exp_pa_df10,tot_exp_pa_df11,tot_exp_pa_df12,
                        tot_exp_pa_df13,tot_exp_pa_df15,tot_exp_pa_df17,
                        tot_exp_pa_df19,tot_exp_pa_df21,tot_exp_pa_df23,
                        tot_exp_pa_df24,tot_exp_pa_df25,tot_exp_pa_df26,
                        tot_exp_pa_df28,tot_exp_pa_df29,tot_exp_pa_df30,
                        tot_exp_pa_df31,tot_exp_pa_df32,tot_exp_pa_df33,
                        tot_exp_pa_df34,tot_exp_pa_df36,tot_exp_pa_df37,
                        tot_exp_pa_df39,tot_exp_pa_df40,tot_exp_pa_df41,
                        tot_exp_pa_df44,tot_exp_pa_df45,tot_exp_pa_df47,
                        tot_exp_pa_df50,tot_exp_pa_df51,tot_exp_pa_df53,
                        tot_exp_pa_df54,tot_exp_pa_df55)
rm(tot_exp_pa_df1,tot_exp_pa_df2,tot_exp_pa_df5,
   tot_exp_pa_df10,tot_exp_pa_df11,tot_exp_pa_df12,
   tot_exp_pa_df13,tot_exp_pa_df15,tot_exp_pa_df17,
   tot_exp_pa_df19,tot_exp_pa_df21,tot_exp_pa_df23,
   tot_exp_pa_df24,tot_exp_pa_df25,tot_exp_pa_df26,
   tot_exp_pa_df28,tot_exp_pa_df29,tot_exp_pa_df30,
   tot_exp_pa_df31,tot_exp_pa_df32,tot_exp_pa_df33,
   tot_exp_pa_df34,tot_exp_pa_df36,tot_exp_pa_df37,
   tot_exp_pa_df39,tot_exp_pa_df40,tot_exp_pa_df41,
   tot_exp_pa_df44,tot_exp_pa_df45,tot_exp_pa_df47,
   tot_exp_pa_df50,tot_exp_pa_df51,tot_exp_pa_df53,
   tot_exp_pa_df54,tot_exp_pa_df55)
tot_exp_pa_df_list <- lapply(tot_exp_pa_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
tot_exp_pa_df_list <- lapply(tot_exp_pa_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, total_exp, treated)))
}
)
setup_tot_exp_pa1 <- panel.matrices(tot_exp_pa_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa2 <- panel.matrices(tot_exp_pa_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa5 <- panel.matrices(tot_exp_pa_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa10 <- panel.matrices(tot_exp_pa_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa11 <- panel.matrices(tot_exp_pa_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa12 <- panel.matrices(tot_exp_pa_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa13 <- panel.matrices(tot_exp_pa_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa15 <- panel.matrices(tot_exp_pa_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa17 <- panel.matrices(tot_exp_pa_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa19 <- panel.matrices(tot_exp_pa_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa21 <- panel.matrices(tot_exp_pa_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa23 <- panel.matrices(tot_exp_pa_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa24 <- panel.matrices(tot_exp_pa_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa25 <- panel.matrices(tot_exp_pa_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa26 <- panel.matrices(tot_exp_pa_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa28 <- panel.matrices(tot_exp_pa_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa29 <- panel.matrices(tot_exp_pa_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa30 <- panel.matrices(tot_exp_pa_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa31 <- panel.matrices(tot_exp_pa_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa32 <- panel.matrices(tot_exp_pa_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa33 <- panel.matrices(tot_exp_pa_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa34 <- panel.matrices(tot_exp_pa_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa36 <- panel.matrices(tot_exp_pa_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa37 <- panel.matrices(tot_exp_pa_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa39 <- panel.matrices(tot_exp_pa_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa40 <- panel.matrices(tot_exp_pa_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa41 <- panel.matrices(tot_exp_pa_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa44 <- panel.matrices(tot_exp_pa_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa45 <- panel.matrices(tot_exp_pa_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa47 <- panel.matrices(tot_exp_pa_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa50 <- panel.matrices(tot_exp_pa_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa51 <- panel.matrices(tot_exp_pa_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa53 <- panel.matrices(tot_exp_pa_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa54 <- panel.matrices(tot_exp_pa_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa55 <- panel.matrices(tot_exp_pa_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_pa_list <- list(setup_tot_exp_pa1,setup_tot_exp_pa2,setup_tot_exp_pa5,
                           setup_tot_exp_pa10,setup_tot_exp_pa11,setup_tot_exp_pa12,
                           setup_tot_exp_pa13,setup_tot_exp_pa15,setup_tot_exp_pa17,
                           setup_tot_exp_pa19,setup_tot_exp_pa21,setup_tot_exp_pa23,
                           setup_tot_exp_pa24,setup_tot_exp_pa25,setup_tot_exp_pa26,
                           setup_tot_exp_pa28,setup_tot_exp_pa29,setup_tot_exp_pa30,
                           setup_tot_exp_pa31,setup_tot_exp_pa32,setup_tot_exp_pa33,
                           setup_tot_exp_pa34,setup_tot_exp_pa36,setup_tot_exp_pa37,
                           setup_tot_exp_pa39,setup_tot_exp_pa40,setup_tot_exp_pa41,
                           setup_tot_exp_pa44,setup_tot_exp_pa45,setup_tot_exp_pa47,
                           setup_tot_exp_pa50,setup_tot_exp_pa51,setup_tot_exp_pa53,
                           setup_tot_exp_pa54,setup_tot_exp_pa55)
rm(setup_tot_exp_pa1,setup_tot_exp_pa2,setup_tot_exp_pa5,
   setup_tot_exp_pa10,setup_tot_exp_pa11,setup_tot_exp_pa12,
   setup_tot_exp_pa13,setup_tot_exp_pa15,setup_tot_exp_pa17,
   setup_tot_exp_pa19,setup_tot_exp_pa21,setup_tot_exp_pa23,
   setup_tot_exp_pa24,setup_tot_exp_pa25,setup_tot_exp_pa26,
   setup_tot_exp_pa28,setup_tot_exp_pa29,setup_tot_exp_pa30,
   setup_tot_exp_pa31,setup_tot_exp_pa32,setup_tot_exp_pa33,
   setup_tot_exp_pa34,setup_tot_exp_pa36,setup_tot_exp_pa37,
   setup_tot_exp_pa39,setup_tot_exp_pa40,setup_tot_exp_pa41,
   setup_tot_exp_pa44,setup_tot_exp_pa45,setup_tot_exp_pa47,
   setup_tot_exp_pa50,setup_tot_exp_pa51,setup_tot_exp_pa53,
   setup_tot_exp_pa54,setup_tot_exp_pa55)
# DID #
tot_exp_pa_est_did1 <- did_estimate(setup_tot_exp_pa_list[[1]]$Y, setup_tot_exp_pa_list[[1]]$N0, setup_tot_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_pa_est_did2 <- did_estimate(setup_tot_exp_pa_list[[2]]$Y, setup_tot_exp_pa_list[[2]]$N0, setup_tot_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_pa_est_did5 <- did_estimate(setup_tot_exp_pa_list[[3]]$Y, setup_tot_exp_pa_list[[3]]$N0, setup_tot_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_pa_est_did10 <- did_estimate(setup_tot_exp_pa_list[[4]]$Y, setup_tot_exp_pa_list[[4]]$N0, setup_tot_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_pa_est_did11 <- did_estimate(setup_tot_exp_pa_list[[5]]$Y, setup_tot_exp_pa_list[[5]]$N0, setup_tot_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_pa_est_did12 <- did_estimate(setup_tot_exp_pa_list[[6]]$Y, setup_tot_exp_pa_list[[6]]$N0, setup_tot_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_pa_est_did13 <- did_estimate(setup_tot_exp_pa_list[[7]]$Y, setup_tot_exp_pa_list[[7]]$N0, setup_tot_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_pa_est_did15 <- did_estimate(setup_tot_exp_pa_list[[8]]$Y, setup_tot_exp_pa_list[[8]]$N0, setup_tot_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_pa_est_did17 <- did_estimate(setup_tot_exp_pa_list[[9]]$Y, setup_tot_exp_pa_list[[9]]$N0, setup_tot_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_pa_est_did19 <- did_estimate(setup_tot_exp_pa_list[[10]]$Y, setup_tot_exp_pa_list[[10]]$N0, setup_tot_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_pa_est_did21 <- did_estimate(setup_tot_exp_pa_list[[11]]$Y, setup_tot_exp_pa_list[[11]]$N0, setup_tot_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_pa_est_did23 <- did_estimate(setup_tot_exp_pa_list[[12]]$Y, setup_tot_exp_pa_list[[12]]$N0, setup_tot_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_pa_est_did24 <- did_estimate(setup_tot_exp_pa_list[[13]]$Y, setup_tot_exp_pa_list[[13]]$N0, setup_tot_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_pa_est_did25 <- did_estimate(setup_tot_exp_pa_list[[14]]$Y, setup_tot_exp_pa_list[[14]]$N0, setup_tot_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_pa_est_did26 <- did_estimate(setup_tot_exp_pa_list[[15]]$Y, setup_tot_exp_pa_list[[15]]$N0, setup_tot_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_pa_est_did28 <- did_estimate(setup_tot_exp_pa_list[[16]]$Y, setup_tot_exp_pa_list[[16]]$N0, setup_tot_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_pa_est_did29 <- did_estimate(setup_tot_exp_pa_list[[17]]$Y, setup_tot_exp_pa_list[[17]]$N0, setup_tot_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_pa_est_did30 <- did_estimate(setup_tot_exp_pa_list[[18]]$Y, setup_tot_exp_pa_list[[18]]$N0, setup_tot_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_pa_est_did31 <- did_estimate(setup_tot_exp_pa_list[[19]]$Y, setup_tot_exp_pa_list[[19]]$N0, setup_tot_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_pa_est_did32 <- did_estimate(setup_tot_exp_pa_list[[20]]$Y, setup_tot_exp_pa_list[[20]]$N0, setup_tot_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_pa_est_did33 <- did_estimate(setup_tot_exp_pa_list[[21]]$Y, setup_tot_exp_pa_list[[21]]$N0, setup_tot_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_pa_est_did34 <- did_estimate(setup_tot_exp_pa_list[[22]]$Y, setup_tot_exp_pa_list[[22]]$N0, setup_tot_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_pa_est_did36 <- did_estimate(setup_tot_exp_pa_list[[23]]$Y, setup_tot_exp_pa_list[[23]]$N0, setup_tot_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_pa_est_did37 <- did_estimate(setup_tot_exp_pa_list[[24]]$Y, setup_tot_exp_pa_list[[24]]$N0, setup_tot_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_pa_est_did39 <- did_estimate(setup_tot_exp_pa_list[[25]]$Y, setup_tot_exp_pa_list[[25]]$N0, setup_tot_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_pa_est_did40 <- did_estimate(setup_tot_exp_pa_list[[26]]$Y, setup_tot_exp_pa_list[[26]]$N0, setup_tot_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_pa_est_did41 <- did_estimate(setup_tot_exp_pa_list[[27]]$Y, setup_tot_exp_pa_list[[27]]$N0, setup_tot_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_pa_est_did44 <- did_estimate(setup_tot_exp_pa_list[[28]]$Y, setup_tot_exp_pa_list[[28]]$N0, setup_tot_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_pa_est_did45 <- did_estimate(setup_tot_exp_pa_list[[29]]$Y, setup_tot_exp_pa_list[[29]]$N0, setup_tot_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_pa_est_did47 <- did_estimate(setup_tot_exp_pa_list[[30]]$Y, setup_tot_exp_pa_list[[30]]$N0, setup_tot_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_pa_est_did50 <- did_estimate(setup_tot_exp_pa_list[[31]]$Y, setup_tot_exp_pa_list[[31]]$N0, setup_tot_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_pa_est_did51 <- did_estimate(setup_tot_exp_pa_list[[32]]$Y, setup_tot_exp_pa_list[[32]]$N0, setup_tot_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_pa_est_did53 <- did_estimate(setup_tot_exp_pa_list[[33]]$Y, setup_tot_exp_pa_list[[33]]$N0, setup_tot_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_pa_est_did54 <- did_estimate(setup_tot_exp_pa_list[[34]]$Y, setup_tot_exp_pa_list[[34]]$N0, setup_tot_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_pa_est_did55 <- did_estimate(setup_tot_exp_pa_list[[35]]$Y, setup_tot_exp_pa_list[[35]]$N0, setup_tot_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_pa_est_did_list <- list(tot_exp_pa_est_did1,tot_exp_pa_est_did2,tot_exp_pa_est_did5,
                             tot_exp_pa_est_did10,tot_exp_pa_est_did11,tot_exp_pa_est_did12,
                             tot_exp_pa_est_did13,tot_exp_pa_est_did15,tot_exp_pa_est_did17,
                             tot_exp_pa_est_did19,tot_exp_pa_est_did21,tot_exp_pa_est_did23,
                             tot_exp_pa_est_did24,tot_exp_pa_est_did25,tot_exp_pa_est_did26,
                             tot_exp_pa_est_did28,tot_exp_pa_est_did29,tot_exp_pa_est_did30,
                             tot_exp_pa_est_did31,tot_exp_pa_est_did32,tot_exp_pa_est_did33,
                             tot_exp_pa_est_did34,tot_exp_pa_est_did36,tot_exp_pa_est_did37,
                             tot_exp_pa_est_did39,tot_exp_pa_est_did40,tot_exp_pa_est_did41,
                             tot_exp_pa_est_did44,tot_exp_pa_est_did45,tot_exp_pa_est_did47,
                             tot_exp_pa_est_did50,tot_exp_pa_est_did51,tot_exp_pa_est_did53,
                             tot_exp_pa_est_did54,tot_exp_pa_est_did55)
rm(tot_exp_pa_est_did1,tot_exp_pa_est_did2,tot_exp_pa_est_did5,
   tot_exp_pa_est_did10,tot_exp_pa_est_did11,tot_exp_pa_est_did12,
   tot_exp_pa_est_did13,tot_exp_pa_est_did15,tot_exp_pa_est_did17,
   tot_exp_pa_est_did19,tot_exp_pa_est_did21,tot_exp_pa_est_did23,
   tot_exp_pa_est_did24,tot_exp_pa_est_did25,tot_exp_pa_est_did26,
   tot_exp_pa_est_did28,tot_exp_pa_est_did29,tot_exp_pa_est_did30,
   tot_exp_pa_est_did31,tot_exp_pa_est_did32,tot_exp_pa_est_did33,
   tot_exp_pa_est_did34,tot_exp_pa_est_did36,tot_exp_pa_est_did37,
   tot_exp_pa_est_did39,tot_exp_pa_est_did40,tot_exp_pa_est_did41,
   tot_exp_pa_est_did44,tot_exp_pa_est_did45,tot_exp_pa_est_did47,
   tot_exp_pa_est_did50,tot_exp_pa_est_did51,tot_exp_pa_est_did53,
   tot_exp_pa_est_did54,tot_exp_pa_est_did55)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_did_plot", i), synthdid_plot(tot_exp_pa_est_did_list[i]))
}
tot_exp_pa_est_did_plot_data_aux1 <- ggplot_build(tot_exp_pa_est_did_plot1)
tot_exp_pa_est_did_plot_data_aux2 <- ggplot_build(tot_exp_pa_est_did_plot2)
tot_exp_pa_est_did_plot_data_aux3 <- ggplot_build(tot_exp_pa_est_did_plot3)
tot_exp_pa_est_did_plot_data_aux4 <- ggplot_build(tot_exp_pa_est_did_plot4)
tot_exp_pa_est_did_plot_data_aux5 <- ggplot_build(tot_exp_pa_est_did_plot5)
tot_exp_pa_est_did_plot_data_aux6 <- ggplot_build(tot_exp_pa_est_did_plot6)
tot_exp_pa_est_did_plot_data_aux7 <- ggplot_build(tot_exp_pa_est_did_plot7)
tot_exp_pa_est_did_plot_data_aux8 <- ggplot_build(tot_exp_pa_est_did_plot8)
tot_exp_pa_est_did_plot_data_aux9 <- ggplot_build(tot_exp_pa_est_did_plot9)
tot_exp_pa_est_did_plot_data_aux10 <- ggplot_build(tot_exp_pa_est_did_plot10)
tot_exp_pa_est_did_plot_data_aux11 <- ggplot_build(tot_exp_pa_est_did_plot11)
tot_exp_pa_est_did_plot_data_aux12 <- ggplot_build(tot_exp_pa_est_did_plot12)
tot_exp_pa_est_did_plot_data_aux13 <- ggplot_build(tot_exp_pa_est_did_plot13)
tot_exp_pa_est_did_plot_data_aux14 <- ggplot_build(tot_exp_pa_est_did_plot14)
tot_exp_pa_est_did_plot_data_aux15 <- ggplot_build(tot_exp_pa_est_did_plot15)
tot_exp_pa_est_did_plot_data_aux16 <- ggplot_build(tot_exp_pa_est_did_plot16)
tot_exp_pa_est_did_plot_data_aux17 <- ggplot_build(tot_exp_pa_est_did_plot17)
tot_exp_pa_est_did_plot_data_aux18 <- ggplot_build(tot_exp_pa_est_did_plot18)
tot_exp_pa_est_did_plot_data_aux19 <- ggplot_build(tot_exp_pa_est_did_plot19)
tot_exp_pa_est_did_plot_data_aux20 <- ggplot_build(tot_exp_pa_est_did_plot20)
tot_exp_pa_est_did_plot_data_aux21 <- ggplot_build(tot_exp_pa_est_did_plot21)
tot_exp_pa_est_did_plot_data_aux22 <- ggplot_build(tot_exp_pa_est_did_plot22)
tot_exp_pa_est_did_plot_data_aux23 <- ggplot_build(tot_exp_pa_est_did_plot23)
tot_exp_pa_est_did_plot_data_aux24 <- ggplot_build(tot_exp_pa_est_did_plot24)
tot_exp_pa_est_did_plot_data_aux25 <- ggplot_build(tot_exp_pa_est_did_plot25)
tot_exp_pa_est_did_plot_data_aux26 <- ggplot_build(tot_exp_pa_est_did_plot26)
tot_exp_pa_est_did_plot_data_aux27 <- ggplot_build(tot_exp_pa_est_did_plot27)
tot_exp_pa_est_did_plot_data_aux28 <- ggplot_build(tot_exp_pa_est_did_plot28)
tot_exp_pa_est_did_plot_data_aux29 <- ggplot_build(tot_exp_pa_est_did_plot29)
tot_exp_pa_est_did_plot_data_aux30 <- ggplot_build(tot_exp_pa_est_did_plot30)
tot_exp_pa_est_did_plot_data_aux31 <- ggplot_build(tot_exp_pa_est_did_plot31)
tot_exp_pa_est_did_plot_data_aux32 <- ggplot_build(tot_exp_pa_est_did_plot32)
tot_exp_pa_est_did_plot_data_aux33 <- ggplot_build(tot_exp_pa_est_did_plot33)
tot_exp_pa_est_did_plot_data_aux34 <- ggplot_build(tot_exp_pa_est_did_plot34)
tot_exp_pa_est_did_plot_data_aux35 <- ggplot_build(tot_exp_pa_est_did_plot35)
tot_exp_pa_est_did_plot_data_aux_list <- list(tot_exp_pa_est_did_plot_data_aux1,tot_exp_pa_est_did_plot_data_aux2,tot_exp_pa_est_did_plot_data_aux3,
                                           tot_exp_pa_est_did_plot_data_aux4,tot_exp_pa_est_did_plot_data_aux5,tot_exp_pa_est_did_plot_data_aux6,
                                           tot_exp_pa_est_did_plot_data_aux7,tot_exp_pa_est_did_plot_data_aux8,tot_exp_pa_est_did_plot_data_aux9,
                                           tot_exp_pa_est_did_plot_data_aux10,tot_exp_pa_est_did_plot_data_aux11,tot_exp_pa_est_did_plot_data_aux12,
                                           tot_exp_pa_est_did_plot_data_aux13,tot_exp_pa_est_did_plot_data_aux14,tot_exp_pa_est_did_plot_data_aux15,
                                           tot_exp_pa_est_did_plot_data_aux16,tot_exp_pa_est_did_plot_data_aux17,tot_exp_pa_est_did_plot_data_aux18,
                                           tot_exp_pa_est_did_plot_data_aux19,tot_exp_pa_est_did_plot_data_aux20,tot_exp_pa_est_did_plot_data_aux21,
                                           tot_exp_pa_est_did_plot_data_aux22,tot_exp_pa_est_did_plot_data_aux23,tot_exp_pa_est_did_plot_data_aux24,
                                           tot_exp_pa_est_did_plot_data_aux25,tot_exp_pa_est_did_plot_data_aux26,tot_exp_pa_est_did_plot_data_aux27,
                                           tot_exp_pa_est_did_plot_data_aux28,tot_exp_pa_est_did_plot_data_aux29,tot_exp_pa_est_did_plot_data_aux30,
                                           tot_exp_pa_est_did_plot_data_aux31,tot_exp_pa_est_did_plot_data_aux32,tot_exp_pa_est_did_plot_data_aux33,
                                           tot_exp_pa_est_did_plot_data_aux34,tot_exp_pa_est_did_plot_data_aux35)
rm(tot_exp_pa_est_did_plot_data_aux1,tot_exp_pa_est_did_plot_data_aux2,tot_exp_pa_est_did_plot_data_aux3,
   tot_exp_pa_est_did_plot_data_aux4,tot_exp_pa_est_did_plot_data_aux5,tot_exp_pa_est_did_plot_data_aux6,
   tot_exp_pa_est_did_plot_data_aux7,tot_exp_pa_est_did_plot_data_aux8,tot_exp_pa_est_did_plot_data_aux9,
   tot_exp_pa_est_did_plot_data_aux10,tot_exp_pa_est_did_plot_data_aux11,tot_exp_pa_est_did_plot_data_aux12,
   tot_exp_pa_est_did_plot_data_aux13,tot_exp_pa_est_did_plot_data_aux14,tot_exp_pa_est_did_plot_data_aux15,
   tot_exp_pa_est_did_plot_data_aux16,tot_exp_pa_est_did_plot_data_aux17,tot_exp_pa_est_did_plot_data_aux18,
   tot_exp_pa_est_did_plot_data_aux19,tot_exp_pa_est_did_plot_data_aux20,tot_exp_pa_est_did_plot_data_aux21,
   tot_exp_pa_est_did_plot_data_aux22,tot_exp_pa_est_did_plot_data_aux23,tot_exp_pa_est_did_plot_data_aux24,
   tot_exp_pa_est_did_plot_data_aux25,tot_exp_pa_est_did_plot_data_aux26,tot_exp_pa_est_did_plot_data_aux27,
   tot_exp_pa_est_did_plot_data_aux28,tot_exp_pa_est_did_plot_data_aux29,tot_exp_pa_est_did_plot_data_aux30,
   tot_exp_pa_est_did_plot_data_aux31,tot_exp_pa_est_did_plot_data_aux32,tot_exp_pa_est_did_plot_data_aux33,
   tot_exp_pa_est_did_plot_data_aux34,tot_exp_pa_est_did_plot_data_aux35)
rm(tot_exp_pa_est_did_plot1,tot_exp_pa_est_did_plot2,tot_exp_pa_est_did_plot3,
   tot_exp_pa_est_did_plot4,tot_exp_pa_est_did_plot5,tot_exp_pa_est_did_plot6,
   tot_exp_pa_est_did_plot7,tot_exp_pa_est_did_plot8,tot_exp_pa_est_did_plot9,
   tot_exp_pa_est_did_plot10,tot_exp_pa_est_did_plot11,tot_exp_pa_est_did_plot12,
   tot_exp_pa_est_did_plot13,tot_exp_pa_est_did_plot14,tot_exp_pa_est_did_plot15,
   tot_exp_pa_est_did_plot16,tot_exp_pa_est_did_plot17,tot_exp_pa_est_did_plot18,
   tot_exp_pa_est_did_plot19,tot_exp_pa_est_did_plot20,tot_exp_pa_est_did_plot21,
   tot_exp_pa_est_did_plot22,tot_exp_pa_est_did_plot23,tot_exp_pa_est_did_plot24,
   tot_exp_pa_est_did_plot25,tot_exp_pa_est_did_plot26,tot_exp_pa_est_did_plot27,
   tot_exp_pa_est_did_plot28,tot_exp_pa_est_did_plot29,tot_exp_pa_est_did_plot30,
   tot_exp_pa_est_did_plot31,tot_exp_pa_est_did_plot32,tot_exp_pa_est_did_plot33,
   tot_exp_pa_est_did_plot34,tot_exp_pa_est_did_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_did_plot_data_long", i), data.frame(tot_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_pa_est_did_plot_data_long_list <- list(tot_exp_pa_est_did_plot_data_long1,tot_exp_pa_est_did_plot_data_long2,tot_exp_pa_est_did_plot_data_long3,
                                            tot_exp_pa_est_did_plot_data_long4,tot_exp_pa_est_did_plot_data_long5,tot_exp_pa_est_did_plot_data_long6,
                                            tot_exp_pa_est_did_plot_data_long7,tot_exp_pa_est_did_plot_data_long8,tot_exp_pa_est_did_plot_data_long9,
                                            tot_exp_pa_est_did_plot_data_long10,tot_exp_pa_est_did_plot_data_long11,tot_exp_pa_est_did_plot_data_long12,
                                            tot_exp_pa_est_did_plot_data_long13,tot_exp_pa_est_did_plot_data_long14,tot_exp_pa_est_did_plot_data_long15,
                                            tot_exp_pa_est_did_plot_data_long16,tot_exp_pa_est_did_plot_data_long17,tot_exp_pa_est_did_plot_data_long18,
                                            tot_exp_pa_est_did_plot_data_long19,tot_exp_pa_est_did_plot_data_long20,tot_exp_pa_est_did_plot_data_long21,
                                            tot_exp_pa_est_did_plot_data_long22,tot_exp_pa_est_did_plot_data_long23,tot_exp_pa_est_did_plot_data_long24,
                                            tot_exp_pa_est_did_plot_data_long25,tot_exp_pa_est_did_plot_data_long26,tot_exp_pa_est_did_plot_data_long27,
                                            tot_exp_pa_est_did_plot_data_long28,tot_exp_pa_est_did_plot_data_long29,tot_exp_pa_est_did_plot_data_long30,
                                            tot_exp_pa_est_did_plot_data_long31,tot_exp_pa_est_did_plot_data_long32,tot_exp_pa_est_did_plot_data_long33,
                                            tot_exp_pa_est_did_plot_data_long34,tot_exp_pa_est_did_plot_data_long35)
rm(tot_exp_pa_est_did_plot_data_long1,tot_exp_pa_est_did_plot_data_long2,tot_exp_pa_est_did_plot_data_long3,
   tot_exp_pa_est_did_plot_data_long4,tot_exp_pa_est_did_plot_data_long5,tot_exp_pa_est_did_plot_data_long6,
   tot_exp_pa_est_did_plot_data_long7,tot_exp_pa_est_did_plot_data_long8,tot_exp_pa_est_did_plot_data_long9,
   tot_exp_pa_est_did_plot_data_long10,tot_exp_pa_est_did_plot_data_long11,tot_exp_pa_est_did_plot_data_long12,
   tot_exp_pa_est_did_plot_data_long13,tot_exp_pa_est_did_plot_data_long14,tot_exp_pa_est_did_plot_data_long15,
   tot_exp_pa_est_did_plot_data_long16,tot_exp_pa_est_did_plot_data_long17,tot_exp_pa_est_did_plot_data_long18,
   tot_exp_pa_est_did_plot_data_long19,tot_exp_pa_est_did_plot_data_long20,tot_exp_pa_est_did_plot_data_long21,
   tot_exp_pa_est_did_plot_data_long22,tot_exp_pa_est_did_plot_data_long23,tot_exp_pa_est_did_plot_data_long24,
   tot_exp_pa_est_did_plot_data_long25,tot_exp_pa_est_did_plot_data_long26,tot_exp_pa_est_did_plot_data_long27,
   tot_exp_pa_est_did_plot_data_long28,tot_exp_pa_est_did_plot_data_long29,tot_exp_pa_est_did_plot_data_long30,
   tot_exp_pa_est_did_plot_data_long31,tot_exp_pa_est_did_plot_data_long32,tot_exp_pa_est_did_plot_data_long33,
   tot_exp_pa_est_did_plot_data_long34,tot_exp_pa_est_did_plot_data_long35)
tot_exp_pa_est_did_plot_data_long_list <- lapply(tot_exp_pa_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_did_plot_data_wide", i), reshape(data=tot_exp_pa_est_did_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
tot_exp_pa_est_did_plot_data_wide_list <- list(tot_exp_pa_est_did_plot_data_wide1,tot_exp_pa_est_did_plot_data_wide2,tot_exp_pa_est_did_plot_data_wide3,
                                            tot_exp_pa_est_did_plot_data_wide4,tot_exp_pa_est_did_plot_data_wide5,tot_exp_pa_est_did_plot_data_wide6,
                                            tot_exp_pa_est_did_plot_data_wide7,tot_exp_pa_est_did_plot_data_wide8,tot_exp_pa_est_did_plot_data_wide9,
                                            tot_exp_pa_est_did_plot_data_wide10,tot_exp_pa_est_did_plot_data_wide11,tot_exp_pa_est_did_plot_data_wide12,
                                            tot_exp_pa_est_did_plot_data_wide13,tot_exp_pa_est_did_plot_data_wide14,tot_exp_pa_est_did_plot_data_wide15,
                                            tot_exp_pa_est_did_plot_data_wide16,tot_exp_pa_est_did_plot_data_wide17,tot_exp_pa_est_did_plot_data_wide18,
                                            tot_exp_pa_est_did_plot_data_wide19,tot_exp_pa_est_did_plot_data_wide20,tot_exp_pa_est_did_plot_data_wide21,
                                            tot_exp_pa_est_did_plot_data_wide22,tot_exp_pa_est_did_plot_data_wide23,tot_exp_pa_est_did_plot_data_wide24,
                                            tot_exp_pa_est_did_plot_data_wide25,tot_exp_pa_est_did_plot_data_wide26,tot_exp_pa_est_did_plot_data_wide27,
                                            tot_exp_pa_est_did_plot_data_wide28,tot_exp_pa_est_did_plot_data_wide29,tot_exp_pa_est_did_plot_data_wide30,
                                            tot_exp_pa_est_did_plot_data_wide31,tot_exp_pa_est_did_plot_data_wide32,tot_exp_pa_est_did_plot_data_wide33,
                                            tot_exp_pa_est_did_plot_data_wide34,tot_exp_pa_est_did_plot_data_wide35)
rm(tot_exp_pa_est_did_plot_data_wide1,tot_exp_pa_est_did_plot_data_wide2,tot_exp_pa_est_did_plot_data_wide3,
   tot_exp_pa_est_did_plot_data_wide4,tot_exp_pa_est_did_plot_data_wide5,tot_exp_pa_est_did_plot_data_wide6,
   tot_exp_pa_est_did_plot_data_wide7,tot_exp_pa_est_did_plot_data_wide8,tot_exp_pa_est_did_plot_data_wide9,
   tot_exp_pa_est_did_plot_data_wide10,tot_exp_pa_est_did_plot_data_wide11,tot_exp_pa_est_did_plot_data_wide12,
   tot_exp_pa_est_did_plot_data_wide13,tot_exp_pa_est_did_plot_data_wide14,tot_exp_pa_est_did_plot_data_wide15,
   tot_exp_pa_est_did_plot_data_wide16,tot_exp_pa_est_did_plot_data_wide17,tot_exp_pa_est_did_plot_data_wide18,
   tot_exp_pa_est_did_plot_data_wide19,tot_exp_pa_est_did_plot_data_wide20,tot_exp_pa_est_did_plot_data_wide21,
   tot_exp_pa_est_did_plot_data_wide22,tot_exp_pa_est_did_plot_data_wide23,tot_exp_pa_est_did_plot_data_wide24,
   tot_exp_pa_est_did_plot_data_wide25,tot_exp_pa_est_did_plot_data_wide26,tot_exp_pa_est_did_plot_data_wide27,
   tot_exp_pa_est_did_plot_data_wide28,tot_exp_pa_est_did_plot_data_wide29,tot_exp_pa_est_did_plot_data_wide30,
   tot_exp_pa_est_did_plot_data_wide31,tot_exp_pa_est_did_plot_data_wide32,tot_exp_pa_est_did_plot_data_wide33,
   tot_exp_pa_est_did_plot_data_wide34,tot_exp_pa_est_did_plot_data_wide35)
tot_exp_pa_est_did_plot_data_wide_list <- lapply(tot_exp_pa_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
tot_exp_pa_est_sc1 <- sc_estimate(setup_tot_exp_pa_list[[1]]$Y, setup_tot_exp_pa_list[[1]]$N0, setup_tot_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_pa_est_sc2 <- sc_estimate(setup_tot_exp_pa_list[[2]]$Y, setup_tot_exp_pa_list[[2]]$N0, setup_tot_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_pa_est_sc5 <- sc_estimate(setup_tot_exp_pa_list[[3]]$Y, setup_tot_exp_pa_list[[3]]$N0, setup_tot_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_pa_est_sc10 <- sc_estimate(setup_tot_exp_pa_list[[4]]$Y, setup_tot_exp_pa_list[[4]]$N0, setup_tot_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_pa_est_sc11 <- sc_estimate(setup_tot_exp_pa_list[[5]]$Y, setup_tot_exp_pa_list[[5]]$N0, setup_tot_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_pa_est_sc12 <- sc_estimate(setup_tot_exp_pa_list[[6]]$Y, setup_tot_exp_pa_list[[6]]$N0, setup_tot_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_pa_est_sc13 <- sc_estimate(setup_tot_exp_pa_list[[7]]$Y, setup_tot_exp_pa_list[[7]]$N0, setup_tot_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_pa_est_sc15 <- sc_estimate(setup_tot_exp_pa_list[[8]]$Y, setup_tot_exp_pa_list[[8]]$N0, setup_tot_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_pa_est_sc17 <- sc_estimate(setup_tot_exp_pa_list[[9]]$Y, setup_tot_exp_pa_list[[9]]$N0, setup_tot_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_pa_est_sc19 <- sc_estimate(setup_tot_exp_pa_list[[10]]$Y, setup_tot_exp_pa_list[[10]]$N0, setup_tot_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_pa_est_sc21 <- sc_estimate(setup_tot_exp_pa_list[[11]]$Y, setup_tot_exp_pa_list[[11]]$N0, setup_tot_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_pa_est_sc23 <- sc_estimate(setup_tot_exp_pa_list[[12]]$Y, setup_tot_exp_pa_list[[12]]$N0, setup_tot_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_pa_est_sc24 <- sc_estimate(setup_tot_exp_pa_list[[13]]$Y, setup_tot_exp_pa_list[[13]]$N0, setup_tot_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_pa_est_sc25 <- sc_estimate(setup_tot_exp_pa_list[[14]]$Y, setup_tot_exp_pa_list[[14]]$N0, setup_tot_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_pa_est_sc26 <- sc_estimate(setup_tot_exp_pa_list[[15]]$Y, setup_tot_exp_pa_list[[15]]$N0, setup_tot_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_pa_est_sc28 <- sc_estimate(setup_tot_exp_pa_list[[16]]$Y, setup_tot_exp_pa_list[[16]]$N0, setup_tot_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_pa_est_sc29 <- sc_estimate(setup_tot_exp_pa_list[[17]]$Y, setup_tot_exp_pa_list[[17]]$N0, setup_tot_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_pa_est_sc30 <- sc_estimate(setup_tot_exp_pa_list[[18]]$Y, setup_tot_exp_pa_list[[18]]$N0, setup_tot_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_pa_est_sc31 <- sc_estimate(setup_tot_exp_pa_list[[19]]$Y, setup_tot_exp_pa_list[[19]]$N0, setup_tot_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_pa_est_sc32 <- sc_estimate(setup_tot_exp_pa_list[[20]]$Y, setup_tot_exp_pa_list[[20]]$N0, setup_tot_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_pa_est_sc33 <- sc_estimate(setup_tot_exp_pa_list[[21]]$Y, setup_tot_exp_pa_list[[21]]$N0, setup_tot_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_pa_est_sc34 <- sc_estimate(setup_tot_exp_pa_list[[22]]$Y, setup_tot_exp_pa_list[[22]]$N0, setup_tot_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_pa_est_sc36 <- sc_estimate(setup_tot_exp_pa_list[[23]]$Y, setup_tot_exp_pa_list[[23]]$N0, setup_tot_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_pa_est_sc37 <- sc_estimate(setup_tot_exp_pa_list[[24]]$Y, setup_tot_exp_pa_list[[24]]$N0, setup_tot_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_pa_est_sc39 <- sc_estimate(setup_tot_exp_pa_list[[25]]$Y, setup_tot_exp_pa_list[[25]]$N0, setup_tot_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_pa_est_sc40 <- sc_estimate(setup_tot_exp_pa_list[[26]]$Y, setup_tot_exp_pa_list[[26]]$N0, setup_tot_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_pa_est_sc41 <- sc_estimate(setup_tot_exp_pa_list[[27]]$Y, setup_tot_exp_pa_list[[27]]$N0, setup_tot_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_pa_est_sc44 <- sc_estimate(setup_tot_exp_pa_list[[28]]$Y, setup_tot_exp_pa_list[[28]]$N0, setup_tot_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_pa_est_sc45 <- sc_estimate(setup_tot_exp_pa_list[[29]]$Y, setup_tot_exp_pa_list[[29]]$N0, setup_tot_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_pa_est_sc47 <- sc_estimate(setup_tot_exp_pa_list[[30]]$Y, setup_tot_exp_pa_list[[30]]$N0, setup_tot_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_pa_est_sc50 <- sc_estimate(setup_tot_exp_pa_list[[31]]$Y, setup_tot_exp_pa_list[[31]]$N0, setup_tot_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_pa_est_sc51 <- sc_estimate(setup_tot_exp_pa_list[[32]]$Y, setup_tot_exp_pa_list[[32]]$N0, setup_tot_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_pa_est_sc53 <- sc_estimate(setup_tot_exp_pa_list[[33]]$Y, setup_tot_exp_pa_list[[33]]$N0, setup_tot_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_pa_est_sc54 <- sc_estimate(setup_tot_exp_pa_list[[34]]$Y, setup_tot_exp_pa_list[[34]]$N0, setup_tot_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_pa_est_sc55 <- sc_estimate(setup_tot_exp_pa_list[[35]]$Y, setup_tot_exp_pa_list[[35]]$N0, setup_tot_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_pa_est_sc_list <- list(tot_exp_pa_est_sc1,tot_exp_pa_est_sc2,tot_exp_pa_est_sc5,
                            tot_exp_pa_est_sc10,tot_exp_pa_est_sc11,tot_exp_pa_est_sc12,
                            tot_exp_pa_est_sc13,tot_exp_pa_est_sc15,tot_exp_pa_est_sc17,
                            tot_exp_pa_est_sc19,tot_exp_pa_est_sc21,tot_exp_pa_est_sc23,
                            tot_exp_pa_est_sc24,tot_exp_pa_est_sc25,tot_exp_pa_est_sc26,
                            tot_exp_pa_est_sc28,tot_exp_pa_est_sc29,tot_exp_pa_est_sc30,
                            tot_exp_pa_est_sc31,tot_exp_pa_est_sc32,tot_exp_pa_est_sc33,
                            tot_exp_pa_est_sc34,tot_exp_pa_est_sc36,tot_exp_pa_est_sc37,
                            tot_exp_pa_est_sc39,tot_exp_pa_est_sc40,tot_exp_pa_est_sc41,
                            tot_exp_pa_est_sc44,tot_exp_pa_est_sc45,tot_exp_pa_est_sc47,
                            tot_exp_pa_est_sc50,tot_exp_pa_est_sc51,tot_exp_pa_est_sc53,
                            tot_exp_pa_est_sc54,tot_exp_pa_est_sc55)
rm(tot_exp_pa_est_sc1,tot_exp_pa_est_sc2,tot_exp_pa_est_sc5,
   tot_exp_pa_est_sc10,tot_exp_pa_est_sc11,tot_exp_pa_est_sc12,
   tot_exp_pa_est_sc13,tot_exp_pa_est_sc15,tot_exp_pa_est_sc17,
   tot_exp_pa_est_sc19,tot_exp_pa_est_sc21,tot_exp_pa_est_sc23,
   tot_exp_pa_est_sc24,tot_exp_pa_est_sc25,tot_exp_pa_est_sc26,
   tot_exp_pa_est_sc28,tot_exp_pa_est_sc29,tot_exp_pa_est_sc30,
   tot_exp_pa_est_sc31,tot_exp_pa_est_sc32,tot_exp_pa_est_sc33,
   tot_exp_pa_est_sc34,tot_exp_pa_est_sc36,tot_exp_pa_est_sc37,
   tot_exp_pa_est_sc39,tot_exp_pa_est_sc40,tot_exp_pa_est_sc41,
   tot_exp_pa_est_sc44,tot_exp_pa_est_sc45,tot_exp_pa_est_sc47,
   tot_exp_pa_est_sc50,tot_exp_pa_est_sc51,tot_exp_pa_est_sc53,
   tot_exp_pa_est_sc54,tot_exp_pa_est_sc55)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sc_plot", i), synthdid_plot(tot_exp_pa_est_sc_list[i]))
}
tot_exp_pa_est_sc_plot_data_aux1 <- ggplot_build(tot_exp_pa_est_sc_plot1)
tot_exp_pa_est_sc_plot_data_aux2 <- ggplot_build(tot_exp_pa_est_sc_plot2)
tot_exp_pa_est_sc_plot_data_aux3 <- ggplot_build(tot_exp_pa_est_sc_plot3)
tot_exp_pa_est_sc_plot_data_aux4 <- ggplot_build(tot_exp_pa_est_sc_plot4)
tot_exp_pa_est_sc_plot_data_aux5 <- ggplot_build(tot_exp_pa_est_sc_plot5)
tot_exp_pa_est_sc_plot_data_aux6 <- ggplot_build(tot_exp_pa_est_sc_plot6)
tot_exp_pa_est_sc_plot_data_aux7 <- ggplot_build(tot_exp_pa_est_sc_plot7)
tot_exp_pa_est_sc_plot_data_aux8 <- ggplot_build(tot_exp_pa_est_sc_plot8)
tot_exp_pa_est_sc_plot_data_aux9 <- ggplot_build(tot_exp_pa_est_sc_plot9)
tot_exp_pa_est_sc_plot_data_aux10 <- ggplot_build(tot_exp_pa_est_sc_plot10)
tot_exp_pa_est_sc_plot_data_aux11 <- ggplot_build(tot_exp_pa_est_sc_plot11)
tot_exp_pa_est_sc_plot_data_aux12 <- ggplot_build(tot_exp_pa_est_sc_plot12)
tot_exp_pa_est_sc_plot_data_aux13 <- ggplot_build(tot_exp_pa_est_sc_plot13)
tot_exp_pa_est_sc_plot_data_aux14 <- ggplot_build(tot_exp_pa_est_sc_plot14)
tot_exp_pa_est_sc_plot_data_aux15 <- ggplot_build(tot_exp_pa_est_sc_plot15)
tot_exp_pa_est_sc_plot_data_aux16 <- ggplot_build(tot_exp_pa_est_sc_plot16)
tot_exp_pa_est_sc_plot_data_aux17 <- ggplot_build(tot_exp_pa_est_sc_plot17)
tot_exp_pa_est_sc_plot_data_aux18 <- ggplot_build(tot_exp_pa_est_sc_plot18)
tot_exp_pa_est_sc_plot_data_aux19 <- ggplot_build(tot_exp_pa_est_sc_plot19)
tot_exp_pa_est_sc_plot_data_aux20 <- ggplot_build(tot_exp_pa_est_sc_plot20)
tot_exp_pa_est_sc_plot_data_aux21 <- ggplot_build(tot_exp_pa_est_sc_plot21)
tot_exp_pa_est_sc_plot_data_aux22 <- ggplot_build(tot_exp_pa_est_sc_plot22)
tot_exp_pa_est_sc_plot_data_aux23 <- ggplot_build(tot_exp_pa_est_sc_plot23)
tot_exp_pa_est_sc_plot_data_aux24 <- ggplot_build(tot_exp_pa_est_sc_plot24)
tot_exp_pa_est_sc_plot_data_aux25 <- ggplot_build(tot_exp_pa_est_sc_plot25)
tot_exp_pa_est_sc_plot_data_aux26 <- ggplot_build(tot_exp_pa_est_sc_plot26)
tot_exp_pa_est_sc_plot_data_aux27 <- ggplot_build(tot_exp_pa_est_sc_plot27)
tot_exp_pa_est_sc_plot_data_aux28 <- ggplot_build(tot_exp_pa_est_sc_plot28)
tot_exp_pa_est_sc_plot_data_aux29 <- ggplot_build(tot_exp_pa_est_sc_plot29)
tot_exp_pa_est_sc_plot_data_aux30 <- ggplot_build(tot_exp_pa_est_sc_plot30)
tot_exp_pa_est_sc_plot_data_aux31 <- ggplot_build(tot_exp_pa_est_sc_plot31)
tot_exp_pa_est_sc_plot_data_aux32 <- ggplot_build(tot_exp_pa_est_sc_plot32)
tot_exp_pa_est_sc_plot_data_aux33 <- ggplot_build(tot_exp_pa_est_sc_plot33)
tot_exp_pa_est_sc_plot_data_aux34 <- ggplot_build(tot_exp_pa_est_sc_plot34)
tot_exp_pa_est_sc_plot_data_aux35 <- ggplot_build(tot_exp_pa_est_sc_plot35)
tot_exp_pa_est_sc_plot_data_aux_list <- list(tot_exp_pa_est_sc_plot_data_aux1,tot_exp_pa_est_sc_plot_data_aux2,tot_exp_pa_est_sc_plot_data_aux3,
                                          tot_exp_pa_est_sc_plot_data_aux4,tot_exp_pa_est_sc_plot_data_aux5,tot_exp_pa_est_sc_plot_data_aux6,
                                          tot_exp_pa_est_sc_plot_data_aux7,tot_exp_pa_est_sc_plot_data_aux8,tot_exp_pa_est_sc_plot_data_aux9,
                                          tot_exp_pa_est_sc_plot_data_aux10,tot_exp_pa_est_sc_plot_data_aux11,tot_exp_pa_est_sc_plot_data_aux12,
                                          tot_exp_pa_est_sc_plot_data_aux13,tot_exp_pa_est_sc_plot_data_aux14,tot_exp_pa_est_sc_plot_data_aux15,
                                          tot_exp_pa_est_sc_plot_data_aux16,tot_exp_pa_est_sc_plot_data_aux17,tot_exp_pa_est_sc_plot_data_aux18,
                                          tot_exp_pa_est_sc_plot_data_aux19,tot_exp_pa_est_sc_plot_data_aux20,tot_exp_pa_est_sc_plot_data_aux21,
                                          tot_exp_pa_est_sc_plot_data_aux22,tot_exp_pa_est_sc_plot_data_aux23,tot_exp_pa_est_sc_plot_data_aux24,
                                          tot_exp_pa_est_sc_plot_data_aux25,tot_exp_pa_est_sc_plot_data_aux26,tot_exp_pa_est_sc_plot_data_aux27,
                                          tot_exp_pa_est_sc_plot_data_aux28,tot_exp_pa_est_sc_plot_data_aux29,tot_exp_pa_est_sc_plot_data_aux30,
                                          tot_exp_pa_est_sc_plot_data_aux31,tot_exp_pa_est_sc_plot_data_aux32,tot_exp_pa_est_sc_plot_data_aux33,
                                          tot_exp_pa_est_sc_plot_data_aux34,tot_exp_pa_est_sc_plot_data_aux35)
rm(tot_exp_pa_est_sc_plot_data_aux1,tot_exp_pa_est_sc_plot_data_aux2,tot_exp_pa_est_sc_plot_data_aux3,
   tot_exp_pa_est_sc_plot_data_aux4,tot_exp_pa_est_sc_plot_data_aux5,tot_exp_pa_est_sc_plot_data_aux6,
   tot_exp_pa_est_sc_plot_data_aux7,tot_exp_pa_est_sc_plot_data_aux8,tot_exp_pa_est_sc_plot_data_aux9,
   tot_exp_pa_est_sc_plot_data_aux10,tot_exp_pa_est_sc_plot_data_aux11,tot_exp_pa_est_sc_plot_data_aux12,
   tot_exp_pa_est_sc_plot_data_aux13,tot_exp_pa_est_sc_plot_data_aux14,tot_exp_pa_est_sc_plot_data_aux15,
   tot_exp_pa_est_sc_plot_data_aux16,tot_exp_pa_est_sc_plot_data_aux17,tot_exp_pa_est_sc_plot_data_aux18,
   tot_exp_pa_est_sc_plot_data_aux19,tot_exp_pa_est_sc_plot_data_aux20,tot_exp_pa_est_sc_plot_data_aux21,
   tot_exp_pa_est_sc_plot_data_aux22,tot_exp_pa_est_sc_plot_data_aux23,tot_exp_pa_est_sc_plot_data_aux24,
   tot_exp_pa_est_sc_plot_data_aux25,tot_exp_pa_est_sc_plot_data_aux26,tot_exp_pa_est_sc_plot_data_aux27,
   tot_exp_pa_est_sc_plot_data_aux28,tot_exp_pa_est_sc_plot_data_aux29,tot_exp_pa_est_sc_plot_data_aux30,
   tot_exp_pa_est_sc_plot_data_aux31,tot_exp_pa_est_sc_plot_data_aux32,tot_exp_pa_est_sc_plot_data_aux33,
   tot_exp_pa_est_sc_plot_data_aux34,tot_exp_pa_est_sc_plot_data_aux35)
rm(tot_exp_pa_est_sc_plot1,tot_exp_pa_est_sc_plot2,tot_exp_pa_est_sc_plot3,
   tot_exp_pa_est_sc_plot4,tot_exp_pa_est_sc_plot5,tot_exp_pa_est_sc_plot6,
   tot_exp_pa_est_sc_plot7,tot_exp_pa_est_sc_plot8,tot_exp_pa_est_sc_plot9,
   tot_exp_pa_est_sc_plot10,tot_exp_pa_est_sc_plot11,tot_exp_pa_est_sc_plot12,
   tot_exp_pa_est_sc_plot13,tot_exp_pa_est_sc_plot14,tot_exp_pa_est_sc_plot15,
   tot_exp_pa_est_sc_plot16,tot_exp_pa_est_sc_plot17,tot_exp_pa_est_sc_plot18,
   tot_exp_pa_est_sc_plot19,tot_exp_pa_est_sc_plot20,tot_exp_pa_est_sc_plot21,
   tot_exp_pa_est_sc_plot22,tot_exp_pa_est_sc_plot23,tot_exp_pa_est_sc_plot24,
   tot_exp_pa_est_sc_plot25,tot_exp_pa_est_sc_plot26,tot_exp_pa_est_sc_plot27,
   tot_exp_pa_est_sc_plot28,tot_exp_pa_est_sc_plot29,tot_exp_pa_est_sc_plot30,
   tot_exp_pa_est_sc_plot31,tot_exp_pa_est_sc_plot32,tot_exp_pa_est_sc_plot33,
   tot_exp_pa_est_sc_plot34,tot_exp_pa_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sc_plot_data_long", i), data.frame(tot_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_pa_est_sc_plot_data_long_list <- list(tot_exp_pa_est_sc_plot_data_long1,tot_exp_pa_est_sc_plot_data_long2,tot_exp_pa_est_sc_plot_data_long3,
                                           tot_exp_pa_est_sc_plot_data_long4,tot_exp_pa_est_sc_plot_data_long5,tot_exp_pa_est_sc_plot_data_long6,
                                           tot_exp_pa_est_sc_plot_data_long7,tot_exp_pa_est_sc_plot_data_long8,tot_exp_pa_est_sc_plot_data_long9,
                                           tot_exp_pa_est_sc_plot_data_long10,tot_exp_pa_est_sc_plot_data_long11,tot_exp_pa_est_sc_plot_data_long12,
                                           tot_exp_pa_est_sc_plot_data_long13,tot_exp_pa_est_sc_plot_data_long14,tot_exp_pa_est_sc_plot_data_long15,
                                           tot_exp_pa_est_sc_plot_data_long16,tot_exp_pa_est_sc_plot_data_long17,tot_exp_pa_est_sc_plot_data_long18,
                                           tot_exp_pa_est_sc_plot_data_long19,tot_exp_pa_est_sc_plot_data_long20,tot_exp_pa_est_sc_plot_data_long21,
                                           tot_exp_pa_est_sc_plot_data_long22,tot_exp_pa_est_sc_plot_data_long23,tot_exp_pa_est_sc_plot_data_long24,
                                           tot_exp_pa_est_sc_plot_data_long25,tot_exp_pa_est_sc_plot_data_long26,tot_exp_pa_est_sc_plot_data_long27,
                                           tot_exp_pa_est_sc_plot_data_long28,tot_exp_pa_est_sc_plot_data_long29,tot_exp_pa_est_sc_plot_data_long30,
                                           tot_exp_pa_est_sc_plot_data_long31,tot_exp_pa_est_sc_plot_data_long32,tot_exp_pa_est_sc_plot_data_long33,
                                           tot_exp_pa_est_sc_plot_data_long34,tot_exp_pa_est_sc_plot_data_long35)
rm(tot_exp_pa_est_sc_plot_data_long1,tot_exp_pa_est_sc_plot_data_long2,tot_exp_pa_est_sc_plot_data_long3,
   tot_exp_pa_est_sc_plot_data_long4,tot_exp_pa_est_sc_plot_data_long5,tot_exp_pa_est_sc_plot_data_long6,
   tot_exp_pa_est_sc_plot_data_long7,tot_exp_pa_est_sc_plot_data_long8,tot_exp_pa_est_sc_plot_data_long9,
   tot_exp_pa_est_sc_plot_data_long10,tot_exp_pa_est_sc_plot_data_long11,tot_exp_pa_est_sc_plot_data_long12,
   tot_exp_pa_est_sc_plot_data_long13,tot_exp_pa_est_sc_plot_data_long14,tot_exp_pa_est_sc_plot_data_long15,
   tot_exp_pa_est_sc_plot_data_long16,tot_exp_pa_est_sc_plot_data_long17,tot_exp_pa_est_sc_plot_data_long18,
   tot_exp_pa_est_sc_plot_data_long19,tot_exp_pa_est_sc_plot_data_long20,tot_exp_pa_est_sc_plot_data_long21,
   tot_exp_pa_est_sc_plot_data_long22,tot_exp_pa_est_sc_plot_data_long23,tot_exp_pa_est_sc_plot_data_long24,
   tot_exp_pa_est_sc_plot_data_long25,tot_exp_pa_est_sc_plot_data_long26,tot_exp_pa_est_sc_plot_data_long27,
   tot_exp_pa_est_sc_plot_data_long28,tot_exp_pa_est_sc_plot_data_long29,tot_exp_pa_est_sc_plot_data_long30,
   tot_exp_pa_est_sc_plot_data_long31,tot_exp_pa_est_sc_plot_data_long32,tot_exp_pa_est_sc_plot_data_long33,
   tot_exp_pa_est_sc_plot_data_long34,tot_exp_pa_est_sc_plot_data_long35)
tot_exp_pa_est_sc_plot_data_long_list <- lapply(tot_exp_pa_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sc_plot_data_wide", i), reshape(data=tot_exp_pa_est_sc_plot_data_long_list[[i]],
                                                             idvar = "year",
                                                             v.names = "outcome",
                                                             timevar = "treated",
                                                             direction = "wide"))
}
tot_exp_pa_est_sc_plot_data_wide_list <- list(tot_exp_pa_est_sc_plot_data_wide1,tot_exp_pa_est_sc_plot_data_wide2,tot_exp_pa_est_sc_plot_data_wide3,
                                           tot_exp_pa_est_sc_plot_data_wide4,tot_exp_pa_est_sc_plot_data_wide5,tot_exp_pa_est_sc_plot_data_wide6,
                                           tot_exp_pa_est_sc_plot_data_wide7,tot_exp_pa_est_sc_plot_data_wide8,tot_exp_pa_est_sc_plot_data_wide9,
                                           tot_exp_pa_est_sc_plot_data_wide10,tot_exp_pa_est_sc_plot_data_wide11,tot_exp_pa_est_sc_plot_data_wide12,
                                           tot_exp_pa_est_sc_plot_data_wide13,tot_exp_pa_est_sc_plot_data_wide14,tot_exp_pa_est_sc_plot_data_wide15,
                                           tot_exp_pa_est_sc_plot_data_wide16,tot_exp_pa_est_sc_plot_data_wide17,tot_exp_pa_est_sc_plot_data_wide18,
                                           tot_exp_pa_est_sc_plot_data_wide19,tot_exp_pa_est_sc_plot_data_wide20,tot_exp_pa_est_sc_plot_data_wide21,
                                           tot_exp_pa_est_sc_plot_data_wide22,tot_exp_pa_est_sc_plot_data_wide23,tot_exp_pa_est_sc_plot_data_wide24,
                                           tot_exp_pa_est_sc_plot_data_wide25,tot_exp_pa_est_sc_plot_data_wide26,tot_exp_pa_est_sc_plot_data_wide27,
                                           tot_exp_pa_est_sc_plot_data_wide28,tot_exp_pa_est_sc_plot_data_wide29,tot_exp_pa_est_sc_plot_data_wide30,
                                           tot_exp_pa_est_sc_plot_data_wide31,tot_exp_pa_est_sc_plot_data_wide32,tot_exp_pa_est_sc_plot_data_wide33,
                                           tot_exp_pa_est_sc_plot_data_wide34,tot_exp_pa_est_sc_plot_data_wide35)
rm(tot_exp_pa_est_sc_plot_data_wide1,tot_exp_pa_est_sc_plot_data_wide2,tot_exp_pa_est_sc_plot_data_wide3,
   tot_exp_pa_est_sc_plot_data_wide4,tot_exp_pa_est_sc_plot_data_wide5,tot_exp_pa_est_sc_plot_data_wide6,
   tot_exp_pa_est_sc_plot_data_wide7,tot_exp_pa_est_sc_plot_data_wide8,tot_exp_pa_est_sc_plot_data_wide9,
   tot_exp_pa_est_sc_plot_data_wide10,tot_exp_pa_est_sc_plot_data_wide11,tot_exp_pa_est_sc_plot_data_wide12,
   tot_exp_pa_est_sc_plot_data_wide13,tot_exp_pa_est_sc_plot_data_wide14,tot_exp_pa_est_sc_plot_data_wide15,
   tot_exp_pa_est_sc_plot_data_wide16,tot_exp_pa_est_sc_plot_data_wide17,tot_exp_pa_est_sc_plot_data_wide18,
   tot_exp_pa_est_sc_plot_data_wide19,tot_exp_pa_est_sc_plot_data_wide20,tot_exp_pa_est_sc_plot_data_wide21,
   tot_exp_pa_est_sc_plot_data_wide22,tot_exp_pa_est_sc_plot_data_wide23,tot_exp_pa_est_sc_plot_data_wide24,
   tot_exp_pa_est_sc_plot_data_wide25,tot_exp_pa_est_sc_plot_data_wide26,tot_exp_pa_est_sc_plot_data_wide27,
   tot_exp_pa_est_sc_plot_data_wide28,tot_exp_pa_est_sc_plot_data_wide29,tot_exp_pa_est_sc_plot_data_wide30,
   tot_exp_pa_est_sc_plot_data_wide31,tot_exp_pa_est_sc_plot_data_wide32,tot_exp_pa_est_sc_plot_data_wide33,
   tot_exp_pa_est_sc_plot_data_wide34,tot_exp_pa_est_sc_plot_data_wide35)
tot_exp_pa_est_sc_plot_data_wide_list <- lapply(tot_exp_pa_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
tot_exp_pa_est_sdid1 <- synthdid_estimate(setup_tot_exp_pa_list[[1]]$Y, setup_tot_exp_pa_list[[1]]$N0, setup_tot_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_pa_est_sdid2 <- synthdid_estimate(setup_tot_exp_pa_list[[2]]$Y, setup_tot_exp_pa_list[[2]]$N0, setup_tot_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_pa_est_sdid5 <- synthdid_estimate(setup_tot_exp_pa_list[[3]]$Y, setup_tot_exp_pa_list[[3]]$N0, setup_tot_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_pa_est_sdid10 <- synthdid_estimate(setup_tot_exp_pa_list[[4]]$Y, setup_tot_exp_pa_list[[4]]$N0, setup_tot_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_pa_est_sdid11 <- synthdid_estimate(setup_tot_exp_pa_list[[5]]$Y, setup_tot_exp_pa_list[[5]]$N0, setup_tot_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_pa_est_sdid12 <- synthdid_estimate(setup_tot_exp_pa_list[[6]]$Y, setup_tot_exp_pa_list[[6]]$N0, setup_tot_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_pa_est_sdid13 <- synthdid_estimate(setup_tot_exp_pa_list[[7]]$Y, setup_tot_exp_pa_list[[7]]$N0, setup_tot_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_pa_est_sdid15 <- synthdid_estimate(setup_tot_exp_pa_list[[8]]$Y, setup_tot_exp_pa_list[[8]]$N0, setup_tot_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_pa_est_sdid17 <- synthdid_estimate(setup_tot_exp_pa_list[[9]]$Y, setup_tot_exp_pa_list[[9]]$N0, setup_tot_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_pa_est_sdid19 <- synthdid_estimate(setup_tot_exp_pa_list[[10]]$Y, setup_tot_exp_pa_list[[10]]$N0, setup_tot_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_pa_est_sdid21 <- synthdid_estimate(setup_tot_exp_pa_list[[11]]$Y, setup_tot_exp_pa_list[[11]]$N0, setup_tot_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_pa_est_sdid23 <- synthdid_estimate(setup_tot_exp_pa_list[[12]]$Y, setup_tot_exp_pa_list[[12]]$N0, setup_tot_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_pa_est_sdid24 <- synthdid_estimate(setup_tot_exp_pa_list[[13]]$Y, setup_tot_exp_pa_list[[13]]$N0, setup_tot_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_pa_est_sdid25 <- synthdid_estimate(setup_tot_exp_pa_list[[14]]$Y, setup_tot_exp_pa_list[[14]]$N0, setup_tot_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_pa_est_sdid26 <- synthdid_estimate(setup_tot_exp_pa_list[[15]]$Y, setup_tot_exp_pa_list[[15]]$N0, setup_tot_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_pa_est_sdid28 <- synthdid_estimate(setup_tot_exp_pa_list[[16]]$Y, setup_tot_exp_pa_list[[16]]$N0, setup_tot_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_pa_est_sdid29 <- synthdid_estimate(setup_tot_exp_pa_list[[17]]$Y, setup_tot_exp_pa_list[[17]]$N0, setup_tot_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_pa_est_sdid30 <- synthdid_estimate(setup_tot_exp_pa_list[[18]]$Y, setup_tot_exp_pa_list[[18]]$N0, setup_tot_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_pa_est_sdid31 <- synthdid_estimate(setup_tot_exp_pa_list[[19]]$Y, setup_tot_exp_pa_list[[19]]$N0, setup_tot_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_pa_est_sdid32 <- synthdid_estimate(setup_tot_exp_pa_list[[20]]$Y, setup_tot_exp_pa_list[[20]]$N0, setup_tot_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_pa_est_sdid33 <- synthdid_estimate(setup_tot_exp_pa_list[[21]]$Y, setup_tot_exp_pa_list[[21]]$N0, setup_tot_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_pa_est_sdid34 <- synthdid_estimate(setup_tot_exp_pa_list[[22]]$Y, setup_tot_exp_pa_list[[22]]$N0, setup_tot_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_pa_est_sdid36 <- synthdid_estimate(setup_tot_exp_pa_list[[23]]$Y, setup_tot_exp_pa_list[[23]]$N0, setup_tot_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_pa_est_sdid37 <- synthdid_estimate(setup_tot_exp_pa_list[[24]]$Y, setup_tot_exp_pa_list[[24]]$N0, setup_tot_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_pa_est_sdid39 <- synthdid_estimate(setup_tot_exp_pa_list[[25]]$Y, setup_tot_exp_pa_list[[25]]$N0, setup_tot_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_pa_est_sdid40 <- synthdid_estimate(setup_tot_exp_pa_list[[26]]$Y, setup_tot_exp_pa_list[[26]]$N0, setup_tot_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_pa_est_sdid41 <- synthdid_estimate(setup_tot_exp_pa_list[[27]]$Y, setup_tot_exp_pa_list[[27]]$N0, setup_tot_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_pa_est_sdid44 <- synthdid_estimate(setup_tot_exp_pa_list[[28]]$Y, setup_tot_exp_pa_list[[28]]$N0, setup_tot_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_pa_est_sdid45 <- synthdid_estimate(setup_tot_exp_pa_list[[29]]$Y, setup_tot_exp_pa_list[[29]]$N0, setup_tot_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_pa_est_sdid47 <- synthdid_estimate(setup_tot_exp_pa_list[[30]]$Y, setup_tot_exp_pa_list[[30]]$N0, setup_tot_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_pa_est_sdid50 <- synthdid_estimate(setup_tot_exp_pa_list[[31]]$Y, setup_tot_exp_pa_list[[31]]$N0, setup_tot_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_pa_est_sdid51 <- synthdid_estimate(setup_tot_exp_pa_list[[32]]$Y, setup_tot_exp_pa_list[[32]]$N0, setup_tot_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_pa_est_sdid53 <- synthdid_estimate(setup_tot_exp_pa_list[[33]]$Y, setup_tot_exp_pa_list[[33]]$N0, setup_tot_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_pa_est_sdid54 <- synthdid_estimate(setup_tot_exp_pa_list[[34]]$Y, setup_tot_exp_pa_list[[34]]$N0, setup_tot_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_pa_est_sdid55 <- synthdid_estimate(setup_tot_exp_pa_list[[35]]$Y, setup_tot_exp_pa_list[[35]]$N0, setup_tot_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_pa_est_sdid_list <- list(tot_exp_pa_est_sdid1,tot_exp_pa_est_sdid2,tot_exp_pa_est_sdid5,
                              tot_exp_pa_est_sdid10,tot_exp_pa_est_sdid11,tot_exp_pa_est_sdid12,
                              tot_exp_pa_est_sdid13,tot_exp_pa_est_sdid15,tot_exp_pa_est_sdid17,
                              tot_exp_pa_est_sdid19,tot_exp_pa_est_sdid21,tot_exp_pa_est_sdid23,
                              tot_exp_pa_est_sdid24,tot_exp_pa_est_sdid25,tot_exp_pa_est_sdid26,
                              tot_exp_pa_est_sdid28,tot_exp_pa_est_sdid29,tot_exp_pa_est_sdid30,
                              tot_exp_pa_est_sdid31,tot_exp_pa_est_sdid32,tot_exp_pa_est_sdid33,
                              tot_exp_pa_est_sdid34,tot_exp_pa_est_sdid36,tot_exp_pa_est_sdid37,
                              tot_exp_pa_est_sdid39,tot_exp_pa_est_sdid40,tot_exp_pa_est_sdid41,
                              tot_exp_pa_est_sdid44,tot_exp_pa_est_sdid45,tot_exp_pa_est_sdid47,
                              tot_exp_pa_est_sdid50,tot_exp_pa_est_sdid51,tot_exp_pa_est_sdid53,
                              tot_exp_pa_est_sdid54,tot_exp_pa_est_sdid55)
rm(tot_exp_pa_est_sdid1,tot_exp_pa_est_sdid2,tot_exp_pa_est_sdid5,
   tot_exp_pa_est_sdid10,tot_exp_pa_est_sdid11,tot_exp_pa_est_sdid12,
   tot_exp_pa_est_sdid13,tot_exp_pa_est_sdid15,tot_exp_pa_est_sdid17,
   tot_exp_pa_est_sdid19,tot_exp_pa_est_sdid21,tot_exp_pa_est_sdid23,
   tot_exp_pa_est_sdid24,tot_exp_pa_est_sdid25,tot_exp_pa_est_sdid26,
   tot_exp_pa_est_sdid28,tot_exp_pa_est_sdid29,tot_exp_pa_est_sdid30,
   tot_exp_pa_est_sdid31,tot_exp_pa_est_sdid32,tot_exp_pa_est_sdid33,
   tot_exp_pa_est_sdid34,tot_exp_pa_est_sdid36,tot_exp_pa_est_sdid37,
   tot_exp_pa_est_sdid39,tot_exp_pa_est_sdid40,tot_exp_pa_est_sdid41,
   tot_exp_pa_est_sdid44,tot_exp_pa_est_sdid45,tot_exp_pa_est_sdid47,
   tot_exp_pa_est_sdid50,tot_exp_pa_est_sdid51,tot_exp_pa_est_sdid53,
   tot_exp_pa_est_sdid54,tot_exp_pa_est_sdid55)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sdid_plot", i), synthdid_plot(tot_exp_pa_est_sdid_list[i]))
}
tot_exp_pa_est_sdid_plot_data_aux1 <- ggplot_build(tot_exp_pa_est_sdid_plot1)
tot_exp_pa_est_sdid_plot_data_aux2 <- ggplot_build(tot_exp_pa_est_sdid_plot2)
tot_exp_pa_est_sdid_plot_data_aux3 <- ggplot_build(tot_exp_pa_est_sdid_plot3)
tot_exp_pa_est_sdid_plot_data_aux4 <- ggplot_build(tot_exp_pa_est_sdid_plot4)
tot_exp_pa_est_sdid_plot_data_aux5 <- ggplot_build(tot_exp_pa_est_sdid_plot5)
tot_exp_pa_est_sdid_plot_data_aux6 <- ggplot_build(tot_exp_pa_est_sdid_plot6)
tot_exp_pa_est_sdid_plot_data_aux7 <- ggplot_build(tot_exp_pa_est_sdid_plot7)
tot_exp_pa_est_sdid_plot_data_aux8 <- ggplot_build(tot_exp_pa_est_sdid_plot8)
tot_exp_pa_est_sdid_plot_data_aux9 <- ggplot_build(tot_exp_pa_est_sdid_plot9)
tot_exp_pa_est_sdid_plot_data_aux10 <- ggplot_build(tot_exp_pa_est_sdid_plot10)
tot_exp_pa_est_sdid_plot_data_aux11 <- ggplot_build(tot_exp_pa_est_sdid_plot11)
tot_exp_pa_est_sdid_plot_data_aux12 <- ggplot_build(tot_exp_pa_est_sdid_plot12)
tot_exp_pa_est_sdid_plot_data_aux13 <- ggplot_build(tot_exp_pa_est_sdid_plot13)
tot_exp_pa_est_sdid_plot_data_aux14 <- ggplot_build(tot_exp_pa_est_sdid_plot14)
tot_exp_pa_est_sdid_plot_data_aux15 <- ggplot_build(tot_exp_pa_est_sdid_plot15)
tot_exp_pa_est_sdid_plot_data_aux16 <- ggplot_build(tot_exp_pa_est_sdid_plot16)
tot_exp_pa_est_sdid_plot_data_aux17 <- ggplot_build(tot_exp_pa_est_sdid_plot17)
tot_exp_pa_est_sdid_plot_data_aux18 <- ggplot_build(tot_exp_pa_est_sdid_plot18)
tot_exp_pa_est_sdid_plot_data_aux19 <- ggplot_build(tot_exp_pa_est_sdid_plot19)
tot_exp_pa_est_sdid_plot_data_aux20 <- ggplot_build(tot_exp_pa_est_sdid_plot20)
tot_exp_pa_est_sdid_plot_data_aux21 <- ggplot_build(tot_exp_pa_est_sdid_plot21)
tot_exp_pa_est_sdid_plot_data_aux22 <- ggplot_build(tot_exp_pa_est_sdid_plot22)
tot_exp_pa_est_sdid_plot_data_aux23 <- ggplot_build(tot_exp_pa_est_sdid_plot23)
tot_exp_pa_est_sdid_plot_data_aux24 <- ggplot_build(tot_exp_pa_est_sdid_plot24)
tot_exp_pa_est_sdid_plot_data_aux25 <- ggplot_build(tot_exp_pa_est_sdid_plot25)
tot_exp_pa_est_sdid_plot_data_aux26 <- ggplot_build(tot_exp_pa_est_sdid_plot26)
tot_exp_pa_est_sdid_plot_data_aux27 <- ggplot_build(tot_exp_pa_est_sdid_plot27)
tot_exp_pa_est_sdid_plot_data_aux28 <- ggplot_build(tot_exp_pa_est_sdid_plot28)
tot_exp_pa_est_sdid_plot_data_aux29 <- ggplot_build(tot_exp_pa_est_sdid_plot29)
tot_exp_pa_est_sdid_plot_data_aux30 <- ggplot_build(tot_exp_pa_est_sdid_plot30)
tot_exp_pa_est_sdid_plot_data_aux31 <- ggplot_build(tot_exp_pa_est_sdid_plot31)
tot_exp_pa_est_sdid_plot_data_aux32 <- ggplot_build(tot_exp_pa_est_sdid_plot32)
tot_exp_pa_est_sdid_plot_data_aux33 <- ggplot_build(tot_exp_pa_est_sdid_plot33)
tot_exp_pa_est_sdid_plot_data_aux34 <- ggplot_build(tot_exp_pa_est_sdid_plot34)
tot_exp_pa_est_sdid_plot_data_aux35 <- ggplot_build(tot_exp_pa_est_sdid_plot35)
tot_exp_pa_est_sdid_plot_data_aux_list <- list(tot_exp_pa_est_sdid_plot_data_aux1,tot_exp_pa_est_sdid_plot_data_aux2,tot_exp_pa_est_sdid_plot_data_aux3,
                                            tot_exp_pa_est_sdid_plot_data_aux4,tot_exp_pa_est_sdid_plot_data_aux5,tot_exp_pa_est_sdid_plot_data_aux6,
                                            tot_exp_pa_est_sdid_plot_data_aux7,tot_exp_pa_est_sdid_plot_data_aux8,tot_exp_pa_est_sdid_plot_data_aux9,
                                            tot_exp_pa_est_sdid_plot_data_aux10,tot_exp_pa_est_sdid_plot_data_aux11,tot_exp_pa_est_sdid_plot_data_aux12,
                                            tot_exp_pa_est_sdid_plot_data_aux13,tot_exp_pa_est_sdid_plot_data_aux14,tot_exp_pa_est_sdid_plot_data_aux15,
                                            tot_exp_pa_est_sdid_plot_data_aux16,tot_exp_pa_est_sdid_plot_data_aux17,tot_exp_pa_est_sdid_plot_data_aux18,
                                            tot_exp_pa_est_sdid_plot_data_aux19,tot_exp_pa_est_sdid_plot_data_aux20,tot_exp_pa_est_sdid_plot_data_aux21,
                                            tot_exp_pa_est_sdid_plot_data_aux22,tot_exp_pa_est_sdid_plot_data_aux23,tot_exp_pa_est_sdid_plot_data_aux24,
                                            tot_exp_pa_est_sdid_plot_data_aux25,tot_exp_pa_est_sdid_plot_data_aux26,tot_exp_pa_est_sdid_plot_data_aux27,
                                            tot_exp_pa_est_sdid_plot_data_aux28,tot_exp_pa_est_sdid_plot_data_aux29,tot_exp_pa_est_sdid_plot_data_aux30,
                                            tot_exp_pa_est_sdid_plot_data_aux31,tot_exp_pa_est_sdid_plot_data_aux32,tot_exp_pa_est_sdid_plot_data_aux33,
                                            tot_exp_pa_est_sdid_plot_data_aux34,tot_exp_pa_est_sdid_plot_data_aux35)
rm(tot_exp_pa_est_sdid_plot_data_aux1,tot_exp_pa_est_sdid_plot_data_aux2,tot_exp_pa_est_sdid_plot_data_aux3,
   tot_exp_pa_est_sdid_plot_data_aux4,tot_exp_pa_est_sdid_plot_data_aux5,tot_exp_pa_est_sdid_plot_data_aux6,
   tot_exp_pa_est_sdid_plot_data_aux7,tot_exp_pa_est_sdid_plot_data_aux8,tot_exp_pa_est_sdid_plot_data_aux9,
   tot_exp_pa_est_sdid_plot_data_aux10,tot_exp_pa_est_sdid_plot_data_aux11,tot_exp_pa_est_sdid_plot_data_aux12,
   tot_exp_pa_est_sdid_plot_data_aux13,tot_exp_pa_est_sdid_plot_data_aux14,tot_exp_pa_est_sdid_plot_data_aux15,
   tot_exp_pa_est_sdid_plot_data_aux16,tot_exp_pa_est_sdid_plot_data_aux17,tot_exp_pa_est_sdid_plot_data_aux18,
   tot_exp_pa_est_sdid_plot_data_aux19,tot_exp_pa_est_sdid_plot_data_aux20,tot_exp_pa_est_sdid_plot_data_aux21,
   tot_exp_pa_est_sdid_plot_data_aux22,tot_exp_pa_est_sdid_plot_data_aux23,tot_exp_pa_est_sdid_plot_data_aux24,
   tot_exp_pa_est_sdid_plot_data_aux25,tot_exp_pa_est_sdid_plot_data_aux26,tot_exp_pa_est_sdid_plot_data_aux27,
   tot_exp_pa_est_sdid_plot_data_aux28,tot_exp_pa_est_sdid_plot_data_aux29,tot_exp_pa_est_sdid_plot_data_aux30,
   tot_exp_pa_est_sdid_plot_data_aux31,tot_exp_pa_est_sdid_plot_data_aux32,tot_exp_pa_est_sdid_plot_data_aux33,
   tot_exp_pa_est_sdid_plot_data_aux34,tot_exp_pa_est_sdid_plot_data_aux35)
rm(tot_exp_pa_est_sdid_plot1,tot_exp_pa_est_sdid_plot2,tot_exp_pa_est_sdid_plot3,
   tot_exp_pa_est_sdid_plot4,tot_exp_pa_est_sdid_plot5,tot_exp_pa_est_sdid_plot6,
   tot_exp_pa_est_sdid_plot7,tot_exp_pa_est_sdid_plot8,tot_exp_pa_est_sdid_plot9,
   tot_exp_pa_est_sdid_plot10,tot_exp_pa_est_sdid_plot11,tot_exp_pa_est_sdid_plot12,
   tot_exp_pa_est_sdid_plot13,tot_exp_pa_est_sdid_plot14,tot_exp_pa_est_sdid_plot15,
   tot_exp_pa_est_sdid_plot16,tot_exp_pa_est_sdid_plot17,tot_exp_pa_est_sdid_plot18,
   tot_exp_pa_est_sdid_plot19,tot_exp_pa_est_sdid_plot20,tot_exp_pa_est_sdid_plot21,
   tot_exp_pa_est_sdid_plot22,tot_exp_pa_est_sdid_plot23,tot_exp_pa_est_sdid_plot24,
   tot_exp_pa_est_sdid_plot25,tot_exp_pa_est_sdid_plot26,tot_exp_pa_est_sdid_plot27,
   tot_exp_pa_est_sdid_plot28,tot_exp_pa_est_sdid_plot29,tot_exp_pa_est_sdid_plot30,
   tot_exp_pa_est_sdid_plot31,tot_exp_pa_est_sdid_plot32,tot_exp_pa_est_sdid_plot33,
   tot_exp_pa_est_sdid_plot34,tot_exp_pa_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sdid_plot_data_long", i), data.frame(tot_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_pa_est_sdid_plot_data_long_list <- list(tot_exp_pa_est_sdid_plot_data_long1,tot_exp_pa_est_sdid_plot_data_long2,tot_exp_pa_est_sdid_plot_data_long3,
                                             tot_exp_pa_est_sdid_plot_data_long4,tot_exp_pa_est_sdid_plot_data_long5,tot_exp_pa_est_sdid_plot_data_long6,
                                             tot_exp_pa_est_sdid_plot_data_long7,tot_exp_pa_est_sdid_plot_data_long8,tot_exp_pa_est_sdid_plot_data_long9,
                                             tot_exp_pa_est_sdid_plot_data_long10,tot_exp_pa_est_sdid_plot_data_long11,tot_exp_pa_est_sdid_plot_data_long12,
                                             tot_exp_pa_est_sdid_plot_data_long13,tot_exp_pa_est_sdid_plot_data_long14,tot_exp_pa_est_sdid_plot_data_long15,
                                             tot_exp_pa_est_sdid_plot_data_long16,tot_exp_pa_est_sdid_plot_data_long17,tot_exp_pa_est_sdid_plot_data_long18,
                                             tot_exp_pa_est_sdid_plot_data_long19,tot_exp_pa_est_sdid_plot_data_long20,tot_exp_pa_est_sdid_plot_data_long21,
                                             tot_exp_pa_est_sdid_plot_data_long22,tot_exp_pa_est_sdid_plot_data_long23,tot_exp_pa_est_sdid_plot_data_long24,
                                             tot_exp_pa_est_sdid_plot_data_long25,tot_exp_pa_est_sdid_plot_data_long26,tot_exp_pa_est_sdid_plot_data_long27,
                                             tot_exp_pa_est_sdid_plot_data_long28,tot_exp_pa_est_sdid_plot_data_long29,tot_exp_pa_est_sdid_plot_data_long30,
                                             tot_exp_pa_est_sdid_plot_data_long31,tot_exp_pa_est_sdid_plot_data_long32,tot_exp_pa_est_sdid_plot_data_long33,
                                             tot_exp_pa_est_sdid_plot_data_long34,tot_exp_pa_est_sdid_plot_data_long35)
rm(tot_exp_pa_est_sdid_plot_data_long1,tot_exp_pa_est_sdid_plot_data_long2,tot_exp_pa_est_sdid_plot_data_long3,
   tot_exp_pa_est_sdid_plot_data_long4,tot_exp_pa_est_sdid_plot_data_long5,tot_exp_pa_est_sdid_plot_data_long6,
   tot_exp_pa_est_sdid_plot_data_long7,tot_exp_pa_est_sdid_plot_data_long8,tot_exp_pa_est_sdid_plot_data_long9,
   tot_exp_pa_est_sdid_plot_data_long10,tot_exp_pa_est_sdid_plot_data_long11,tot_exp_pa_est_sdid_plot_data_long12,
   tot_exp_pa_est_sdid_plot_data_long13,tot_exp_pa_est_sdid_plot_data_long14,tot_exp_pa_est_sdid_plot_data_long15,
   tot_exp_pa_est_sdid_plot_data_long16,tot_exp_pa_est_sdid_plot_data_long17,tot_exp_pa_est_sdid_plot_data_long18,
   tot_exp_pa_est_sdid_plot_data_long19,tot_exp_pa_est_sdid_plot_data_long20,tot_exp_pa_est_sdid_plot_data_long21,
   tot_exp_pa_est_sdid_plot_data_long22,tot_exp_pa_est_sdid_plot_data_long23,tot_exp_pa_est_sdid_plot_data_long24,
   tot_exp_pa_est_sdid_plot_data_long25,tot_exp_pa_est_sdid_plot_data_long26,tot_exp_pa_est_sdid_plot_data_long27,
   tot_exp_pa_est_sdid_plot_data_long28,tot_exp_pa_est_sdid_plot_data_long29,tot_exp_pa_est_sdid_plot_data_long30,
   tot_exp_pa_est_sdid_plot_data_long31,tot_exp_pa_est_sdid_plot_data_long32,tot_exp_pa_est_sdid_plot_data_long33,
   tot_exp_pa_est_sdid_plot_data_long34,tot_exp_pa_est_sdid_plot_data_long35)
tot_exp_pa_est_sdid_plot_data_long_list <- lapply(tot_exp_pa_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_pa_est_sdid_plot_data_wide", i), reshape(data=tot_exp_pa_est_sdid_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
tot_exp_pa_est_sdid_plot_data_wide_list <- list(tot_exp_pa_est_sdid_plot_data_wide1,tot_exp_pa_est_sdid_plot_data_wide2,tot_exp_pa_est_sdid_plot_data_wide3,
                                             tot_exp_pa_est_sdid_plot_data_wide4,tot_exp_pa_est_sdid_plot_data_wide5,tot_exp_pa_est_sdid_plot_data_wide6,
                                             tot_exp_pa_est_sdid_plot_data_wide7,tot_exp_pa_est_sdid_plot_data_wide8,tot_exp_pa_est_sdid_plot_data_wide9,
                                             tot_exp_pa_est_sdid_plot_data_wide10,tot_exp_pa_est_sdid_plot_data_wide11,tot_exp_pa_est_sdid_plot_data_wide12,
                                             tot_exp_pa_est_sdid_plot_data_wide13,tot_exp_pa_est_sdid_plot_data_wide14,tot_exp_pa_est_sdid_plot_data_wide15,
                                             tot_exp_pa_est_sdid_plot_data_wide16,tot_exp_pa_est_sdid_plot_data_wide17,tot_exp_pa_est_sdid_plot_data_wide18,
                                             tot_exp_pa_est_sdid_plot_data_wide19,tot_exp_pa_est_sdid_plot_data_wide20,tot_exp_pa_est_sdid_plot_data_wide21,
                                             tot_exp_pa_est_sdid_plot_data_wide22,tot_exp_pa_est_sdid_plot_data_wide23,tot_exp_pa_est_sdid_plot_data_wide24,
                                             tot_exp_pa_est_sdid_plot_data_wide25,tot_exp_pa_est_sdid_plot_data_wide26,tot_exp_pa_est_sdid_plot_data_wide27,
                                             tot_exp_pa_est_sdid_plot_data_wide28,tot_exp_pa_est_sdid_plot_data_wide29,tot_exp_pa_est_sdid_plot_data_wide30,
                                             tot_exp_pa_est_sdid_plot_data_wide31,tot_exp_pa_est_sdid_plot_data_wide32,tot_exp_pa_est_sdid_plot_data_wide33,
                                             tot_exp_pa_est_sdid_plot_data_wide34,tot_exp_pa_est_sdid_plot_data_wide35)
rm(tot_exp_pa_est_sdid_plot_data_wide1,tot_exp_pa_est_sdid_plot_data_wide2,tot_exp_pa_est_sdid_plot_data_wide3,
   tot_exp_pa_est_sdid_plot_data_wide4,tot_exp_pa_est_sdid_plot_data_wide5,tot_exp_pa_est_sdid_plot_data_wide6,
   tot_exp_pa_est_sdid_plot_data_wide7,tot_exp_pa_est_sdid_plot_data_wide8,tot_exp_pa_est_sdid_plot_data_wide9,
   tot_exp_pa_est_sdid_plot_data_wide10,tot_exp_pa_est_sdid_plot_data_wide11,tot_exp_pa_est_sdid_plot_data_wide12,
   tot_exp_pa_est_sdid_plot_data_wide13,tot_exp_pa_est_sdid_plot_data_wide14,tot_exp_pa_est_sdid_plot_data_wide15,
   tot_exp_pa_est_sdid_plot_data_wide16,tot_exp_pa_est_sdid_plot_data_wide17,tot_exp_pa_est_sdid_plot_data_wide18,
   tot_exp_pa_est_sdid_plot_data_wide19,tot_exp_pa_est_sdid_plot_data_wide20,tot_exp_pa_est_sdid_plot_data_wide21,
   tot_exp_pa_est_sdid_plot_data_wide22,tot_exp_pa_est_sdid_plot_data_wide23,tot_exp_pa_est_sdid_plot_data_wide24,
   tot_exp_pa_est_sdid_plot_data_wide25,tot_exp_pa_est_sdid_plot_data_wide26,tot_exp_pa_est_sdid_plot_data_wide27,
   tot_exp_pa_est_sdid_plot_data_wide28,tot_exp_pa_est_sdid_plot_data_wide29,tot_exp_pa_est_sdid_plot_data_wide30,
   tot_exp_pa_est_sdid_plot_data_wide31,tot_exp_pa_est_sdid_plot_data_wide32,tot_exp_pa_est_sdid_plot_data_wide33,
   tot_exp_pa_est_sdid_plot_data_wide34,tot_exp_pa_est_sdid_plot_data_wide35)
tot_exp_pa_est_sdid_plot_data_wide_list <- lapply(tot_exp_pa_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
tot_exp_est_did_plot_data_wide_pa$did_facet_title <- "Diff-in-Diff"
tot_exp_est_sc_plot_data_wide_pa$sc_facet_title <- "Synthetic Control"
tot_exp_est_sdid_plot_data_wide_pa$sdid_facet_title <- "Synthetic Diff-in-Diff"
tot_exp_est_did_plot_data_wide_pa$diff_relative <- tot_exp_est_did_plot_data_wide_pa$diff - tot_exp_est_did_plot_data_wide_pa$diff[16]
for(i in 1:35) {
  tot_exp_pa_est_did_plot_data_wide_list[[i]]$diff_relative <- tot_exp_pa_est_did_plot_data_wide_list[[i]]$diff - tot_exp_pa_est_did_plot_data_wide_list[[i]]$diff[16]
}
tot_exp_pa_spag_did_plot <- ggplot(tot_exp_est_did_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Total Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_pa_spag_sc_plot <- ggplot(tot_exp_est_sc_plot_data_wide_pa, aes(year,diff)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = tot_exp_pa_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Pennsylvania"),data = tot_exp_est_sc_plot_data_wide_pa, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Pennsylvania" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_est_sdid_plot_data_wide_pa$diff_relative <- tot_exp_est_sdid_plot_data_wide_pa$diff - tot_exp_est_sdid_plot_data_wide_pa$diff[16]
for(i in 1:35) {
  tot_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff_relative <- tot_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff - tot_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff[16]
}
tot_exp_pa_spag_sdid_plot <- ggplot(tot_exp_est_sdid_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_pa_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
tot_exp_pa_est_did_vec <- c(tot_exp_est_did_pa)
for (i in c(1:4,6:35)) {
  tot_exp_pa_est_did_vec_aux <- tot_exp_pa_est_did_list[[i]][1]
  tot_exp_pa_est_did_vec <- c(tot_exp_pa_est_did_vec,tot_exp_pa_est_did_vec_aux)
}
tot_exp_pa_est_did_df <- data.frame(tot_exp_pa_est_did_vec)
tot_exp_pa_hist_did_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_pa_est_did_vec)) +
  geom_histogram(data = tot_exp_pa_est_did_df, aes(x = tot_exp_pa_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_pa_hist_did_plot1_ylim <- ggplot_build(tot_exp_pa_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_pa_hist_did_plot <- tot_exp_pa_hist_did_plot_aux +
  expand_limits(y=tot_exp_pa_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_pa_est_did_vec[1], mean(tot_exp_pa_est_did_vec[2:35])), xend = c(tot_exp_pa_est_did_vec[1],mean(tot_exp_pa_est_did_vec[2:35])), y = c(0,0), yend = c(tot_exp_pa_hist_did_plot1_ylim,tot_exp_pa_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_pa_est_did_vec[1], mean(tot_exp_pa_est_did_vec[2:35])), y = c(tot_exp_pa_hist_did_plot1_ylim,tot_exp_pa_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_pa_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_pa_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.7,.5), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_pa_est_sc_vec <- c(tot_exp_est_sc_pa)
for (i in c(1:4,6:35)) {
  tot_exp_pa_est_sc_vec_aux <- tot_exp_pa_est_sc_list[[i]][1]
  tot_exp_pa_est_sc_vec <- c(tot_exp_pa_est_sc_vec,tot_exp_pa_est_sc_vec_aux)
}
tot_exp_pa_est_sc_df <- data.frame(tot_exp_pa_est_sc_vec)
tot_exp_pa_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_pa_est_sc_vec)) +
  geom_histogram(data = tot_exp_pa_est_sc_df, aes(x = tot_exp_pa_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_pa_hist_sc_plot1_ylim <- ggplot_build(tot_exp_pa_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_pa_hist_sc_plot <- tot_exp_pa_hist_sc_plot_aux +
  expand_limits(y=tot_exp_pa_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_pa_est_sc_vec[1], mean(tot_exp_pa_est_sc_vec[2:35])), xend = c(tot_exp_pa_est_sc_vec[1],mean(tot_exp_pa_est_sc_vec[2:35])), y = c(0,0), yend = c(tot_exp_pa_hist_sc_plot1_ylim,tot_exp_pa_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_pa_est_sc_vec[1], mean(tot_exp_pa_est_sc_vec[2:35])), y = c(tot_exp_pa_hist_sc_plot1_ylim,tot_exp_pa_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_pa_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_pa_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_pa_est_sdid_vec <- c(tot_exp_est_sdid_pa)
for (i in c(1:4,6:35)) {
  tot_exp_pa_est_sdid_vec_aux <- tot_exp_pa_est_sdid_list[[i]][1]
  tot_exp_pa_est_sdid_vec <- c(tot_exp_pa_est_sdid_vec,tot_exp_pa_est_sdid_vec_aux)
}
tot_exp_pa_est_sdid_df <- data.frame(tot_exp_pa_est_sdid_vec)
tot_exp_pa_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_pa_est_sdid_vec)) +
  geom_histogram(data = tot_exp_pa_est_sdid_df, aes(x = tot_exp_pa_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_pa_hist_sdid_plot1_ylim <- ggplot_build(tot_exp_pa_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_pa_hist_sdid_plot <- tot_exp_pa_hist_sdid_plot_aux +
  expand_limits(y=tot_exp_pa_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_pa_est_sdid_vec[1], mean(tot_exp_pa_est_sdid_vec[2:35])), xend = c(tot_exp_pa_est_sdid_vec[1],mean(tot_exp_pa_est_sdid_vec[2:35])), y = c(0,0), yend = c(tot_exp_pa_hist_sdid_plot1_ylim,tot_exp_pa_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_pa_est_sdid_vec[1], mean(tot_exp_pa_est_sdid_vec[2:35])), y = c(tot_exp_pa_hist_sdid_plot1_ylim,tot_exp_pa_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_pa_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_pa_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.7,.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/tot_exp_spag_dist_plots_PA.pdf', paper = "USr", width = 10.9, height = 8.4)
(tot_exp_pa_spag_dist_plots_PA <- tot_exp_pa_spag_did_plot + tot_exp_pa_spag_sc_plot + tot_exp_pa_spag_sdid_plot + tot_exp_pa_hist_did_plot + tot_exp_pa_hist_sc_plot + tot_exp_pa_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Medicaid Expenditure #####
### PA - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
med_exp_pa_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id !=11))
med_exp_pa_df$treated <- as.integer(ifelse(med_exp_pa_df$name == "Pennsylvania" & med_exp_pa_df$year >= 1996, 1, 0))
med_exp_pa_df <- med_exp_pa_df[order(med_exp_pa_df$year, med_exp_pa_df$treated_pa_aux, med_exp_pa_df$name),]
med_exp_pa_df <- subset(med_exp_pa_df, alwaysconpa == 1 | name == "Pennsylvania", select=c(name, year, medicaid_exp, treated))
setup_med_exp_pa <- panel.matrices(med_exp_pa_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
med_exp_est_did_pa <- did_estimate(setup_med_exp_pa$Y, setup_med_exp_pa$N0, setup_med_exp_pa$T0, X = covariates_exp_pa_array)
med_exp_est_did_plot_pa <- synthdid_plot(med_exp_est_did_pa)
med_exp_est_did_plot_data_aux_pa <- ggplot_build(med_exp_est_did_plot_pa)
med_exp_est_did_plot_data_long_pa <- data.frame(med_exp_est_did_plot_data_aux_pa$data[[1]]$x, med_exp_est_did_plot_data_aux_pa$data[[1]]$y, med_exp_est_did_plot_data_aux_pa$data[[1]]$group)
colnames(med_exp_est_did_plot_data_long_pa) <- c('year', 'outcome', 'treated')
med_exp_est_did_plot_data_long_pa$treated <- med_exp_est_did_plot_data_long_pa$treated - 1
med_exp_est_did_plot_data_wide_pa <- reshape(data=med_exp_est_did_plot_data_long_pa,
                                             idvar = "year",
                                             v.names = "outcome",
                                             timevar = "treated",
                                             direction = "wide")
med_exp_est_did_plot_data_wide_pa$diff <- med_exp_est_did_plot_data_wide_pa$outcome.1 - med_exp_est_did_plot_data_wide_pa$outcome.0
# SC #
med_exp_est_sc_pa <- sc_estimate(setup_med_exp_pa$Y, setup_med_exp_pa$N0, setup_med_exp_pa$T0, X = covariates_exp_pa_array)
med_exp_est_sc_plot_pa <- synthdid_plot(med_exp_est_sc_pa)
med_exp_est_sc_plot_data_aux_pa <- ggplot_build(med_exp_est_sc_plot_pa)
med_exp_est_sc_plot_data_long_pa <- data.frame(med_exp_est_sc_plot_data_aux_pa$data[[1]]$x, med_exp_est_sc_plot_data_aux_pa$data[[1]]$y, med_exp_est_sc_plot_data_aux_pa$data[[1]]$group)
colnames(med_exp_est_sc_plot_data_long_pa) <- c('year', 'outcome', 'treated')
med_exp_est_sc_plot_data_long_pa$treated <- med_exp_est_sc_plot_data_long_pa$treated - 1
med_exp_est_sc_plot_data_wide_pa <- reshape(data=med_exp_est_sc_plot_data_long_pa,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
med_exp_est_sc_plot_data_wide_pa$diff <- med_exp_est_sc_plot_data_wide_pa$outcome.1 - med_exp_est_sc_plot_data_wide_pa$outcome.0
# SDID #
med_exp_est_sdid_pa <- synthdid_estimate(setup_med_exp_pa$Y, setup_med_exp_pa$N0, setup_med_exp_pa$T0, X = covariates_exp_pa_array)
med_exp_est_sdid_plot_pa <- synthdid_plot(med_exp_est_sdid_pa)
med_exp_est_sdid_plot_data_aux_pa <- ggplot_build(med_exp_est_sdid_plot_pa)
med_exp_est_sdid_plot_data_long_pa <- data.frame(med_exp_est_sdid_plot_data_aux_pa$data[[1]]$x, med_exp_est_sdid_plot_data_aux_pa$data[[1]]$y, med_exp_est_sdid_plot_data_aux_pa$data[[1]]$group)
colnames(med_exp_est_sdid_plot_data_long_pa) <- c('year', 'outcome', 'treated')
med_exp_est_sdid_plot_data_long_pa$treated <- med_exp_est_sdid_plot_data_long_pa$treated - 1
med_exp_est_sdid_plot_data_wide_pa <- reshape(data=med_exp_est_sdid_plot_data_long_pa,
                                              idvar = "year",
                                              v.names = "outcome",
                                              timevar = "treated",
                                              direction = "wide")
med_exp_est_sdid_plot_data_wide_pa$diff <- med_exp_est_sdid_plot_data_wide_pa$outcome.1 - med_exp_est_sdid_plot_data_wide_pa$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("med_exp_pa_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
med_exp_pa_df1$treated_aux <- ifelse(med_exp_pa_df1$id == 1, 1, 0)
med_exp_pa_df2$treated_aux <- ifelse(med_exp_pa_df2$id == 2, 1, 0)
med_exp_pa_df5$treated_aux <- ifelse(med_exp_pa_df5$id == 5, 1, 0)
med_exp_pa_df10$treated_aux <- ifelse(med_exp_pa_df10$id == 10, 1, 0)
med_exp_pa_df11$treated_aux <- ifelse(med_exp_pa_df11$id == 11, 1, 0)
med_exp_pa_df12$treated_aux <- ifelse(med_exp_pa_df12$id == 12, 1, 0)
med_exp_pa_df13$treated_aux <- ifelse(med_exp_pa_df13$id == 13, 1, 0)
med_exp_pa_df15$treated_aux <- ifelse(med_exp_pa_df15$id == 15, 1, 0)
med_exp_pa_df17$treated_aux <- ifelse(med_exp_pa_df17$id == 17, 1, 0)
med_exp_pa_df19$treated_aux <- ifelse(med_exp_pa_df19$id == 19, 1, 0)
med_exp_pa_df21$treated_aux <- ifelse(med_exp_pa_df21$id == 21, 1, 0)
med_exp_pa_df23$treated_aux <- ifelse(med_exp_pa_df23$id == 23, 1, 0)
med_exp_pa_df24$treated_aux <- ifelse(med_exp_pa_df24$id == 24, 1, 0)
med_exp_pa_df25$treated_aux <- ifelse(med_exp_pa_df25$id == 25, 1, 0)
med_exp_pa_df26$treated_aux <- ifelse(med_exp_pa_df26$id == 26, 1, 0)
med_exp_pa_df28$treated_aux <- ifelse(med_exp_pa_df28$id == 28, 1, 0)
med_exp_pa_df29$treated_aux <- ifelse(med_exp_pa_df29$id == 29, 1, 0)
med_exp_pa_df30$treated_aux <- ifelse(med_exp_pa_df30$id == 30, 1, 0)
med_exp_pa_df31$treated_aux <- ifelse(med_exp_pa_df31$id == 31, 1, 0)
med_exp_pa_df32$treated_aux <- ifelse(med_exp_pa_df32$id == 32, 1, 0)
med_exp_pa_df33$treated_aux <- ifelse(med_exp_pa_df33$id == 33, 1, 0)
med_exp_pa_df34$treated_aux <- ifelse(med_exp_pa_df34$id == 34, 1, 0)
med_exp_pa_df36$treated_aux <- ifelse(med_exp_pa_df36$id == 36, 1, 0)
med_exp_pa_df37$treated_aux <- ifelse(med_exp_pa_df37$id == 37, 1, 0)
med_exp_pa_df39$treated_aux <- ifelse(med_exp_pa_df39$id == 39, 1, 0)
med_exp_pa_df40$treated_aux <- ifelse(med_exp_pa_df40$id == 40, 1, 0)
med_exp_pa_df41$treated_aux <- ifelse(med_exp_pa_df41$id == 41, 1, 0)
med_exp_pa_df44$treated_aux <- ifelse(med_exp_pa_df44$id == 44, 1, 0)
med_exp_pa_df45$treated_aux <- ifelse(med_exp_pa_df45$id == 45, 1, 0)
med_exp_pa_df47$treated_aux <- ifelse(med_exp_pa_df47$id == 47, 1, 0)
med_exp_pa_df50$treated_aux <- ifelse(med_exp_pa_df50$id == 50, 1, 0)
med_exp_pa_df51$treated_aux <- ifelse(med_exp_pa_df51$id == 51, 1, 0)
med_exp_pa_df53$treated_aux <- ifelse(med_exp_pa_df53$id == 53, 1, 0)
med_exp_pa_df54$treated_aux <- ifelse(med_exp_pa_df54$id == 54, 1, 0)
med_exp_pa_df55$treated_aux <- ifelse(med_exp_pa_df55$id == 55, 1, 0)
med_exp_pa_df1$treated <- as.integer(ifelse(med_exp_pa_df1$id == 1 & med_exp_pa_df1$year >= 1996, 1, 0))
med_exp_pa_df2$treated <- as.integer(ifelse(med_exp_pa_df2$id == 2 & med_exp_pa_df2$year >= 1996, 1, 0))
med_exp_pa_df5$treated <- as.integer(ifelse(med_exp_pa_df5$id == 5 & med_exp_pa_df5$year >= 1996, 1, 0))
med_exp_pa_df10$treated <- as.integer(ifelse(med_exp_pa_df10$id == 10 & med_exp_pa_df10$year >= 1996, 1, 0))
med_exp_pa_df11$treated <- as.integer(ifelse(med_exp_pa_df11$id == 11 & med_exp_pa_df11$year >= 1996, 1, 0))
med_exp_pa_df12$treated <- as.integer(ifelse(med_exp_pa_df12$id == 12 & med_exp_pa_df12$year >= 1996, 1, 0))
med_exp_pa_df13$treated <- as.integer(ifelse(med_exp_pa_df13$id == 13 & med_exp_pa_df13$year >= 1996, 1, 0))
med_exp_pa_df15$treated <- as.integer(ifelse(med_exp_pa_df15$id == 15 & med_exp_pa_df15$year >= 1996, 1, 0))
med_exp_pa_df17$treated <- as.integer(ifelse(med_exp_pa_df17$id == 17 & med_exp_pa_df17$year >= 1996, 1, 0))
med_exp_pa_df19$treated <- as.integer(ifelse(med_exp_pa_df19$id == 19 & med_exp_pa_df19$year >= 1996, 1, 0))
med_exp_pa_df21$treated <- as.integer(ifelse(med_exp_pa_df21$id == 21 & med_exp_pa_df21$year >= 1996, 1, 0))
med_exp_pa_df23$treated <- as.integer(ifelse(med_exp_pa_df23$id == 23 & med_exp_pa_df23$year >= 1996, 1, 0))
med_exp_pa_df24$treated <- as.integer(ifelse(med_exp_pa_df24$id == 24 & med_exp_pa_df24$year >= 1996, 1, 0))
med_exp_pa_df25$treated <- as.integer(ifelse(med_exp_pa_df25$id == 25 & med_exp_pa_df25$year >= 1996, 1, 0))
med_exp_pa_df26$treated <- as.integer(ifelse(med_exp_pa_df26$id == 26 & med_exp_pa_df26$year >= 1996, 1, 0))
med_exp_pa_df28$treated <- as.integer(ifelse(med_exp_pa_df28$id == 28 & med_exp_pa_df28$year >= 1996, 1, 0))
med_exp_pa_df29$treated <- as.integer(ifelse(med_exp_pa_df29$id == 29 & med_exp_pa_df29$year >= 1996, 1, 0))
med_exp_pa_df30$treated <- as.integer(ifelse(med_exp_pa_df30$id == 30 & med_exp_pa_df30$year >= 1996, 1, 0))
med_exp_pa_df31$treated <- as.integer(ifelse(med_exp_pa_df31$id == 31 & med_exp_pa_df31$year >= 1996, 1, 0))
med_exp_pa_df32$treated <- as.integer(ifelse(med_exp_pa_df32$id == 32 & med_exp_pa_df32$year >= 1996, 1, 0))
med_exp_pa_df33$treated <- as.integer(ifelse(med_exp_pa_df33$id == 33 & med_exp_pa_df33$year >= 1996, 1, 0))
med_exp_pa_df34$treated <- as.integer(ifelse(med_exp_pa_df34$id == 34 & med_exp_pa_df34$year >= 1996, 1, 0))
med_exp_pa_df36$treated <- as.integer(ifelse(med_exp_pa_df36$id == 36 & med_exp_pa_df36$year >= 1996, 1, 0))
med_exp_pa_df37$treated <- as.integer(ifelse(med_exp_pa_df37$id == 37 & med_exp_pa_df37$year >= 1996, 1, 0))
med_exp_pa_df39$treated <- as.integer(ifelse(med_exp_pa_df39$id == 39 & med_exp_pa_df39$year >= 1996, 1, 0))
med_exp_pa_df40$treated <- as.integer(ifelse(med_exp_pa_df40$id == 40 & med_exp_pa_df40$year >= 1996, 1, 0))
med_exp_pa_df41$treated <- as.integer(ifelse(med_exp_pa_df41$id == 41 & med_exp_pa_df41$year >= 1996, 1, 0))
med_exp_pa_df44$treated <- as.integer(ifelse(med_exp_pa_df44$id == 44 & med_exp_pa_df44$year >= 1996, 1, 0))
med_exp_pa_df45$treated <- as.integer(ifelse(med_exp_pa_df45$id == 45 & med_exp_pa_df45$year >= 1996, 1, 0))
med_exp_pa_df47$treated <- as.integer(ifelse(med_exp_pa_df47$id == 47 & med_exp_pa_df47$year >= 1996, 1, 0))
med_exp_pa_df50$treated <- as.integer(ifelse(med_exp_pa_df50$id == 50 & med_exp_pa_df50$year >= 1996, 1, 0))
med_exp_pa_df51$treated <- as.integer(ifelse(med_exp_pa_df51$id == 51 & med_exp_pa_df51$year >= 1996, 1, 0))
med_exp_pa_df53$treated <- as.integer(ifelse(med_exp_pa_df53$id == 53 & med_exp_pa_df53$year >= 1996, 1, 0))
med_exp_pa_df54$treated <- as.integer(ifelse(med_exp_pa_df54$id == 54 & med_exp_pa_df54$year >= 1996, 1, 0))
med_exp_pa_df55$treated <- as.integer(ifelse(med_exp_pa_df55$id == 55 & med_exp_pa_df55$year >= 1996, 1, 0))
med_exp_pa_df_list <- list(med_exp_pa_df1,med_exp_pa_df2,med_exp_pa_df5,
                           med_exp_pa_df10,med_exp_pa_df11,med_exp_pa_df12,
                           med_exp_pa_df13,med_exp_pa_df15,med_exp_pa_df17,
                           med_exp_pa_df19,med_exp_pa_df21,med_exp_pa_df23,
                           med_exp_pa_df24,med_exp_pa_df25,med_exp_pa_df26,
                           med_exp_pa_df28,med_exp_pa_df29,med_exp_pa_df30,
                           med_exp_pa_df31,med_exp_pa_df32,med_exp_pa_df33,
                           med_exp_pa_df34,med_exp_pa_df36,med_exp_pa_df37,
                           med_exp_pa_df39,med_exp_pa_df40,med_exp_pa_df41,
                           med_exp_pa_df44,med_exp_pa_df45,med_exp_pa_df47,
                           med_exp_pa_df50,med_exp_pa_df51,med_exp_pa_df53,
                           med_exp_pa_df54,med_exp_pa_df55)
rm(med_exp_pa_df1,med_exp_pa_df2,med_exp_pa_df5,
   med_exp_pa_df10,med_exp_pa_df11,med_exp_pa_df12,
   med_exp_pa_df13,med_exp_pa_df15,med_exp_pa_df17,
   med_exp_pa_df19,med_exp_pa_df21,med_exp_pa_df23,
   med_exp_pa_df24,med_exp_pa_df25,med_exp_pa_df26,
   med_exp_pa_df28,med_exp_pa_df29,med_exp_pa_df30,
   med_exp_pa_df31,med_exp_pa_df32,med_exp_pa_df33,
   med_exp_pa_df34,med_exp_pa_df36,med_exp_pa_df37,
   med_exp_pa_df39,med_exp_pa_df40,med_exp_pa_df41,
   med_exp_pa_df44,med_exp_pa_df45,med_exp_pa_df47,
   med_exp_pa_df50,med_exp_pa_df51,med_exp_pa_df53,
   med_exp_pa_df54,med_exp_pa_df55)
med_exp_pa_df_list <- lapply(med_exp_pa_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
med_exp_pa_df_list <- lapply(med_exp_pa_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, medicaid_exp, treated)))
}
)
setup_med_exp_pa1 <- panel.matrices(med_exp_pa_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa2 <- panel.matrices(med_exp_pa_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa5 <- panel.matrices(med_exp_pa_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa10 <- panel.matrices(med_exp_pa_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa11 <- panel.matrices(med_exp_pa_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa12 <- panel.matrices(med_exp_pa_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa13 <- panel.matrices(med_exp_pa_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa15 <- panel.matrices(med_exp_pa_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa17 <- panel.matrices(med_exp_pa_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa19 <- panel.matrices(med_exp_pa_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa21 <- panel.matrices(med_exp_pa_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa23 <- panel.matrices(med_exp_pa_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa24 <- panel.matrices(med_exp_pa_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa25 <- panel.matrices(med_exp_pa_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa26 <- panel.matrices(med_exp_pa_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa28 <- panel.matrices(med_exp_pa_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa29 <- panel.matrices(med_exp_pa_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa30 <- panel.matrices(med_exp_pa_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa31 <- panel.matrices(med_exp_pa_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa32 <- panel.matrices(med_exp_pa_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa33 <- panel.matrices(med_exp_pa_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa34 <- panel.matrices(med_exp_pa_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa36 <- panel.matrices(med_exp_pa_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa37 <- panel.matrices(med_exp_pa_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa39 <- panel.matrices(med_exp_pa_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa40 <- panel.matrices(med_exp_pa_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa41 <- panel.matrices(med_exp_pa_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa44 <- panel.matrices(med_exp_pa_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa45 <- panel.matrices(med_exp_pa_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa47 <- panel.matrices(med_exp_pa_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa50 <- panel.matrices(med_exp_pa_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa51 <- panel.matrices(med_exp_pa_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa53 <- panel.matrices(med_exp_pa_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa54 <- panel.matrices(med_exp_pa_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa55 <- panel.matrices(med_exp_pa_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_pa_list <- list(setup_med_exp_pa1,setup_med_exp_pa2,setup_med_exp_pa5,
                              setup_med_exp_pa10,setup_med_exp_pa11,setup_med_exp_pa12,
                              setup_med_exp_pa13,setup_med_exp_pa15,setup_med_exp_pa17,
                              setup_med_exp_pa19,setup_med_exp_pa21,setup_med_exp_pa23,
                              setup_med_exp_pa24,setup_med_exp_pa25,setup_med_exp_pa26,
                              setup_med_exp_pa28,setup_med_exp_pa29,setup_med_exp_pa30,
                              setup_med_exp_pa31,setup_med_exp_pa32,setup_med_exp_pa33,
                              setup_med_exp_pa34,setup_med_exp_pa36,setup_med_exp_pa37,
                              setup_med_exp_pa39,setup_med_exp_pa40,setup_med_exp_pa41,
                              setup_med_exp_pa44,setup_med_exp_pa45,setup_med_exp_pa47,
                              setup_med_exp_pa50,setup_med_exp_pa51,setup_med_exp_pa53,
                              setup_med_exp_pa54,setup_med_exp_pa55)
rm(setup_med_exp_pa1,setup_med_exp_pa2,setup_med_exp_pa5,
   setup_med_exp_pa10,setup_med_exp_pa11,setup_med_exp_pa12,
   setup_med_exp_pa13,setup_med_exp_pa15,setup_med_exp_pa17,
   setup_med_exp_pa19,setup_med_exp_pa21,setup_med_exp_pa23,
   setup_med_exp_pa24,setup_med_exp_pa25,setup_med_exp_pa26,
   setup_med_exp_pa28,setup_med_exp_pa29,setup_med_exp_pa30,
   setup_med_exp_pa31,setup_med_exp_pa32,setup_med_exp_pa33,
   setup_med_exp_pa34,setup_med_exp_pa36,setup_med_exp_pa37,
   setup_med_exp_pa39,setup_med_exp_pa40,setup_med_exp_pa41,
   setup_med_exp_pa44,setup_med_exp_pa45,setup_med_exp_pa47,
   setup_med_exp_pa50,setup_med_exp_pa51,setup_med_exp_pa53,
   setup_med_exp_pa54,setup_med_exp_pa55)
# DID #
med_exp_pa_est_did1 <- did_estimate(setup_med_exp_pa_list[[1]]$Y, setup_med_exp_pa_list[[1]]$N0, setup_med_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_pa_est_did2 <- did_estimate(setup_med_exp_pa_list[[2]]$Y, setup_med_exp_pa_list[[2]]$N0, setup_med_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_pa_est_did5 <- did_estimate(setup_med_exp_pa_list[[3]]$Y, setup_med_exp_pa_list[[3]]$N0, setup_med_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_pa_est_did10 <- did_estimate(setup_med_exp_pa_list[[4]]$Y, setup_med_exp_pa_list[[4]]$N0, setup_med_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_pa_est_did11 <- did_estimate(setup_med_exp_pa_list[[5]]$Y, setup_med_exp_pa_list[[5]]$N0, setup_med_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_pa_est_did12 <- did_estimate(setup_med_exp_pa_list[[6]]$Y, setup_med_exp_pa_list[[6]]$N0, setup_med_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_pa_est_did13 <- did_estimate(setup_med_exp_pa_list[[7]]$Y, setup_med_exp_pa_list[[7]]$N0, setup_med_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_pa_est_did15 <- did_estimate(setup_med_exp_pa_list[[8]]$Y, setup_med_exp_pa_list[[8]]$N0, setup_med_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_pa_est_did17 <- did_estimate(setup_med_exp_pa_list[[9]]$Y, setup_med_exp_pa_list[[9]]$N0, setup_med_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_pa_est_did19 <- did_estimate(setup_med_exp_pa_list[[10]]$Y, setup_med_exp_pa_list[[10]]$N0, setup_med_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_pa_est_did21 <- did_estimate(setup_med_exp_pa_list[[11]]$Y, setup_med_exp_pa_list[[11]]$N0, setup_med_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_pa_est_did23 <- did_estimate(setup_med_exp_pa_list[[12]]$Y, setup_med_exp_pa_list[[12]]$N0, setup_med_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_pa_est_did24 <- did_estimate(setup_med_exp_pa_list[[13]]$Y, setup_med_exp_pa_list[[13]]$N0, setup_med_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_pa_est_did25 <- did_estimate(setup_med_exp_pa_list[[14]]$Y, setup_med_exp_pa_list[[14]]$N0, setup_med_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_pa_est_did26 <- did_estimate(setup_med_exp_pa_list[[15]]$Y, setup_med_exp_pa_list[[15]]$N0, setup_med_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_pa_est_did28 <- did_estimate(setup_med_exp_pa_list[[16]]$Y, setup_med_exp_pa_list[[16]]$N0, setup_med_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_pa_est_did29 <- did_estimate(setup_med_exp_pa_list[[17]]$Y, setup_med_exp_pa_list[[17]]$N0, setup_med_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_pa_est_did30 <- did_estimate(setup_med_exp_pa_list[[18]]$Y, setup_med_exp_pa_list[[18]]$N0, setup_med_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_pa_est_did31 <- did_estimate(setup_med_exp_pa_list[[19]]$Y, setup_med_exp_pa_list[[19]]$N0, setup_med_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_pa_est_did32 <- did_estimate(setup_med_exp_pa_list[[20]]$Y, setup_med_exp_pa_list[[20]]$N0, setup_med_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_pa_est_did33 <- did_estimate(setup_med_exp_pa_list[[21]]$Y, setup_med_exp_pa_list[[21]]$N0, setup_med_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_pa_est_did34 <- did_estimate(setup_med_exp_pa_list[[22]]$Y, setup_med_exp_pa_list[[22]]$N0, setup_med_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_pa_est_did36 <- did_estimate(setup_med_exp_pa_list[[23]]$Y, setup_med_exp_pa_list[[23]]$N0, setup_med_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_pa_est_did37 <- did_estimate(setup_med_exp_pa_list[[24]]$Y, setup_med_exp_pa_list[[24]]$N0, setup_med_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_pa_est_did39 <- did_estimate(setup_med_exp_pa_list[[25]]$Y, setup_med_exp_pa_list[[25]]$N0, setup_med_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_pa_est_did40 <- did_estimate(setup_med_exp_pa_list[[26]]$Y, setup_med_exp_pa_list[[26]]$N0, setup_med_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_pa_est_did41 <- did_estimate(setup_med_exp_pa_list[[27]]$Y, setup_med_exp_pa_list[[27]]$N0, setup_med_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_pa_est_did44 <- did_estimate(setup_med_exp_pa_list[[28]]$Y, setup_med_exp_pa_list[[28]]$N0, setup_med_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_pa_est_did45 <- did_estimate(setup_med_exp_pa_list[[29]]$Y, setup_med_exp_pa_list[[29]]$N0, setup_med_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_pa_est_did47 <- did_estimate(setup_med_exp_pa_list[[30]]$Y, setup_med_exp_pa_list[[30]]$N0, setup_med_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_pa_est_did50 <- did_estimate(setup_med_exp_pa_list[[31]]$Y, setup_med_exp_pa_list[[31]]$N0, setup_med_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_pa_est_did51 <- did_estimate(setup_med_exp_pa_list[[32]]$Y, setup_med_exp_pa_list[[32]]$N0, setup_med_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_pa_est_did53 <- did_estimate(setup_med_exp_pa_list[[33]]$Y, setup_med_exp_pa_list[[33]]$N0, setup_med_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_pa_est_did54 <- did_estimate(setup_med_exp_pa_list[[34]]$Y, setup_med_exp_pa_list[[34]]$N0, setup_med_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_pa_est_did55 <- did_estimate(setup_med_exp_pa_list[[35]]$Y, setup_med_exp_pa_list[[35]]$N0, setup_med_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_pa_est_did_list <- list(med_exp_pa_est_did1,med_exp_pa_est_did2,med_exp_pa_est_did5,
                                med_exp_pa_est_did10,med_exp_pa_est_did11,med_exp_pa_est_did12,
                                med_exp_pa_est_did13,med_exp_pa_est_did15,med_exp_pa_est_did17,
                                med_exp_pa_est_did19,med_exp_pa_est_did21,med_exp_pa_est_did23,
                                med_exp_pa_est_did24,med_exp_pa_est_did25,med_exp_pa_est_did26,
                                med_exp_pa_est_did28,med_exp_pa_est_did29,med_exp_pa_est_did30,
                                med_exp_pa_est_did31,med_exp_pa_est_did32,med_exp_pa_est_did33,
                                med_exp_pa_est_did34,med_exp_pa_est_did36,med_exp_pa_est_did37,
                                med_exp_pa_est_did39,med_exp_pa_est_did40,med_exp_pa_est_did41,
                                med_exp_pa_est_did44,med_exp_pa_est_did45,med_exp_pa_est_did47,
                                med_exp_pa_est_did50,med_exp_pa_est_did51,med_exp_pa_est_did53,
                                med_exp_pa_est_did54,med_exp_pa_est_did55)
rm(med_exp_pa_est_did1,med_exp_pa_est_did2,med_exp_pa_est_did5,
   med_exp_pa_est_did10,med_exp_pa_est_did11,med_exp_pa_est_did12,
   med_exp_pa_est_did13,med_exp_pa_est_did15,med_exp_pa_est_did17,
   med_exp_pa_est_did19,med_exp_pa_est_did21,med_exp_pa_est_did23,
   med_exp_pa_est_did24,med_exp_pa_est_did25,med_exp_pa_est_did26,
   med_exp_pa_est_did28,med_exp_pa_est_did29,med_exp_pa_est_did30,
   med_exp_pa_est_did31,med_exp_pa_est_did32,med_exp_pa_est_did33,
   med_exp_pa_est_did34,med_exp_pa_est_did36,med_exp_pa_est_did37,
   med_exp_pa_est_did39,med_exp_pa_est_did40,med_exp_pa_est_did41,
   med_exp_pa_est_did44,med_exp_pa_est_did45,med_exp_pa_est_did47,
   med_exp_pa_est_did50,med_exp_pa_est_did51,med_exp_pa_est_did53,
   med_exp_pa_est_did54,med_exp_pa_est_did55)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_did_plot", i), synthdid_plot(med_exp_pa_est_did_list[i]))
}
med_exp_pa_est_did_plot_data_aux1 <- ggplot_build(med_exp_pa_est_did_plot1)
med_exp_pa_est_did_plot_data_aux2 <- ggplot_build(med_exp_pa_est_did_plot2)
med_exp_pa_est_did_plot_data_aux3 <- ggplot_build(med_exp_pa_est_did_plot3)
med_exp_pa_est_did_plot_data_aux4 <- ggplot_build(med_exp_pa_est_did_plot4)
med_exp_pa_est_did_plot_data_aux5 <- ggplot_build(med_exp_pa_est_did_plot5)
med_exp_pa_est_did_plot_data_aux6 <- ggplot_build(med_exp_pa_est_did_plot6)
med_exp_pa_est_did_plot_data_aux7 <- ggplot_build(med_exp_pa_est_did_plot7)
med_exp_pa_est_did_plot_data_aux8 <- ggplot_build(med_exp_pa_est_did_plot8)
med_exp_pa_est_did_plot_data_aux9 <- ggplot_build(med_exp_pa_est_did_plot9)
med_exp_pa_est_did_plot_data_aux10 <- ggplot_build(med_exp_pa_est_did_plot10)
med_exp_pa_est_did_plot_data_aux11 <- ggplot_build(med_exp_pa_est_did_plot11)
med_exp_pa_est_did_plot_data_aux12 <- ggplot_build(med_exp_pa_est_did_plot12)
med_exp_pa_est_did_plot_data_aux13 <- ggplot_build(med_exp_pa_est_did_plot13)
med_exp_pa_est_did_plot_data_aux14 <- ggplot_build(med_exp_pa_est_did_plot14)
med_exp_pa_est_did_plot_data_aux15 <- ggplot_build(med_exp_pa_est_did_plot15)
med_exp_pa_est_did_plot_data_aux16 <- ggplot_build(med_exp_pa_est_did_plot16)
med_exp_pa_est_did_plot_data_aux17 <- ggplot_build(med_exp_pa_est_did_plot17)
med_exp_pa_est_did_plot_data_aux18 <- ggplot_build(med_exp_pa_est_did_plot18)
med_exp_pa_est_did_plot_data_aux19 <- ggplot_build(med_exp_pa_est_did_plot19)
med_exp_pa_est_did_plot_data_aux20 <- ggplot_build(med_exp_pa_est_did_plot20)
med_exp_pa_est_did_plot_data_aux21 <- ggplot_build(med_exp_pa_est_did_plot21)
med_exp_pa_est_did_plot_data_aux22 <- ggplot_build(med_exp_pa_est_did_plot22)
med_exp_pa_est_did_plot_data_aux23 <- ggplot_build(med_exp_pa_est_did_plot23)
med_exp_pa_est_did_plot_data_aux24 <- ggplot_build(med_exp_pa_est_did_plot24)
med_exp_pa_est_did_plot_data_aux25 <- ggplot_build(med_exp_pa_est_did_plot25)
med_exp_pa_est_did_plot_data_aux26 <- ggplot_build(med_exp_pa_est_did_plot26)
med_exp_pa_est_did_plot_data_aux27 <- ggplot_build(med_exp_pa_est_did_plot27)
med_exp_pa_est_did_plot_data_aux28 <- ggplot_build(med_exp_pa_est_did_plot28)
med_exp_pa_est_did_plot_data_aux29 <- ggplot_build(med_exp_pa_est_did_plot29)
med_exp_pa_est_did_plot_data_aux30 <- ggplot_build(med_exp_pa_est_did_plot30)
med_exp_pa_est_did_plot_data_aux31 <- ggplot_build(med_exp_pa_est_did_plot31)
med_exp_pa_est_did_plot_data_aux32 <- ggplot_build(med_exp_pa_est_did_plot32)
med_exp_pa_est_did_plot_data_aux33 <- ggplot_build(med_exp_pa_est_did_plot33)
med_exp_pa_est_did_plot_data_aux34 <- ggplot_build(med_exp_pa_est_did_plot34)
med_exp_pa_est_did_plot_data_aux35 <- ggplot_build(med_exp_pa_est_did_plot35)
med_exp_pa_est_did_plot_data_aux_list <- list(med_exp_pa_est_did_plot_data_aux1,med_exp_pa_est_did_plot_data_aux2,med_exp_pa_est_did_plot_data_aux3,
                                              med_exp_pa_est_did_plot_data_aux4,med_exp_pa_est_did_plot_data_aux5,med_exp_pa_est_did_plot_data_aux6,
                                              med_exp_pa_est_did_plot_data_aux7,med_exp_pa_est_did_plot_data_aux8,med_exp_pa_est_did_plot_data_aux9,
                                              med_exp_pa_est_did_plot_data_aux10,med_exp_pa_est_did_plot_data_aux11,med_exp_pa_est_did_plot_data_aux12,
                                              med_exp_pa_est_did_plot_data_aux13,med_exp_pa_est_did_plot_data_aux14,med_exp_pa_est_did_plot_data_aux15,
                                              med_exp_pa_est_did_plot_data_aux16,med_exp_pa_est_did_plot_data_aux17,med_exp_pa_est_did_plot_data_aux18,
                                              med_exp_pa_est_did_plot_data_aux19,med_exp_pa_est_did_plot_data_aux20,med_exp_pa_est_did_plot_data_aux21,
                                              med_exp_pa_est_did_plot_data_aux22,med_exp_pa_est_did_plot_data_aux23,med_exp_pa_est_did_plot_data_aux24,
                                              med_exp_pa_est_did_plot_data_aux25,med_exp_pa_est_did_plot_data_aux26,med_exp_pa_est_did_plot_data_aux27,
                                              med_exp_pa_est_did_plot_data_aux28,med_exp_pa_est_did_plot_data_aux29,med_exp_pa_est_did_plot_data_aux30,
                                              med_exp_pa_est_did_plot_data_aux31,med_exp_pa_est_did_plot_data_aux32,med_exp_pa_est_did_plot_data_aux33,
                                              med_exp_pa_est_did_plot_data_aux34,med_exp_pa_est_did_plot_data_aux35)
rm(med_exp_pa_est_did_plot_data_aux1,med_exp_pa_est_did_plot_data_aux2,med_exp_pa_est_did_plot_data_aux3,
   med_exp_pa_est_did_plot_data_aux4,med_exp_pa_est_did_plot_data_aux5,med_exp_pa_est_did_plot_data_aux6,
   med_exp_pa_est_did_plot_data_aux7,med_exp_pa_est_did_plot_data_aux8,med_exp_pa_est_did_plot_data_aux9,
   med_exp_pa_est_did_plot_data_aux10,med_exp_pa_est_did_plot_data_aux11,med_exp_pa_est_did_plot_data_aux12,
   med_exp_pa_est_did_plot_data_aux13,med_exp_pa_est_did_plot_data_aux14,med_exp_pa_est_did_plot_data_aux15,
   med_exp_pa_est_did_plot_data_aux16,med_exp_pa_est_did_plot_data_aux17,med_exp_pa_est_did_plot_data_aux18,
   med_exp_pa_est_did_plot_data_aux19,med_exp_pa_est_did_plot_data_aux20,med_exp_pa_est_did_plot_data_aux21,
   med_exp_pa_est_did_plot_data_aux22,med_exp_pa_est_did_plot_data_aux23,med_exp_pa_est_did_plot_data_aux24,
   med_exp_pa_est_did_plot_data_aux25,med_exp_pa_est_did_plot_data_aux26,med_exp_pa_est_did_plot_data_aux27,
   med_exp_pa_est_did_plot_data_aux28,med_exp_pa_est_did_plot_data_aux29,med_exp_pa_est_did_plot_data_aux30,
   med_exp_pa_est_did_plot_data_aux31,med_exp_pa_est_did_plot_data_aux32,med_exp_pa_est_did_plot_data_aux33,
   med_exp_pa_est_did_plot_data_aux34,med_exp_pa_est_did_plot_data_aux35)
rm(med_exp_pa_est_did_plot1,med_exp_pa_est_did_plot2,med_exp_pa_est_did_plot3,
   med_exp_pa_est_did_plot4,med_exp_pa_est_did_plot5,med_exp_pa_est_did_plot6,
   med_exp_pa_est_did_plot7,med_exp_pa_est_did_plot8,med_exp_pa_est_did_plot9,
   med_exp_pa_est_did_plot10,med_exp_pa_est_did_plot11,med_exp_pa_est_did_plot12,
   med_exp_pa_est_did_plot13,med_exp_pa_est_did_plot14,med_exp_pa_est_did_plot15,
   med_exp_pa_est_did_plot16,med_exp_pa_est_did_plot17,med_exp_pa_est_did_plot18,
   med_exp_pa_est_did_plot19,med_exp_pa_est_did_plot20,med_exp_pa_est_did_plot21,
   med_exp_pa_est_did_plot22,med_exp_pa_est_did_plot23,med_exp_pa_est_did_plot24,
   med_exp_pa_est_did_plot25,med_exp_pa_est_did_plot26,med_exp_pa_est_did_plot27,
   med_exp_pa_est_did_plot28,med_exp_pa_est_did_plot29,med_exp_pa_est_did_plot30,
   med_exp_pa_est_did_plot31,med_exp_pa_est_did_plot32,med_exp_pa_est_did_plot33,
   med_exp_pa_est_did_plot34,med_exp_pa_est_did_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_did_plot_data_long", i), data.frame(med_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_pa_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_pa_est_did_plot_data_long_list <- list(med_exp_pa_est_did_plot_data_long1,med_exp_pa_est_did_plot_data_long2,med_exp_pa_est_did_plot_data_long3,
                                               med_exp_pa_est_did_plot_data_long4,med_exp_pa_est_did_plot_data_long5,med_exp_pa_est_did_plot_data_long6,
                                               med_exp_pa_est_did_plot_data_long7,med_exp_pa_est_did_plot_data_long8,med_exp_pa_est_did_plot_data_long9,
                                               med_exp_pa_est_did_plot_data_long10,med_exp_pa_est_did_plot_data_long11,med_exp_pa_est_did_plot_data_long12,
                                               med_exp_pa_est_did_plot_data_long13,med_exp_pa_est_did_plot_data_long14,med_exp_pa_est_did_plot_data_long15,
                                               med_exp_pa_est_did_plot_data_long16,med_exp_pa_est_did_plot_data_long17,med_exp_pa_est_did_plot_data_long18,
                                               med_exp_pa_est_did_plot_data_long19,med_exp_pa_est_did_plot_data_long20,med_exp_pa_est_did_plot_data_long21,
                                               med_exp_pa_est_did_plot_data_long22,med_exp_pa_est_did_plot_data_long23,med_exp_pa_est_did_plot_data_long24,
                                               med_exp_pa_est_did_plot_data_long25,med_exp_pa_est_did_plot_data_long26,med_exp_pa_est_did_plot_data_long27,
                                               med_exp_pa_est_did_plot_data_long28,med_exp_pa_est_did_plot_data_long29,med_exp_pa_est_did_plot_data_long30,
                                               med_exp_pa_est_did_plot_data_long31,med_exp_pa_est_did_plot_data_long32,med_exp_pa_est_did_plot_data_long33,
                                               med_exp_pa_est_did_plot_data_long34,med_exp_pa_est_did_plot_data_long35)
rm(med_exp_pa_est_did_plot_data_long1,med_exp_pa_est_did_plot_data_long2,med_exp_pa_est_did_plot_data_long3,
   med_exp_pa_est_did_plot_data_long4,med_exp_pa_est_did_plot_data_long5,med_exp_pa_est_did_plot_data_long6,
   med_exp_pa_est_did_plot_data_long7,med_exp_pa_est_did_plot_data_long8,med_exp_pa_est_did_plot_data_long9,
   med_exp_pa_est_did_plot_data_long10,med_exp_pa_est_did_plot_data_long11,med_exp_pa_est_did_plot_data_long12,
   med_exp_pa_est_did_plot_data_long13,med_exp_pa_est_did_plot_data_long14,med_exp_pa_est_did_plot_data_long15,
   med_exp_pa_est_did_plot_data_long16,med_exp_pa_est_did_plot_data_long17,med_exp_pa_est_did_plot_data_long18,
   med_exp_pa_est_did_plot_data_long19,med_exp_pa_est_did_plot_data_long20,med_exp_pa_est_did_plot_data_long21,
   med_exp_pa_est_did_plot_data_long22,med_exp_pa_est_did_plot_data_long23,med_exp_pa_est_did_plot_data_long24,
   med_exp_pa_est_did_plot_data_long25,med_exp_pa_est_did_plot_data_long26,med_exp_pa_est_did_plot_data_long27,
   med_exp_pa_est_did_plot_data_long28,med_exp_pa_est_did_plot_data_long29,med_exp_pa_est_did_plot_data_long30,
   med_exp_pa_est_did_plot_data_long31,med_exp_pa_est_did_plot_data_long32,med_exp_pa_est_did_plot_data_long33,
   med_exp_pa_est_did_plot_data_long34,med_exp_pa_est_did_plot_data_long35)
med_exp_pa_est_did_plot_data_long_list <- lapply(med_exp_pa_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_did_plot_data_wide", i), reshape(data=med_exp_pa_est_did_plot_data_long_list[[i]],
                                                                 idvar = "year",
                                                                 v.names = "outcome",
                                                                 timevar = "treated",
                                                                 direction = "wide"))
}
med_exp_pa_est_did_plot_data_wide_list <- list(med_exp_pa_est_did_plot_data_wide1,med_exp_pa_est_did_plot_data_wide2,med_exp_pa_est_did_plot_data_wide3,
                                               med_exp_pa_est_did_plot_data_wide4,med_exp_pa_est_did_plot_data_wide5,med_exp_pa_est_did_plot_data_wide6,
                                               med_exp_pa_est_did_plot_data_wide7,med_exp_pa_est_did_plot_data_wide8,med_exp_pa_est_did_plot_data_wide9,
                                               med_exp_pa_est_did_plot_data_wide10,med_exp_pa_est_did_plot_data_wide11,med_exp_pa_est_did_plot_data_wide12,
                                               med_exp_pa_est_did_plot_data_wide13,med_exp_pa_est_did_plot_data_wide14,med_exp_pa_est_did_plot_data_wide15,
                                               med_exp_pa_est_did_plot_data_wide16,med_exp_pa_est_did_plot_data_wide17,med_exp_pa_est_did_plot_data_wide18,
                                               med_exp_pa_est_did_plot_data_wide19,med_exp_pa_est_did_plot_data_wide20,med_exp_pa_est_did_plot_data_wide21,
                                               med_exp_pa_est_did_plot_data_wide22,med_exp_pa_est_did_plot_data_wide23,med_exp_pa_est_did_plot_data_wide24,
                                               med_exp_pa_est_did_plot_data_wide25,med_exp_pa_est_did_plot_data_wide26,med_exp_pa_est_did_plot_data_wide27,
                                               med_exp_pa_est_did_plot_data_wide28,med_exp_pa_est_did_plot_data_wide29,med_exp_pa_est_did_plot_data_wide30,
                                               med_exp_pa_est_did_plot_data_wide31,med_exp_pa_est_did_plot_data_wide32,med_exp_pa_est_did_plot_data_wide33,
                                               med_exp_pa_est_did_plot_data_wide34,med_exp_pa_est_did_plot_data_wide35)
rm(med_exp_pa_est_did_plot_data_wide1,med_exp_pa_est_did_plot_data_wide2,med_exp_pa_est_did_plot_data_wide3,
   med_exp_pa_est_did_plot_data_wide4,med_exp_pa_est_did_plot_data_wide5,med_exp_pa_est_did_plot_data_wide6,
   med_exp_pa_est_did_plot_data_wide7,med_exp_pa_est_did_plot_data_wide8,med_exp_pa_est_did_plot_data_wide9,
   med_exp_pa_est_did_plot_data_wide10,med_exp_pa_est_did_plot_data_wide11,med_exp_pa_est_did_plot_data_wide12,
   med_exp_pa_est_did_plot_data_wide13,med_exp_pa_est_did_plot_data_wide14,med_exp_pa_est_did_plot_data_wide15,
   med_exp_pa_est_did_plot_data_wide16,med_exp_pa_est_did_plot_data_wide17,med_exp_pa_est_did_plot_data_wide18,
   med_exp_pa_est_did_plot_data_wide19,med_exp_pa_est_did_plot_data_wide20,med_exp_pa_est_did_plot_data_wide21,
   med_exp_pa_est_did_plot_data_wide22,med_exp_pa_est_did_plot_data_wide23,med_exp_pa_est_did_plot_data_wide24,
   med_exp_pa_est_did_plot_data_wide25,med_exp_pa_est_did_plot_data_wide26,med_exp_pa_est_did_plot_data_wide27,
   med_exp_pa_est_did_plot_data_wide28,med_exp_pa_est_did_plot_data_wide29,med_exp_pa_est_did_plot_data_wide30,
   med_exp_pa_est_did_plot_data_wide31,med_exp_pa_est_did_plot_data_wide32,med_exp_pa_est_did_plot_data_wide33,
   med_exp_pa_est_did_plot_data_wide34,med_exp_pa_est_did_plot_data_wide35)
med_exp_pa_est_did_plot_data_wide_list <- lapply(med_exp_pa_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
med_exp_pa_est_sc1 <- sc_estimate(setup_med_exp_pa_list[[1]]$Y, setup_med_exp_pa_list[[1]]$N0, setup_med_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_pa_est_sc2 <- sc_estimate(setup_med_exp_pa_list[[2]]$Y, setup_med_exp_pa_list[[2]]$N0, setup_med_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_pa_est_sc5 <- sc_estimate(setup_med_exp_pa_list[[3]]$Y, setup_med_exp_pa_list[[3]]$N0, setup_med_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_pa_est_sc10 <- sc_estimate(setup_med_exp_pa_list[[4]]$Y, setup_med_exp_pa_list[[4]]$N0, setup_med_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_pa_est_sc11 <- sc_estimate(setup_med_exp_pa_list[[5]]$Y, setup_med_exp_pa_list[[5]]$N0, setup_med_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_pa_est_sc12 <- sc_estimate(setup_med_exp_pa_list[[6]]$Y, setup_med_exp_pa_list[[6]]$N0, setup_med_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_pa_est_sc13 <- sc_estimate(setup_med_exp_pa_list[[7]]$Y, setup_med_exp_pa_list[[7]]$N0, setup_med_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_pa_est_sc15 <- sc_estimate(setup_med_exp_pa_list[[8]]$Y, setup_med_exp_pa_list[[8]]$N0, setup_med_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_pa_est_sc17 <- sc_estimate(setup_med_exp_pa_list[[9]]$Y, setup_med_exp_pa_list[[9]]$N0, setup_med_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_pa_est_sc19 <- sc_estimate(setup_med_exp_pa_list[[10]]$Y, setup_med_exp_pa_list[[10]]$N0, setup_med_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_pa_est_sc21 <- sc_estimate(setup_med_exp_pa_list[[11]]$Y, setup_med_exp_pa_list[[11]]$N0, setup_med_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_pa_est_sc23 <- sc_estimate(setup_med_exp_pa_list[[12]]$Y, setup_med_exp_pa_list[[12]]$N0, setup_med_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_pa_est_sc24 <- sc_estimate(setup_med_exp_pa_list[[13]]$Y, setup_med_exp_pa_list[[13]]$N0, setup_med_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_pa_est_sc25 <- sc_estimate(setup_med_exp_pa_list[[14]]$Y, setup_med_exp_pa_list[[14]]$N0, setup_med_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_pa_est_sc26 <- sc_estimate(setup_med_exp_pa_list[[15]]$Y, setup_med_exp_pa_list[[15]]$N0, setup_med_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_pa_est_sc28 <- sc_estimate(setup_med_exp_pa_list[[16]]$Y, setup_med_exp_pa_list[[16]]$N0, setup_med_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_pa_est_sc29 <- sc_estimate(setup_med_exp_pa_list[[17]]$Y, setup_med_exp_pa_list[[17]]$N0, setup_med_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_pa_est_sc30 <- sc_estimate(setup_med_exp_pa_list[[18]]$Y, setup_med_exp_pa_list[[18]]$N0, setup_med_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_pa_est_sc31 <- sc_estimate(setup_med_exp_pa_list[[19]]$Y, setup_med_exp_pa_list[[19]]$N0, setup_med_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_pa_est_sc32 <- sc_estimate(setup_med_exp_pa_list[[20]]$Y, setup_med_exp_pa_list[[20]]$N0, setup_med_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_pa_est_sc33 <- sc_estimate(setup_med_exp_pa_list[[21]]$Y, setup_med_exp_pa_list[[21]]$N0, setup_med_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_pa_est_sc34 <- sc_estimate(setup_med_exp_pa_list[[22]]$Y, setup_med_exp_pa_list[[22]]$N0, setup_med_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_pa_est_sc36 <- sc_estimate(setup_med_exp_pa_list[[23]]$Y, setup_med_exp_pa_list[[23]]$N0, setup_med_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_pa_est_sc37 <- sc_estimate(setup_med_exp_pa_list[[24]]$Y, setup_med_exp_pa_list[[24]]$N0, setup_med_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_pa_est_sc39 <- sc_estimate(setup_med_exp_pa_list[[25]]$Y, setup_med_exp_pa_list[[25]]$N0, setup_med_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_pa_est_sc40 <- sc_estimate(setup_med_exp_pa_list[[26]]$Y, setup_med_exp_pa_list[[26]]$N0, setup_med_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_pa_est_sc41 <- sc_estimate(setup_med_exp_pa_list[[27]]$Y, setup_med_exp_pa_list[[27]]$N0, setup_med_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_pa_est_sc44 <- sc_estimate(setup_med_exp_pa_list[[28]]$Y, setup_med_exp_pa_list[[28]]$N0, setup_med_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_pa_est_sc45 <- sc_estimate(setup_med_exp_pa_list[[29]]$Y, setup_med_exp_pa_list[[29]]$N0, setup_med_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_pa_est_sc47 <- sc_estimate(setup_med_exp_pa_list[[30]]$Y, setup_med_exp_pa_list[[30]]$N0, setup_med_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_pa_est_sc50 <- sc_estimate(setup_med_exp_pa_list[[31]]$Y, setup_med_exp_pa_list[[31]]$N0, setup_med_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_pa_est_sc51 <- sc_estimate(setup_med_exp_pa_list[[32]]$Y, setup_med_exp_pa_list[[32]]$N0, setup_med_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_pa_est_sc53 <- sc_estimate(setup_med_exp_pa_list[[33]]$Y, setup_med_exp_pa_list[[33]]$N0, setup_med_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_pa_est_sc54 <- sc_estimate(setup_med_exp_pa_list[[34]]$Y, setup_med_exp_pa_list[[34]]$N0, setup_med_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_pa_est_sc55 <- sc_estimate(setup_med_exp_pa_list[[35]]$Y, setup_med_exp_pa_list[[35]]$N0, setup_med_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_pa_est_sc_list <- list(med_exp_pa_est_sc1,med_exp_pa_est_sc2,med_exp_pa_est_sc5,
                               med_exp_pa_est_sc10,med_exp_pa_est_sc11,med_exp_pa_est_sc12,
                               med_exp_pa_est_sc13,med_exp_pa_est_sc15,med_exp_pa_est_sc17,
                               med_exp_pa_est_sc19,med_exp_pa_est_sc21,med_exp_pa_est_sc23,
                               med_exp_pa_est_sc24,med_exp_pa_est_sc25,med_exp_pa_est_sc26,
                               med_exp_pa_est_sc28,med_exp_pa_est_sc29,med_exp_pa_est_sc30,
                               med_exp_pa_est_sc31,med_exp_pa_est_sc32,med_exp_pa_est_sc33,
                               med_exp_pa_est_sc34,med_exp_pa_est_sc36,med_exp_pa_est_sc37,
                               med_exp_pa_est_sc39,med_exp_pa_est_sc40,med_exp_pa_est_sc41,
                               med_exp_pa_est_sc44,med_exp_pa_est_sc45,med_exp_pa_est_sc47,
                               med_exp_pa_est_sc50,med_exp_pa_est_sc51,med_exp_pa_est_sc53,
                               med_exp_pa_est_sc54,med_exp_pa_est_sc55)
rm(med_exp_pa_est_sc1,med_exp_pa_est_sc2,med_exp_pa_est_sc5,
   med_exp_pa_est_sc10,med_exp_pa_est_sc11,med_exp_pa_est_sc12,
   med_exp_pa_est_sc13,med_exp_pa_est_sc15,med_exp_pa_est_sc17,
   med_exp_pa_est_sc19,med_exp_pa_est_sc21,med_exp_pa_est_sc23,
   med_exp_pa_est_sc24,med_exp_pa_est_sc25,med_exp_pa_est_sc26,
   med_exp_pa_est_sc28,med_exp_pa_est_sc29,med_exp_pa_est_sc30,
   med_exp_pa_est_sc31,med_exp_pa_est_sc32,med_exp_pa_est_sc33,
   med_exp_pa_est_sc34,med_exp_pa_est_sc36,med_exp_pa_est_sc37,
   med_exp_pa_est_sc39,med_exp_pa_est_sc40,med_exp_pa_est_sc41,
   med_exp_pa_est_sc44,med_exp_pa_est_sc45,med_exp_pa_est_sc47,
   med_exp_pa_est_sc50,med_exp_pa_est_sc51,med_exp_pa_est_sc53,
   med_exp_pa_est_sc54,med_exp_pa_est_sc55)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sc_plot", i), synthdid_plot(med_exp_pa_est_sc_list[i]))
}
med_exp_pa_est_sc_plot_data_aux1 <- ggplot_build(med_exp_pa_est_sc_plot1)
med_exp_pa_est_sc_plot_data_aux2 <- ggplot_build(med_exp_pa_est_sc_plot2)
med_exp_pa_est_sc_plot_data_aux3 <- ggplot_build(med_exp_pa_est_sc_plot3)
med_exp_pa_est_sc_plot_data_aux4 <- ggplot_build(med_exp_pa_est_sc_plot4)
med_exp_pa_est_sc_plot_data_aux5 <- ggplot_build(med_exp_pa_est_sc_plot5)
med_exp_pa_est_sc_plot_data_aux6 <- ggplot_build(med_exp_pa_est_sc_plot6)
med_exp_pa_est_sc_plot_data_aux7 <- ggplot_build(med_exp_pa_est_sc_plot7)
med_exp_pa_est_sc_plot_data_aux8 <- ggplot_build(med_exp_pa_est_sc_plot8)
med_exp_pa_est_sc_plot_data_aux9 <- ggplot_build(med_exp_pa_est_sc_plot9)
med_exp_pa_est_sc_plot_data_aux10 <- ggplot_build(med_exp_pa_est_sc_plot10)
med_exp_pa_est_sc_plot_data_aux11 <- ggplot_build(med_exp_pa_est_sc_plot11)
med_exp_pa_est_sc_plot_data_aux12 <- ggplot_build(med_exp_pa_est_sc_plot12)
med_exp_pa_est_sc_plot_data_aux13 <- ggplot_build(med_exp_pa_est_sc_plot13)
med_exp_pa_est_sc_plot_data_aux14 <- ggplot_build(med_exp_pa_est_sc_plot14)
med_exp_pa_est_sc_plot_data_aux15 <- ggplot_build(med_exp_pa_est_sc_plot15)
med_exp_pa_est_sc_plot_data_aux16 <- ggplot_build(med_exp_pa_est_sc_plot16)
med_exp_pa_est_sc_plot_data_aux17 <- ggplot_build(med_exp_pa_est_sc_plot17)
med_exp_pa_est_sc_plot_data_aux18 <- ggplot_build(med_exp_pa_est_sc_plot18)
med_exp_pa_est_sc_plot_data_aux19 <- ggplot_build(med_exp_pa_est_sc_plot19)
med_exp_pa_est_sc_plot_data_aux20 <- ggplot_build(med_exp_pa_est_sc_plot20)
med_exp_pa_est_sc_plot_data_aux21 <- ggplot_build(med_exp_pa_est_sc_plot21)
med_exp_pa_est_sc_plot_data_aux22 <- ggplot_build(med_exp_pa_est_sc_plot22)
med_exp_pa_est_sc_plot_data_aux23 <- ggplot_build(med_exp_pa_est_sc_plot23)
med_exp_pa_est_sc_plot_data_aux24 <- ggplot_build(med_exp_pa_est_sc_plot24)
med_exp_pa_est_sc_plot_data_aux25 <- ggplot_build(med_exp_pa_est_sc_plot25)
med_exp_pa_est_sc_plot_data_aux26 <- ggplot_build(med_exp_pa_est_sc_plot26)
med_exp_pa_est_sc_plot_data_aux27 <- ggplot_build(med_exp_pa_est_sc_plot27)
med_exp_pa_est_sc_plot_data_aux28 <- ggplot_build(med_exp_pa_est_sc_plot28)
med_exp_pa_est_sc_plot_data_aux29 <- ggplot_build(med_exp_pa_est_sc_plot29)
med_exp_pa_est_sc_plot_data_aux30 <- ggplot_build(med_exp_pa_est_sc_plot30)
med_exp_pa_est_sc_plot_data_aux31 <- ggplot_build(med_exp_pa_est_sc_plot31)
med_exp_pa_est_sc_plot_data_aux32 <- ggplot_build(med_exp_pa_est_sc_plot32)
med_exp_pa_est_sc_plot_data_aux33 <- ggplot_build(med_exp_pa_est_sc_plot33)
med_exp_pa_est_sc_plot_data_aux34 <- ggplot_build(med_exp_pa_est_sc_plot34)
med_exp_pa_est_sc_plot_data_aux35 <- ggplot_build(med_exp_pa_est_sc_plot35)
med_exp_pa_est_sc_plot_data_aux_list <- list(med_exp_pa_est_sc_plot_data_aux1,med_exp_pa_est_sc_plot_data_aux2,med_exp_pa_est_sc_plot_data_aux3,
                                             med_exp_pa_est_sc_plot_data_aux4,med_exp_pa_est_sc_plot_data_aux5,med_exp_pa_est_sc_plot_data_aux6,
                                             med_exp_pa_est_sc_plot_data_aux7,med_exp_pa_est_sc_plot_data_aux8,med_exp_pa_est_sc_plot_data_aux9,
                                             med_exp_pa_est_sc_plot_data_aux10,med_exp_pa_est_sc_plot_data_aux11,med_exp_pa_est_sc_plot_data_aux12,
                                             med_exp_pa_est_sc_plot_data_aux13,med_exp_pa_est_sc_plot_data_aux14,med_exp_pa_est_sc_plot_data_aux15,
                                             med_exp_pa_est_sc_plot_data_aux16,med_exp_pa_est_sc_plot_data_aux17,med_exp_pa_est_sc_plot_data_aux18,
                                             med_exp_pa_est_sc_plot_data_aux19,med_exp_pa_est_sc_plot_data_aux20,med_exp_pa_est_sc_plot_data_aux21,
                                             med_exp_pa_est_sc_plot_data_aux22,med_exp_pa_est_sc_plot_data_aux23,med_exp_pa_est_sc_plot_data_aux24,
                                             med_exp_pa_est_sc_plot_data_aux25,med_exp_pa_est_sc_plot_data_aux26,med_exp_pa_est_sc_plot_data_aux27,
                                             med_exp_pa_est_sc_plot_data_aux28,med_exp_pa_est_sc_plot_data_aux29,med_exp_pa_est_sc_plot_data_aux30,
                                             med_exp_pa_est_sc_plot_data_aux31,med_exp_pa_est_sc_plot_data_aux32,med_exp_pa_est_sc_plot_data_aux33,
                                             med_exp_pa_est_sc_plot_data_aux34,med_exp_pa_est_sc_plot_data_aux35)
rm(med_exp_pa_est_sc_plot_data_aux1,med_exp_pa_est_sc_plot_data_aux2,med_exp_pa_est_sc_plot_data_aux3,
   med_exp_pa_est_sc_plot_data_aux4,med_exp_pa_est_sc_plot_data_aux5,med_exp_pa_est_sc_plot_data_aux6,
   med_exp_pa_est_sc_plot_data_aux7,med_exp_pa_est_sc_plot_data_aux8,med_exp_pa_est_sc_plot_data_aux9,
   med_exp_pa_est_sc_plot_data_aux10,med_exp_pa_est_sc_plot_data_aux11,med_exp_pa_est_sc_plot_data_aux12,
   med_exp_pa_est_sc_plot_data_aux13,med_exp_pa_est_sc_plot_data_aux14,med_exp_pa_est_sc_plot_data_aux15,
   med_exp_pa_est_sc_plot_data_aux16,med_exp_pa_est_sc_plot_data_aux17,med_exp_pa_est_sc_plot_data_aux18,
   med_exp_pa_est_sc_plot_data_aux19,med_exp_pa_est_sc_plot_data_aux20,med_exp_pa_est_sc_plot_data_aux21,
   med_exp_pa_est_sc_plot_data_aux22,med_exp_pa_est_sc_plot_data_aux23,med_exp_pa_est_sc_plot_data_aux24,
   med_exp_pa_est_sc_plot_data_aux25,med_exp_pa_est_sc_plot_data_aux26,med_exp_pa_est_sc_plot_data_aux27,
   med_exp_pa_est_sc_plot_data_aux28,med_exp_pa_est_sc_plot_data_aux29,med_exp_pa_est_sc_plot_data_aux30,
   med_exp_pa_est_sc_plot_data_aux31,med_exp_pa_est_sc_plot_data_aux32,med_exp_pa_est_sc_plot_data_aux33,
   med_exp_pa_est_sc_plot_data_aux34,med_exp_pa_est_sc_plot_data_aux35)
rm(med_exp_pa_est_sc_plot1,med_exp_pa_est_sc_plot2,med_exp_pa_est_sc_plot3,
   med_exp_pa_est_sc_plot4,med_exp_pa_est_sc_plot5,med_exp_pa_est_sc_plot6,
   med_exp_pa_est_sc_plot7,med_exp_pa_est_sc_plot8,med_exp_pa_est_sc_plot9,
   med_exp_pa_est_sc_plot10,med_exp_pa_est_sc_plot11,med_exp_pa_est_sc_plot12,
   med_exp_pa_est_sc_plot13,med_exp_pa_est_sc_plot14,med_exp_pa_est_sc_plot15,
   med_exp_pa_est_sc_plot16,med_exp_pa_est_sc_plot17,med_exp_pa_est_sc_plot18,
   med_exp_pa_est_sc_plot19,med_exp_pa_est_sc_plot20,med_exp_pa_est_sc_plot21,
   med_exp_pa_est_sc_plot22,med_exp_pa_est_sc_plot23,med_exp_pa_est_sc_plot24,
   med_exp_pa_est_sc_plot25,med_exp_pa_est_sc_plot26,med_exp_pa_est_sc_plot27,
   med_exp_pa_est_sc_plot28,med_exp_pa_est_sc_plot29,med_exp_pa_est_sc_plot30,
   med_exp_pa_est_sc_plot31,med_exp_pa_est_sc_plot32,med_exp_pa_est_sc_plot33,
   med_exp_pa_est_sc_plot34,med_exp_pa_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sc_plot_data_long", i), data.frame(med_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_pa_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_pa_est_sc_plot_data_long_list <- list(med_exp_pa_est_sc_plot_data_long1,med_exp_pa_est_sc_plot_data_long2,med_exp_pa_est_sc_plot_data_long3,
                                              med_exp_pa_est_sc_plot_data_long4,med_exp_pa_est_sc_plot_data_long5,med_exp_pa_est_sc_plot_data_long6,
                                              med_exp_pa_est_sc_plot_data_long7,med_exp_pa_est_sc_plot_data_long8,med_exp_pa_est_sc_plot_data_long9,
                                              med_exp_pa_est_sc_plot_data_long10,med_exp_pa_est_sc_plot_data_long11,med_exp_pa_est_sc_plot_data_long12,
                                              med_exp_pa_est_sc_plot_data_long13,med_exp_pa_est_sc_plot_data_long14,med_exp_pa_est_sc_plot_data_long15,
                                              med_exp_pa_est_sc_plot_data_long16,med_exp_pa_est_sc_plot_data_long17,med_exp_pa_est_sc_plot_data_long18,
                                              med_exp_pa_est_sc_plot_data_long19,med_exp_pa_est_sc_plot_data_long20,med_exp_pa_est_sc_plot_data_long21,
                                              med_exp_pa_est_sc_plot_data_long22,med_exp_pa_est_sc_plot_data_long23,med_exp_pa_est_sc_plot_data_long24,
                                              med_exp_pa_est_sc_plot_data_long25,med_exp_pa_est_sc_plot_data_long26,med_exp_pa_est_sc_plot_data_long27,
                                              med_exp_pa_est_sc_plot_data_long28,med_exp_pa_est_sc_plot_data_long29,med_exp_pa_est_sc_plot_data_long30,
                                              med_exp_pa_est_sc_plot_data_long31,med_exp_pa_est_sc_plot_data_long32,med_exp_pa_est_sc_plot_data_long33,
                                              med_exp_pa_est_sc_plot_data_long34,med_exp_pa_est_sc_plot_data_long35)
rm(med_exp_pa_est_sc_plot_data_long1,med_exp_pa_est_sc_plot_data_long2,med_exp_pa_est_sc_plot_data_long3,
   med_exp_pa_est_sc_plot_data_long4,med_exp_pa_est_sc_plot_data_long5,med_exp_pa_est_sc_plot_data_long6,
   med_exp_pa_est_sc_plot_data_long7,med_exp_pa_est_sc_plot_data_long8,med_exp_pa_est_sc_plot_data_long9,
   med_exp_pa_est_sc_plot_data_long10,med_exp_pa_est_sc_plot_data_long11,med_exp_pa_est_sc_plot_data_long12,
   med_exp_pa_est_sc_plot_data_long13,med_exp_pa_est_sc_plot_data_long14,med_exp_pa_est_sc_plot_data_long15,
   med_exp_pa_est_sc_plot_data_long16,med_exp_pa_est_sc_plot_data_long17,med_exp_pa_est_sc_plot_data_long18,
   med_exp_pa_est_sc_plot_data_long19,med_exp_pa_est_sc_plot_data_long20,med_exp_pa_est_sc_plot_data_long21,
   med_exp_pa_est_sc_plot_data_long22,med_exp_pa_est_sc_plot_data_long23,med_exp_pa_est_sc_plot_data_long24,
   med_exp_pa_est_sc_plot_data_long25,med_exp_pa_est_sc_plot_data_long26,med_exp_pa_est_sc_plot_data_long27,
   med_exp_pa_est_sc_plot_data_long28,med_exp_pa_est_sc_plot_data_long29,med_exp_pa_est_sc_plot_data_long30,
   med_exp_pa_est_sc_plot_data_long31,med_exp_pa_est_sc_plot_data_long32,med_exp_pa_est_sc_plot_data_long33,
   med_exp_pa_est_sc_plot_data_long34,med_exp_pa_est_sc_plot_data_long35)
med_exp_pa_est_sc_plot_data_long_list <- lapply(med_exp_pa_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sc_plot_data_wide", i), reshape(data=med_exp_pa_est_sc_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
med_exp_pa_est_sc_plot_data_wide_list <- list(med_exp_pa_est_sc_plot_data_wide1,med_exp_pa_est_sc_plot_data_wide2,med_exp_pa_est_sc_plot_data_wide3,
                                              med_exp_pa_est_sc_plot_data_wide4,med_exp_pa_est_sc_plot_data_wide5,med_exp_pa_est_sc_plot_data_wide6,
                                              med_exp_pa_est_sc_plot_data_wide7,med_exp_pa_est_sc_plot_data_wide8,med_exp_pa_est_sc_plot_data_wide9,
                                              med_exp_pa_est_sc_plot_data_wide10,med_exp_pa_est_sc_plot_data_wide11,med_exp_pa_est_sc_plot_data_wide12,
                                              med_exp_pa_est_sc_plot_data_wide13,med_exp_pa_est_sc_plot_data_wide14,med_exp_pa_est_sc_plot_data_wide15,
                                              med_exp_pa_est_sc_plot_data_wide16,med_exp_pa_est_sc_plot_data_wide17,med_exp_pa_est_sc_plot_data_wide18,
                                              med_exp_pa_est_sc_plot_data_wide19,med_exp_pa_est_sc_plot_data_wide20,med_exp_pa_est_sc_plot_data_wide21,
                                              med_exp_pa_est_sc_plot_data_wide22,med_exp_pa_est_sc_plot_data_wide23,med_exp_pa_est_sc_plot_data_wide24,
                                              med_exp_pa_est_sc_plot_data_wide25,med_exp_pa_est_sc_plot_data_wide26,med_exp_pa_est_sc_plot_data_wide27,
                                              med_exp_pa_est_sc_plot_data_wide28,med_exp_pa_est_sc_plot_data_wide29,med_exp_pa_est_sc_plot_data_wide30,
                                              med_exp_pa_est_sc_plot_data_wide31,med_exp_pa_est_sc_plot_data_wide32,med_exp_pa_est_sc_plot_data_wide33,
                                              med_exp_pa_est_sc_plot_data_wide34,med_exp_pa_est_sc_plot_data_wide35)
rm(med_exp_pa_est_sc_plot_data_wide1,med_exp_pa_est_sc_plot_data_wide2,med_exp_pa_est_sc_plot_data_wide3,
   med_exp_pa_est_sc_plot_data_wide4,med_exp_pa_est_sc_plot_data_wide5,med_exp_pa_est_sc_plot_data_wide6,
   med_exp_pa_est_sc_plot_data_wide7,med_exp_pa_est_sc_plot_data_wide8,med_exp_pa_est_sc_plot_data_wide9,
   med_exp_pa_est_sc_plot_data_wide10,med_exp_pa_est_sc_plot_data_wide11,med_exp_pa_est_sc_plot_data_wide12,
   med_exp_pa_est_sc_plot_data_wide13,med_exp_pa_est_sc_plot_data_wide14,med_exp_pa_est_sc_plot_data_wide15,
   med_exp_pa_est_sc_plot_data_wide16,med_exp_pa_est_sc_plot_data_wide17,med_exp_pa_est_sc_plot_data_wide18,
   med_exp_pa_est_sc_plot_data_wide19,med_exp_pa_est_sc_plot_data_wide20,med_exp_pa_est_sc_plot_data_wide21,
   med_exp_pa_est_sc_plot_data_wide22,med_exp_pa_est_sc_plot_data_wide23,med_exp_pa_est_sc_plot_data_wide24,
   med_exp_pa_est_sc_plot_data_wide25,med_exp_pa_est_sc_plot_data_wide26,med_exp_pa_est_sc_plot_data_wide27,
   med_exp_pa_est_sc_plot_data_wide28,med_exp_pa_est_sc_plot_data_wide29,med_exp_pa_est_sc_plot_data_wide30,
   med_exp_pa_est_sc_plot_data_wide31,med_exp_pa_est_sc_plot_data_wide32,med_exp_pa_est_sc_plot_data_wide33,
   med_exp_pa_est_sc_plot_data_wide34,med_exp_pa_est_sc_plot_data_wide35)
med_exp_pa_est_sc_plot_data_wide_list <- lapply(med_exp_pa_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
med_exp_pa_est_sdid1 <- synthdid_estimate(setup_med_exp_pa_list[[1]]$Y, setup_med_exp_pa_list[[1]]$N0, setup_med_exp_pa_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_pa_est_sdid2 <- synthdid_estimate(setup_med_exp_pa_list[[2]]$Y, setup_med_exp_pa_list[[2]]$N0, setup_med_exp_pa_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_pa_est_sdid5 <- synthdid_estimate(setup_med_exp_pa_list[[3]]$Y, setup_med_exp_pa_list[[3]]$N0, setup_med_exp_pa_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_pa_est_sdid10 <- synthdid_estimate(setup_med_exp_pa_list[[4]]$Y, setup_med_exp_pa_list[[4]]$N0, setup_med_exp_pa_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_pa_est_sdid11 <- synthdid_estimate(setup_med_exp_pa_list[[5]]$Y, setup_med_exp_pa_list[[5]]$N0, setup_med_exp_pa_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_pa_est_sdid12 <- synthdid_estimate(setup_med_exp_pa_list[[6]]$Y, setup_med_exp_pa_list[[6]]$N0, setup_med_exp_pa_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_pa_est_sdid13 <- synthdid_estimate(setup_med_exp_pa_list[[7]]$Y, setup_med_exp_pa_list[[7]]$N0, setup_med_exp_pa_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_pa_est_sdid15 <- synthdid_estimate(setup_med_exp_pa_list[[8]]$Y, setup_med_exp_pa_list[[8]]$N0, setup_med_exp_pa_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_pa_est_sdid17 <- synthdid_estimate(setup_med_exp_pa_list[[9]]$Y, setup_med_exp_pa_list[[9]]$N0, setup_med_exp_pa_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_pa_est_sdid19 <- synthdid_estimate(setup_med_exp_pa_list[[10]]$Y, setup_med_exp_pa_list[[10]]$N0, setup_med_exp_pa_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_pa_est_sdid21 <- synthdid_estimate(setup_med_exp_pa_list[[11]]$Y, setup_med_exp_pa_list[[11]]$N0, setup_med_exp_pa_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_pa_est_sdid23 <- synthdid_estimate(setup_med_exp_pa_list[[12]]$Y, setup_med_exp_pa_list[[12]]$N0, setup_med_exp_pa_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_pa_est_sdid24 <- synthdid_estimate(setup_med_exp_pa_list[[13]]$Y, setup_med_exp_pa_list[[13]]$N0, setup_med_exp_pa_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_pa_est_sdid25 <- synthdid_estimate(setup_med_exp_pa_list[[14]]$Y, setup_med_exp_pa_list[[14]]$N0, setup_med_exp_pa_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_pa_est_sdid26 <- synthdid_estimate(setup_med_exp_pa_list[[15]]$Y, setup_med_exp_pa_list[[15]]$N0, setup_med_exp_pa_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_pa_est_sdid28 <- synthdid_estimate(setup_med_exp_pa_list[[16]]$Y, setup_med_exp_pa_list[[16]]$N0, setup_med_exp_pa_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_pa_est_sdid29 <- synthdid_estimate(setup_med_exp_pa_list[[17]]$Y, setup_med_exp_pa_list[[17]]$N0, setup_med_exp_pa_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_pa_est_sdid30 <- synthdid_estimate(setup_med_exp_pa_list[[18]]$Y, setup_med_exp_pa_list[[18]]$N0, setup_med_exp_pa_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_pa_est_sdid31 <- synthdid_estimate(setup_med_exp_pa_list[[19]]$Y, setup_med_exp_pa_list[[19]]$N0, setup_med_exp_pa_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_pa_est_sdid32 <- synthdid_estimate(setup_med_exp_pa_list[[20]]$Y, setup_med_exp_pa_list[[20]]$N0, setup_med_exp_pa_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_pa_est_sdid33 <- synthdid_estimate(setup_med_exp_pa_list[[21]]$Y, setup_med_exp_pa_list[[21]]$N0, setup_med_exp_pa_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_pa_est_sdid34 <- synthdid_estimate(setup_med_exp_pa_list[[22]]$Y, setup_med_exp_pa_list[[22]]$N0, setup_med_exp_pa_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_pa_est_sdid36 <- synthdid_estimate(setup_med_exp_pa_list[[23]]$Y, setup_med_exp_pa_list[[23]]$N0, setup_med_exp_pa_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_pa_est_sdid37 <- synthdid_estimate(setup_med_exp_pa_list[[24]]$Y, setup_med_exp_pa_list[[24]]$N0, setup_med_exp_pa_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_pa_est_sdid39 <- synthdid_estimate(setup_med_exp_pa_list[[25]]$Y, setup_med_exp_pa_list[[25]]$N0, setup_med_exp_pa_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_pa_est_sdid40 <- synthdid_estimate(setup_med_exp_pa_list[[26]]$Y, setup_med_exp_pa_list[[26]]$N0, setup_med_exp_pa_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_pa_est_sdid41 <- synthdid_estimate(setup_med_exp_pa_list[[27]]$Y, setup_med_exp_pa_list[[27]]$N0, setup_med_exp_pa_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_pa_est_sdid44 <- synthdid_estimate(setup_med_exp_pa_list[[28]]$Y, setup_med_exp_pa_list[[28]]$N0, setup_med_exp_pa_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_pa_est_sdid45 <- synthdid_estimate(setup_med_exp_pa_list[[29]]$Y, setup_med_exp_pa_list[[29]]$N0, setup_med_exp_pa_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_pa_est_sdid47 <- synthdid_estimate(setup_med_exp_pa_list[[30]]$Y, setup_med_exp_pa_list[[30]]$N0, setup_med_exp_pa_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_pa_est_sdid50 <- synthdid_estimate(setup_med_exp_pa_list[[31]]$Y, setup_med_exp_pa_list[[31]]$N0, setup_med_exp_pa_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_pa_est_sdid51 <- synthdid_estimate(setup_med_exp_pa_list[[32]]$Y, setup_med_exp_pa_list[[32]]$N0, setup_med_exp_pa_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_pa_est_sdid53 <- synthdid_estimate(setup_med_exp_pa_list[[33]]$Y, setup_med_exp_pa_list[[33]]$N0, setup_med_exp_pa_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_pa_est_sdid54 <- synthdid_estimate(setup_med_exp_pa_list[[34]]$Y, setup_med_exp_pa_list[[34]]$N0, setup_med_exp_pa_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_pa_est_sdid55 <- synthdid_estimate(setup_med_exp_pa_list[[35]]$Y, setup_med_exp_pa_list[[35]]$N0, setup_med_exp_pa_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_pa_est_sdid_list <- list(med_exp_pa_est_sdid1,med_exp_pa_est_sdid2,med_exp_pa_est_sdid5,
                                 med_exp_pa_est_sdid10,med_exp_pa_est_sdid11,med_exp_pa_est_sdid12,
                                 med_exp_pa_est_sdid13,med_exp_pa_est_sdid15,med_exp_pa_est_sdid17,
                                 med_exp_pa_est_sdid19,med_exp_pa_est_sdid21,med_exp_pa_est_sdid23,
                                 med_exp_pa_est_sdid24,med_exp_pa_est_sdid25,med_exp_pa_est_sdid26,
                                 med_exp_pa_est_sdid28,med_exp_pa_est_sdid29,med_exp_pa_est_sdid30,
                                 med_exp_pa_est_sdid31,med_exp_pa_est_sdid32,med_exp_pa_est_sdid33,
                                 med_exp_pa_est_sdid34,med_exp_pa_est_sdid36,med_exp_pa_est_sdid37,
                                 med_exp_pa_est_sdid39,med_exp_pa_est_sdid40,med_exp_pa_est_sdid41,
                                 med_exp_pa_est_sdid44,med_exp_pa_est_sdid45,med_exp_pa_est_sdid47,
                                 med_exp_pa_est_sdid50,med_exp_pa_est_sdid51,med_exp_pa_est_sdid53,
                                 med_exp_pa_est_sdid54,med_exp_pa_est_sdid55)
rm(med_exp_pa_est_sdid1,med_exp_pa_est_sdid2,med_exp_pa_est_sdid5,
   med_exp_pa_est_sdid10,med_exp_pa_est_sdid11,med_exp_pa_est_sdid12,
   med_exp_pa_est_sdid13,med_exp_pa_est_sdid15,med_exp_pa_est_sdid17,
   med_exp_pa_est_sdid19,med_exp_pa_est_sdid21,med_exp_pa_est_sdid23,
   med_exp_pa_est_sdid24,med_exp_pa_est_sdid25,med_exp_pa_est_sdid26,
   med_exp_pa_est_sdid28,med_exp_pa_est_sdid29,med_exp_pa_est_sdid30,
   med_exp_pa_est_sdid31,med_exp_pa_est_sdid32,med_exp_pa_est_sdid33,
   med_exp_pa_est_sdid34,med_exp_pa_est_sdid36,med_exp_pa_est_sdid37,
   med_exp_pa_est_sdid39,med_exp_pa_est_sdid40,med_exp_pa_est_sdid41,
   med_exp_pa_est_sdid44,med_exp_pa_est_sdid45,med_exp_pa_est_sdid47,
   med_exp_pa_est_sdid50,med_exp_pa_est_sdid51,med_exp_pa_est_sdid53,
   med_exp_pa_est_sdid54,med_exp_pa_est_sdid55)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sdid_plot", i), synthdid_plot(med_exp_pa_est_sdid_list[i]))
}
med_exp_pa_est_sdid_plot_data_aux1 <- ggplot_build(med_exp_pa_est_sdid_plot1)
med_exp_pa_est_sdid_plot_data_aux2 <- ggplot_build(med_exp_pa_est_sdid_plot2)
med_exp_pa_est_sdid_plot_data_aux3 <- ggplot_build(med_exp_pa_est_sdid_plot3)
med_exp_pa_est_sdid_plot_data_aux4 <- ggplot_build(med_exp_pa_est_sdid_plot4)
med_exp_pa_est_sdid_plot_data_aux5 <- ggplot_build(med_exp_pa_est_sdid_plot5)
med_exp_pa_est_sdid_plot_data_aux6 <- ggplot_build(med_exp_pa_est_sdid_plot6)
med_exp_pa_est_sdid_plot_data_aux7 <- ggplot_build(med_exp_pa_est_sdid_plot7)
med_exp_pa_est_sdid_plot_data_aux8 <- ggplot_build(med_exp_pa_est_sdid_plot8)
med_exp_pa_est_sdid_plot_data_aux9 <- ggplot_build(med_exp_pa_est_sdid_plot9)
med_exp_pa_est_sdid_plot_data_aux10 <- ggplot_build(med_exp_pa_est_sdid_plot10)
med_exp_pa_est_sdid_plot_data_aux11 <- ggplot_build(med_exp_pa_est_sdid_plot11)
med_exp_pa_est_sdid_plot_data_aux12 <- ggplot_build(med_exp_pa_est_sdid_plot12)
med_exp_pa_est_sdid_plot_data_aux13 <- ggplot_build(med_exp_pa_est_sdid_plot13)
med_exp_pa_est_sdid_plot_data_aux14 <- ggplot_build(med_exp_pa_est_sdid_plot14)
med_exp_pa_est_sdid_plot_data_aux15 <- ggplot_build(med_exp_pa_est_sdid_plot15)
med_exp_pa_est_sdid_plot_data_aux16 <- ggplot_build(med_exp_pa_est_sdid_plot16)
med_exp_pa_est_sdid_plot_data_aux17 <- ggplot_build(med_exp_pa_est_sdid_plot17)
med_exp_pa_est_sdid_plot_data_aux18 <- ggplot_build(med_exp_pa_est_sdid_plot18)
med_exp_pa_est_sdid_plot_data_aux19 <- ggplot_build(med_exp_pa_est_sdid_plot19)
med_exp_pa_est_sdid_plot_data_aux20 <- ggplot_build(med_exp_pa_est_sdid_plot20)
med_exp_pa_est_sdid_plot_data_aux21 <- ggplot_build(med_exp_pa_est_sdid_plot21)
med_exp_pa_est_sdid_plot_data_aux22 <- ggplot_build(med_exp_pa_est_sdid_plot22)
med_exp_pa_est_sdid_plot_data_aux23 <- ggplot_build(med_exp_pa_est_sdid_plot23)
med_exp_pa_est_sdid_plot_data_aux24 <- ggplot_build(med_exp_pa_est_sdid_plot24)
med_exp_pa_est_sdid_plot_data_aux25 <- ggplot_build(med_exp_pa_est_sdid_plot25)
med_exp_pa_est_sdid_plot_data_aux26 <- ggplot_build(med_exp_pa_est_sdid_plot26)
med_exp_pa_est_sdid_plot_data_aux27 <- ggplot_build(med_exp_pa_est_sdid_plot27)
med_exp_pa_est_sdid_plot_data_aux28 <- ggplot_build(med_exp_pa_est_sdid_plot28)
med_exp_pa_est_sdid_plot_data_aux29 <- ggplot_build(med_exp_pa_est_sdid_plot29)
med_exp_pa_est_sdid_plot_data_aux30 <- ggplot_build(med_exp_pa_est_sdid_plot30)
med_exp_pa_est_sdid_plot_data_aux31 <- ggplot_build(med_exp_pa_est_sdid_plot31)
med_exp_pa_est_sdid_plot_data_aux32 <- ggplot_build(med_exp_pa_est_sdid_plot32)
med_exp_pa_est_sdid_plot_data_aux33 <- ggplot_build(med_exp_pa_est_sdid_plot33)
med_exp_pa_est_sdid_plot_data_aux34 <- ggplot_build(med_exp_pa_est_sdid_plot34)
med_exp_pa_est_sdid_plot_data_aux35 <- ggplot_build(med_exp_pa_est_sdid_plot35)
med_exp_pa_est_sdid_plot_data_aux_list <- list(med_exp_pa_est_sdid_plot_data_aux1,med_exp_pa_est_sdid_plot_data_aux2,med_exp_pa_est_sdid_plot_data_aux3,
                                               med_exp_pa_est_sdid_plot_data_aux4,med_exp_pa_est_sdid_plot_data_aux5,med_exp_pa_est_sdid_plot_data_aux6,
                                               med_exp_pa_est_sdid_plot_data_aux7,med_exp_pa_est_sdid_plot_data_aux8,med_exp_pa_est_sdid_plot_data_aux9,
                                               med_exp_pa_est_sdid_plot_data_aux10,med_exp_pa_est_sdid_plot_data_aux11,med_exp_pa_est_sdid_plot_data_aux12,
                                               med_exp_pa_est_sdid_plot_data_aux13,med_exp_pa_est_sdid_plot_data_aux14,med_exp_pa_est_sdid_plot_data_aux15,
                                               med_exp_pa_est_sdid_plot_data_aux16,med_exp_pa_est_sdid_plot_data_aux17,med_exp_pa_est_sdid_plot_data_aux18,
                                               med_exp_pa_est_sdid_plot_data_aux19,med_exp_pa_est_sdid_plot_data_aux20,med_exp_pa_est_sdid_plot_data_aux21,
                                               med_exp_pa_est_sdid_plot_data_aux22,med_exp_pa_est_sdid_plot_data_aux23,med_exp_pa_est_sdid_plot_data_aux24,
                                               med_exp_pa_est_sdid_plot_data_aux25,med_exp_pa_est_sdid_plot_data_aux26,med_exp_pa_est_sdid_plot_data_aux27,
                                               med_exp_pa_est_sdid_plot_data_aux28,med_exp_pa_est_sdid_plot_data_aux29,med_exp_pa_est_sdid_plot_data_aux30,
                                               med_exp_pa_est_sdid_plot_data_aux31,med_exp_pa_est_sdid_plot_data_aux32,med_exp_pa_est_sdid_plot_data_aux33,
                                               med_exp_pa_est_sdid_plot_data_aux34,med_exp_pa_est_sdid_plot_data_aux35)
rm(med_exp_pa_est_sdid_plot_data_aux1,med_exp_pa_est_sdid_plot_data_aux2,med_exp_pa_est_sdid_plot_data_aux3,
   med_exp_pa_est_sdid_plot_data_aux4,med_exp_pa_est_sdid_plot_data_aux5,med_exp_pa_est_sdid_plot_data_aux6,
   med_exp_pa_est_sdid_plot_data_aux7,med_exp_pa_est_sdid_plot_data_aux8,med_exp_pa_est_sdid_plot_data_aux9,
   med_exp_pa_est_sdid_plot_data_aux10,med_exp_pa_est_sdid_plot_data_aux11,med_exp_pa_est_sdid_plot_data_aux12,
   med_exp_pa_est_sdid_plot_data_aux13,med_exp_pa_est_sdid_plot_data_aux14,med_exp_pa_est_sdid_plot_data_aux15,
   med_exp_pa_est_sdid_plot_data_aux16,med_exp_pa_est_sdid_plot_data_aux17,med_exp_pa_est_sdid_plot_data_aux18,
   med_exp_pa_est_sdid_plot_data_aux19,med_exp_pa_est_sdid_plot_data_aux20,med_exp_pa_est_sdid_plot_data_aux21,
   med_exp_pa_est_sdid_plot_data_aux22,med_exp_pa_est_sdid_plot_data_aux23,med_exp_pa_est_sdid_plot_data_aux24,
   med_exp_pa_est_sdid_plot_data_aux25,med_exp_pa_est_sdid_plot_data_aux26,med_exp_pa_est_sdid_plot_data_aux27,
   med_exp_pa_est_sdid_plot_data_aux28,med_exp_pa_est_sdid_plot_data_aux29,med_exp_pa_est_sdid_plot_data_aux30,
   med_exp_pa_est_sdid_plot_data_aux31,med_exp_pa_est_sdid_plot_data_aux32,med_exp_pa_est_sdid_plot_data_aux33,
   med_exp_pa_est_sdid_plot_data_aux34,med_exp_pa_est_sdid_plot_data_aux35)
rm(med_exp_pa_est_sdid_plot1,med_exp_pa_est_sdid_plot2,med_exp_pa_est_sdid_plot3,
   med_exp_pa_est_sdid_plot4,med_exp_pa_est_sdid_plot5,med_exp_pa_est_sdid_plot6,
   med_exp_pa_est_sdid_plot7,med_exp_pa_est_sdid_plot8,med_exp_pa_est_sdid_plot9,
   med_exp_pa_est_sdid_plot10,med_exp_pa_est_sdid_plot11,med_exp_pa_est_sdid_plot12,
   med_exp_pa_est_sdid_plot13,med_exp_pa_est_sdid_plot14,med_exp_pa_est_sdid_plot15,
   med_exp_pa_est_sdid_plot16,med_exp_pa_est_sdid_plot17,med_exp_pa_est_sdid_plot18,
   med_exp_pa_est_sdid_plot19,med_exp_pa_est_sdid_plot20,med_exp_pa_est_sdid_plot21,
   med_exp_pa_est_sdid_plot22,med_exp_pa_est_sdid_plot23,med_exp_pa_est_sdid_plot24,
   med_exp_pa_est_sdid_plot25,med_exp_pa_est_sdid_plot26,med_exp_pa_est_sdid_plot27,
   med_exp_pa_est_sdid_plot28,med_exp_pa_est_sdid_plot29,med_exp_pa_est_sdid_plot30,
   med_exp_pa_est_sdid_plot31,med_exp_pa_est_sdid_plot32,med_exp_pa_est_sdid_plot33,
   med_exp_pa_est_sdid_plot34,med_exp_pa_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sdid_plot_data_long", i), data.frame(med_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_pa_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_pa_est_sdid_plot_data_long_list <- list(med_exp_pa_est_sdid_plot_data_long1,med_exp_pa_est_sdid_plot_data_long2,med_exp_pa_est_sdid_plot_data_long3,
                                                med_exp_pa_est_sdid_plot_data_long4,med_exp_pa_est_sdid_plot_data_long5,med_exp_pa_est_sdid_plot_data_long6,
                                                med_exp_pa_est_sdid_plot_data_long7,med_exp_pa_est_sdid_plot_data_long8,med_exp_pa_est_sdid_plot_data_long9,
                                                med_exp_pa_est_sdid_plot_data_long10,med_exp_pa_est_sdid_plot_data_long11,med_exp_pa_est_sdid_plot_data_long12,
                                                med_exp_pa_est_sdid_plot_data_long13,med_exp_pa_est_sdid_plot_data_long14,med_exp_pa_est_sdid_plot_data_long15,
                                                med_exp_pa_est_sdid_plot_data_long16,med_exp_pa_est_sdid_plot_data_long17,med_exp_pa_est_sdid_plot_data_long18,
                                                med_exp_pa_est_sdid_plot_data_long19,med_exp_pa_est_sdid_plot_data_long20,med_exp_pa_est_sdid_plot_data_long21,
                                                med_exp_pa_est_sdid_plot_data_long22,med_exp_pa_est_sdid_plot_data_long23,med_exp_pa_est_sdid_plot_data_long24,
                                                med_exp_pa_est_sdid_plot_data_long25,med_exp_pa_est_sdid_plot_data_long26,med_exp_pa_est_sdid_plot_data_long27,
                                                med_exp_pa_est_sdid_plot_data_long28,med_exp_pa_est_sdid_plot_data_long29,med_exp_pa_est_sdid_plot_data_long30,
                                                med_exp_pa_est_sdid_plot_data_long31,med_exp_pa_est_sdid_plot_data_long32,med_exp_pa_est_sdid_plot_data_long33,
                                                med_exp_pa_est_sdid_plot_data_long34,med_exp_pa_est_sdid_plot_data_long35)
rm(med_exp_pa_est_sdid_plot_data_long1,med_exp_pa_est_sdid_plot_data_long2,med_exp_pa_est_sdid_plot_data_long3,
   med_exp_pa_est_sdid_plot_data_long4,med_exp_pa_est_sdid_plot_data_long5,med_exp_pa_est_sdid_plot_data_long6,
   med_exp_pa_est_sdid_plot_data_long7,med_exp_pa_est_sdid_plot_data_long8,med_exp_pa_est_sdid_plot_data_long9,
   med_exp_pa_est_sdid_plot_data_long10,med_exp_pa_est_sdid_plot_data_long11,med_exp_pa_est_sdid_plot_data_long12,
   med_exp_pa_est_sdid_plot_data_long13,med_exp_pa_est_sdid_plot_data_long14,med_exp_pa_est_sdid_plot_data_long15,
   med_exp_pa_est_sdid_plot_data_long16,med_exp_pa_est_sdid_plot_data_long17,med_exp_pa_est_sdid_plot_data_long18,
   med_exp_pa_est_sdid_plot_data_long19,med_exp_pa_est_sdid_plot_data_long20,med_exp_pa_est_sdid_plot_data_long21,
   med_exp_pa_est_sdid_plot_data_long22,med_exp_pa_est_sdid_plot_data_long23,med_exp_pa_est_sdid_plot_data_long24,
   med_exp_pa_est_sdid_plot_data_long25,med_exp_pa_est_sdid_plot_data_long26,med_exp_pa_est_sdid_plot_data_long27,
   med_exp_pa_est_sdid_plot_data_long28,med_exp_pa_est_sdid_plot_data_long29,med_exp_pa_est_sdid_plot_data_long30,
   med_exp_pa_est_sdid_plot_data_long31,med_exp_pa_est_sdid_plot_data_long32,med_exp_pa_est_sdid_plot_data_long33,
   med_exp_pa_est_sdid_plot_data_long34,med_exp_pa_est_sdid_plot_data_long35)
med_exp_pa_est_sdid_plot_data_long_list <- lapply(med_exp_pa_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_pa_est_sdid_plot_data_wide", i), reshape(data=med_exp_pa_est_sdid_plot_data_long_list[[i]],
                                                                  idvar = "year",
                                                                  v.names = "outcome",
                                                                  timevar = "treated",
                                                                  direction = "wide"))
}
med_exp_pa_est_sdid_plot_data_wide_list <- list(med_exp_pa_est_sdid_plot_data_wide1,med_exp_pa_est_sdid_plot_data_wide2,med_exp_pa_est_sdid_plot_data_wide3,
                                                med_exp_pa_est_sdid_plot_data_wide4,med_exp_pa_est_sdid_plot_data_wide5,med_exp_pa_est_sdid_plot_data_wide6,
                                                med_exp_pa_est_sdid_plot_data_wide7,med_exp_pa_est_sdid_plot_data_wide8,med_exp_pa_est_sdid_plot_data_wide9,
                                                med_exp_pa_est_sdid_plot_data_wide10,med_exp_pa_est_sdid_plot_data_wide11,med_exp_pa_est_sdid_plot_data_wide12,
                                                med_exp_pa_est_sdid_plot_data_wide13,med_exp_pa_est_sdid_plot_data_wide14,med_exp_pa_est_sdid_plot_data_wide15,
                                                med_exp_pa_est_sdid_plot_data_wide16,med_exp_pa_est_sdid_plot_data_wide17,med_exp_pa_est_sdid_plot_data_wide18,
                                                med_exp_pa_est_sdid_plot_data_wide19,med_exp_pa_est_sdid_plot_data_wide20,med_exp_pa_est_sdid_plot_data_wide21,
                                                med_exp_pa_est_sdid_plot_data_wide22,med_exp_pa_est_sdid_plot_data_wide23,med_exp_pa_est_sdid_plot_data_wide24,
                                                med_exp_pa_est_sdid_plot_data_wide25,med_exp_pa_est_sdid_plot_data_wide26,med_exp_pa_est_sdid_plot_data_wide27,
                                                med_exp_pa_est_sdid_plot_data_wide28,med_exp_pa_est_sdid_plot_data_wide29,med_exp_pa_est_sdid_plot_data_wide30,
                                                med_exp_pa_est_sdid_plot_data_wide31,med_exp_pa_est_sdid_plot_data_wide32,med_exp_pa_est_sdid_plot_data_wide33,
                                                med_exp_pa_est_sdid_plot_data_wide34,med_exp_pa_est_sdid_plot_data_wide35)
rm(med_exp_pa_est_sdid_plot_data_wide1,med_exp_pa_est_sdid_plot_data_wide2,med_exp_pa_est_sdid_plot_data_wide3,
   med_exp_pa_est_sdid_plot_data_wide4,med_exp_pa_est_sdid_plot_data_wide5,med_exp_pa_est_sdid_plot_data_wide6,
   med_exp_pa_est_sdid_plot_data_wide7,med_exp_pa_est_sdid_plot_data_wide8,med_exp_pa_est_sdid_plot_data_wide9,
   med_exp_pa_est_sdid_plot_data_wide10,med_exp_pa_est_sdid_plot_data_wide11,med_exp_pa_est_sdid_plot_data_wide12,
   med_exp_pa_est_sdid_plot_data_wide13,med_exp_pa_est_sdid_plot_data_wide14,med_exp_pa_est_sdid_plot_data_wide15,
   med_exp_pa_est_sdid_plot_data_wide16,med_exp_pa_est_sdid_plot_data_wide17,med_exp_pa_est_sdid_plot_data_wide18,
   med_exp_pa_est_sdid_plot_data_wide19,med_exp_pa_est_sdid_plot_data_wide20,med_exp_pa_est_sdid_plot_data_wide21,
   med_exp_pa_est_sdid_plot_data_wide22,med_exp_pa_est_sdid_plot_data_wide23,med_exp_pa_est_sdid_plot_data_wide24,
   med_exp_pa_est_sdid_plot_data_wide25,med_exp_pa_est_sdid_plot_data_wide26,med_exp_pa_est_sdid_plot_data_wide27,
   med_exp_pa_est_sdid_plot_data_wide28,med_exp_pa_est_sdid_plot_data_wide29,med_exp_pa_est_sdid_plot_data_wide30,
   med_exp_pa_est_sdid_plot_data_wide31,med_exp_pa_est_sdid_plot_data_wide32,med_exp_pa_est_sdid_plot_data_wide33,
   med_exp_pa_est_sdid_plot_data_wide34,med_exp_pa_est_sdid_plot_data_wide35)
med_exp_pa_est_sdid_plot_data_wide_list <- lapply(med_exp_pa_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
med_exp_est_did_plot_data_wide_pa$did_facet_title <- "Diff-in-Diff"
med_exp_est_sc_plot_data_wide_pa$sc_facet_title <- "Synthetic Control"
med_exp_est_sdid_plot_data_wide_pa$sdid_facet_title <- "Synthetic Diff-in-Diff"
med_exp_est_did_plot_data_wide_pa$diff_relative <- med_exp_est_did_plot_data_wide_pa$diff - med_exp_est_did_plot_data_wide_pa$diff[16]
for(i in 1:35) {
  med_exp_pa_est_did_plot_data_wide_list[[i]]$diff_relative <- med_exp_pa_est_did_plot_data_wide_list[[i]]$diff - med_exp_pa_est_did_plot_data_wide_list[[i]]$diff[16]
}
med_exp_pa_spag_did_plot <- ggplot(med_exp_est_did_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Medicaid Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_pa_spag_sc_plot <- ggplot(med_exp_est_sc_plot_data_wide_pa, aes(year,diff)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = med_exp_pa_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Pennsylvania"),data = med_exp_est_sc_plot_data_wide_pa, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Pennsylvania" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_est_sdid_plot_data_wide_pa$diff_relative <- med_exp_est_sdid_plot_data_wide_pa$diff - med_exp_est_sdid_plot_data_wide_pa$diff[16]
for(i in 1:35) {
  med_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff_relative <- med_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff - med_exp_pa_est_sdid_plot_data_wide_list[[i]]$diff[16]
}
med_exp_pa_spag_sdid_plot <- ggplot(med_exp_est_sdid_plot_data_wide_pa, aes(year,diff_relative)) +
  geom_vline(xintercept = 1995, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_pa_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
med_exp_pa_est_did_vec <- c(med_exp_est_did_pa)
for (i in c(1:4,6:35)) {
  med_exp_pa_est_did_vec_aux <- med_exp_pa_est_did_list[[i]][1]
  med_exp_pa_est_did_vec <- c(med_exp_pa_est_did_vec,med_exp_pa_est_did_vec_aux)
}
med_exp_pa_est_did_df <- data.frame(med_exp_pa_est_did_vec)
med_exp_pa_hist_did_plot_aux <- ggplot(data = NULL, aes(x = med_exp_pa_est_did_vec)) +
  geom_histogram(data = med_exp_pa_est_did_df, aes(x = med_exp_pa_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_pa_hist_did_plot1_ylim <- ggplot_build(med_exp_pa_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_pa_hist_did_plot <- med_exp_pa_hist_did_plot_aux +
  expand_limits(y=med_exp_pa_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_pa_est_did_vec[1], mean(med_exp_pa_est_did_vec[2:35])), xend = c(med_exp_pa_est_did_vec[1],mean(med_exp_pa_est_did_vec[2:35])), y = c(0,0), yend = c(med_exp_pa_hist_did_plot1_ylim,med_exp_pa_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_pa_est_did_vec[1], mean(med_exp_pa_est_did_vec[2:35])), y = c(med_exp_pa_hist_did_plot1_ylim,med_exp_pa_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_pa_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_pa_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.65,.5), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_pa_est_sc_vec <- c(med_exp_est_sc_pa)
for (i in c(1:4,6:35)) {
  med_exp_pa_est_sc_vec_aux <- med_exp_pa_est_sc_list[[i]][1]
  med_exp_pa_est_sc_vec <- c(med_exp_pa_est_sc_vec,med_exp_pa_est_sc_vec_aux)
}
med_exp_pa_est_sc_df <- data.frame(med_exp_pa_est_sc_vec)
med_exp_pa_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = med_exp_pa_est_sc_vec)) +
  geom_histogram(data = med_exp_pa_est_sc_df, aes(x = med_exp_pa_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_pa_hist_sc_plot1_ylim <- ggplot_build(med_exp_pa_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_pa_hist_sc_plot <- med_exp_pa_hist_sc_plot_aux +
  expand_limits(y=med_exp_pa_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_pa_est_sc_vec[1], mean(med_exp_pa_est_sc_vec[2:35])), xend = c(med_exp_pa_est_sc_vec[1],mean(med_exp_pa_est_sc_vec[2:35])), y = c(0,0), yend = c(med_exp_pa_hist_sc_plot1_ylim,med_exp_pa_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_pa_est_sc_vec[1], mean(med_exp_pa_est_sc_vec[2:35])), y = c(med_exp_pa_hist_sc_plot1_ylim,med_exp_pa_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_pa_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_pa_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_pa_est_sdid_vec <- c(med_exp_est_sdid_pa)
for (i in c(1:4,6:35)) {
  med_exp_pa_est_sdid_vec_aux <- med_exp_pa_est_sdid_list[[i]][1]
  med_exp_pa_est_sdid_vec <- c(med_exp_pa_est_sdid_vec,med_exp_pa_est_sdid_vec_aux)
}
med_exp_pa_est_sdid_df <- data.frame(med_exp_pa_est_sdid_vec)
med_exp_pa_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = med_exp_pa_est_sdid_vec)) +
  geom_histogram(data = med_exp_pa_est_sdid_df, aes(x = med_exp_pa_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_pa_hist_sdid_plot1_ylim <- ggplot_build(med_exp_pa_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_pa_hist_sdid_plot <- med_exp_pa_hist_sdid_plot_aux +
  expand_limits(y=med_exp_pa_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_pa_est_sdid_vec[1], mean(med_exp_pa_est_sdid_vec[2:35])), xend = c(med_exp_pa_est_sdid_vec[1],mean(med_exp_pa_est_sdid_vec[2:35])), y = c(0,0), yend = c(med_exp_pa_hist_sdid_plot1_ylim,med_exp_pa_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_pa_est_sdid_vec[1], mean(med_exp_pa_est_sdid_vec[2:35])), y = c(med_exp_pa_hist_sdid_plot1_ylim,med_exp_pa_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_pa_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_pa_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.75,.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/med_exp_spag_dist_plots_PA.pdf', paper = "USr", width = 10.9, height = 8.4)
(med_exp_pa_spag_dist_plots_PA <- med_exp_pa_spag_did_plot + med_exp_pa_spag_sc_plot + med_exp_pa_spag_sdid_plot + med_exp_pa_hist_did_plot + med_exp_pa_hist_sc_plot + med_exp_pa_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()









########## Indiana ##########

##### Quantity of Nursing Homes #####
### IN - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_homes_in_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_in_df$treated <- as.integer(ifelse(q_nursing_homes_in_df$name == "Indiana" & q_nursing_homes_in_df$year >= 1999, 1, 0))
q_nursing_homes_in_df <- q_nursing_homes_in_df[order(q_nursing_homes_in_df$year, q_nursing_homes_in_df$treated_in_aux, q_nursing_homes_in_df$name),]
q_nursing_homes_in_df <- subset(q_nursing_homes_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nh_in <- panel.matrices(q_nursing_homes_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nh_est_did_in <- did_estimate(setup_q_nh_in$Y, setup_q_nh_in$N0, setup_q_nh_in$T0, X = covariates_acc_in_array)
q_nh_est_did_plot_in <- synthdid_plot(q_nh_est_did_in)
q_nh_est_did_plot_data_aux_in <- ggplot_build(q_nh_est_did_plot_in)
q_nh_est_did_plot_data_long_in <- data.frame(q_nh_est_did_plot_data_aux_in$data[[1]]$x, q_nh_est_did_plot_data_aux_in$data[[1]]$y, q_nh_est_did_plot_data_aux_in$data[[1]]$group)
colnames(q_nh_est_did_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nh_est_did_plot_data_long_in$treated <- q_nh_est_did_plot_data_long_in$treated - 1
q_nh_est_did_plot_data_wide_in <- reshape(data=q_nh_est_did_plot_data_long_in,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nh_est_did_plot_data_wide_in$diff <- q_nh_est_did_plot_data_wide_in$outcome.1 - q_nh_est_did_plot_data_wide_in$outcome.0
# SC #
q_nh_est_sc_in <- sc_estimate(setup_q_nh_in$Y, setup_q_nh_in$N0, setup_q_nh_in$T0, X = covariates_acc_in_array)
q_nh_est_sc_plot_in <- synthdid_plot(q_nh_est_sc_in)
q_nh_est_sc_plot_data_aux_in <- ggplot_build(q_nh_est_sc_plot_in)
q_nh_est_sc_plot_data_long_in <- data.frame(q_nh_est_sc_plot_data_aux_in$data[[1]]$x, q_nh_est_sc_plot_data_aux_in$data[[1]]$y, q_nh_est_sc_plot_data_aux_in$data[[1]]$group)
colnames(q_nh_est_sc_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nh_est_sc_plot_data_long_in$treated <- q_nh_est_sc_plot_data_long_in$treated - 1
q_nh_est_sc_plot_data_wide_in <- reshape(data=q_nh_est_sc_plot_data_long_in,
                                         idvar = "year",
                                         v.names = "outcome",
                                         timevar = "treated",
                                         direction = "wide")
q_nh_est_sc_plot_data_wide_in$diff <- q_nh_est_sc_plot_data_wide_in$outcome.1 - q_nh_est_sc_plot_data_wide_in$outcome.0
# SDID #
q_nh_est_sdid_in <- synthdid_estimate(setup_q_nh_in$Y, setup_q_nh_in$N0, setup_q_nh_in$T0, X = covariates_acc_in_array)
q_nh_est_sdid_plot_in <- synthdid_plot(q_nh_est_sdid_in)
q_nh_est_sdid_plot_data_aux_in <- ggplot_build(q_nh_est_sdid_plot_in)
q_nh_est_sdid_plot_data_long_in <- data.frame(q_nh_est_sdid_plot_data_aux_in$data[[1]]$x, q_nh_est_sdid_plot_data_aux_in$data[[1]]$y, q_nh_est_sdid_plot_data_aux_in$data[[1]]$group)
colnames(q_nh_est_sdid_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nh_est_sdid_plot_data_long_in$treated <- q_nh_est_sdid_plot_data_long_in$treated - 1
q_nh_est_sdid_plot_data_wide_in <- reshape(data=q_nh_est_sdid_plot_data_long_in,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nh_est_sdid_plot_data_wide_in$diff <- q_nh_est_sdid_plot_data_wide_in$outcome.1 - q_nh_est_sdid_plot_data_wide_in$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nh_in_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nh_in_df1$treated_aux <- ifelse(q_nh_in_df1$id == 1, 1, 0)
q_nh_in_df2$treated_aux <- ifelse(q_nh_in_df2$id == 2, 1, 0)
q_nh_in_df5$treated_aux <- ifelse(q_nh_in_df5$id == 5, 1, 0)
q_nh_in_df10$treated_aux <- ifelse(q_nh_in_df10$id == 10, 1, 0)
q_nh_in_df11$treated_aux <- ifelse(q_nh_in_df11$id == 11, 1, 0)
q_nh_in_df12$treated_aux <- ifelse(q_nh_in_df12$id == 12, 1, 0)
q_nh_in_df13$treated_aux <- ifelse(q_nh_in_df13$id == 13, 1, 0)
q_nh_in_df15$treated_aux <- ifelse(q_nh_in_df15$id == 15, 1, 0)
q_nh_in_df17$treated_aux <- ifelse(q_nh_in_df17$id == 17, 1, 0)
q_nh_in_df19$treated_aux <- ifelse(q_nh_in_df19$id == 19, 1, 0)
q_nh_in_df21$treated_aux <- ifelse(q_nh_in_df21$id == 21, 1, 0)
q_nh_in_df23$treated_aux <- ifelse(q_nh_in_df23$id == 23, 1, 0)
q_nh_in_df24$treated_aux <- ifelse(q_nh_in_df24$id == 24, 1, 0)
q_nh_in_df25$treated_aux <- ifelse(q_nh_in_df25$id == 25, 1, 0)
q_nh_in_df26$treated_aux <- ifelse(q_nh_in_df26$id == 26, 1, 0)
q_nh_in_df28$treated_aux <- ifelse(q_nh_in_df28$id == 28, 1, 0)
q_nh_in_df29$treated_aux <- ifelse(q_nh_in_df29$id == 29, 1, 0)
q_nh_in_df30$treated_aux <- ifelse(q_nh_in_df30$id == 30, 1, 0)
q_nh_in_df31$treated_aux <- ifelse(q_nh_in_df31$id == 31, 1, 0)
q_nh_in_df32$treated_aux <- ifelse(q_nh_in_df32$id == 32, 1, 0)
q_nh_in_df33$treated_aux <- ifelse(q_nh_in_df33$id == 33, 1, 0)
q_nh_in_df34$treated_aux <- ifelse(q_nh_in_df34$id == 34, 1, 0)
q_nh_in_df36$treated_aux <- ifelse(q_nh_in_df36$id == 36, 1, 0)
q_nh_in_df37$treated_aux <- ifelse(q_nh_in_df37$id == 37, 1, 0)
q_nh_in_df39$treated_aux <- ifelse(q_nh_in_df39$id == 39, 1, 0)
q_nh_in_df40$treated_aux <- ifelse(q_nh_in_df40$id == 40, 1, 0)
q_nh_in_df41$treated_aux <- ifelse(q_nh_in_df41$id == 41, 1, 0)
q_nh_in_df44$treated_aux <- ifelse(q_nh_in_df44$id == 44, 1, 0)
q_nh_in_df45$treated_aux <- ifelse(q_nh_in_df45$id == 45, 1, 0)
q_nh_in_df47$treated_aux <- ifelse(q_nh_in_df47$id == 47, 1, 0)
q_nh_in_df50$treated_aux <- ifelse(q_nh_in_df50$id == 50, 1, 0)
q_nh_in_df51$treated_aux <- ifelse(q_nh_in_df51$id == 51, 1, 0)
q_nh_in_df53$treated_aux <- ifelse(q_nh_in_df53$id == 53, 1, 0)
q_nh_in_df54$treated_aux <- ifelse(q_nh_in_df54$id == 54, 1, 0)
q_nh_in_df55$treated_aux <- ifelse(q_nh_in_df55$id == 55, 1, 0)
q_nh_in_df1$treated <- as.integer(ifelse(q_nh_in_df1$id == 1 & q_nh_in_df1$year >= 1999, 1, 0))
q_nh_in_df2$treated <- as.integer(ifelse(q_nh_in_df2$id == 2 & q_nh_in_df2$year >= 1999, 1, 0))
q_nh_in_df5$treated <- as.integer(ifelse(q_nh_in_df5$id == 5 & q_nh_in_df5$year >= 1999, 1, 0))
q_nh_in_df10$treated <- as.integer(ifelse(q_nh_in_df10$id == 10 & q_nh_in_df10$year >= 1999, 1, 0))
q_nh_in_df11$treated <- as.integer(ifelse(q_nh_in_df11$id == 11 & q_nh_in_df11$year >= 1999, 1, 0))
q_nh_in_df12$treated <- as.integer(ifelse(q_nh_in_df12$id == 12 & q_nh_in_df12$year >= 1999, 1, 0))
q_nh_in_df13$treated <- as.integer(ifelse(q_nh_in_df13$id == 13 & q_nh_in_df13$year >= 1999, 1, 0))
q_nh_in_df15$treated <- as.integer(ifelse(q_nh_in_df15$id == 15 & q_nh_in_df15$year >= 1999, 1, 0))
q_nh_in_df17$treated <- as.integer(ifelse(q_nh_in_df17$id == 17 & q_nh_in_df17$year >= 1999, 1, 0))
q_nh_in_df19$treated <- as.integer(ifelse(q_nh_in_df19$id == 19 & q_nh_in_df19$year >= 1999, 1, 0))
q_nh_in_df21$treated <- as.integer(ifelse(q_nh_in_df21$id == 21 & q_nh_in_df21$year >= 1999, 1, 0))
q_nh_in_df23$treated <- as.integer(ifelse(q_nh_in_df23$id == 23 & q_nh_in_df23$year >= 1999, 1, 0))
q_nh_in_df24$treated <- as.integer(ifelse(q_nh_in_df24$id == 24 & q_nh_in_df24$year >= 1999, 1, 0))
q_nh_in_df25$treated <- as.integer(ifelse(q_nh_in_df25$id == 25 & q_nh_in_df25$year >= 1999, 1, 0))
q_nh_in_df26$treated <- as.integer(ifelse(q_nh_in_df26$id == 26 & q_nh_in_df26$year >= 1999, 1, 0))
q_nh_in_df28$treated <- as.integer(ifelse(q_nh_in_df28$id == 28 & q_nh_in_df28$year >= 1999, 1, 0))
q_nh_in_df29$treated <- as.integer(ifelse(q_nh_in_df29$id == 29 & q_nh_in_df29$year >= 1999, 1, 0))
q_nh_in_df30$treated <- as.integer(ifelse(q_nh_in_df30$id == 30 & q_nh_in_df30$year >= 1999, 1, 0))
q_nh_in_df31$treated <- as.integer(ifelse(q_nh_in_df31$id == 31 & q_nh_in_df31$year >= 1999, 1, 0))
q_nh_in_df32$treated <- as.integer(ifelse(q_nh_in_df32$id == 32 & q_nh_in_df32$year >= 1999, 1, 0))
q_nh_in_df33$treated <- as.integer(ifelse(q_nh_in_df33$id == 33 & q_nh_in_df33$year >= 1999, 1, 0))
q_nh_in_df34$treated <- as.integer(ifelse(q_nh_in_df34$id == 34 & q_nh_in_df34$year >= 1999, 1, 0))
q_nh_in_df36$treated <- as.integer(ifelse(q_nh_in_df36$id == 36 & q_nh_in_df36$year >= 1999, 1, 0))
q_nh_in_df37$treated <- as.integer(ifelse(q_nh_in_df37$id == 37 & q_nh_in_df37$year >= 1999, 1, 0))
q_nh_in_df39$treated <- as.integer(ifelse(q_nh_in_df39$id == 39 & q_nh_in_df39$year >= 1999, 1, 0))
q_nh_in_df40$treated <- as.integer(ifelse(q_nh_in_df40$id == 40 & q_nh_in_df40$year >= 1999, 1, 0))
q_nh_in_df41$treated <- as.integer(ifelse(q_nh_in_df41$id == 41 & q_nh_in_df41$year >= 1999, 1, 0))
q_nh_in_df44$treated <- as.integer(ifelse(q_nh_in_df44$id == 44 & q_nh_in_df44$year >= 1999, 1, 0))
q_nh_in_df45$treated <- as.integer(ifelse(q_nh_in_df45$id == 45 & q_nh_in_df45$year >= 1999, 1, 0))
q_nh_in_df47$treated <- as.integer(ifelse(q_nh_in_df47$id == 47 & q_nh_in_df47$year >= 1999, 1, 0))
q_nh_in_df50$treated <- as.integer(ifelse(q_nh_in_df50$id == 50 & q_nh_in_df50$year >= 1999, 1, 0))
q_nh_in_df51$treated <- as.integer(ifelse(q_nh_in_df51$id == 51 & q_nh_in_df51$year >= 1999, 1, 0))
q_nh_in_df53$treated <- as.integer(ifelse(q_nh_in_df53$id == 53 & q_nh_in_df53$year >= 1999, 1, 0))
q_nh_in_df54$treated <- as.integer(ifelse(q_nh_in_df54$id == 54 & q_nh_in_df54$year >= 1999, 1, 0))
q_nh_in_df55$treated <- as.integer(ifelse(q_nh_in_df55$id == 55 & q_nh_in_df55$year >= 1999, 1, 0))
q_nh_in_df_list <- list(q_nh_in_df1,q_nh_in_df2,q_nh_in_df5,
                        q_nh_in_df10,q_nh_in_df11,q_nh_in_df12,
                        q_nh_in_df13,q_nh_in_df15,q_nh_in_df17,
                        q_nh_in_df19,q_nh_in_df21,q_nh_in_df23,
                        q_nh_in_df24,q_nh_in_df25,q_nh_in_df26,
                        q_nh_in_df28,q_nh_in_df29,q_nh_in_df30,
                        q_nh_in_df31,q_nh_in_df32,q_nh_in_df33,
                        q_nh_in_df34,q_nh_in_df36,q_nh_in_df37,
                        q_nh_in_df39,q_nh_in_df40,q_nh_in_df41,
                        q_nh_in_df44,q_nh_in_df45,q_nh_in_df47,
                        q_nh_in_df50,q_nh_in_df51,q_nh_in_df53,
                        q_nh_in_df54,q_nh_in_df55)
rm(q_nh_in_df1,q_nh_in_df2,q_nh_in_df5,
   q_nh_in_df10,q_nh_in_df11,q_nh_in_df12,
   q_nh_in_df13,q_nh_in_df15,q_nh_in_df17,
   q_nh_in_df19,q_nh_in_df21,q_nh_in_df23,
   q_nh_in_df24,q_nh_in_df25,q_nh_in_df26,
   q_nh_in_df28,q_nh_in_df29,q_nh_in_df30,
   q_nh_in_df31,q_nh_in_df32,q_nh_in_df33,
   q_nh_in_df34,q_nh_in_df36,q_nh_in_df37,
   q_nh_in_df39,q_nh_in_df40,q_nh_in_df41,
   q_nh_in_df44,q_nh_in_df45,q_nh_in_df47,
   q_nh_in_df50,q_nh_in_df51,q_nh_in_df53,
   q_nh_in_df54,q_nh_in_df55)
q_nh_in_df_list <- lapply(q_nh_in_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nh_in_df_list <- lapply(q_nh_in_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomes_pcp, treated)))
}
)
setup_q_nh_in1 <- panel.matrices(q_nh_in_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in2 <- panel.matrices(q_nh_in_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in5 <- panel.matrices(q_nh_in_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in10 <- panel.matrices(q_nh_in_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in11 <- panel.matrices(q_nh_in_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in12 <- panel.matrices(q_nh_in_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in13 <- panel.matrices(q_nh_in_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in15 <- panel.matrices(q_nh_in_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in17 <- panel.matrices(q_nh_in_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in19 <- panel.matrices(q_nh_in_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in21 <- panel.matrices(q_nh_in_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in23 <- panel.matrices(q_nh_in_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in24 <- panel.matrices(q_nh_in_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in25 <- panel.matrices(q_nh_in_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in26 <- panel.matrices(q_nh_in_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in28 <- panel.matrices(q_nh_in_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in29 <- panel.matrices(q_nh_in_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in30 <- panel.matrices(q_nh_in_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in31 <- panel.matrices(q_nh_in_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in32 <- panel.matrices(q_nh_in_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in33 <- panel.matrices(q_nh_in_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in34 <- panel.matrices(q_nh_in_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in36 <- panel.matrices(q_nh_in_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in37 <- panel.matrices(q_nh_in_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in39 <- panel.matrices(q_nh_in_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in40 <- panel.matrices(q_nh_in_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in41 <- panel.matrices(q_nh_in_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in44 <- panel.matrices(q_nh_in_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in45 <- panel.matrices(q_nh_in_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in47 <- panel.matrices(q_nh_in_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in50 <- panel.matrices(q_nh_in_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in51 <- panel.matrices(q_nh_in_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in53 <- panel.matrices(q_nh_in_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in54 <- panel.matrices(q_nh_in_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in55 <- panel.matrices(q_nh_in_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_in_list <- list(setup_q_nh_in1,setup_q_nh_in2,setup_q_nh_in5,
                           setup_q_nh_in10,setup_q_nh_in11,setup_q_nh_in12,
                           setup_q_nh_in13,setup_q_nh_in15,setup_q_nh_in17,
                           setup_q_nh_in19,setup_q_nh_in21,setup_q_nh_in23,
                           setup_q_nh_in24,setup_q_nh_in25,setup_q_nh_in26,
                           setup_q_nh_in28,setup_q_nh_in29,setup_q_nh_in30,
                           setup_q_nh_in31,setup_q_nh_in32,setup_q_nh_in33,
                           setup_q_nh_in34,setup_q_nh_in36,setup_q_nh_in37,
                           setup_q_nh_in39,setup_q_nh_in40,setup_q_nh_in41,
                           setup_q_nh_in44,setup_q_nh_in45,setup_q_nh_in47,
                           setup_q_nh_in50,setup_q_nh_in51,setup_q_nh_in53,
                           setup_q_nh_in54,setup_q_nh_in55)
rm(setup_q_nh_in1,setup_q_nh_in2,setup_q_nh_in5,
   setup_q_nh_in10,setup_q_nh_in11,setup_q_nh_in12,
   setup_q_nh_in13,setup_q_nh_in15,setup_q_nh_in17,
   setup_q_nh_in19,setup_q_nh_in21,setup_q_nh_in23,
   setup_q_nh_in24,setup_q_nh_in25,setup_q_nh_in26,
   setup_q_nh_in28,setup_q_nh_in29,setup_q_nh_in30,
   setup_q_nh_in31,setup_q_nh_in32,setup_q_nh_in33,
   setup_q_nh_in34,setup_q_nh_in36,setup_q_nh_in37,
   setup_q_nh_in39,setup_q_nh_in40,setup_q_nh_in41,
   setup_q_nh_in44,setup_q_nh_in45,setup_q_nh_in47,
   setup_q_nh_in50,setup_q_nh_in51,setup_q_nh_in53,
   setup_q_nh_in54,setup_q_nh_in55)
# DID #
q_nh_in_est_did1 <- did_estimate(setup_q_nh_in_list[[1]]$Y, setup_q_nh_in_list[[1]]$N0, setup_q_nh_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_in_est_did2 <- did_estimate(setup_q_nh_in_list[[2]]$Y, setup_q_nh_in_list[[2]]$N0, setup_q_nh_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_in_est_did5 <- did_estimate(setup_q_nh_in_list[[3]]$Y, setup_q_nh_in_list[[3]]$N0, setup_q_nh_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_in_est_did10 <- did_estimate(setup_q_nh_in_list[[4]]$Y, setup_q_nh_in_list[[4]]$N0, setup_q_nh_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_in_est_did11 <- did_estimate(setup_q_nh_in_list[[5]]$Y, setup_q_nh_in_list[[5]]$N0, setup_q_nh_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_in_est_did12 <- did_estimate(setup_q_nh_in_list[[6]]$Y, setup_q_nh_in_list[[6]]$N0, setup_q_nh_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_in_est_did13 <- did_estimate(setup_q_nh_in_list[[7]]$Y, setup_q_nh_in_list[[7]]$N0, setup_q_nh_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_in_est_did15 <- did_estimate(setup_q_nh_in_list[[8]]$Y, setup_q_nh_in_list[[8]]$N0, setup_q_nh_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_in_est_did17 <- did_estimate(setup_q_nh_in_list[[9]]$Y, setup_q_nh_in_list[[9]]$N0, setup_q_nh_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_in_est_did19 <- did_estimate(setup_q_nh_in_list[[10]]$Y, setup_q_nh_in_list[[10]]$N0, setup_q_nh_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_in_est_did21 <- did_estimate(setup_q_nh_in_list[[11]]$Y, setup_q_nh_in_list[[11]]$N0, setup_q_nh_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_in_est_did23 <- did_estimate(setup_q_nh_in_list[[12]]$Y, setup_q_nh_in_list[[12]]$N0, setup_q_nh_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_in_est_did24 <- did_estimate(setup_q_nh_in_list[[13]]$Y, setup_q_nh_in_list[[13]]$N0, setup_q_nh_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_in_est_did25 <- did_estimate(setup_q_nh_in_list[[14]]$Y, setup_q_nh_in_list[[14]]$N0, setup_q_nh_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_in_est_did26 <- did_estimate(setup_q_nh_in_list[[15]]$Y, setup_q_nh_in_list[[15]]$N0, setup_q_nh_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_in_est_did28 <- did_estimate(setup_q_nh_in_list[[16]]$Y, setup_q_nh_in_list[[16]]$N0, setup_q_nh_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_in_est_did29 <- did_estimate(setup_q_nh_in_list[[17]]$Y, setup_q_nh_in_list[[17]]$N0, setup_q_nh_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_in_est_did30 <- did_estimate(setup_q_nh_in_list[[18]]$Y, setup_q_nh_in_list[[18]]$N0, setup_q_nh_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_in_est_did31 <- did_estimate(setup_q_nh_in_list[[19]]$Y, setup_q_nh_in_list[[19]]$N0, setup_q_nh_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_in_est_did32 <- did_estimate(setup_q_nh_in_list[[20]]$Y, setup_q_nh_in_list[[20]]$N0, setup_q_nh_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_in_est_did33 <- did_estimate(setup_q_nh_in_list[[21]]$Y, setup_q_nh_in_list[[21]]$N0, setup_q_nh_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_in_est_did34 <- did_estimate(setup_q_nh_in_list[[22]]$Y, setup_q_nh_in_list[[22]]$N0, setup_q_nh_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_in_est_did36 <- did_estimate(setup_q_nh_in_list[[23]]$Y, setup_q_nh_in_list[[23]]$N0, setup_q_nh_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_in_est_did37 <- did_estimate(setup_q_nh_in_list[[24]]$Y, setup_q_nh_in_list[[24]]$N0, setup_q_nh_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_in_est_did39 <- did_estimate(setup_q_nh_in_list[[25]]$Y, setup_q_nh_in_list[[25]]$N0, setup_q_nh_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_in_est_did40 <- did_estimate(setup_q_nh_in_list[[26]]$Y, setup_q_nh_in_list[[26]]$N0, setup_q_nh_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_in_est_did41 <- did_estimate(setup_q_nh_in_list[[27]]$Y, setup_q_nh_in_list[[27]]$N0, setup_q_nh_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_in_est_did44 <- did_estimate(setup_q_nh_in_list[[28]]$Y, setup_q_nh_in_list[[28]]$N0, setup_q_nh_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_in_est_did45 <- did_estimate(setup_q_nh_in_list[[29]]$Y, setup_q_nh_in_list[[29]]$N0, setup_q_nh_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_in_est_did47 <- did_estimate(setup_q_nh_in_list[[30]]$Y, setup_q_nh_in_list[[30]]$N0, setup_q_nh_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_in_est_did50 <- did_estimate(setup_q_nh_in_list[[31]]$Y, setup_q_nh_in_list[[31]]$N0, setup_q_nh_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_in_est_did51 <- did_estimate(setup_q_nh_in_list[[32]]$Y, setup_q_nh_in_list[[32]]$N0, setup_q_nh_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_in_est_did53 <- did_estimate(setup_q_nh_in_list[[33]]$Y, setup_q_nh_in_list[[33]]$N0, setup_q_nh_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_in_est_did54 <- did_estimate(setup_q_nh_in_list[[34]]$Y, setup_q_nh_in_list[[34]]$N0, setup_q_nh_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_in_est_did55 <- did_estimate(setup_q_nh_in_list[[35]]$Y, setup_q_nh_in_list[[35]]$N0, setup_q_nh_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_in_est_did_list <- list(q_nh_in_est_did1,q_nh_in_est_did2,q_nh_in_est_did5,
                             q_nh_in_est_did10,q_nh_in_est_did11,q_nh_in_est_did12,
                             q_nh_in_est_did13,q_nh_in_est_did15,q_nh_in_est_did17,
                             q_nh_in_est_did19,q_nh_in_est_did21,q_nh_in_est_did23,
                             q_nh_in_est_did24,q_nh_in_est_did25,q_nh_in_est_did26,
                             q_nh_in_est_did28,q_nh_in_est_did29,q_nh_in_est_did30,
                             q_nh_in_est_did31,q_nh_in_est_did32,q_nh_in_est_did33,
                             q_nh_in_est_did34,q_nh_in_est_did36,q_nh_in_est_did37,
                             q_nh_in_est_did39,q_nh_in_est_did40,q_nh_in_est_did41,
                             q_nh_in_est_did44,q_nh_in_est_did45,q_nh_in_est_did47,
                             q_nh_in_est_did50,q_nh_in_est_did51,q_nh_in_est_did53,
                             q_nh_in_est_did54,q_nh_in_est_did55)
rm(q_nh_in_est_did1,q_nh_in_est_did2,q_nh_in_est_did5,
   q_nh_in_est_did10,q_nh_in_est_did11,q_nh_in_est_did12,
   q_nh_in_est_did13,q_nh_in_est_did15,q_nh_in_est_did17,
   q_nh_in_est_did19,q_nh_in_est_did21,q_nh_in_est_did23,
   q_nh_in_est_did24,q_nh_in_est_did25,q_nh_in_est_did26,
   q_nh_in_est_did28,q_nh_in_est_did29,q_nh_in_est_did30,
   q_nh_in_est_did31,q_nh_in_est_did32,q_nh_in_est_did33,
   q_nh_in_est_did34,q_nh_in_est_did36,q_nh_in_est_did37,
   q_nh_in_est_did39,q_nh_in_est_did40,q_nh_in_est_did41,
   q_nh_in_est_did44,q_nh_in_est_did45,q_nh_in_est_did47,
   q_nh_in_est_did50,q_nh_in_est_did51,q_nh_in_est_did53,
   q_nh_in_est_did54,q_nh_in_est_did55)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_did_plot", i), synthdid_plot(q_nh_in_est_did_list[i]))
}
q_nh_in_est_did_plot_data_aux1 <- ggplot_build(q_nh_in_est_did_plot1)
q_nh_in_est_did_plot_data_aux2 <- ggplot_build(q_nh_in_est_did_plot2)
q_nh_in_est_did_plot_data_aux3 <- ggplot_build(q_nh_in_est_did_plot3)
q_nh_in_est_did_plot_data_aux4 <- ggplot_build(q_nh_in_est_did_plot4)
q_nh_in_est_did_plot_data_aux5 <- ggplot_build(q_nh_in_est_did_plot5)
q_nh_in_est_did_plot_data_aux6 <- ggplot_build(q_nh_in_est_did_plot6)
q_nh_in_est_did_plot_data_aux7 <- ggplot_build(q_nh_in_est_did_plot7)
q_nh_in_est_did_plot_data_aux8 <- ggplot_build(q_nh_in_est_did_plot8)
q_nh_in_est_did_plot_data_aux9 <- ggplot_build(q_nh_in_est_did_plot9)
q_nh_in_est_did_plot_data_aux10 <- ggplot_build(q_nh_in_est_did_plot10)
q_nh_in_est_did_plot_data_aux11 <- ggplot_build(q_nh_in_est_did_plot11)
q_nh_in_est_did_plot_data_aux12 <- ggplot_build(q_nh_in_est_did_plot12)
q_nh_in_est_did_plot_data_aux13 <- ggplot_build(q_nh_in_est_did_plot13)
q_nh_in_est_did_plot_data_aux14 <- ggplot_build(q_nh_in_est_did_plot14)
q_nh_in_est_did_plot_data_aux15 <- ggplot_build(q_nh_in_est_did_plot15)
q_nh_in_est_did_plot_data_aux16 <- ggplot_build(q_nh_in_est_did_plot16)
q_nh_in_est_did_plot_data_aux17 <- ggplot_build(q_nh_in_est_did_plot17)
q_nh_in_est_did_plot_data_aux18 <- ggplot_build(q_nh_in_est_did_plot18)
q_nh_in_est_did_plot_data_aux19 <- ggplot_build(q_nh_in_est_did_plot19)
q_nh_in_est_did_plot_data_aux20 <- ggplot_build(q_nh_in_est_did_plot20)
q_nh_in_est_did_plot_data_aux21 <- ggplot_build(q_nh_in_est_did_plot21)
q_nh_in_est_did_plot_data_aux22 <- ggplot_build(q_nh_in_est_did_plot22)
q_nh_in_est_did_plot_data_aux23 <- ggplot_build(q_nh_in_est_did_plot23)
q_nh_in_est_did_plot_data_aux24 <- ggplot_build(q_nh_in_est_did_plot24)
q_nh_in_est_did_plot_data_aux25 <- ggplot_build(q_nh_in_est_did_plot25)
q_nh_in_est_did_plot_data_aux26 <- ggplot_build(q_nh_in_est_did_plot26)
q_nh_in_est_did_plot_data_aux27 <- ggplot_build(q_nh_in_est_did_plot27)
q_nh_in_est_did_plot_data_aux28 <- ggplot_build(q_nh_in_est_did_plot28)
q_nh_in_est_did_plot_data_aux29 <- ggplot_build(q_nh_in_est_did_plot29)
q_nh_in_est_did_plot_data_aux30 <- ggplot_build(q_nh_in_est_did_plot30)
q_nh_in_est_did_plot_data_aux31 <- ggplot_build(q_nh_in_est_did_plot31)
q_nh_in_est_did_plot_data_aux32 <- ggplot_build(q_nh_in_est_did_plot32)
q_nh_in_est_did_plot_data_aux33 <- ggplot_build(q_nh_in_est_did_plot33)
q_nh_in_est_did_plot_data_aux34 <- ggplot_build(q_nh_in_est_did_plot34)
q_nh_in_est_did_plot_data_aux35 <- ggplot_build(q_nh_in_est_did_plot35)
q_nh_in_est_did_plot_data_aux_list <- list(q_nh_in_est_did_plot_data_aux1,q_nh_in_est_did_plot_data_aux2,q_nh_in_est_did_plot_data_aux3,
                                           q_nh_in_est_did_plot_data_aux4,q_nh_in_est_did_plot_data_aux5,q_nh_in_est_did_plot_data_aux6,
                                           q_nh_in_est_did_plot_data_aux7,q_nh_in_est_did_plot_data_aux8,q_nh_in_est_did_plot_data_aux9,
                                           q_nh_in_est_did_plot_data_aux10,q_nh_in_est_did_plot_data_aux11,q_nh_in_est_did_plot_data_aux12,
                                           q_nh_in_est_did_plot_data_aux13,q_nh_in_est_did_plot_data_aux14,q_nh_in_est_did_plot_data_aux15,
                                           q_nh_in_est_did_plot_data_aux16,q_nh_in_est_did_plot_data_aux17,q_nh_in_est_did_plot_data_aux18,
                                           q_nh_in_est_did_plot_data_aux19,q_nh_in_est_did_plot_data_aux20,q_nh_in_est_did_plot_data_aux21,
                                           q_nh_in_est_did_plot_data_aux22,q_nh_in_est_did_plot_data_aux23,q_nh_in_est_did_plot_data_aux24,
                                           q_nh_in_est_did_plot_data_aux25,q_nh_in_est_did_plot_data_aux26,q_nh_in_est_did_plot_data_aux27,
                                           q_nh_in_est_did_plot_data_aux28,q_nh_in_est_did_plot_data_aux29,q_nh_in_est_did_plot_data_aux30,
                                           q_nh_in_est_did_plot_data_aux31,q_nh_in_est_did_plot_data_aux32,q_nh_in_est_did_plot_data_aux33,
                                           q_nh_in_est_did_plot_data_aux34,q_nh_in_est_did_plot_data_aux35)
rm(q_nh_in_est_did_plot_data_aux1,q_nh_in_est_did_plot_data_aux2,q_nh_in_est_did_plot_data_aux3,
   q_nh_in_est_did_plot_data_aux4,q_nh_in_est_did_plot_data_aux5,q_nh_in_est_did_plot_data_aux6,
   q_nh_in_est_did_plot_data_aux7,q_nh_in_est_did_plot_data_aux8,q_nh_in_est_did_plot_data_aux9,
   q_nh_in_est_did_plot_data_aux10,q_nh_in_est_did_plot_data_aux11,q_nh_in_est_did_plot_data_aux12,
   q_nh_in_est_did_plot_data_aux13,q_nh_in_est_did_plot_data_aux14,q_nh_in_est_did_plot_data_aux15,
   q_nh_in_est_did_plot_data_aux16,q_nh_in_est_did_plot_data_aux17,q_nh_in_est_did_plot_data_aux18,
   q_nh_in_est_did_plot_data_aux19,q_nh_in_est_did_plot_data_aux20,q_nh_in_est_did_plot_data_aux21,
   q_nh_in_est_did_plot_data_aux22,q_nh_in_est_did_plot_data_aux23,q_nh_in_est_did_plot_data_aux24,
   q_nh_in_est_did_plot_data_aux25,q_nh_in_est_did_plot_data_aux26,q_nh_in_est_did_plot_data_aux27,
   q_nh_in_est_did_plot_data_aux28,q_nh_in_est_did_plot_data_aux29,q_nh_in_est_did_plot_data_aux30,
   q_nh_in_est_did_plot_data_aux31,q_nh_in_est_did_plot_data_aux32,q_nh_in_est_did_plot_data_aux33,
   q_nh_in_est_did_plot_data_aux34,q_nh_in_est_did_plot_data_aux35)
rm(q_nh_in_est_did_plot1,q_nh_in_est_did_plot2,q_nh_in_est_did_plot3,
   q_nh_in_est_did_plot4,q_nh_in_est_did_plot5,q_nh_in_est_did_plot6,
   q_nh_in_est_did_plot7,q_nh_in_est_did_plot8,q_nh_in_est_did_plot9,
   q_nh_in_est_did_plot10,q_nh_in_est_did_plot11,q_nh_in_est_did_plot12,
   q_nh_in_est_did_plot13,q_nh_in_est_did_plot14,q_nh_in_est_did_plot15,
   q_nh_in_est_did_plot16,q_nh_in_est_did_plot17,q_nh_in_est_did_plot18,
   q_nh_in_est_did_plot19,q_nh_in_est_did_plot20,q_nh_in_est_did_plot21,
   q_nh_in_est_did_plot22,q_nh_in_est_did_plot23,q_nh_in_est_did_plot24,
   q_nh_in_est_did_plot25,q_nh_in_est_did_plot26,q_nh_in_est_did_plot27,
   q_nh_in_est_did_plot28,q_nh_in_est_did_plot29,q_nh_in_est_did_plot30,
   q_nh_in_est_did_plot31,q_nh_in_est_did_plot32,q_nh_in_est_did_plot33,
   q_nh_in_est_did_plot34,q_nh_in_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_did_plot_data_long", i), data.frame(q_nh_in_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_in_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_in_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_in_est_did_plot_data_long_list <- list(q_nh_in_est_did_plot_data_long1,q_nh_in_est_did_plot_data_long2,q_nh_in_est_did_plot_data_long3,
                                            q_nh_in_est_did_plot_data_long4,q_nh_in_est_did_plot_data_long5,q_nh_in_est_did_plot_data_long6,
                                            q_nh_in_est_did_plot_data_long7,q_nh_in_est_did_plot_data_long8,q_nh_in_est_did_plot_data_long9,
                                            q_nh_in_est_did_plot_data_long10,q_nh_in_est_did_plot_data_long11,q_nh_in_est_did_plot_data_long12,
                                            q_nh_in_est_did_plot_data_long13,q_nh_in_est_did_plot_data_long14,q_nh_in_est_did_plot_data_long15,
                                            q_nh_in_est_did_plot_data_long16,q_nh_in_est_did_plot_data_long17,q_nh_in_est_did_plot_data_long18,
                                            q_nh_in_est_did_plot_data_long19,q_nh_in_est_did_plot_data_long20,q_nh_in_est_did_plot_data_long21,
                                            q_nh_in_est_did_plot_data_long22,q_nh_in_est_did_plot_data_long23,q_nh_in_est_did_plot_data_long24,
                                            q_nh_in_est_did_plot_data_long25,q_nh_in_est_did_plot_data_long26,q_nh_in_est_did_plot_data_long27,
                                            q_nh_in_est_did_plot_data_long28,q_nh_in_est_did_plot_data_long29,q_nh_in_est_did_plot_data_long30,
                                            q_nh_in_est_did_plot_data_long31,q_nh_in_est_did_plot_data_long32,q_nh_in_est_did_plot_data_long33,
                                            q_nh_in_est_did_plot_data_long34,q_nh_in_est_did_plot_data_long35)
rm(q_nh_in_est_did_plot_data_long1,q_nh_in_est_did_plot_data_long2,q_nh_in_est_did_plot_data_long3,
   q_nh_in_est_did_plot_data_long4,q_nh_in_est_did_plot_data_long5,q_nh_in_est_did_plot_data_long6,
   q_nh_in_est_did_plot_data_long7,q_nh_in_est_did_plot_data_long8,q_nh_in_est_did_plot_data_long9,
   q_nh_in_est_did_plot_data_long10,q_nh_in_est_did_plot_data_long11,q_nh_in_est_did_plot_data_long12,
   q_nh_in_est_did_plot_data_long13,q_nh_in_est_did_plot_data_long14,q_nh_in_est_did_plot_data_long15,
   q_nh_in_est_did_plot_data_long16,q_nh_in_est_did_plot_data_long17,q_nh_in_est_did_plot_data_long18,
   q_nh_in_est_did_plot_data_long19,q_nh_in_est_did_plot_data_long20,q_nh_in_est_did_plot_data_long21,
   q_nh_in_est_did_plot_data_long22,q_nh_in_est_did_plot_data_long23,q_nh_in_est_did_plot_data_long24,
   q_nh_in_est_did_plot_data_long25,q_nh_in_est_did_plot_data_long26,q_nh_in_est_did_plot_data_long27,
   q_nh_in_est_did_plot_data_long28,q_nh_in_est_did_plot_data_long29,q_nh_in_est_did_plot_data_long30,
   q_nh_in_est_did_plot_data_long31,q_nh_in_est_did_plot_data_long32,q_nh_in_est_did_plot_data_long33,
   q_nh_in_est_did_plot_data_long34,q_nh_in_est_did_plot_data_long35)
q_nh_in_est_did_plot_data_long_list <- lapply(q_nh_in_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_did_plot_data_wide", i), reshape(data=q_nh_in_est_did_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
q_nh_in_est_did_plot_data_wide_list <- list(q_nh_in_est_did_plot_data_wide1,q_nh_in_est_did_plot_data_wide2,q_nh_in_est_did_plot_data_wide3,
                                            q_nh_in_est_did_plot_data_wide4,q_nh_in_est_did_plot_data_wide5,q_nh_in_est_did_plot_data_wide6,
                                            q_nh_in_est_did_plot_data_wide7,q_nh_in_est_did_plot_data_wide8,q_nh_in_est_did_plot_data_wide9,
                                            q_nh_in_est_did_plot_data_wide10,q_nh_in_est_did_plot_data_wide11,q_nh_in_est_did_plot_data_wide12,
                                            q_nh_in_est_did_plot_data_wide13,q_nh_in_est_did_plot_data_wide14,q_nh_in_est_did_plot_data_wide15,
                                            q_nh_in_est_did_plot_data_wide16,q_nh_in_est_did_plot_data_wide17,q_nh_in_est_did_plot_data_wide18,
                                            q_nh_in_est_did_plot_data_wide19,q_nh_in_est_did_plot_data_wide20,q_nh_in_est_did_plot_data_wide21,
                                            q_nh_in_est_did_plot_data_wide22,q_nh_in_est_did_plot_data_wide23,q_nh_in_est_did_plot_data_wide24,
                                            q_nh_in_est_did_plot_data_wide25,q_nh_in_est_did_plot_data_wide26,q_nh_in_est_did_plot_data_wide27,
                                            q_nh_in_est_did_plot_data_wide28,q_nh_in_est_did_plot_data_wide29,q_nh_in_est_did_plot_data_wide30,
                                            q_nh_in_est_did_plot_data_wide31,q_nh_in_est_did_plot_data_wide32,q_nh_in_est_did_plot_data_wide33,
                                            q_nh_in_est_did_plot_data_wide34,q_nh_in_est_did_plot_data_wide35)
rm(q_nh_in_est_did_plot_data_wide1,q_nh_in_est_did_plot_data_wide2,q_nh_in_est_did_plot_data_wide3,
   q_nh_in_est_did_plot_data_wide4,q_nh_in_est_did_plot_data_wide5,q_nh_in_est_did_plot_data_wide6,
   q_nh_in_est_did_plot_data_wide7,q_nh_in_est_did_plot_data_wide8,q_nh_in_est_did_plot_data_wide9,
   q_nh_in_est_did_plot_data_wide10,q_nh_in_est_did_plot_data_wide11,q_nh_in_est_did_plot_data_wide12,
   q_nh_in_est_did_plot_data_wide13,q_nh_in_est_did_plot_data_wide14,q_nh_in_est_did_plot_data_wide15,
   q_nh_in_est_did_plot_data_wide16,q_nh_in_est_did_plot_data_wide17,q_nh_in_est_did_plot_data_wide18,
   q_nh_in_est_did_plot_data_wide19,q_nh_in_est_did_plot_data_wide20,q_nh_in_est_did_plot_data_wide21,
   q_nh_in_est_did_plot_data_wide22,q_nh_in_est_did_plot_data_wide23,q_nh_in_est_did_plot_data_wide24,
   q_nh_in_est_did_plot_data_wide25,q_nh_in_est_did_plot_data_wide26,q_nh_in_est_did_plot_data_wide27,
   q_nh_in_est_did_plot_data_wide28,q_nh_in_est_did_plot_data_wide29,q_nh_in_est_did_plot_data_wide30,
   q_nh_in_est_did_plot_data_wide31,q_nh_in_est_did_plot_data_wide32,q_nh_in_est_did_plot_data_wide33,
   q_nh_in_est_did_plot_data_wide34,q_nh_in_est_did_plot_data_wide35)
q_nh_in_est_did_plot_data_wide_list <- lapply(q_nh_in_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nh_in_est_sc1 <- sc_estimate(setup_q_nh_in_list[[1]]$Y, setup_q_nh_in_list[[1]]$N0, setup_q_nh_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_in_est_sc2 <- sc_estimate(setup_q_nh_in_list[[2]]$Y, setup_q_nh_in_list[[2]]$N0, setup_q_nh_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_in_est_sc5 <- sc_estimate(setup_q_nh_in_list[[3]]$Y, setup_q_nh_in_list[[3]]$N0, setup_q_nh_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_in_est_sc10 <- sc_estimate(setup_q_nh_in_list[[4]]$Y, setup_q_nh_in_list[[4]]$N0, setup_q_nh_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_in_est_sc11 <- sc_estimate(setup_q_nh_in_list[[5]]$Y, setup_q_nh_in_list[[5]]$N0, setup_q_nh_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_in_est_sc12 <- sc_estimate(setup_q_nh_in_list[[6]]$Y, setup_q_nh_in_list[[6]]$N0, setup_q_nh_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_in_est_sc13 <- sc_estimate(setup_q_nh_in_list[[7]]$Y, setup_q_nh_in_list[[7]]$N0, setup_q_nh_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_in_est_sc15 <- sc_estimate(setup_q_nh_in_list[[8]]$Y, setup_q_nh_in_list[[8]]$N0, setup_q_nh_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_in_est_sc17 <- sc_estimate(setup_q_nh_in_list[[9]]$Y, setup_q_nh_in_list[[9]]$N0, setup_q_nh_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_in_est_sc19 <- sc_estimate(setup_q_nh_in_list[[10]]$Y, setup_q_nh_in_list[[10]]$N0, setup_q_nh_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_in_est_sc21 <- sc_estimate(setup_q_nh_in_list[[11]]$Y, setup_q_nh_in_list[[11]]$N0, setup_q_nh_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_in_est_sc23 <- sc_estimate(setup_q_nh_in_list[[12]]$Y, setup_q_nh_in_list[[12]]$N0, setup_q_nh_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_in_est_sc24 <- sc_estimate(setup_q_nh_in_list[[13]]$Y, setup_q_nh_in_list[[13]]$N0, setup_q_nh_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_in_est_sc25 <- sc_estimate(setup_q_nh_in_list[[14]]$Y, setup_q_nh_in_list[[14]]$N0, setup_q_nh_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_in_est_sc26 <- sc_estimate(setup_q_nh_in_list[[15]]$Y, setup_q_nh_in_list[[15]]$N0, setup_q_nh_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_in_est_sc28 <- sc_estimate(setup_q_nh_in_list[[16]]$Y, setup_q_nh_in_list[[16]]$N0, setup_q_nh_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_in_est_sc29 <- sc_estimate(setup_q_nh_in_list[[17]]$Y, setup_q_nh_in_list[[17]]$N0, setup_q_nh_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_in_est_sc30 <- sc_estimate(setup_q_nh_in_list[[18]]$Y, setup_q_nh_in_list[[18]]$N0, setup_q_nh_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_in_est_sc31 <- sc_estimate(setup_q_nh_in_list[[19]]$Y, setup_q_nh_in_list[[19]]$N0, setup_q_nh_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_in_est_sc32 <- sc_estimate(setup_q_nh_in_list[[20]]$Y, setup_q_nh_in_list[[20]]$N0, setup_q_nh_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_in_est_sc33 <- sc_estimate(setup_q_nh_in_list[[21]]$Y, setup_q_nh_in_list[[21]]$N0, setup_q_nh_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_in_est_sc34 <- sc_estimate(setup_q_nh_in_list[[22]]$Y, setup_q_nh_in_list[[22]]$N0, setup_q_nh_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_in_est_sc36 <- sc_estimate(setup_q_nh_in_list[[23]]$Y, setup_q_nh_in_list[[23]]$N0, setup_q_nh_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_in_est_sc37 <- sc_estimate(setup_q_nh_in_list[[24]]$Y, setup_q_nh_in_list[[24]]$N0, setup_q_nh_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_in_est_sc39 <- sc_estimate(setup_q_nh_in_list[[25]]$Y, setup_q_nh_in_list[[25]]$N0, setup_q_nh_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_in_est_sc40 <- sc_estimate(setup_q_nh_in_list[[26]]$Y, setup_q_nh_in_list[[26]]$N0, setup_q_nh_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_in_est_sc41 <- sc_estimate(setup_q_nh_in_list[[27]]$Y, setup_q_nh_in_list[[27]]$N0, setup_q_nh_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_in_est_sc44 <- sc_estimate(setup_q_nh_in_list[[28]]$Y, setup_q_nh_in_list[[28]]$N0, setup_q_nh_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_in_est_sc45 <- sc_estimate(setup_q_nh_in_list[[29]]$Y, setup_q_nh_in_list[[29]]$N0, setup_q_nh_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_in_est_sc47 <- sc_estimate(setup_q_nh_in_list[[30]]$Y, setup_q_nh_in_list[[30]]$N0, setup_q_nh_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_in_est_sc50 <- sc_estimate(setup_q_nh_in_list[[31]]$Y, setup_q_nh_in_list[[31]]$N0, setup_q_nh_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_in_est_sc51 <- sc_estimate(setup_q_nh_in_list[[32]]$Y, setup_q_nh_in_list[[32]]$N0, setup_q_nh_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_in_est_sc53 <- sc_estimate(setup_q_nh_in_list[[33]]$Y, setup_q_nh_in_list[[33]]$N0, setup_q_nh_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_in_est_sc54 <- sc_estimate(setup_q_nh_in_list[[34]]$Y, setup_q_nh_in_list[[34]]$N0, setup_q_nh_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_in_est_sc55 <- sc_estimate(setup_q_nh_in_list[[35]]$Y, setup_q_nh_in_list[[35]]$N0, setup_q_nh_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_in_est_sc_list <- list(q_nh_in_est_sc1,q_nh_in_est_sc2,q_nh_in_est_sc5,
                            q_nh_in_est_sc10,q_nh_in_est_sc11,q_nh_in_est_sc12,
                            q_nh_in_est_sc13,q_nh_in_est_sc15,q_nh_in_est_sc17,
                            q_nh_in_est_sc19,q_nh_in_est_sc21,q_nh_in_est_sc23,
                            q_nh_in_est_sc24,q_nh_in_est_sc25,q_nh_in_est_sc26,
                            q_nh_in_est_sc28,q_nh_in_est_sc29,q_nh_in_est_sc30,
                            q_nh_in_est_sc31,q_nh_in_est_sc32,q_nh_in_est_sc33,
                            q_nh_in_est_sc34,q_nh_in_est_sc36,q_nh_in_est_sc37,
                            q_nh_in_est_sc39,q_nh_in_est_sc40,q_nh_in_est_sc41,
                            q_nh_in_est_sc44,q_nh_in_est_sc45,q_nh_in_est_sc47,
                            q_nh_in_est_sc50,q_nh_in_est_sc51,q_nh_in_est_sc53,
                            q_nh_in_est_sc54,q_nh_in_est_sc55)
rm(q_nh_in_est_sc1,q_nh_in_est_sc2,q_nh_in_est_sc5,
   q_nh_in_est_sc10,q_nh_in_est_sc11,q_nh_in_est_sc12,
   q_nh_in_est_sc13,q_nh_in_est_sc15,q_nh_in_est_sc17,
   q_nh_in_est_sc19,q_nh_in_est_sc21,q_nh_in_est_sc23,
   q_nh_in_est_sc24,q_nh_in_est_sc25,q_nh_in_est_sc26,
   q_nh_in_est_sc28,q_nh_in_est_sc29,q_nh_in_est_sc30,
   q_nh_in_est_sc31,q_nh_in_est_sc32,q_nh_in_est_sc33,
   q_nh_in_est_sc34,q_nh_in_est_sc36,q_nh_in_est_sc37,
   q_nh_in_est_sc39,q_nh_in_est_sc40,q_nh_in_est_sc41,
   q_nh_in_est_sc44,q_nh_in_est_sc45,q_nh_in_est_sc47,
   q_nh_in_est_sc50,q_nh_in_est_sc51,q_nh_in_est_sc53,
   q_nh_in_est_sc54,q_nh_in_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sc_plot", i), synthdid_plot(q_nh_in_est_sc_list[i]))
}
q_nh_in_est_sc_plot_data_aux1 <- ggplot_build(q_nh_in_est_sc_plot1)
q_nh_in_est_sc_plot_data_aux2 <- ggplot_build(q_nh_in_est_sc_plot2)
q_nh_in_est_sc_plot_data_aux3 <- ggplot_build(q_nh_in_est_sc_plot3)
q_nh_in_est_sc_plot_data_aux4 <- ggplot_build(q_nh_in_est_sc_plot4)
q_nh_in_est_sc_plot_data_aux5 <- ggplot_build(q_nh_in_est_sc_plot5)
q_nh_in_est_sc_plot_data_aux6 <- ggplot_build(q_nh_in_est_sc_plot6)
q_nh_in_est_sc_plot_data_aux7 <- ggplot_build(q_nh_in_est_sc_plot7)
q_nh_in_est_sc_plot_data_aux8 <- ggplot_build(q_nh_in_est_sc_plot8)
q_nh_in_est_sc_plot_data_aux9 <- ggplot_build(q_nh_in_est_sc_plot9)
q_nh_in_est_sc_plot_data_aux10 <- ggplot_build(q_nh_in_est_sc_plot10)
q_nh_in_est_sc_plot_data_aux11 <- ggplot_build(q_nh_in_est_sc_plot11)
q_nh_in_est_sc_plot_data_aux12 <- ggplot_build(q_nh_in_est_sc_plot12)
q_nh_in_est_sc_plot_data_aux13 <- ggplot_build(q_nh_in_est_sc_plot13)
q_nh_in_est_sc_plot_data_aux14 <- ggplot_build(q_nh_in_est_sc_plot14)
q_nh_in_est_sc_plot_data_aux15 <- ggplot_build(q_nh_in_est_sc_plot15)
q_nh_in_est_sc_plot_data_aux16 <- ggplot_build(q_nh_in_est_sc_plot16)
q_nh_in_est_sc_plot_data_aux17 <- ggplot_build(q_nh_in_est_sc_plot17)
q_nh_in_est_sc_plot_data_aux18 <- ggplot_build(q_nh_in_est_sc_plot18)
q_nh_in_est_sc_plot_data_aux19 <- ggplot_build(q_nh_in_est_sc_plot19)
q_nh_in_est_sc_plot_data_aux20 <- ggplot_build(q_nh_in_est_sc_plot20)
q_nh_in_est_sc_plot_data_aux21 <- ggplot_build(q_nh_in_est_sc_plot21)
q_nh_in_est_sc_plot_data_aux22 <- ggplot_build(q_nh_in_est_sc_plot22)
q_nh_in_est_sc_plot_data_aux23 <- ggplot_build(q_nh_in_est_sc_plot23)
q_nh_in_est_sc_plot_data_aux24 <- ggplot_build(q_nh_in_est_sc_plot24)
q_nh_in_est_sc_plot_data_aux25 <- ggplot_build(q_nh_in_est_sc_plot25)
q_nh_in_est_sc_plot_data_aux26 <- ggplot_build(q_nh_in_est_sc_plot26)
q_nh_in_est_sc_plot_data_aux27 <- ggplot_build(q_nh_in_est_sc_plot27)
q_nh_in_est_sc_plot_data_aux28 <- ggplot_build(q_nh_in_est_sc_plot28)
q_nh_in_est_sc_plot_data_aux29 <- ggplot_build(q_nh_in_est_sc_plot29)
q_nh_in_est_sc_plot_data_aux30 <- ggplot_build(q_nh_in_est_sc_plot30)
q_nh_in_est_sc_plot_data_aux31 <- ggplot_build(q_nh_in_est_sc_plot31)
q_nh_in_est_sc_plot_data_aux32 <- ggplot_build(q_nh_in_est_sc_plot32)
q_nh_in_est_sc_plot_data_aux33 <- ggplot_build(q_nh_in_est_sc_plot33)
q_nh_in_est_sc_plot_data_aux34 <- ggplot_build(q_nh_in_est_sc_plot34)
q_nh_in_est_sc_plot_data_aux35 <- ggplot_build(q_nh_in_est_sc_plot35)
q_nh_in_est_sc_plot_data_aux_list <- list(q_nh_in_est_sc_plot_data_aux1,q_nh_in_est_sc_plot_data_aux2,q_nh_in_est_sc_plot_data_aux3,
                                          q_nh_in_est_sc_plot_data_aux4,q_nh_in_est_sc_plot_data_aux5,q_nh_in_est_sc_plot_data_aux6,
                                          q_nh_in_est_sc_plot_data_aux7,q_nh_in_est_sc_plot_data_aux8,q_nh_in_est_sc_plot_data_aux9,
                                          q_nh_in_est_sc_plot_data_aux10,q_nh_in_est_sc_plot_data_aux11,q_nh_in_est_sc_plot_data_aux12,
                                          q_nh_in_est_sc_plot_data_aux13,q_nh_in_est_sc_plot_data_aux14,q_nh_in_est_sc_plot_data_aux15,
                                          q_nh_in_est_sc_plot_data_aux16,q_nh_in_est_sc_plot_data_aux17,q_nh_in_est_sc_plot_data_aux18,
                                          q_nh_in_est_sc_plot_data_aux19,q_nh_in_est_sc_plot_data_aux20,q_nh_in_est_sc_plot_data_aux21,
                                          q_nh_in_est_sc_plot_data_aux22,q_nh_in_est_sc_plot_data_aux23,q_nh_in_est_sc_plot_data_aux24,
                                          q_nh_in_est_sc_plot_data_aux25,q_nh_in_est_sc_plot_data_aux26,q_nh_in_est_sc_plot_data_aux27,
                                          q_nh_in_est_sc_plot_data_aux28,q_nh_in_est_sc_plot_data_aux29,q_nh_in_est_sc_plot_data_aux30,
                                          q_nh_in_est_sc_plot_data_aux31,q_nh_in_est_sc_plot_data_aux32,q_nh_in_est_sc_plot_data_aux33,
                                          q_nh_in_est_sc_plot_data_aux34,q_nh_in_est_sc_plot_data_aux35)
rm(q_nh_in_est_sc_plot_data_aux1,q_nh_in_est_sc_plot_data_aux2,q_nh_in_est_sc_plot_data_aux3,
   q_nh_in_est_sc_plot_data_aux4,q_nh_in_est_sc_plot_data_aux5,q_nh_in_est_sc_plot_data_aux6,
   q_nh_in_est_sc_plot_data_aux7,q_nh_in_est_sc_plot_data_aux8,q_nh_in_est_sc_plot_data_aux9,
   q_nh_in_est_sc_plot_data_aux10,q_nh_in_est_sc_plot_data_aux11,q_nh_in_est_sc_plot_data_aux12,
   q_nh_in_est_sc_plot_data_aux13,q_nh_in_est_sc_plot_data_aux14,q_nh_in_est_sc_plot_data_aux15,
   q_nh_in_est_sc_plot_data_aux16,q_nh_in_est_sc_plot_data_aux17,q_nh_in_est_sc_plot_data_aux18,
   q_nh_in_est_sc_plot_data_aux19,q_nh_in_est_sc_plot_data_aux20,q_nh_in_est_sc_plot_data_aux21,
   q_nh_in_est_sc_plot_data_aux22,q_nh_in_est_sc_plot_data_aux23,q_nh_in_est_sc_plot_data_aux24,
   q_nh_in_est_sc_plot_data_aux25,q_nh_in_est_sc_plot_data_aux26,q_nh_in_est_sc_plot_data_aux27,
   q_nh_in_est_sc_plot_data_aux28,q_nh_in_est_sc_plot_data_aux29,q_nh_in_est_sc_plot_data_aux30,
   q_nh_in_est_sc_plot_data_aux31,q_nh_in_est_sc_plot_data_aux32,q_nh_in_est_sc_plot_data_aux33,
   q_nh_in_est_sc_plot_data_aux34,q_nh_in_est_sc_plot_data_aux35)
rm(q_nh_in_est_sc_plot1,q_nh_in_est_sc_plot2,q_nh_in_est_sc_plot3,
   q_nh_in_est_sc_plot4,q_nh_in_est_sc_plot5,q_nh_in_est_sc_plot6,
   q_nh_in_est_sc_plot7,q_nh_in_est_sc_plot8,q_nh_in_est_sc_plot9,
   q_nh_in_est_sc_plot10,q_nh_in_est_sc_plot11,q_nh_in_est_sc_plot12,
   q_nh_in_est_sc_plot13,q_nh_in_est_sc_plot14,q_nh_in_est_sc_plot15,
   q_nh_in_est_sc_plot16,q_nh_in_est_sc_plot17,q_nh_in_est_sc_plot18,
   q_nh_in_est_sc_plot19,q_nh_in_est_sc_plot20,q_nh_in_est_sc_plot21,
   q_nh_in_est_sc_plot22,q_nh_in_est_sc_plot23,q_nh_in_est_sc_plot24,
   q_nh_in_est_sc_plot25,q_nh_in_est_sc_plot26,q_nh_in_est_sc_plot27,
   q_nh_in_est_sc_plot28,q_nh_in_est_sc_plot29,q_nh_in_est_sc_plot30,
   q_nh_in_est_sc_plot31,q_nh_in_est_sc_plot32,q_nh_in_est_sc_plot33,
   q_nh_in_est_sc_plot34,q_nh_in_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sc_plot_data_long", i), data.frame(q_nh_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_in_est_sc_plot_data_long_list <- list(q_nh_in_est_sc_plot_data_long1,q_nh_in_est_sc_plot_data_long2,q_nh_in_est_sc_plot_data_long3,
                                           q_nh_in_est_sc_plot_data_long4,q_nh_in_est_sc_plot_data_long5,q_nh_in_est_sc_plot_data_long6,
                                           q_nh_in_est_sc_plot_data_long7,q_nh_in_est_sc_plot_data_long8,q_nh_in_est_sc_plot_data_long9,
                                           q_nh_in_est_sc_plot_data_long10,q_nh_in_est_sc_plot_data_long11,q_nh_in_est_sc_plot_data_long12,
                                           q_nh_in_est_sc_plot_data_long13,q_nh_in_est_sc_plot_data_long14,q_nh_in_est_sc_plot_data_long15,
                                           q_nh_in_est_sc_plot_data_long16,q_nh_in_est_sc_plot_data_long17,q_nh_in_est_sc_plot_data_long18,
                                           q_nh_in_est_sc_plot_data_long19,q_nh_in_est_sc_plot_data_long20,q_nh_in_est_sc_plot_data_long21,
                                           q_nh_in_est_sc_plot_data_long22,q_nh_in_est_sc_plot_data_long23,q_nh_in_est_sc_plot_data_long24,
                                           q_nh_in_est_sc_plot_data_long25,q_nh_in_est_sc_plot_data_long26,q_nh_in_est_sc_plot_data_long27,
                                           q_nh_in_est_sc_plot_data_long28,q_nh_in_est_sc_plot_data_long29,q_nh_in_est_sc_plot_data_long30,
                                           q_nh_in_est_sc_plot_data_long31,q_nh_in_est_sc_plot_data_long32,q_nh_in_est_sc_plot_data_long33,
                                           q_nh_in_est_sc_plot_data_long34,q_nh_in_est_sc_plot_data_long35)
rm(q_nh_in_est_sc_plot_data_long1,q_nh_in_est_sc_plot_data_long2,q_nh_in_est_sc_plot_data_long3,
   q_nh_in_est_sc_plot_data_long4,q_nh_in_est_sc_plot_data_long5,q_nh_in_est_sc_plot_data_long6,
   q_nh_in_est_sc_plot_data_long7,q_nh_in_est_sc_plot_data_long8,q_nh_in_est_sc_plot_data_long9,
   q_nh_in_est_sc_plot_data_long10,q_nh_in_est_sc_plot_data_long11,q_nh_in_est_sc_plot_data_long12,
   q_nh_in_est_sc_plot_data_long13,q_nh_in_est_sc_plot_data_long14,q_nh_in_est_sc_plot_data_long15,
   q_nh_in_est_sc_plot_data_long16,q_nh_in_est_sc_plot_data_long17,q_nh_in_est_sc_plot_data_long18,
   q_nh_in_est_sc_plot_data_long19,q_nh_in_est_sc_plot_data_long20,q_nh_in_est_sc_plot_data_long21,
   q_nh_in_est_sc_plot_data_long22,q_nh_in_est_sc_plot_data_long23,q_nh_in_est_sc_plot_data_long24,
   q_nh_in_est_sc_plot_data_long25,q_nh_in_est_sc_plot_data_long26,q_nh_in_est_sc_plot_data_long27,
   q_nh_in_est_sc_plot_data_long28,q_nh_in_est_sc_plot_data_long29,q_nh_in_est_sc_plot_data_long30,
   q_nh_in_est_sc_plot_data_long31,q_nh_in_est_sc_plot_data_long32,q_nh_in_est_sc_plot_data_long33,
   q_nh_in_est_sc_plot_data_long34,q_nh_in_est_sc_plot_data_long35)
q_nh_in_est_sc_plot_data_long_list <- lapply(q_nh_in_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sc_plot_data_wide", i), reshape(data=q_nh_in_est_sc_plot_data_long_list[[i]],
                                                             idvar = "year",
                                                             v.names = "outcome",
                                                             timevar = "treated",
                                                             direction = "wide"))
}
q_nh_in_est_sc_plot_data_wide_list <- list(q_nh_in_est_sc_plot_data_wide1,q_nh_in_est_sc_plot_data_wide2,q_nh_in_est_sc_plot_data_wide3,
                                           q_nh_in_est_sc_plot_data_wide4,q_nh_in_est_sc_plot_data_wide5,q_nh_in_est_sc_plot_data_wide6,
                                           q_nh_in_est_sc_plot_data_wide7,q_nh_in_est_sc_plot_data_wide8,q_nh_in_est_sc_plot_data_wide9,
                                           q_nh_in_est_sc_plot_data_wide10,q_nh_in_est_sc_plot_data_wide11,q_nh_in_est_sc_plot_data_wide12,
                                           q_nh_in_est_sc_plot_data_wide13,q_nh_in_est_sc_plot_data_wide14,q_nh_in_est_sc_plot_data_wide15,
                                           q_nh_in_est_sc_plot_data_wide16,q_nh_in_est_sc_plot_data_wide17,q_nh_in_est_sc_plot_data_wide18,
                                           q_nh_in_est_sc_plot_data_wide19,q_nh_in_est_sc_plot_data_wide20,q_nh_in_est_sc_plot_data_wide21,
                                           q_nh_in_est_sc_plot_data_wide22,q_nh_in_est_sc_plot_data_wide23,q_nh_in_est_sc_plot_data_wide24,
                                           q_nh_in_est_sc_plot_data_wide25,q_nh_in_est_sc_plot_data_wide26,q_nh_in_est_sc_plot_data_wide27,
                                           q_nh_in_est_sc_plot_data_wide28,q_nh_in_est_sc_plot_data_wide29,q_nh_in_est_sc_plot_data_wide30,
                                           q_nh_in_est_sc_plot_data_wide31,q_nh_in_est_sc_plot_data_wide32,q_nh_in_est_sc_plot_data_wide33,
                                           q_nh_in_est_sc_plot_data_wide34,q_nh_in_est_sc_plot_data_wide35)
rm(q_nh_in_est_sc_plot_data_wide1,q_nh_in_est_sc_plot_data_wide2,q_nh_in_est_sc_plot_data_wide3,
   q_nh_in_est_sc_plot_data_wide4,q_nh_in_est_sc_plot_data_wide5,q_nh_in_est_sc_plot_data_wide6,
   q_nh_in_est_sc_plot_data_wide7,q_nh_in_est_sc_plot_data_wide8,q_nh_in_est_sc_plot_data_wide9,
   q_nh_in_est_sc_plot_data_wide10,q_nh_in_est_sc_plot_data_wide11,q_nh_in_est_sc_plot_data_wide12,
   q_nh_in_est_sc_plot_data_wide13,q_nh_in_est_sc_plot_data_wide14,q_nh_in_est_sc_plot_data_wide15,
   q_nh_in_est_sc_plot_data_wide16,q_nh_in_est_sc_plot_data_wide17,q_nh_in_est_sc_plot_data_wide18,
   q_nh_in_est_sc_plot_data_wide19,q_nh_in_est_sc_plot_data_wide20,q_nh_in_est_sc_plot_data_wide21,
   q_nh_in_est_sc_plot_data_wide22,q_nh_in_est_sc_plot_data_wide23,q_nh_in_est_sc_plot_data_wide24,
   q_nh_in_est_sc_plot_data_wide25,q_nh_in_est_sc_plot_data_wide26,q_nh_in_est_sc_plot_data_wide27,
   q_nh_in_est_sc_plot_data_wide28,q_nh_in_est_sc_plot_data_wide29,q_nh_in_est_sc_plot_data_wide30,
   q_nh_in_est_sc_plot_data_wide31,q_nh_in_est_sc_plot_data_wide32,q_nh_in_est_sc_plot_data_wide33,
   q_nh_in_est_sc_plot_data_wide34,q_nh_in_est_sc_plot_data_wide35)
q_nh_in_est_sc_plot_data_wide_list <- lapply(q_nh_in_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nh_in_est_sdid1 <- synthdid_estimate(setup_q_nh_in_list[[1]]$Y, setup_q_nh_in_list[[1]]$N0, setup_q_nh_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_in_est_sdid2 <- synthdid_estimate(setup_q_nh_in_list[[2]]$Y, setup_q_nh_in_list[[2]]$N0, setup_q_nh_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_in_est_sdid5 <- synthdid_estimate(setup_q_nh_in_list[[3]]$Y, setup_q_nh_in_list[[3]]$N0, setup_q_nh_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_in_est_sdid10 <- synthdid_estimate(setup_q_nh_in_list[[4]]$Y, setup_q_nh_in_list[[4]]$N0, setup_q_nh_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_in_est_sdid11 <- synthdid_estimate(setup_q_nh_in_list[[5]]$Y, setup_q_nh_in_list[[5]]$N0, setup_q_nh_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_in_est_sdid12 <- synthdid_estimate(setup_q_nh_in_list[[6]]$Y, setup_q_nh_in_list[[6]]$N0, setup_q_nh_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_in_est_sdid13 <- synthdid_estimate(setup_q_nh_in_list[[7]]$Y, setup_q_nh_in_list[[7]]$N0, setup_q_nh_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_in_est_sdid15 <- synthdid_estimate(setup_q_nh_in_list[[8]]$Y, setup_q_nh_in_list[[8]]$N0, setup_q_nh_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_in_est_sdid17 <- synthdid_estimate(setup_q_nh_in_list[[9]]$Y, setup_q_nh_in_list[[9]]$N0, setup_q_nh_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_in_est_sdid19 <- synthdid_estimate(setup_q_nh_in_list[[10]]$Y, setup_q_nh_in_list[[10]]$N0, setup_q_nh_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_in_est_sdid21 <- synthdid_estimate(setup_q_nh_in_list[[11]]$Y, setup_q_nh_in_list[[11]]$N0, setup_q_nh_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_in_est_sdid23 <- synthdid_estimate(setup_q_nh_in_list[[12]]$Y, setup_q_nh_in_list[[12]]$N0, setup_q_nh_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_in_est_sdid24 <- synthdid_estimate(setup_q_nh_in_list[[13]]$Y, setup_q_nh_in_list[[13]]$N0, setup_q_nh_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_in_est_sdid25 <- synthdid_estimate(setup_q_nh_in_list[[14]]$Y, setup_q_nh_in_list[[14]]$N0, setup_q_nh_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_in_est_sdid26 <- synthdid_estimate(setup_q_nh_in_list[[15]]$Y, setup_q_nh_in_list[[15]]$N0, setup_q_nh_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_in_est_sdid28 <- synthdid_estimate(setup_q_nh_in_list[[16]]$Y, setup_q_nh_in_list[[16]]$N0, setup_q_nh_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_in_est_sdid29 <- synthdid_estimate(setup_q_nh_in_list[[17]]$Y, setup_q_nh_in_list[[17]]$N0, setup_q_nh_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_in_est_sdid30 <- synthdid_estimate(setup_q_nh_in_list[[18]]$Y, setup_q_nh_in_list[[18]]$N0, setup_q_nh_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_in_est_sdid31 <- synthdid_estimate(setup_q_nh_in_list[[19]]$Y, setup_q_nh_in_list[[19]]$N0, setup_q_nh_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_in_est_sdid32 <- synthdid_estimate(setup_q_nh_in_list[[20]]$Y, setup_q_nh_in_list[[20]]$N0, setup_q_nh_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_in_est_sdid33 <- synthdid_estimate(setup_q_nh_in_list[[21]]$Y, setup_q_nh_in_list[[21]]$N0, setup_q_nh_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_in_est_sdid34 <- synthdid_estimate(setup_q_nh_in_list[[22]]$Y, setup_q_nh_in_list[[22]]$N0, setup_q_nh_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_in_est_sdid36 <- synthdid_estimate(setup_q_nh_in_list[[23]]$Y, setup_q_nh_in_list[[23]]$N0, setup_q_nh_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_in_est_sdid37 <- synthdid_estimate(setup_q_nh_in_list[[24]]$Y, setup_q_nh_in_list[[24]]$N0, setup_q_nh_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_in_est_sdid39 <- synthdid_estimate(setup_q_nh_in_list[[25]]$Y, setup_q_nh_in_list[[25]]$N0, setup_q_nh_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_in_est_sdid40 <- synthdid_estimate(setup_q_nh_in_list[[26]]$Y, setup_q_nh_in_list[[26]]$N0, setup_q_nh_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_in_est_sdid41 <- synthdid_estimate(setup_q_nh_in_list[[27]]$Y, setup_q_nh_in_list[[27]]$N0, setup_q_nh_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_in_est_sdid44 <- synthdid_estimate(setup_q_nh_in_list[[28]]$Y, setup_q_nh_in_list[[28]]$N0, setup_q_nh_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_in_est_sdid45 <- synthdid_estimate(setup_q_nh_in_list[[29]]$Y, setup_q_nh_in_list[[29]]$N0, setup_q_nh_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_in_est_sdid47 <- synthdid_estimate(setup_q_nh_in_list[[30]]$Y, setup_q_nh_in_list[[30]]$N0, setup_q_nh_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_in_est_sdid50 <- synthdid_estimate(setup_q_nh_in_list[[31]]$Y, setup_q_nh_in_list[[31]]$N0, setup_q_nh_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_in_est_sdid51 <- synthdid_estimate(setup_q_nh_in_list[[32]]$Y, setup_q_nh_in_list[[32]]$N0, setup_q_nh_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_in_est_sdid53 <- synthdid_estimate(setup_q_nh_in_list[[33]]$Y, setup_q_nh_in_list[[33]]$N0, setup_q_nh_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_in_est_sdid54 <- synthdid_estimate(setup_q_nh_in_list[[34]]$Y, setup_q_nh_in_list[[34]]$N0, setup_q_nh_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_in_est_sdid55 <- synthdid_estimate(setup_q_nh_in_list[[35]]$Y, setup_q_nh_in_list[[35]]$N0, setup_q_nh_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_in_est_sdid_list <- list(q_nh_in_est_sdid1,q_nh_in_est_sdid2,q_nh_in_est_sdid5,
                              q_nh_in_est_sdid10,q_nh_in_est_sdid11,q_nh_in_est_sdid12,
                              q_nh_in_est_sdid13,q_nh_in_est_sdid15,q_nh_in_est_sdid17,
                              q_nh_in_est_sdid19,q_nh_in_est_sdid21,q_nh_in_est_sdid23,
                              q_nh_in_est_sdid24,q_nh_in_est_sdid25,q_nh_in_est_sdid26,
                              q_nh_in_est_sdid28,q_nh_in_est_sdid29,q_nh_in_est_sdid30,
                              q_nh_in_est_sdid31,q_nh_in_est_sdid32,q_nh_in_est_sdid33,
                              q_nh_in_est_sdid34,q_nh_in_est_sdid36,q_nh_in_est_sdid37,
                              q_nh_in_est_sdid39,q_nh_in_est_sdid40,q_nh_in_est_sdid41,
                              q_nh_in_est_sdid44,q_nh_in_est_sdid45,q_nh_in_est_sdid47,
                              q_nh_in_est_sdid50,q_nh_in_est_sdid51,q_nh_in_est_sdid53,
                              q_nh_in_est_sdid54,q_nh_in_est_sdid55)
rm(q_nh_in_est_sdid1,q_nh_in_est_sdid2,q_nh_in_est_sdid5,
   q_nh_in_est_sdid10,q_nh_in_est_sdid11,q_nh_in_est_sdid12,
   q_nh_in_est_sdid13,q_nh_in_est_sdid15,q_nh_in_est_sdid17,
   q_nh_in_est_sdid19,q_nh_in_est_sdid21,q_nh_in_est_sdid23,
   q_nh_in_est_sdid24,q_nh_in_est_sdid25,q_nh_in_est_sdid26,
   q_nh_in_est_sdid28,q_nh_in_est_sdid29,q_nh_in_est_sdid30,
   q_nh_in_est_sdid31,q_nh_in_est_sdid32,q_nh_in_est_sdid33,
   q_nh_in_est_sdid34,q_nh_in_est_sdid36,q_nh_in_est_sdid37,
   q_nh_in_est_sdid39,q_nh_in_est_sdid40,q_nh_in_est_sdid41,
   q_nh_in_est_sdid44,q_nh_in_est_sdid45,q_nh_in_est_sdid47,
   q_nh_in_est_sdid50,q_nh_in_est_sdid51,q_nh_in_est_sdid53,
   q_nh_in_est_sdid54,q_nh_in_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sdid_plot", i), synthdid_plot(q_nh_in_est_sdid_list[i]))
}
q_nh_in_est_sdid_plot_data_aux1 <- ggplot_build(q_nh_in_est_sdid_plot1)
q_nh_in_est_sdid_plot_data_aux2 <- ggplot_build(q_nh_in_est_sdid_plot2)
q_nh_in_est_sdid_plot_data_aux3 <- ggplot_build(q_nh_in_est_sdid_plot3)
q_nh_in_est_sdid_plot_data_aux4 <- ggplot_build(q_nh_in_est_sdid_plot4)
q_nh_in_est_sdid_plot_data_aux5 <- ggplot_build(q_nh_in_est_sdid_plot5)
q_nh_in_est_sdid_plot_data_aux6 <- ggplot_build(q_nh_in_est_sdid_plot6)
q_nh_in_est_sdid_plot_data_aux7 <- ggplot_build(q_nh_in_est_sdid_plot7)
q_nh_in_est_sdid_plot_data_aux8 <- ggplot_build(q_nh_in_est_sdid_plot8)
q_nh_in_est_sdid_plot_data_aux9 <- ggplot_build(q_nh_in_est_sdid_plot9)
q_nh_in_est_sdid_plot_data_aux10 <- ggplot_build(q_nh_in_est_sdid_plot10)
q_nh_in_est_sdid_plot_data_aux11 <- ggplot_build(q_nh_in_est_sdid_plot11)
q_nh_in_est_sdid_plot_data_aux12 <- ggplot_build(q_nh_in_est_sdid_plot12)
q_nh_in_est_sdid_plot_data_aux13 <- ggplot_build(q_nh_in_est_sdid_plot13)
q_nh_in_est_sdid_plot_data_aux14 <- ggplot_build(q_nh_in_est_sdid_plot14)
q_nh_in_est_sdid_plot_data_aux15 <- ggplot_build(q_nh_in_est_sdid_plot15)
q_nh_in_est_sdid_plot_data_aux16 <- ggplot_build(q_nh_in_est_sdid_plot16)
q_nh_in_est_sdid_plot_data_aux17 <- ggplot_build(q_nh_in_est_sdid_plot17)
q_nh_in_est_sdid_plot_data_aux18 <- ggplot_build(q_nh_in_est_sdid_plot18)
q_nh_in_est_sdid_plot_data_aux19 <- ggplot_build(q_nh_in_est_sdid_plot19)
q_nh_in_est_sdid_plot_data_aux20 <- ggplot_build(q_nh_in_est_sdid_plot20)
q_nh_in_est_sdid_plot_data_aux21 <- ggplot_build(q_nh_in_est_sdid_plot21)
q_nh_in_est_sdid_plot_data_aux22 <- ggplot_build(q_nh_in_est_sdid_plot22)
q_nh_in_est_sdid_plot_data_aux23 <- ggplot_build(q_nh_in_est_sdid_plot23)
q_nh_in_est_sdid_plot_data_aux24 <- ggplot_build(q_nh_in_est_sdid_plot24)
q_nh_in_est_sdid_plot_data_aux25 <- ggplot_build(q_nh_in_est_sdid_plot25)
q_nh_in_est_sdid_plot_data_aux26 <- ggplot_build(q_nh_in_est_sdid_plot26)
q_nh_in_est_sdid_plot_data_aux27 <- ggplot_build(q_nh_in_est_sdid_plot27)
q_nh_in_est_sdid_plot_data_aux28 <- ggplot_build(q_nh_in_est_sdid_plot28)
q_nh_in_est_sdid_plot_data_aux29 <- ggplot_build(q_nh_in_est_sdid_plot29)
q_nh_in_est_sdid_plot_data_aux30 <- ggplot_build(q_nh_in_est_sdid_plot30)
q_nh_in_est_sdid_plot_data_aux31 <- ggplot_build(q_nh_in_est_sdid_plot31)
q_nh_in_est_sdid_plot_data_aux32 <- ggplot_build(q_nh_in_est_sdid_plot32)
q_nh_in_est_sdid_plot_data_aux33 <- ggplot_build(q_nh_in_est_sdid_plot33)
q_nh_in_est_sdid_plot_data_aux34 <- ggplot_build(q_nh_in_est_sdid_plot34)
q_nh_in_est_sdid_plot_data_aux35 <- ggplot_build(q_nh_in_est_sdid_plot35)
q_nh_in_est_sdid_plot_data_aux_list <- list(q_nh_in_est_sdid_plot_data_aux1,q_nh_in_est_sdid_plot_data_aux2,q_nh_in_est_sdid_plot_data_aux3,
                                            q_nh_in_est_sdid_plot_data_aux4,q_nh_in_est_sdid_plot_data_aux5,q_nh_in_est_sdid_plot_data_aux6,
                                            q_nh_in_est_sdid_plot_data_aux7,q_nh_in_est_sdid_plot_data_aux8,q_nh_in_est_sdid_plot_data_aux9,
                                            q_nh_in_est_sdid_plot_data_aux10,q_nh_in_est_sdid_plot_data_aux11,q_nh_in_est_sdid_plot_data_aux12,
                                            q_nh_in_est_sdid_plot_data_aux13,q_nh_in_est_sdid_plot_data_aux14,q_nh_in_est_sdid_plot_data_aux15,
                                            q_nh_in_est_sdid_plot_data_aux16,q_nh_in_est_sdid_plot_data_aux17,q_nh_in_est_sdid_plot_data_aux18,
                                            q_nh_in_est_sdid_plot_data_aux19,q_nh_in_est_sdid_plot_data_aux20,q_nh_in_est_sdid_plot_data_aux21,
                                            q_nh_in_est_sdid_plot_data_aux22,q_nh_in_est_sdid_plot_data_aux23,q_nh_in_est_sdid_plot_data_aux24,
                                            q_nh_in_est_sdid_plot_data_aux25,q_nh_in_est_sdid_plot_data_aux26,q_nh_in_est_sdid_plot_data_aux27,
                                            q_nh_in_est_sdid_plot_data_aux28,q_nh_in_est_sdid_plot_data_aux29,q_nh_in_est_sdid_plot_data_aux30,
                                            q_nh_in_est_sdid_plot_data_aux31,q_nh_in_est_sdid_plot_data_aux32,q_nh_in_est_sdid_plot_data_aux33,
                                            q_nh_in_est_sdid_plot_data_aux34,q_nh_in_est_sdid_plot_data_aux35)
rm(q_nh_in_est_sdid_plot_data_aux1,q_nh_in_est_sdid_plot_data_aux2,q_nh_in_est_sdid_plot_data_aux3,
   q_nh_in_est_sdid_plot_data_aux4,q_nh_in_est_sdid_plot_data_aux5,q_nh_in_est_sdid_plot_data_aux6,
   q_nh_in_est_sdid_plot_data_aux7,q_nh_in_est_sdid_plot_data_aux8,q_nh_in_est_sdid_plot_data_aux9,
   q_nh_in_est_sdid_plot_data_aux10,q_nh_in_est_sdid_plot_data_aux11,q_nh_in_est_sdid_plot_data_aux12,
   q_nh_in_est_sdid_plot_data_aux13,q_nh_in_est_sdid_plot_data_aux14,q_nh_in_est_sdid_plot_data_aux15,
   q_nh_in_est_sdid_plot_data_aux16,q_nh_in_est_sdid_plot_data_aux17,q_nh_in_est_sdid_plot_data_aux18,
   q_nh_in_est_sdid_plot_data_aux19,q_nh_in_est_sdid_plot_data_aux20,q_nh_in_est_sdid_plot_data_aux21,
   q_nh_in_est_sdid_plot_data_aux22,q_nh_in_est_sdid_plot_data_aux23,q_nh_in_est_sdid_plot_data_aux24,
   q_nh_in_est_sdid_plot_data_aux25,q_nh_in_est_sdid_plot_data_aux26,q_nh_in_est_sdid_plot_data_aux27,
   q_nh_in_est_sdid_plot_data_aux28,q_nh_in_est_sdid_plot_data_aux29,q_nh_in_est_sdid_plot_data_aux30,
   q_nh_in_est_sdid_plot_data_aux31,q_nh_in_est_sdid_plot_data_aux32,q_nh_in_est_sdid_plot_data_aux33,
   q_nh_in_est_sdid_plot_data_aux34,q_nh_in_est_sdid_plot_data_aux35)
rm(q_nh_in_est_sdid_plot1,q_nh_in_est_sdid_plot2,q_nh_in_est_sdid_plot3,
   q_nh_in_est_sdid_plot4,q_nh_in_est_sdid_plot5,q_nh_in_est_sdid_plot6,
   q_nh_in_est_sdid_plot7,q_nh_in_est_sdid_plot8,q_nh_in_est_sdid_plot9,
   q_nh_in_est_sdid_plot10,q_nh_in_est_sdid_plot11,q_nh_in_est_sdid_plot12,
   q_nh_in_est_sdid_plot13,q_nh_in_est_sdid_plot14,q_nh_in_est_sdid_plot15,
   q_nh_in_est_sdid_plot16,q_nh_in_est_sdid_plot17,q_nh_in_est_sdid_plot18,
   q_nh_in_est_sdid_plot19,q_nh_in_est_sdid_plot20,q_nh_in_est_sdid_plot21,
   q_nh_in_est_sdid_plot22,q_nh_in_est_sdid_plot23,q_nh_in_est_sdid_plot24,
   q_nh_in_est_sdid_plot25,q_nh_in_est_sdid_plot26,q_nh_in_est_sdid_plot27,
   q_nh_in_est_sdid_plot28,q_nh_in_est_sdid_plot29,q_nh_in_est_sdid_plot30,
   q_nh_in_est_sdid_plot31,q_nh_in_est_sdid_plot32,q_nh_in_est_sdid_plot33,
   q_nh_in_est_sdid_plot34,q_nh_in_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sdid_plot_data_long", i), data.frame(q_nh_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_in_est_sdid_plot_data_long_list <- list(q_nh_in_est_sdid_plot_data_long1,q_nh_in_est_sdid_plot_data_long2,q_nh_in_est_sdid_plot_data_long3,
                                             q_nh_in_est_sdid_plot_data_long4,q_nh_in_est_sdid_plot_data_long5,q_nh_in_est_sdid_plot_data_long6,
                                             q_nh_in_est_sdid_plot_data_long7,q_nh_in_est_sdid_plot_data_long8,q_nh_in_est_sdid_plot_data_long9,
                                             q_nh_in_est_sdid_plot_data_long10,q_nh_in_est_sdid_plot_data_long11,q_nh_in_est_sdid_plot_data_long12,
                                             q_nh_in_est_sdid_plot_data_long13,q_nh_in_est_sdid_plot_data_long14,q_nh_in_est_sdid_plot_data_long15,
                                             q_nh_in_est_sdid_plot_data_long16,q_nh_in_est_sdid_plot_data_long17,q_nh_in_est_sdid_plot_data_long18,
                                             q_nh_in_est_sdid_plot_data_long19,q_nh_in_est_sdid_plot_data_long20,q_nh_in_est_sdid_plot_data_long21,
                                             q_nh_in_est_sdid_plot_data_long22,q_nh_in_est_sdid_plot_data_long23,q_nh_in_est_sdid_plot_data_long24,
                                             q_nh_in_est_sdid_plot_data_long25,q_nh_in_est_sdid_plot_data_long26,q_nh_in_est_sdid_plot_data_long27,
                                             q_nh_in_est_sdid_plot_data_long28,q_nh_in_est_sdid_plot_data_long29,q_nh_in_est_sdid_plot_data_long30,
                                             q_nh_in_est_sdid_plot_data_long31,q_nh_in_est_sdid_plot_data_long32,q_nh_in_est_sdid_plot_data_long33,
                                             q_nh_in_est_sdid_plot_data_long34,q_nh_in_est_sdid_plot_data_long35)
rm(q_nh_in_est_sdid_plot_data_long1,q_nh_in_est_sdid_plot_data_long2,q_nh_in_est_sdid_plot_data_long3,
   q_nh_in_est_sdid_plot_data_long4,q_nh_in_est_sdid_plot_data_long5,q_nh_in_est_sdid_plot_data_long6,
   q_nh_in_est_sdid_plot_data_long7,q_nh_in_est_sdid_plot_data_long8,q_nh_in_est_sdid_plot_data_long9,
   q_nh_in_est_sdid_plot_data_long10,q_nh_in_est_sdid_plot_data_long11,q_nh_in_est_sdid_plot_data_long12,
   q_nh_in_est_sdid_plot_data_long13,q_nh_in_est_sdid_plot_data_long14,q_nh_in_est_sdid_plot_data_long15,
   q_nh_in_est_sdid_plot_data_long16,q_nh_in_est_sdid_plot_data_long17,q_nh_in_est_sdid_plot_data_long18,
   q_nh_in_est_sdid_plot_data_long19,q_nh_in_est_sdid_plot_data_long20,q_nh_in_est_sdid_plot_data_long21,
   q_nh_in_est_sdid_plot_data_long22,q_nh_in_est_sdid_plot_data_long23,q_nh_in_est_sdid_plot_data_long24,
   q_nh_in_est_sdid_plot_data_long25,q_nh_in_est_sdid_plot_data_long26,q_nh_in_est_sdid_plot_data_long27,
   q_nh_in_est_sdid_plot_data_long28,q_nh_in_est_sdid_plot_data_long29,q_nh_in_est_sdid_plot_data_long30,
   q_nh_in_est_sdid_plot_data_long31,q_nh_in_est_sdid_plot_data_long32,q_nh_in_est_sdid_plot_data_long33,
   q_nh_in_est_sdid_plot_data_long34,q_nh_in_est_sdid_plot_data_long35)
q_nh_in_est_sdid_plot_data_long_list <- lapply(q_nh_in_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_in_est_sdid_plot_data_wide", i), reshape(data=q_nh_in_est_sdid_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
q_nh_in_est_sdid_plot_data_wide_list <- list(q_nh_in_est_sdid_plot_data_wide1,q_nh_in_est_sdid_plot_data_wide2,q_nh_in_est_sdid_plot_data_wide3,
                                             q_nh_in_est_sdid_plot_data_wide4,q_nh_in_est_sdid_plot_data_wide5,q_nh_in_est_sdid_plot_data_wide6,
                                             q_nh_in_est_sdid_plot_data_wide7,q_nh_in_est_sdid_plot_data_wide8,q_nh_in_est_sdid_plot_data_wide9,
                                             q_nh_in_est_sdid_plot_data_wide10,q_nh_in_est_sdid_plot_data_wide11,q_nh_in_est_sdid_plot_data_wide12,
                                             q_nh_in_est_sdid_plot_data_wide13,q_nh_in_est_sdid_plot_data_wide14,q_nh_in_est_sdid_plot_data_wide15,
                                             q_nh_in_est_sdid_plot_data_wide16,q_nh_in_est_sdid_plot_data_wide17,q_nh_in_est_sdid_plot_data_wide18,
                                             q_nh_in_est_sdid_plot_data_wide19,q_nh_in_est_sdid_plot_data_wide20,q_nh_in_est_sdid_plot_data_wide21,
                                             q_nh_in_est_sdid_plot_data_wide22,q_nh_in_est_sdid_plot_data_wide23,q_nh_in_est_sdid_plot_data_wide24,
                                             q_nh_in_est_sdid_plot_data_wide25,q_nh_in_est_sdid_plot_data_wide26,q_nh_in_est_sdid_plot_data_wide27,
                                             q_nh_in_est_sdid_plot_data_wide28,q_nh_in_est_sdid_plot_data_wide29,q_nh_in_est_sdid_plot_data_wide30,
                                             q_nh_in_est_sdid_plot_data_wide31,q_nh_in_est_sdid_plot_data_wide32,q_nh_in_est_sdid_plot_data_wide33,
                                             q_nh_in_est_sdid_plot_data_wide34,q_nh_in_est_sdid_plot_data_wide35)
rm(q_nh_in_est_sdid_plot_data_wide1,q_nh_in_est_sdid_plot_data_wide2,q_nh_in_est_sdid_plot_data_wide3,
   q_nh_in_est_sdid_plot_data_wide4,q_nh_in_est_sdid_plot_data_wide5,q_nh_in_est_sdid_plot_data_wide6,
   q_nh_in_est_sdid_plot_data_wide7,q_nh_in_est_sdid_plot_data_wide8,q_nh_in_est_sdid_plot_data_wide9,
   q_nh_in_est_sdid_plot_data_wide10,q_nh_in_est_sdid_plot_data_wide11,q_nh_in_est_sdid_plot_data_wide12,
   q_nh_in_est_sdid_plot_data_wide13,q_nh_in_est_sdid_plot_data_wide14,q_nh_in_est_sdid_plot_data_wide15,
   q_nh_in_est_sdid_plot_data_wide16,q_nh_in_est_sdid_plot_data_wide17,q_nh_in_est_sdid_plot_data_wide18,
   q_nh_in_est_sdid_plot_data_wide19,q_nh_in_est_sdid_plot_data_wide20,q_nh_in_est_sdid_plot_data_wide21,
   q_nh_in_est_sdid_plot_data_wide22,q_nh_in_est_sdid_plot_data_wide23,q_nh_in_est_sdid_plot_data_wide24,
   q_nh_in_est_sdid_plot_data_wide25,q_nh_in_est_sdid_plot_data_wide26,q_nh_in_est_sdid_plot_data_wide27,
   q_nh_in_est_sdid_plot_data_wide28,q_nh_in_est_sdid_plot_data_wide29,q_nh_in_est_sdid_plot_data_wide30,
   q_nh_in_est_sdid_plot_data_wide31,q_nh_in_est_sdid_plot_data_wide32,q_nh_in_est_sdid_plot_data_wide33,
   q_nh_in_est_sdid_plot_data_wide34,q_nh_in_est_sdid_plot_data_wide35)
q_nh_in_est_sdid_plot_data_wide_list <- lapply(q_nh_in_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nh_est_did_plot_data_wide_in$did_facet_title <- "Diff-in-Diff"
q_nh_est_sc_plot_data_wide_in$sc_facet_title <- "Synthetic Control"
q_nh_est_sdid_plot_data_wide_in$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nh_est_did_plot_data_wide_in$diff_relative <- q_nh_est_did_plot_data_wide_in$diff - q_nh_est_did_plot_data_wide_in$diff[8]
for(i in 1:35) {
  q_nh_in_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nh_in_est_did_plot_data_wide_list[[i]]$diff - q_nh_in_est_did_plot_data_wide_list[[i]]$diff[8]
}
q_nh_in_spag_did_plot <- ggplot(q_nh_est_did_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Homes \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_in_spag_sc_plot <- ggplot(q_nh_est_sc_plot_data_wide_in, aes(year,diff)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nh_in_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Indiana"),data = q_nh_est_sc_plot_data_wide_in, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Indiana" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_est_sdid_plot_data_wide_in$diff_relative <- q_nh_est_sdid_plot_data_wide_in$diff - q_nh_est_sdid_plot_data_wide_in$diff[8]
for(i in 1:35) {
  q_nh_in_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nh_in_est_sdid_plot_data_wide_list[[i]]$diff - q_nh_in_est_sdid_plot_data_wide_list[[i]]$diff[8]
}
q_nh_in_spag_sdid_plot <- ggplot(q_nh_est_sdid_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_in_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nh_in_est_did_vec <- c(q_nh_est_did_in)
for (i in 1:35) {
  q_nh_in_est_did_vec_aux <- q_nh_in_est_did_list[[i]][1]
  q_nh_in_est_did_vec <- c(q_nh_in_est_did_vec,q_nh_in_est_did_vec_aux)
}
q_nh_in_est_did_df <- data.frame(q_nh_in_est_did_vec)
q_nh_in_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nh_in_est_did_vec)) +
  geom_histogram(data = q_nh_in_est_did_df, aes(x = q_nh_in_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_in_hist_did_plot1_ylim <- ggplot_build(q_nh_in_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_in_hist_did_plot <- q_nh_in_hist_did_plot_aux +
  expand_limits(y=q_nh_in_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_in_est_did_vec[1], mean(q_nh_in_est_did_vec[2:36])), xend = c(q_nh_in_est_did_vec[1],mean(q_nh_in_est_did_vec[2:36])), y = c(0,0), yend = c(q_nh_in_hist_did_plot1_ylim,q_nh_in_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_in_est_did_vec[1], mean(q_nh_in_est_did_vec[2:36])), y = c(q_nh_in_hist_did_plot1_ylim,q_nh_in_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_in_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_in_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_in_est_sc_vec <- c(q_nh_est_sc_in)
for (i in 1:35) {
  q_nh_in_est_sc_vec_aux <- q_nh_in_est_sc_list[[i]][1]
  q_nh_in_est_sc_vec <- c(q_nh_in_est_sc_vec,q_nh_in_est_sc_vec_aux)
}
q_nh_in_est_sc_df <- data.frame(q_nh_in_est_sc_vec)
q_nh_in_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nh_in_est_sc_vec)) +
  geom_histogram(data = q_nh_in_est_sc_df, aes(x = q_nh_in_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_in_hist_sc_plot1_ylim <- ggplot_build(q_nh_in_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_in_hist_sc_plot <- q_nh_in_hist_sc_plot_aux +
  expand_limits(y=q_nh_in_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_in_est_sc_vec[1], mean(q_nh_in_est_sc_vec[2:36])), xend = c(q_nh_in_est_sc_vec[1],mean(q_nh_in_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nh_in_hist_sc_plot1_ylim,q_nh_in_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_in_est_sc_vec[1], mean(q_nh_in_est_sc_vec[2:36])), y = c(q_nh_in_hist_sc_plot1_ylim,q_nh_in_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_in_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_in_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.35,.65), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_in_est_sdid_vec <- c(q_nh_est_sdid_in)
for (i in 1:35) {
  q_nh_in_est_sdid_vec_aux <- q_nh_in_est_sdid_list[[i]][1]
  q_nh_in_est_sdid_vec <- c(q_nh_in_est_sdid_vec,q_nh_in_est_sdid_vec_aux)
}
q_nh_in_est_sdid_df <- data.frame(q_nh_in_est_sdid_vec)
q_nh_in_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nh_in_est_sdid_vec)) +
  geom_histogram(data = q_nh_in_est_sdid_df, aes(x = q_nh_in_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_in_hist_sdid_plot1_ylim <- ggplot_build(q_nh_in_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_in_hist_sdid_plot <- q_nh_in_hist_sdid_plot_aux +
  expand_limits(y=q_nh_in_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_in_est_sdid_vec[1], mean(q_nh_in_est_sdid_vec[2:36])), xend = c(q_nh_in_est_sdid_vec[1],mean(q_nh_in_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nh_in_hist_sdid_plot1_ylim,q_nh_in_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_in_est_sdid_vec[1], mean(q_nh_in_est_sdid_vec[2:36])), y = c(q_nh_in_hist_sdid_plot1_ylim,q_nh_in_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_in_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_in_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nh_spag_dist_plots_IN.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nh_in_spag_dist_plots_in <- q_nh_in_spag_did_plot + q_nh_in_spag_sc_plot + q_nh_in_spag_sdid_plot + q_nh_in_hist_did_plot + q_nh_in_hist_sc_plot + q_nh_in_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Quantity of Nursing Home Beds #####
### IN - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_home_beds_in_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_in_df$treated <- as.integer(ifelse(q_nursing_home_beds_in_df$name == "Indiana" & q_nursing_home_beds_in_df$year >= 1999, 1, 0))
q_nursing_home_beds_in_df <- q_nursing_home_beds_in_df[order(q_nursing_home_beds_in_df$year, q_nursing_home_beds_in_df$treated_in_aux, q_nursing_home_beds_in_df$name),]
q_nursing_home_beds_in_df <- subset(q_nursing_home_beds_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nhb_in <- panel.matrices(q_nursing_home_beds_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nhb_est_did_in <- did_estimate(setup_q_nhb_in$Y, setup_q_nhb_in$N0, setup_q_nhb_in$T0, X = covariates_acc_in_array)
q_nhb_est_did_plot_in <- synthdid_plot(q_nhb_est_did_in)
q_nhb_est_did_plot_data_aux_in <- ggplot_build(q_nhb_est_did_plot_in)
q_nhb_est_did_plot_data_long_in <- data.frame(q_nhb_est_did_plot_data_aux_in$data[[1]]$x, q_nhb_est_did_plot_data_aux_in$data[[1]]$y, q_nhb_est_did_plot_data_aux_in$data[[1]]$group)
colnames(q_nhb_est_did_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nhb_est_did_plot_data_long_in$treated <- q_nhb_est_did_plot_data_long_in$treated - 1
q_nhb_est_did_plot_data_wide_in <- reshape(data=q_nhb_est_did_plot_data_long_in,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nhb_est_did_plot_data_wide_in$diff <- q_nhb_est_did_plot_data_wide_in$outcome.1 - q_nhb_est_did_plot_data_wide_in$outcome.0
# SC #
q_nhb_est_sc_in <- sc_estimate(setup_q_nhb_in$Y, setup_q_nhb_in$N0, setup_q_nhb_in$T0, X = covariates_acc_in_array)
q_nhb_est_sc_plot_in <- synthdid_plot(q_nhb_est_sc_in)
q_nhb_est_sc_plot_data_aux_in <- ggplot_build(q_nhb_est_sc_plot_in)
q_nhb_est_sc_plot_data_long_in <- data.frame(q_nhb_est_sc_plot_data_aux_in$data[[1]]$x, q_nhb_est_sc_plot_data_aux_in$data[[1]]$y, q_nhb_est_sc_plot_data_aux_in$data[[1]]$group)
colnames(q_nhb_est_sc_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nhb_est_sc_plot_data_long_in$treated <- q_nhb_est_sc_plot_data_long_in$treated - 1
q_nhb_est_sc_plot_data_wide_in <- reshape(data=q_nhb_est_sc_plot_data_long_in,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nhb_est_sc_plot_data_wide_in$diff <- q_nhb_est_sc_plot_data_wide_in$outcome.1 - q_nhb_est_sc_plot_data_wide_in$outcome.0
# SDID #
q_nhb_est_sdid_in <- synthdid_estimate(setup_q_nhb_in$Y, setup_q_nhb_in$N0, setup_q_nhb_in$T0, X = covariates_acc_in_array)
q_nhb_est_sdid_plot_in <- synthdid_plot(q_nhb_est_sdid_in)
q_nhb_est_sdid_plot_data_aux_in <- ggplot_build(q_nhb_est_sdid_plot_in)
q_nhb_est_sdid_plot_data_long_in <- data.frame(q_nhb_est_sdid_plot_data_aux_in$data[[1]]$x, q_nhb_est_sdid_plot_data_aux_in$data[[1]]$y, q_nhb_est_sdid_plot_data_aux_in$data[[1]]$group)
colnames(q_nhb_est_sdid_plot_data_long_in) <- c('year', 'outcome', 'treated')
q_nhb_est_sdid_plot_data_long_in$treated <- q_nhb_est_sdid_plot_data_long_in$treated - 1
q_nhb_est_sdid_plot_data_wide_in <- reshape(data=q_nhb_est_sdid_plot_data_long_in,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
q_nhb_est_sdid_plot_data_wide_in$diff <- q_nhb_est_sdid_plot_data_wide_in$outcome.1 - q_nhb_est_sdid_plot_data_wide_in$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nhb_in_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nhb_in_df1$treated_aux <- ifelse(q_nhb_in_df1$id == 1, 1, 0)
q_nhb_in_df2$treated_aux <- ifelse(q_nhb_in_df2$id == 2, 1, 0)
q_nhb_in_df5$treated_aux <- ifelse(q_nhb_in_df5$id == 5, 1, 0)
q_nhb_in_df10$treated_aux <- ifelse(q_nhb_in_df10$id == 10, 1, 0)
q_nhb_in_df11$treated_aux <- ifelse(q_nhb_in_df11$id == 11, 1, 0)
q_nhb_in_df12$treated_aux <- ifelse(q_nhb_in_df12$id == 12, 1, 0)
q_nhb_in_df13$treated_aux <- ifelse(q_nhb_in_df13$id == 13, 1, 0)
q_nhb_in_df15$treated_aux <- ifelse(q_nhb_in_df15$id == 15, 1, 0)
q_nhb_in_df17$treated_aux <- ifelse(q_nhb_in_df17$id == 17, 1, 0)
q_nhb_in_df19$treated_aux <- ifelse(q_nhb_in_df19$id == 19, 1, 0)
q_nhb_in_df21$treated_aux <- ifelse(q_nhb_in_df21$id == 21, 1, 0)
q_nhb_in_df23$treated_aux <- ifelse(q_nhb_in_df23$id == 23, 1, 0)
q_nhb_in_df24$treated_aux <- ifelse(q_nhb_in_df24$id == 24, 1, 0)
q_nhb_in_df25$treated_aux <- ifelse(q_nhb_in_df25$id == 25, 1, 0)
q_nhb_in_df26$treated_aux <- ifelse(q_nhb_in_df26$id == 26, 1, 0)
q_nhb_in_df28$treated_aux <- ifelse(q_nhb_in_df28$id == 28, 1, 0)
q_nhb_in_df29$treated_aux <- ifelse(q_nhb_in_df29$id == 29, 1, 0)
q_nhb_in_df30$treated_aux <- ifelse(q_nhb_in_df30$id == 30, 1, 0)
q_nhb_in_df31$treated_aux <- ifelse(q_nhb_in_df31$id == 31, 1, 0)
q_nhb_in_df32$treated_aux <- ifelse(q_nhb_in_df32$id == 32, 1, 0)
q_nhb_in_df33$treated_aux <- ifelse(q_nhb_in_df33$id == 33, 1, 0)
q_nhb_in_df34$treated_aux <- ifelse(q_nhb_in_df34$id == 34, 1, 0)
q_nhb_in_df36$treated_aux <- ifelse(q_nhb_in_df36$id == 36, 1, 0)
q_nhb_in_df37$treated_aux <- ifelse(q_nhb_in_df37$id == 37, 1, 0)
q_nhb_in_df39$treated_aux <- ifelse(q_nhb_in_df39$id == 39, 1, 0)
q_nhb_in_df40$treated_aux <- ifelse(q_nhb_in_df40$id == 40, 1, 0)
q_nhb_in_df41$treated_aux <- ifelse(q_nhb_in_df41$id == 41, 1, 0)
q_nhb_in_df44$treated_aux <- ifelse(q_nhb_in_df44$id == 44, 1, 0)
q_nhb_in_df45$treated_aux <- ifelse(q_nhb_in_df45$id == 45, 1, 0)
q_nhb_in_df47$treated_aux <- ifelse(q_nhb_in_df47$id == 47, 1, 0)
q_nhb_in_df50$treated_aux <- ifelse(q_nhb_in_df50$id == 50, 1, 0)
q_nhb_in_df51$treated_aux <- ifelse(q_nhb_in_df51$id == 51, 1, 0)
q_nhb_in_df53$treated_aux <- ifelse(q_nhb_in_df53$id == 53, 1, 0)
q_nhb_in_df54$treated_aux <- ifelse(q_nhb_in_df54$id == 54, 1, 0)
q_nhb_in_df55$treated_aux <- ifelse(q_nhb_in_df55$id == 55, 1, 0)
q_nhb_in_df1$treated <- as.integer(ifelse(q_nhb_in_df1$id == 1 & q_nhb_in_df1$year >= 1999, 1, 0))
q_nhb_in_df2$treated <- as.integer(ifelse(q_nhb_in_df2$id == 2 & q_nhb_in_df2$year >= 1999, 1, 0))
q_nhb_in_df5$treated <- as.integer(ifelse(q_nhb_in_df5$id == 5 & q_nhb_in_df5$year >= 1999, 1, 0))
q_nhb_in_df10$treated <- as.integer(ifelse(q_nhb_in_df10$id == 10 & q_nhb_in_df10$year >= 1999, 1, 0))
q_nhb_in_df11$treated <- as.integer(ifelse(q_nhb_in_df11$id == 11 & q_nhb_in_df11$year >= 1999, 1, 0))
q_nhb_in_df12$treated <- as.integer(ifelse(q_nhb_in_df12$id == 12 & q_nhb_in_df12$year >= 1999, 1, 0))
q_nhb_in_df13$treated <- as.integer(ifelse(q_nhb_in_df13$id == 13 & q_nhb_in_df13$year >= 1999, 1, 0))
q_nhb_in_df15$treated <- as.integer(ifelse(q_nhb_in_df15$id == 15 & q_nhb_in_df15$year >= 1999, 1, 0))
q_nhb_in_df17$treated <- as.integer(ifelse(q_nhb_in_df17$id == 17 & q_nhb_in_df17$year >= 1999, 1, 0))
q_nhb_in_df19$treated <- as.integer(ifelse(q_nhb_in_df19$id == 19 & q_nhb_in_df19$year >= 1999, 1, 0))
q_nhb_in_df21$treated <- as.integer(ifelse(q_nhb_in_df21$id == 21 & q_nhb_in_df21$year >= 1999, 1, 0))
q_nhb_in_df23$treated <- as.integer(ifelse(q_nhb_in_df23$id == 23 & q_nhb_in_df23$year >= 1999, 1, 0))
q_nhb_in_df24$treated <- as.integer(ifelse(q_nhb_in_df24$id == 24 & q_nhb_in_df24$year >= 1999, 1, 0))
q_nhb_in_df25$treated <- as.integer(ifelse(q_nhb_in_df25$id == 25 & q_nhb_in_df25$year >= 1999, 1, 0))
q_nhb_in_df26$treated <- as.integer(ifelse(q_nhb_in_df26$id == 26 & q_nhb_in_df26$year >= 1999, 1, 0))
q_nhb_in_df28$treated <- as.integer(ifelse(q_nhb_in_df28$id == 28 & q_nhb_in_df28$year >= 1999, 1, 0))
q_nhb_in_df29$treated <- as.integer(ifelse(q_nhb_in_df29$id == 29 & q_nhb_in_df29$year >= 1999, 1, 0))
q_nhb_in_df30$treated <- as.integer(ifelse(q_nhb_in_df30$id == 30 & q_nhb_in_df30$year >= 1999, 1, 0))
q_nhb_in_df31$treated <- as.integer(ifelse(q_nhb_in_df31$id == 31 & q_nhb_in_df31$year >= 1999, 1, 0))
q_nhb_in_df32$treated <- as.integer(ifelse(q_nhb_in_df32$id == 32 & q_nhb_in_df32$year >= 1999, 1, 0))
q_nhb_in_df33$treated <- as.integer(ifelse(q_nhb_in_df33$id == 33 & q_nhb_in_df33$year >= 1999, 1, 0))
q_nhb_in_df34$treated <- as.integer(ifelse(q_nhb_in_df34$id == 34 & q_nhb_in_df34$year >= 1999, 1, 0))
q_nhb_in_df36$treated <- as.integer(ifelse(q_nhb_in_df36$id == 36 & q_nhb_in_df36$year >= 1999, 1, 0))
q_nhb_in_df37$treated <- as.integer(ifelse(q_nhb_in_df37$id == 37 & q_nhb_in_df37$year >= 1999, 1, 0))
q_nhb_in_df39$treated <- as.integer(ifelse(q_nhb_in_df39$id == 39 & q_nhb_in_df39$year >= 1999, 1, 0))
q_nhb_in_df40$treated <- as.integer(ifelse(q_nhb_in_df40$id == 40 & q_nhb_in_df40$year >= 1999, 1, 0))
q_nhb_in_df41$treated <- as.integer(ifelse(q_nhb_in_df41$id == 41 & q_nhb_in_df41$year >= 1999, 1, 0))
q_nhb_in_df44$treated <- as.integer(ifelse(q_nhb_in_df44$id == 44 & q_nhb_in_df44$year >= 1999, 1, 0))
q_nhb_in_df45$treated <- as.integer(ifelse(q_nhb_in_df45$id == 45 & q_nhb_in_df45$year >= 1999, 1, 0))
q_nhb_in_df47$treated <- as.integer(ifelse(q_nhb_in_df47$id == 47 & q_nhb_in_df47$year >= 1999, 1, 0))
q_nhb_in_df50$treated <- as.integer(ifelse(q_nhb_in_df50$id == 50 & q_nhb_in_df50$year >= 1999, 1, 0))
q_nhb_in_df51$treated <- as.integer(ifelse(q_nhb_in_df51$id == 51 & q_nhb_in_df51$year >= 1999, 1, 0))
q_nhb_in_df53$treated <- as.integer(ifelse(q_nhb_in_df53$id == 53 & q_nhb_in_df53$year >= 1999, 1, 0))
q_nhb_in_df54$treated <- as.integer(ifelse(q_nhb_in_df54$id == 54 & q_nhb_in_df54$year >= 1999, 1, 0))
q_nhb_in_df55$treated <- as.integer(ifelse(q_nhb_in_df55$id == 55 & q_nhb_in_df55$year >= 1999, 1, 0))
q_nhb_in_df_list <- list(q_nhb_in_df1,q_nhb_in_df2,q_nhb_in_df5,
                         q_nhb_in_df10,q_nhb_in_df11,q_nhb_in_df12,
                         q_nhb_in_df13,q_nhb_in_df15,q_nhb_in_df17,
                         q_nhb_in_df19,q_nhb_in_df21,q_nhb_in_df23,
                         q_nhb_in_df24,q_nhb_in_df25,q_nhb_in_df26,
                         q_nhb_in_df28,q_nhb_in_df29,q_nhb_in_df30,
                         q_nhb_in_df31,q_nhb_in_df32,q_nhb_in_df33,
                         q_nhb_in_df34,q_nhb_in_df36,q_nhb_in_df37,
                         q_nhb_in_df39,q_nhb_in_df40,q_nhb_in_df41,
                         q_nhb_in_df44,q_nhb_in_df45,q_nhb_in_df47,
                         q_nhb_in_df50,q_nhb_in_df51,q_nhb_in_df53,
                         q_nhb_in_df54,q_nhb_in_df55)
rm(q_nhb_in_df1,q_nhb_in_df2,q_nhb_in_df5,
   q_nhb_in_df10,q_nhb_in_df11,q_nhb_in_df12,
   q_nhb_in_df13,q_nhb_in_df15,q_nhb_in_df17,
   q_nhb_in_df19,q_nhb_in_df21,q_nhb_in_df23,
   q_nhb_in_df24,q_nhb_in_df25,q_nhb_in_df26,
   q_nhb_in_df28,q_nhb_in_df29,q_nhb_in_df30,
   q_nhb_in_df31,q_nhb_in_df32,q_nhb_in_df33,
   q_nhb_in_df34,q_nhb_in_df36,q_nhb_in_df37,
   q_nhb_in_df39,q_nhb_in_df40,q_nhb_in_df41,
   q_nhb_in_df44,q_nhb_in_df45,q_nhb_in_df47,
   q_nhb_in_df50,q_nhb_in_df51,q_nhb_in_df53,
   q_nhb_in_df54,q_nhb_in_df55)
q_nhb_in_df_list <- lapply(q_nhb_in_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nhb_in_df_list <- lapply(q_nhb_in_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated)))
}
)
setup_q_nhb_in1 <- panel.matrices(q_nhb_in_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in2 <- panel.matrices(q_nhb_in_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in5 <- panel.matrices(q_nhb_in_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in10 <- panel.matrices(q_nhb_in_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in11 <- panel.matrices(q_nhb_in_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in12 <- panel.matrices(q_nhb_in_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in13 <- panel.matrices(q_nhb_in_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in15 <- panel.matrices(q_nhb_in_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in17 <- panel.matrices(q_nhb_in_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in19 <- panel.matrices(q_nhb_in_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in21 <- panel.matrices(q_nhb_in_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in23 <- panel.matrices(q_nhb_in_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in24 <- panel.matrices(q_nhb_in_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in25 <- panel.matrices(q_nhb_in_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in26 <- panel.matrices(q_nhb_in_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in28 <- panel.matrices(q_nhb_in_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in29 <- panel.matrices(q_nhb_in_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in30 <- panel.matrices(q_nhb_in_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in31 <- panel.matrices(q_nhb_in_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in32 <- panel.matrices(q_nhb_in_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in33 <- panel.matrices(q_nhb_in_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in34 <- panel.matrices(q_nhb_in_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in36 <- panel.matrices(q_nhb_in_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in37 <- panel.matrices(q_nhb_in_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in39 <- panel.matrices(q_nhb_in_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in40 <- panel.matrices(q_nhb_in_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in41 <- panel.matrices(q_nhb_in_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in44 <- panel.matrices(q_nhb_in_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in45 <- panel.matrices(q_nhb_in_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in47 <- panel.matrices(q_nhb_in_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in50 <- panel.matrices(q_nhb_in_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in51 <- panel.matrices(q_nhb_in_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in53 <- panel.matrices(q_nhb_in_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in54 <- panel.matrices(q_nhb_in_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in55 <- panel.matrices(q_nhb_in_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_in_list <- list(setup_q_nhb_in1,setup_q_nhb_in2,setup_q_nhb_in5,
                            setup_q_nhb_in10,setup_q_nhb_in11,setup_q_nhb_in12,
                            setup_q_nhb_in13,setup_q_nhb_in15,setup_q_nhb_in17,
                            setup_q_nhb_in19,setup_q_nhb_in21,setup_q_nhb_in23,
                            setup_q_nhb_in24,setup_q_nhb_in25,setup_q_nhb_in26,
                            setup_q_nhb_in28,setup_q_nhb_in29,setup_q_nhb_in30,
                            setup_q_nhb_in31,setup_q_nhb_in32,setup_q_nhb_in33,
                            setup_q_nhb_in34,setup_q_nhb_in36,setup_q_nhb_in37,
                            setup_q_nhb_in39,setup_q_nhb_in40,setup_q_nhb_in41,
                            setup_q_nhb_in44,setup_q_nhb_in45,setup_q_nhb_in47,
                            setup_q_nhb_in50,setup_q_nhb_in51,setup_q_nhb_in53,
                            setup_q_nhb_in54,setup_q_nhb_in55)
rm(setup_q_nhb_in1,setup_q_nhb_in2,setup_q_nhb_in5,
   setup_q_nhb_in10,setup_q_nhb_in11,setup_q_nhb_in12,
   setup_q_nhb_in13,setup_q_nhb_in15,setup_q_nhb_in17,
   setup_q_nhb_in19,setup_q_nhb_in21,setup_q_nhb_in23,
   setup_q_nhb_in24,setup_q_nhb_in25,setup_q_nhb_in26,
   setup_q_nhb_in28,setup_q_nhb_in29,setup_q_nhb_in30,
   setup_q_nhb_in31,setup_q_nhb_in32,setup_q_nhb_in33,
   setup_q_nhb_in34,setup_q_nhb_in36,setup_q_nhb_in37,
   setup_q_nhb_in39,setup_q_nhb_in40,setup_q_nhb_in41,
   setup_q_nhb_in44,setup_q_nhb_in45,setup_q_nhb_in47,
   setup_q_nhb_in50,setup_q_nhb_in51,setup_q_nhb_in53,
   setup_q_nhb_in54,setup_q_nhb_in55)
# DID #
q_nhb_in_est_did1 <- did_estimate(setup_q_nhb_in_list[[1]]$Y, setup_q_nhb_in_list[[1]]$N0, setup_q_nhb_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_in_est_did2 <- did_estimate(setup_q_nhb_in_list[[2]]$Y, setup_q_nhb_in_list[[2]]$N0, setup_q_nhb_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_in_est_did5 <- did_estimate(setup_q_nhb_in_list[[3]]$Y, setup_q_nhb_in_list[[3]]$N0, setup_q_nhb_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_in_est_did10 <- did_estimate(setup_q_nhb_in_list[[4]]$Y, setup_q_nhb_in_list[[4]]$N0, setup_q_nhb_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_in_est_did11 <- did_estimate(setup_q_nhb_in_list[[5]]$Y, setup_q_nhb_in_list[[5]]$N0, setup_q_nhb_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_in_est_did12 <- did_estimate(setup_q_nhb_in_list[[6]]$Y, setup_q_nhb_in_list[[6]]$N0, setup_q_nhb_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_in_est_did13 <- did_estimate(setup_q_nhb_in_list[[7]]$Y, setup_q_nhb_in_list[[7]]$N0, setup_q_nhb_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_in_est_did15 <- did_estimate(setup_q_nhb_in_list[[8]]$Y, setup_q_nhb_in_list[[8]]$N0, setup_q_nhb_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_in_est_did17 <- did_estimate(setup_q_nhb_in_list[[9]]$Y, setup_q_nhb_in_list[[9]]$N0, setup_q_nhb_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_in_est_did19 <- did_estimate(setup_q_nhb_in_list[[10]]$Y, setup_q_nhb_in_list[[10]]$N0, setup_q_nhb_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_in_est_did21 <- did_estimate(setup_q_nhb_in_list[[11]]$Y, setup_q_nhb_in_list[[11]]$N0, setup_q_nhb_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_in_est_did23 <- did_estimate(setup_q_nhb_in_list[[12]]$Y, setup_q_nhb_in_list[[12]]$N0, setup_q_nhb_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_in_est_did24 <- did_estimate(setup_q_nhb_in_list[[13]]$Y, setup_q_nhb_in_list[[13]]$N0, setup_q_nhb_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_in_est_did25 <- did_estimate(setup_q_nhb_in_list[[14]]$Y, setup_q_nhb_in_list[[14]]$N0, setup_q_nhb_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_in_est_did26 <- did_estimate(setup_q_nhb_in_list[[15]]$Y, setup_q_nhb_in_list[[15]]$N0, setup_q_nhb_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_in_est_did28 <- did_estimate(setup_q_nhb_in_list[[16]]$Y, setup_q_nhb_in_list[[16]]$N0, setup_q_nhb_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_in_est_did29 <- did_estimate(setup_q_nhb_in_list[[17]]$Y, setup_q_nhb_in_list[[17]]$N0, setup_q_nhb_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_in_est_did30 <- did_estimate(setup_q_nhb_in_list[[18]]$Y, setup_q_nhb_in_list[[18]]$N0, setup_q_nhb_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_in_est_did31 <- did_estimate(setup_q_nhb_in_list[[19]]$Y, setup_q_nhb_in_list[[19]]$N0, setup_q_nhb_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_in_est_did32 <- did_estimate(setup_q_nhb_in_list[[20]]$Y, setup_q_nhb_in_list[[20]]$N0, setup_q_nhb_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_in_est_did33 <- did_estimate(setup_q_nhb_in_list[[21]]$Y, setup_q_nhb_in_list[[21]]$N0, setup_q_nhb_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_in_est_did34 <- did_estimate(setup_q_nhb_in_list[[22]]$Y, setup_q_nhb_in_list[[22]]$N0, setup_q_nhb_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_in_est_did36 <- did_estimate(setup_q_nhb_in_list[[23]]$Y, setup_q_nhb_in_list[[23]]$N0, setup_q_nhb_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_in_est_did37 <- did_estimate(setup_q_nhb_in_list[[24]]$Y, setup_q_nhb_in_list[[24]]$N0, setup_q_nhb_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_in_est_did39 <- did_estimate(setup_q_nhb_in_list[[25]]$Y, setup_q_nhb_in_list[[25]]$N0, setup_q_nhb_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_in_est_did40 <- did_estimate(setup_q_nhb_in_list[[26]]$Y, setup_q_nhb_in_list[[26]]$N0, setup_q_nhb_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_in_est_did41 <- did_estimate(setup_q_nhb_in_list[[27]]$Y, setup_q_nhb_in_list[[27]]$N0, setup_q_nhb_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_in_est_did44 <- did_estimate(setup_q_nhb_in_list[[28]]$Y, setup_q_nhb_in_list[[28]]$N0, setup_q_nhb_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_in_est_did45 <- did_estimate(setup_q_nhb_in_list[[29]]$Y, setup_q_nhb_in_list[[29]]$N0, setup_q_nhb_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_in_est_did47 <- did_estimate(setup_q_nhb_in_list[[30]]$Y, setup_q_nhb_in_list[[30]]$N0, setup_q_nhb_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_in_est_did50 <- did_estimate(setup_q_nhb_in_list[[31]]$Y, setup_q_nhb_in_list[[31]]$N0, setup_q_nhb_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_in_est_did51 <- did_estimate(setup_q_nhb_in_list[[32]]$Y, setup_q_nhb_in_list[[32]]$N0, setup_q_nhb_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_in_est_did53 <- did_estimate(setup_q_nhb_in_list[[33]]$Y, setup_q_nhb_in_list[[33]]$N0, setup_q_nhb_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_in_est_did54 <- did_estimate(setup_q_nhb_in_list[[34]]$Y, setup_q_nhb_in_list[[34]]$N0, setup_q_nhb_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_in_est_did55 <- did_estimate(setup_q_nhb_in_list[[35]]$Y, setup_q_nhb_in_list[[35]]$N0, setup_q_nhb_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_in_est_did_list <- list(q_nhb_in_est_did1,q_nhb_in_est_did2,q_nhb_in_est_did5,
                              q_nhb_in_est_did10,q_nhb_in_est_did11,q_nhb_in_est_did12,
                              q_nhb_in_est_did13,q_nhb_in_est_did15,q_nhb_in_est_did17,
                              q_nhb_in_est_did19,q_nhb_in_est_did21,q_nhb_in_est_did23,
                              q_nhb_in_est_did24,q_nhb_in_est_did25,q_nhb_in_est_did26,
                              q_nhb_in_est_did28,q_nhb_in_est_did29,q_nhb_in_est_did30,
                              q_nhb_in_est_did31,q_nhb_in_est_did32,q_nhb_in_est_did33,
                              q_nhb_in_est_did34,q_nhb_in_est_did36,q_nhb_in_est_did37,
                              q_nhb_in_est_did39,q_nhb_in_est_did40,q_nhb_in_est_did41,
                              q_nhb_in_est_did44,q_nhb_in_est_did45,q_nhb_in_est_did47,
                              q_nhb_in_est_did50,q_nhb_in_est_did51,q_nhb_in_est_did53,
                              q_nhb_in_est_did54,q_nhb_in_est_did55)
rm(q_nhb_in_est_did1,q_nhb_in_est_did2,q_nhb_in_est_did5,
   q_nhb_in_est_did10,q_nhb_in_est_did11,q_nhb_in_est_did12,
   q_nhb_in_est_did13,q_nhb_in_est_did15,q_nhb_in_est_did17,
   q_nhb_in_est_did19,q_nhb_in_est_did21,q_nhb_in_est_did23,
   q_nhb_in_est_did24,q_nhb_in_est_did25,q_nhb_in_est_did26,
   q_nhb_in_est_did28,q_nhb_in_est_did29,q_nhb_in_est_did30,
   q_nhb_in_est_did31,q_nhb_in_est_did32,q_nhb_in_est_did33,
   q_nhb_in_est_did34,q_nhb_in_est_did36,q_nhb_in_est_did37,
   q_nhb_in_est_did39,q_nhb_in_est_did40,q_nhb_in_est_did41,
   q_nhb_in_est_did44,q_nhb_in_est_did45,q_nhb_in_est_did47,
   q_nhb_in_est_did50,q_nhb_in_est_did51,q_nhb_in_est_did53,
   q_nhb_in_est_did54,q_nhb_in_est_did55)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_did_plot", i), synthdid_plot(q_nhb_in_est_did_list[i]))
}
q_nhb_in_est_did_plot_data_aux1 <- ggplot_build(q_nhb_in_est_did_plot1)
q_nhb_in_est_did_plot_data_aux2 <- ggplot_build(q_nhb_in_est_did_plot2)
q_nhb_in_est_did_plot_data_aux3 <- ggplot_build(q_nhb_in_est_did_plot3)
q_nhb_in_est_did_plot_data_aux4 <- ggplot_build(q_nhb_in_est_did_plot4)
q_nhb_in_est_did_plot_data_aux5 <- ggplot_build(q_nhb_in_est_did_plot5)
q_nhb_in_est_did_plot_data_aux6 <- ggplot_build(q_nhb_in_est_did_plot6)
q_nhb_in_est_did_plot_data_aux7 <- ggplot_build(q_nhb_in_est_did_plot7)
q_nhb_in_est_did_plot_data_aux8 <- ggplot_build(q_nhb_in_est_did_plot8)
q_nhb_in_est_did_plot_data_aux9 <- ggplot_build(q_nhb_in_est_did_plot9)
q_nhb_in_est_did_plot_data_aux10 <- ggplot_build(q_nhb_in_est_did_plot10)
q_nhb_in_est_did_plot_data_aux11 <- ggplot_build(q_nhb_in_est_did_plot11)
q_nhb_in_est_did_plot_data_aux12 <- ggplot_build(q_nhb_in_est_did_plot12)
q_nhb_in_est_did_plot_data_aux13 <- ggplot_build(q_nhb_in_est_did_plot13)
q_nhb_in_est_did_plot_data_aux14 <- ggplot_build(q_nhb_in_est_did_plot14)
q_nhb_in_est_did_plot_data_aux15 <- ggplot_build(q_nhb_in_est_did_plot15)
q_nhb_in_est_did_plot_data_aux16 <- ggplot_build(q_nhb_in_est_did_plot16)
q_nhb_in_est_did_plot_data_aux17 <- ggplot_build(q_nhb_in_est_did_plot17)
q_nhb_in_est_did_plot_data_aux18 <- ggplot_build(q_nhb_in_est_did_plot18)
q_nhb_in_est_did_plot_data_aux19 <- ggplot_build(q_nhb_in_est_did_plot19)
q_nhb_in_est_did_plot_data_aux20 <- ggplot_build(q_nhb_in_est_did_plot20)
q_nhb_in_est_did_plot_data_aux21 <- ggplot_build(q_nhb_in_est_did_plot21)
q_nhb_in_est_did_plot_data_aux22 <- ggplot_build(q_nhb_in_est_did_plot22)
q_nhb_in_est_did_plot_data_aux23 <- ggplot_build(q_nhb_in_est_did_plot23)
q_nhb_in_est_did_plot_data_aux24 <- ggplot_build(q_nhb_in_est_did_plot24)
q_nhb_in_est_did_plot_data_aux25 <- ggplot_build(q_nhb_in_est_did_plot25)
q_nhb_in_est_did_plot_data_aux26 <- ggplot_build(q_nhb_in_est_did_plot26)
q_nhb_in_est_did_plot_data_aux27 <- ggplot_build(q_nhb_in_est_did_plot27)
q_nhb_in_est_did_plot_data_aux28 <- ggplot_build(q_nhb_in_est_did_plot28)
q_nhb_in_est_did_plot_data_aux29 <- ggplot_build(q_nhb_in_est_did_plot29)
q_nhb_in_est_did_plot_data_aux30 <- ggplot_build(q_nhb_in_est_did_plot30)
q_nhb_in_est_did_plot_data_aux31 <- ggplot_build(q_nhb_in_est_did_plot31)
q_nhb_in_est_did_plot_data_aux32 <- ggplot_build(q_nhb_in_est_did_plot32)
q_nhb_in_est_did_plot_data_aux33 <- ggplot_build(q_nhb_in_est_did_plot33)
q_nhb_in_est_did_plot_data_aux34 <- ggplot_build(q_nhb_in_est_did_plot34)
q_nhb_in_est_did_plot_data_aux35 <- ggplot_build(q_nhb_in_est_did_plot35)
q_nhb_in_est_did_plot_data_aux_list <- list(q_nhb_in_est_did_plot_data_aux1,q_nhb_in_est_did_plot_data_aux2,q_nhb_in_est_did_plot_data_aux3,
                                            q_nhb_in_est_did_plot_data_aux4,q_nhb_in_est_did_plot_data_aux5,q_nhb_in_est_did_plot_data_aux6,
                                            q_nhb_in_est_did_plot_data_aux7,q_nhb_in_est_did_plot_data_aux8,q_nhb_in_est_did_plot_data_aux9,
                                            q_nhb_in_est_did_plot_data_aux10,q_nhb_in_est_did_plot_data_aux11,q_nhb_in_est_did_plot_data_aux12,
                                            q_nhb_in_est_did_plot_data_aux13,q_nhb_in_est_did_plot_data_aux14,q_nhb_in_est_did_plot_data_aux15,
                                            q_nhb_in_est_did_plot_data_aux16,q_nhb_in_est_did_plot_data_aux17,q_nhb_in_est_did_plot_data_aux18,
                                            q_nhb_in_est_did_plot_data_aux19,q_nhb_in_est_did_plot_data_aux20,q_nhb_in_est_did_plot_data_aux21,
                                            q_nhb_in_est_did_plot_data_aux22,q_nhb_in_est_did_plot_data_aux23,q_nhb_in_est_did_plot_data_aux24,
                                            q_nhb_in_est_did_plot_data_aux25,q_nhb_in_est_did_plot_data_aux26,q_nhb_in_est_did_plot_data_aux27,
                                            q_nhb_in_est_did_plot_data_aux28,q_nhb_in_est_did_plot_data_aux29,q_nhb_in_est_did_plot_data_aux30,
                                            q_nhb_in_est_did_plot_data_aux31,q_nhb_in_est_did_plot_data_aux32,q_nhb_in_est_did_plot_data_aux33,
                                            q_nhb_in_est_did_plot_data_aux34,q_nhb_in_est_did_plot_data_aux35)
rm(q_nhb_in_est_did_plot_data_aux1,q_nhb_in_est_did_plot_data_aux2,q_nhb_in_est_did_plot_data_aux3,
   q_nhb_in_est_did_plot_data_aux4,q_nhb_in_est_did_plot_data_aux5,q_nhb_in_est_did_plot_data_aux6,
   q_nhb_in_est_did_plot_data_aux7,q_nhb_in_est_did_plot_data_aux8,q_nhb_in_est_did_plot_data_aux9,
   q_nhb_in_est_did_plot_data_aux10,q_nhb_in_est_did_plot_data_aux11,q_nhb_in_est_did_plot_data_aux12,
   q_nhb_in_est_did_plot_data_aux13,q_nhb_in_est_did_plot_data_aux14,q_nhb_in_est_did_plot_data_aux15,
   q_nhb_in_est_did_plot_data_aux16,q_nhb_in_est_did_plot_data_aux17,q_nhb_in_est_did_plot_data_aux18,
   q_nhb_in_est_did_plot_data_aux19,q_nhb_in_est_did_plot_data_aux20,q_nhb_in_est_did_plot_data_aux21,
   q_nhb_in_est_did_plot_data_aux22,q_nhb_in_est_did_plot_data_aux23,q_nhb_in_est_did_plot_data_aux24,
   q_nhb_in_est_did_plot_data_aux25,q_nhb_in_est_did_plot_data_aux26,q_nhb_in_est_did_plot_data_aux27,
   q_nhb_in_est_did_plot_data_aux28,q_nhb_in_est_did_plot_data_aux29,q_nhb_in_est_did_plot_data_aux30,
   q_nhb_in_est_did_plot_data_aux31,q_nhb_in_est_did_plot_data_aux32,q_nhb_in_est_did_plot_data_aux33,
   q_nhb_in_est_did_plot_data_aux34,q_nhb_in_est_did_plot_data_aux35)
rm(q_nhb_in_est_did_plot1,q_nhb_in_est_did_plot2,q_nhb_in_est_did_plot3,
   q_nhb_in_est_did_plot4,q_nhb_in_est_did_plot5,q_nhb_in_est_did_plot6,
   q_nhb_in_est_did_plot7,q_nhb_in_est_did_plot8,q_nhb_in_est_did_plot9,
   q_nhb_in_est_did_plot10,q_nhb_in_est_did_plot11,q_nhb_in_est_did_plot12,
   q_nhb_in_est_did_plot13,q_nhb_in_est_did_plot14,q_nhb_in_est_did_plot15,
   q_nhb_in_est_did_plot16,q_nhb_in_est_did_plot17,q_nhb_in_est_did_plot18,
   q_nhb_in_est_did_plot19,q_nhb_in_est_did_plot20,q_nhb_in_est_did_plot21,
   q_nhb_in_est_did_plot22,q_nhb_in_est_did_plot23,q_nhb_in_est_did_plot24,
   q_nhb_in_est_did_plot25,q_nhb_in_est_did_plot26,q_nhb_in_est_did_plot27,
   q_nhb_in_est_did_plot28,q_nhb_in_est_did_plot29,q_nhb_in_est_did_plot30,
   q_nhb_in_est_did_plot31,q_nhb_in_est_did_plot32,q_nhb_in_est_did_plot33,
   q_nhb_in_est_did_plot34,q_nhb_in_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_did_plot_data_long", i), data.frame(q_nhb_in_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_in_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_in_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_in_est_did_plot_data_long_list <- list(q_nhb_in_est_did_plot_data_long1,q_nhb_in_est_did_plot_data_long2,q_nhb_in_est_did_plot_data_long3,
                                             q_nhb_in_est_did_plot_data_long4,q_nhb_in_est_did_plot_data_long5,q_nhb_in_est_did_plot_data_long6,
                                             q_nhb_in_est_did_plot_data_long7,q_nhb_in_est_did_plot_data_long8,q_nhb_in_est_did_plot_data_long9,
                                             q_nhb_in_est_did_plot_data_long10,q_nhb_in_est_did_plot_data_long11,q_nhb_in_est_did_plot_data_long12,
                                             q_nhb_in_est_did_plot_data_long13,q_nhb_in_est_did_plot_data_long14,q_nhb_in_est_did_plot_data_long15,
                                             q_nhb_in_est_did_plot_data_long16,q_nhb_in_est_did_plot_data_long17,q_nhb_in_est_did_plot_data_long18,
                                             q_nhb_in_est_did_plot_data_long19,q_nhb_in_est_did_plot_data_long20,q_nhb_in_est_did_plot_data_long21,
                                             q_nhb_in_est_did_plot_data_long22,q_nhb_in_est_did_plot_data_long23,q_nhb_in_est_did_plot_data_long24,
                                             q_nhb_in_est_did_plot_data_long25,q_nhb_in_est_did_plot_data_long26,q_nhb_in_est_did_plot_data_long27,
                                             q_nhb_in_est_did_plot_data_long28,q_nhb_in_est_did_plot_data_long29,q_nhb_in_est_did_plot_data_long30,
                                             q_nhb_in_est_did_plot_data_long31,q_nhb_in_est_did_plot_data_long32,q_nhb_in_est_did_plot_data_long33,
                                             q_nhb_in_est_did_plot_data_long34,q_nhb_in_est_did_plot_data_long35)
rm(q_nhb_in_est_did_plot_data_long1,q_nhb_in_est_did_plot_data_long2,q_nhb_in_est_did_plot_data_long3,
   q_nhb_in_est_did_plot_data_long4,q_nhb_in_est_did_plot_data_long5,q_nhb_in_est_did_plot_data_long6,
   q_nhb_in_est_did_plot_data_long7,q_nhb_in_est_did_plot_data_long8,q_nhb_in_est_did_plot_data_long9,
   q_nhb_in_est_did_plot_data_long10,q_nhb_in_est_did_plot_data_long11,q_nhb_in_est_did_plot_data_long12,
   q_nhb_in_est_did_plot_data_long13,q_nhb_in_est_did_plot_data_long14,q_nhb_in_est_did_plot_data_long15,
   q_nhb_in_est_did_plot_data_long16,q_nhb_in_est_did_plot_data_long17,q_nhb_in_est_did_plot_data_long18,
   q_nhb_in_est_did_plot_data_long19,q_nhb_in_est_did_plot_data_long20,q_nhb_in_est_did_plot_data_long21,
   q_nhb_in_est_did_plot_data_long22,q_nhb_in_est_did_plot_data_long23,q_nhb_in_est_did_plot_data_long24,
   q_nhb_in_est_did_plot_data_long25,q_nhb_in_est_did_plot_data_long26,q_nhb_in_est_did_plot_data_long27,
   q_nhb_in_est_did_plot_data_long28,q_nhb_in_est_did_plot_data_long29,q_nhb_in_est_did_plot_data_long30,
   q_nhb_in_est_did_plot_data_long31,q_nhb_in_est_did_plot_data_long32,q_nhb_in_est_did_plot_data_long33,
   q_nhb_in_est_did_plot_data_long34,q_nhb_in_est_did_plot_data_long35)
q_nhb_in_est_did_plot_data_long_list <- lapply(q_nhb_in_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_did_plot_data_wide", i), reshape(data=q_nhb_in_est_did_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
q_nhb_in_est_did_plot_data_wide_list <- list(q_nhb_in_est_did_plot_data_wide1,q_nhb_in_est_did_plot_data_wide2,q_nhb_in_est_did_plot_data_wide3,
                                             q_nhb_in_est_did_plot_data_wide4,q_nhb_in_est_did_plot_data_wide5,q_nhb_in_est_did_plot_data_wide6,
                                             q_nhb_in_est_did_plot_data_wide7,q_nhb_in_est_did_plot_data_wide8,q_nhb_in_est_did_plot_data_wide9,
                                             q_nhb_in_est_did_plot_data_wide10,q_nhb_in_est_did_plot_data_wide11,q_nhb_in_est_did_plot_data_wide12,
                                             q_nhb_in_est_did_plot_data_wide13,q_nhb_in_est_did_plot_data_wide14,q_nhb_in_est_did_plot_data_wide15,
                                             q_nhb_in_est_did_plot_data_wide16,q_nhb_in_est_did_plot_data_wide17,q_nhb_in_est_did_plot_data_wide18,
                                             q_nhb_in_est_did_plot_data_wide19,q_nhb_in_est_did_plot_data_wide20,q_nhb_in_est_did_plot_data_wide21,
                                             q_nhb_in_est_did_plot_data_wide22,q_nhb_in_est_did_plot_data_wide23,q_nhb_in_est_did_plot_data_wide24,
                                             q_nhb_in_est_did_plot_data_wide25,q_nhb_in_est_did_plot_data_wide26,q_nhb_in_est_did_plot_data_wide27,
                                             q_nhb_in_est_did_plot_data_wide28,q_nhb_in_est_did_plot_data_wide29,q_nhb_in_est_did_plot_data_wide30,
                                             q_nhb_in_est_did_plot_data_wide31,q_nhb_in_est_did_plot_data_wide32,q_nhb_in_est_did_plot_data_wide33,
                                             q_nhb_in_est_did_plot_data_wide34,q_nhb_in_est_did_plot_data_wide35)
rm(q_nhb_in_est_did_plot_data_wide1,q_nhb_in_est_did_plot_data_wide2,q_nhb_in_est_did_plot_data_wide3,
   q_nhb_in_est_did_plot_data_wide4,q_nhb_in_est_did_plot_data_wide5,q_nhb_in_est_did_plot_data_wide6,
   q_nhb_in_est_did_plot_data_wide7,q_nhb_in_est_did_plot_data_wide8,q_nhb_in_est_did_plot_data_wide9,
   q_nhb_in_est_did_plot_data_wide10,q_nhb_in_est_did_plot_data_wide11,q_nhb_in_est_did_plot_data_wide12,
   q_nhb_in_est_did_plot_data_wide13,q_nhb_in_est_did_plot_data_wide14,q_nhb_in_est_did_plot_data_wide15,
   q_nhb_in_est_did_plot_data_wide16,q_nhb_in_est_did_plot_data_wide17,q_nhb_in_est_did_plot_data_wide18,
   q_nhb_in_est_did_plot_data_wide19,q_nhb_in_est_did_plot_data_wide20,q_nhb_in_est_did_plot_data_wide21,
   q_nhb_in_est_did_plot_data_wide22,q_nhb_in_est_did_plot_data_wide23,q_nhb_in_est_did_plot_data_wide24,
   q_nhb_in_est_did_plot_data_wide25,q_nhb_in_est_did_plot_data_wide26,q_nhb_in_est_did_plot_data_wide27,
   q_nhb_in_est_did_plot_data_wide28,q_nhb_in_est_did_plot_data_wide29,q_nhb_in_est_did_plot_data_wide30,
   q_nhb_in_est_did_plot_data_wide31,q_nhb_in_est_did_plot_data_wide32,q_nhb_in_est_did_plot_data_wide33,
   q_nhb_in_est_did_plot_data_wide34,q_nhb_in_est_did_plot_data_wide35)
q_nhb_in_est_did_plot_data_wide_list <- lapply(q_nhb_in_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nhb_in_est_sc1 <- sc_estimate(setup_q_nhb_in_list[[1]]$Y, setup_q_nhb_in_list[[1]]$N0, setup_q_nhb_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_in_est_sc2 <- sc_estimate(setup_q_nhb_in_list[[2]]$Y, setup_q_nhb_in_list[[2]]$N0, setup_q_nhb_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_in_est_sc5 <- sc_estimate(setup_q_nhb_in_list[[3]]$Y, setup_q_nhb_in_list[[3]]$N0, setup_q_nhb_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_in_est_sc10 <- sc_estimate(setup_q_nhb_in_list[[4]]$Y, setup_q_nhb_in_list[[4]]$N0, setup_q_nhb_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_in_est_sc11 <- sc_estimate(setup_q_nhb_in_list[[5]]$Y, setup_q_nhb_in_list[[5]]$N0, setup_q_nhb_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_in_est_sc12 <- sc_estimate(setup_q_nhb_in_list[[6]]$Y, setup_q_nhb_in_list[[6]]$N0, setup_q_nhb_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_in_est_sc13 <- sc_estimate(setup_q_nhb_in_list[[7]]$Y, setup_q_nhb_in_list[[7]]$N0, setup_q_nhb_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_in_est_sc15 <- sc_estimate(setup_q_nhb_in_list[[8]]$Y, setup_q_nhb_in_list[[8]]$N0, setup_q_nhb_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_in_est_sc17 <- sc_estimate(setup_q_nhb_in_list[[9]]$Y, setup_q_nhb_in_list[[9]]$N0, setup_q_nhb_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_in_est_sc19 <- sc_estimate(setup_q_nhb_in_list[[10]]$Y, setup_q_nhb_in_list[[10]]$N0, setup_q_nhb_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_in_est_sc21 <- sc_estimate(setup_q_nhb_in_list[[11]]$Y, setup_q_nhb_in_list[[11]]$N0, setup_q_nhb_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_in_est_sc23 <- sc_estimate(setup_q_nhb_in_list[[12]]$Y, setup_q_nhb_in_list[[12]]$N0, setup_q_nhb_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_in_est_sc24 <- sc_estimate(setup_q_nhb_in_list[[13]]$Y, setup_q_nhb_in_list[[13]]$N0, setup_q_nhb_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_in_est_sc25 <- sc_estimate(setup_q_nhb_in_list[[14]]$Y, setup_q_nhb_in_list[[14]]$N0, setup_q_nhb_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_in_est_sc26 <- sc_estimate(setup_q_nhb_in_list[[15]]$Y, setup_q_nhb_in_list[[15]]$N0, setup_q_nhb_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_in_est_sc28 <- sc_estimate(setup_q_nhb_in_list[[16]]$Y, setup_q_nhb_in_list[[16]]$N0, setup_q_nhb_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_in_est_sc29 <- sc_estimate(setup_q_nhb_in_list[[17]]$Y, setup_q_nhb_in_list[[17]]$N0, setup_q_nhb_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_in_est_sc30 <- sc_estimate(setup_q_nhb_in_list[[18]]$Y, setup_q_nhb_in_list[[18]]$N0, setup_q_nhb_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_in_est_sc31 <- sc_estimate(setup_q_nhb_in_list[[19]]$Y, setup_q_nhb_in_list[[19]]$N0, setup_q_nhb_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_in_est_sc32 <- sc_estimate(setup_q_nhb_in_list[[20]]$Y, setup_q_nhb_in_list[[20]]$N0, setup_q_nhb_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_in_est_sc33 <- sc_estimate(setup_q_nhb_in_list[[21]]$Y, setup_q_nhb_in_list[[21]]$N0, setup_q_nhb_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_in_est_sc34 <- sc_estimate(setup_q_nhb_in_list[[22]]$Y, setup_q_nhb_in_list[[22]]$N0, setup_q_nhb_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_in_est_sc36 <- sc_estimate(setup_q_nhb_in_list[[23]]$Y, setup_q_nhb_in_list[[23]]$N0, setup_q_nhb_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_in_est_sc37 <- sc_estimate(setup_q_nhb_in_list[[24]]$Y, setup_q_nhb_in_list[[24]]$N0, setup_q_nhb_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_in_est_sc39 <- sc_estimate(setup_q_nhb_in_list[[25]]$Y, setup_q_nhb_in_list[[25]]$N0, setup_q_nhb_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_in_est_sc40 <- sc_estimate(setup_q_nhb_in_list[[26]]$Y, setup_q_nhb_in_list[[26]]$N0, setup_q_nhb_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_in_est_sc41 <- sc_estimate(setup_q_nhb_in_list[[27]]$Y, setup_q_nhb_in_list[[27]]$N0, setup_q_nhb_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_in_est_sc44 <- sc_estimate(setup_q_nhb_in_list[[28]]$Y, setup_q_nhb_in_list[[28]]$N0, setup_q_nhb_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_in_est_sc45 <- sc_estimate(setup_q_nhb_in_list[[29]]$Y, setup_q_nhb_in_list[[29]]$N0, setup_q_nhb_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_in_est_sc47 <- sc_estimate(setup_q_nhb_in_list[[30]]$Y, setup_q_nhb_in_list[[30]]$N0, setup_q_nhb_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_in_est_sc50 <- sc_estimate(setup_q_nhb_in_list[[31]]$Y, setup_q_nhb_in_list[[31]]$N0, setup_q_nhb_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_in_est_sc51 <- sc_estimate(setup_q_nhb_in_list[[32]]$Y, setup_q_nhb_in_list[[32]]$N0, setup_q_nhb_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_in_est_sc53 <- sc_estimate(setup_q_nhb_in_list[[33]]$Y, setup_q_nhb_in_list[[33]]$N0, setup_q_nhb_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_in_est_sc54 <- sc_estimate(setup_q_nhb_in_list[[34]]$Y, setup_q_nhb_in_list[[34]]$N0, setup_q_nhb_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_in_est_sc55 <- sc_estimate(setup_q_nhb_in_list[[35]]$Y, setup_q_nhb_in_list[[35]]$N0, setup_q_nhb_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_in_est_sc_list <- list(q_nhb_in_est_sc1,q_nhb_in_est_sc2,q_nhb_in_est_sc5,
                             q_nhb_in_est_sc10,q_nhb_in_est_sc11,q_nhb_in_est_sc12,
                             q_nhb_in_est_sc13,q_nhb_in_est_sc15,q_nhb_in_est_sc17,
                             q_nhb_in_est_sc19,q_nhb_in_est_sc21,q_nhb_in_est_sc23,
                             q_nhb_in_est_sc24,q_nhb_in_est_sc25,q_nhb_in_est_sc26,
                             q_nhb_in_est_sc28,q_nhb_in_est_sc29,q_nhb_in_est_sc30,
                             q_nhb_in_est_sc31,q_nhb_in_est_sc32,q_nhb_in_est_sc33,
                             q_nhb_in_est_sc34,q_nhb_in_est_sc36,q_nhb_in_est_sc37,
                             q_nhb_in_est_sc39,q_nhb_in_est_sc40,q_nhb_in_est_sc41,
                             q_nhb_in_est_sc44,q_nhb_in_est_sc45,q_nhb_in_est_sc47,
                             q_nhb_in_est_sc50,q_nhb_in_est_sc51,q_nhb_in_est_sc53,
                             q_nhb_in_est_sc54,q_nhb_in_est_sc55)
rm(q_nhb_in_est_sc1,q_nhb_in_est_sc2,q_nhb_in_est_sc5,
   q_nhb_in_est_sc10,q_nhb_in_est_sc11,q_nhb_in_est_sc12,
   q_nhb_in_est_sc13,q_nhb_in_est_sc15,q_nhb_in_est_sc17,
   q_nhb_in_est_sc19,q_nhb_in_est_sc21,q_nhb_in_est_sc23,
   q_nhb_in_est_sc24,q_nhb_in_est_sc25,q_nhb_in_est_sc26,
   q_nhb_in_est_sc28,q_nhb_in_est_sc29,q_nhb_in_est_sc30,
   q_nhb_in_est_sc31,q_nhb_in_est_sc32,q_nhb_in_est_sc33,
   q_nhb_in_est_sc34,q_nhb_in_est_sc36,q_nhb_in_est_sc37,
   q_nhb_in_est_sc39,q_nhb_in_est_sc40,q_nhb_in_est_sc41,
   q_nhb_in_est_sc44,q_nhb_in_est_sc45,q_nhb_in_est_sc47,
   q_nhb_in_est_sc50,q_nhb_in_est_sc51,q_nhb_in_est_sc53,
   q_nhb_in_est_sc54,q_nhb_in_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sc_plot", i), synthdid_plot(q_nhb_in_est_sc_list[i]))
}
q_nhb_in_est_sc_plot_data_aux1 <- ggplot_build(q_nhb_in_est_sc_plot1)
q_nhb_in_est_sc_plot_data_aux2 <- ggplot_build(q_nhb_in_est_sc_plot2)
q_nhb_in_est_sc_plot_data_aux3 <- ggplot_build(q_nhb_in_est_sc_plot3)
q_nhb_in_est_sc_plot_data_aux4 <- ggplot_build(q_nhb_in_est_sc_plot4)
q_nhb_in_est_sc_plot_data_aux5 <- ggplot_build(q_nhb_in_est_sc_plot5)
q_nhb_in_est_sc_plot_data_aux6 <- ggplot_build(q_nhb_in_est_sc_plot6)
q_nhb_in_est_sc_plot_data_aux7 <- ggplot_build(q_nhb_in_est_sc_plot7)
q_nhb_in_est_sc_plot_data_aux8 <- ggplot_build(q_nhb_in_est_sc_plot8)
q_nhb_in_est_sc_plot_data_aux9 <- ggplot_build(q_nhb_in_est_sc_plot9)
q_nhb_in_est_sc_plot_data_aux10 <- ggplot_build(q_nhb_in_est_sc_plot10)
q_nhb_in_est_sc_plot_data_aux11 <- ggplot_build(q_nhb_in_est_sc_plot11)
q_nhb_in_est_sc_plot_data_aux12 <- ggplot_build(q_nhb_in_est_sc_plot12)
q_nhb_in_est_sc_plot_data_aux13 <- ggplot_build(q_nhb_in_est_sc_plot13)
q_nhb_in_est_sc_plot_data_aux14 <- ggplot_build(q_nhb_in_est_sc_plot14)
q_nhb_in_est_sc_plot_data_aux15 <- ggplot_build(q_nhb_in_est_sc_plot15)
q_nhb_in_est_sc_plot_data_aux16 <- ggplot_build(q_nhb_in_est_sc_plot16)
q_nhb_in_est_sc_plot_data_aux17 <- ggplot_build(q_nhb_in_est_sc_plot17)
q_nhb_in_est_sc_plot_data_aux18 <- ggplot_build(q_nhb_in_est_sc_plot18)
q_nhb_in_est_sc_plot_data_aux19 <- ggplot_build(q_nhb_in_est_sc_plot19)
q_nhb_in_est_sc_plot_data_aux20 <- ggplot_build(q_nhb_in_est_sc_plot20)
q_nhb_in_est_sc_plot_data_aux21 <- ggplot_build(q_nhb_in_est_sc_plot21)
q_nhb_in_est_sc_plot_data_aux22 <- ggplot_build(q_nhb_in_est_sc_plot22)
q_nhb_in_est_sc_plot_data_aux23 <- ggplot_build(q_nhb_in_est_sc_plot23)
q_nhb_in_est_sc_plot_data_aux24 <- ggplot_build(q_nhb_in_est_sc_plot24)
q_nhb_in_est_sc_plot_data_aux25 <- ggplot_build(q_nhb_in_est_sc_plot25)
q_nhb_in_est_sc_plot_data_aux26 <- ggplot_build(q_nhb_in_est_sc_plot26)
q_nhb_in_est_sc_plot_data_aux27 <- ggplot_build(q_nhb_in_est_sc_plot27)
q_nhb_in_est_sc_plot_data_aux28 <- ggplot_build(q_nhb_in_est_sc_plot28)
q_nhb_in_est_sc_plot_data_aux29 <- ggplot_build(q_nhb_in_est_sc_plot29)
q_nhb_in_est_sc_plot_data_aux30 <- ggplot_build(q_nhb_in_est_sc_plot30)
q_nhb_in_est_sc_plot_data_aux31 <- ggplot_build(q_nhb_in_est_sc_plot31)
q_nhb_in_est_sc_plot_data_aux32 <- ggplot_build(q_nhb_in_est_sc_plot32)
q_nhb_in_est_sc_plot_data_aux33 <- ggplot_build(q_nhb_in_est_sc_plot33)
q_nhb_in_est_sc_plot_data_aux34 <- ggplot_build(q_nhb_in_est_sc_plot34)
q_nhb_in_est_sc_plot_data_aux35 <- ggplot_build(q_nhb_in_est_sc_plot35)
q_nhb_in_est_sc_plot_data_aux_list <- list(q_nhb_in_est_sc_plot_data_aux1,q_nhb_in_est_sc_plot_data_aux2,q_nhb_in_est_sc_plot_data_aux3,
                                           q_nhb_in_est_sc_plot_data_aux4,q_nhb_in_est_sc_plot_data_aux5,q_nhb_in_est_sc_plot_data_aux6,
                                           q_nhb_in_est_sc_plot_data_aux7,q_nhb_in_est_sc_plot_data_aux8,q_nhb_in_est_sc_plot_data_aux9,
                                           q_nhb_in_est_sc_plot_data_aux10,q_nhb_in_est_sc_plot_data_aux11,q_nhb_in_est_sc_plot_data_aux12,
                                           q_nhb_in_est_sc_plot_data_aux13,q_nhb_in_est_sc_plot_data_aux14,q_nhb_in_est_sc_plot_data_aux15,
                                           q_nhb_in_est_sc_plot_data_aux16,q_nhb_in_est_sc_plot_data_aux17,q_nhb_in_est_sc_plot_data_aux18,
                                           q_nhb_in_est_sc_plot_data_aux19,q_nhb_in_est_sc_plot_data_aux20,q_nhb_in_est_sc_plot_data_aux21,
                                           q_nhb_in_est_sc_plot_data_aux22,q_nhb_in_est_sc_plot_data_aux23,q_nhb_in_est_sc_plot_data_aux24,
                                           q_nhb_in_est_sc_plot_data_aux25,q_nhb_in_est_sc_plot_data_aux26,q_nhb_in_est_sc_plot_data_aux27,
                                           q_nhb_in_est_sc_plot_data_aux28,q_nhb_in_est_sc_plot_data_aux29,q_nhb_in_est_sc_plot_data_aux30,
                                           q_nhb_in_est_sc_plot_data_aux31,q_nhb_in_est_sc_plot_data_aux32,q_nhb_in_est_sc_plot_data_aux33,
                                           q_nhb_in_est_sc_plot_data_aux34,q_nhb_in_est_sc_plot_data_aux35)
rm(q_nhb_in_est_sc_plot_data_aux1,q_nhb_in_est_sc_plot_data_aux2,q_nhb_in_est_sc_plot_data_aux3,
   q_nhb_in_est_sc_plot_data_aux4,q_nhb_in_est_sc_plot_data_aux5,q_nhb_in_est_sc_plot_data_aux6,
   q_nhb_in_est_sc_plot_data_aux7,q_nhb_in_est_sc_plot_data_aux8,q_nhb_in_est_sc_plot_data_aux9,
   q_nhb_in_est_sc_plot_data_aux10,q_nhb_in_est_sc_plot_data_aux11,q_nhb_in_est_sc_plot_data_aux12,
   q_nhb_in_est_sc_plot_data_aux13,q_nhb_in_est_sc_plot_data_aux14,q_nhb_in_est_sc_plot_data_aux15,
   q_nhb_in_est_sc_plot_data_aux16,q_nhb_in_est_sc_plot_data_aux17,q_nhb_in_est_sc_plot_data_aux18,
   q_nhb_in_est_sc_plot_data_aux19,q_nhb_in_est_sc_plot_data_aux20,q_nhb_in_est_sc_plot_data_aux21,
   q_nhb_in_est_sc_plot_data_aux22,q_nhb_in_est_sc_plot_data_aux23,q_nhb_in_est_sc_plot_data_aux24,
   q_nhb_in_est_sc_plot_data_aux25,q_nhb_in_est_sc_plot_data_aux26,q_nhb_in_est_sc_plot_data_aux27,
   q_nhb_in_est_sc_plot_data_aux28,q_nhb_in_est_sc_plot_data_aux29,q_nhb_in_est_sc_plot_data_aux30,
   q_nhb_in_est_sc_plot_data_aux31,q_nhb_in_est_sc_plot_data_aux32,q_nhb_in_est_sc_plot_data_aux33,
   q_nhb_in_est_sc_plot_data_aux34,q_nhb_in_est_sc_plot_data_aux35)
rm(q_nhb_in_est_sc_plot1,q_nhb_in_est_sc_plot2,q_nhb_in_est_sc_plot3,
   q_nhb_in_est_sc_plot4,q_nhb_in_est_sc_plot5,q_nhb_in_est_sc_plot6,
   q_nhb_in_est_sc_plot7,q_nhb_in_est_sc_plot8,q_nhb_in_est_sc_plot9,
   q_nhb_in_est_sc_plot10,q_nhb_in_est_sc_plot11,q_nhb_in_est_sc_plot12,
   q_nhb_in_est_sc_plot13,q_nhb_in_est_sc_plot14,q_nhb_in_est_sc_plot15,
   q_nhb_in_est_sc_plot16,q_nhb_in_est_sc_plot17,q_nhb_in_est_sc_plot18,
   q_nhb_in_est_sc_plot19,q_nhb_in_est_sc_plot20,q_nhb_in_est_sc_plot21,
   q_nhb_in_est_sc_plot22,q_nhb_in_est_sc_plot23,q_nhb_in_est_sc_plot24,
   q_nhb_in_est_sc_plot25,q_nhb_in_est_sc_plot26,q_nhb_in_est_sc_plot27,
   q_nhb_in_est_sc_plot28,q_nhb_in_est_sc_plot29,q_nhb_in_est_sc_plot30,
   q_nhb_in_est_sc_plot31,q_nhb_in_est_sc_plot32,q_nhb_in_est_sc_plot33,
   q_nhb_in_est_sc_plot34,q_nhb_in_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sc_plot_data_long", i), data.frame(q_nhb_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_in_est_sc_plot_data_long_list <- list(q_nhb_in_est_sc_plot_data_long1,q_nhb_in_est_sc_plot_data_long2,q_nhb_in_est_sc_plot_data_long3,
                                            q_nhb_in_est_sc_plot_data_long4,q_nhb_in_est_sc_plot_data_long5,q_nhb_in_est_sc_plot_data_long6,
                                            q_nhb_in_est_sc_plot_data_long7,q_nhb_in_est_sc_plot_data_long8,q_nhb_in_est_sc_plot_data_long9,
                                            q_nhb_in_est_sc_plot_data_long10,q_nhb_in_est_sc_plot_data_long11,q_nhb_in_est_sc_plot_data_long12,
                                            q_nhb_in_est_sc_plot_data_long13,q_nhb_in_est_sc_plot_data_long14,q_nhb_in_est_sc_plot_data_long15,
                                            q_nhb_in_est_sc_plot_data_long16,q_nhb_in_est_sc_plot_data_long17,q_nhb_in_est_sc_plot_data_long18,
                                            q_nhb_in_est_sc_plot_data_long19,q_nhb_in_est_sc_plot_data_long20,q_nhb_in_est_sc_plot_data_long21,
                                            q_nhb_in_est_sc_plot_data_long22,q_nhb_in_est_sc_plot_data_long23,q_nhb_in_est_sc_plot_data_long24,
                                            q_nhb_in_est_sc_plot_data_long25,q_nhb_in_est_sc_plot_data_long26,q_nhb_in_est_sc_plot_data_long27,
                                            q_nhb_in_est_sc_plot_data_long28,q_nhb_in_est_sc_plot_data_long29,q_nhb_in_est_sc_plot_data_long30,
                                            q_nhb_in_est_sc_plot_data_long31,q_nhb_in_est_sc_plot_data_long32,q_nhb_in_est_sc_plot_data_long33,
                                            q_nhb_in_est_sc_plot_data_long34,q_nhb_in_est_sc_plot_data_long35)
rm(q_nhb_in_est_sc_plot_data_long1,q_nhb_in_est_sc_plot_data_long2,q_nhb_in_est_sc_plot_data_long3,
   q_nhb_in_est_sc_plot_data_long4,q_nhb_in_est_sc_plot_data_long5,q_nhb_in_est_sc_plot_data_long6,
   q_nhb_in_est_sc_plot_data_long7,q_nhb_in_est_sc_plot_data_long8,q_nhb_in_est_sc_plot_data_long9,
   q_nhb_in_est_sc_plot_data_long10,q_nhb_in_est_sc_plot_data_long11,q_nhb_in_est_sc_plot_data_long12,
   q_nhb_in_est_sc_plot_data_long13,q_nhb_in_est_sc_plot_data_long14,q_nhb_in_est_sc_plot_data_long15,
   q_nhb_in_est_sc_plot_data_long16,q_nhb_in_est_sc_plot_data_long17,q_nhb_in_est_sc_plot_data_long18,
   q_nhb_in_est_sc_plot_data_long19,q_nhb_in_est_sc_plot_data_long20,q_nhb_in_est_sc_plot_data_long21,
   q_nhb_in_est_sc_plot_data_long22,q_nhb_in_est_sc_plot_data_long23,q_nhb_in_est_sc_plot_data_long24,
   q_nhb_in_est_sc_plot_data_long25,q_nhb_in_est_sc_plot_data_long26,q_nhb_in_est_sc_plot_data_long27,
   q_nhb_in_est_sc_plot_data_long28,q_nhb_in_est_sc_plot_data_long29,q_nhb_in_est_sc_plot_data_long30,
   q_nhb_in_est_sc_plot_data_long31,q_nhb_in_est_sc_plot_data_long32,q_nhb_in_est_sc_plot_data_long33,
   q_nhb_in_est_sc_plot_data_long34,q_nhb_in_est_sc_plot_data_long35)
q_nhb_in_est_sc_plot_data_long_list <- lapply(q_nhb_in_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sc_plot_data_wide", i), reshape(data=q_nhb_in_est_sc_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
q_nhb_in_est_sc_plot_data_wide_list <- list(q_nhb_in_est_sc_plot_data_wide1,q_nhb_in_est_sc_plot_data_wide2,q_nhb_in_est_sc_plot_data_wide3,
                                            q_nhb_in_est_sc_plot_data_wide4,q_nhb_in_est_sc_plot_data_wide5,q_nhb_in_est_sc_plot_data_wide6,
                                            q_nhb_in_est_sc_plot_data_wide7,q_nhb_in_est_sc_plot_data_wide8,q_nhb_in_est_sc_plot_data_wide9,
                                            q_nhb_in_est_sc_plot_data_wide10,q_nhb_in_est_sc_plot_data_wide11,q_nhb_in_est_sc_plot_data_wide12,
                                            q_nhb_in_est_sc_plot_data_wide13,q_nhb_in_est_sc_plot_data_wide14,q_nhb_in_est_sc_plot_data_wide15,
                                            q_nhb_in_est_sc_plot_data_wide16,q_nhb_in_est_sc_plot_data_wide17,q_nhb_in_est_sc_plot_data_wide18,
                                            q_nhb_in_est_sc_plot_data_wide19,q_nhb_in_est_sc_plot_data_wide20,q_nhb_in_est_sc_plot_data_wide21,
                                            q_nhb_in_est_sc_plot_data_wide22,q_nhb_in_est_sc_plot_data_wide23,q_nhb_in_est_sc_plot_data_wide24,
                                            q_nhb_in_est_sc_plot_data_wide25,q_nhb_in_est_sc_plot_data_wide26,q_nhb_in_est_sc_plot_data_wide27,
                                            q_nhb_in_est_sc_plot_data_wide28,q_nhb_in_est_sc_plot_data_wide29,q_nhb_in_est_sc_plot_data_wide30,
                                            q_nhb_in_est_sc_plot_data_wide31,q_nhb_in_est_sc_plot_data_wide32,q_nhb_in_est_sc_plot_data_wide33,
                                            q_nhb_in_est_sc_plot_data_wide34,q_nhb_in_est_sc_plot_data_wide35)
rm(q_nhb_in_est_sc_plot_data_wide1,q_nhb_in_est_sc_plot_data_wide2,q_nhb_in_est_sc_plot_data_wide3,
   q_nhb_in_est_sc_plot_data_wide4,q_nhb_in_est_sc_plot_data_wide5,q_nhb_in_est_sc_plot_data_wide6,
   q_nhb_in_est_sc_plot_data_wide7,q_nhb_in_est_sc_plot_data_wide8,q_nhb_in_est_sc_plot_data_wide9,
   q_nhb_in_est_sc_plot_data_wide10,q_nhb_in_est_sc_plot_data_wide11,q_nhb_in_est_sc_plot_data_wide12,
   q_nhb_in_est_sc_plot_data_wide13,q_nhb_in_est_sc_plot_data_wide14,q_nhb_in_est_sc_plot_data_wide15,
   q_nhb_in_est_sc_plot_data_wide16,q_nhb_in_est_sc_plot_data_wide17,q_nhb_in_est_sc_plot_data_wide18,
   q_nhb_in_est_sc_plot_data_wide19,q_nhb_in_est_sc_plot_data_wide20,q_nhb_in_est_sc_plot_data_wide21,
   q_nhb_in_est_sc_plot_data_wide22,q_nhb_in_est_sc_plot_data_wide23,q_nhb_in_est_sc_plot_data_wide24,
   q_nhb_in_est_sc_plot_data_wide25,q_nhb_in_est_sc_plot_data_wide26,q_nhb_in_est_sc_plot_data_wide27,
   q_nhb_in_est_sc_plot_data_wide28,q_nhb_in_est_sc_plot_data_wide29,q_nhb_in_est_sc_plot_data_wide30,
   q_nhb_in_est_sc_plot_data_wide31,q_nhb_in_est_sc_plot_data_wide32,q_nhb_in_est_sc_plot_data_wide33,
   q_nhb_in_est_sc_plot_data_wide34,q_nhb_in_est_sc_plot_data_wide35)
q_nhb_in_est_sc_plot_data_wide_list <- lapply(q_nhb_in_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nhb_in_est_sdid1 <- synthdid_estimate(setup_q_nhb_in_list[[1]]$Y, setup_q_nhb_in_list[[1]]$N0, setup_q_nhb_in_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_in_est_sdid2 <- synthdid_estimate(setup_q_nhb_in_list[[2]]$Y, setup_q_nhb_in_list[[2]]$N0, setup_q_nhb_in_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_in_est_sdid5 <- synthdid_estimate(setup_q_nhb_in_list[[3]]$Y, setup_q_nhb_in_list[[3]]$N0, setup_q_nhb_in_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_in_est_sdid10 <- synthdid_estimate(setup_q_nhb_in_list[[4]]$Y, setup_q_nhb_in_list[[4]]$N0, setup_q_nhb_in_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_in_est_sdid11 <- synthdid_estimate(setup_q_nhb_in_list[[5]]$Y, setup_q_nhb_in_list[[5]]$N0, setup_q_nhb_in_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_in_est_sdid12 <- synthdid_estimate(setup_q_nhb_in_list[[6]]$Y, setup_q_nhb_in_list[[6]]$N0, setup_q_nhb_in_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_in_est_sdid13 <- synthdid_estimate(setup_q_nhb_in_list[[7]]$Y, setup_q_nhb_in_list[[7]]$N0, setup_q_nhb_in_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_in_est_sdid15 <- synthdid_estimate(setup_q_nhb_in_list[[8]]$Y, setup_q_nhb_in_list[[8]]$N0, setup_q_nhb_in_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_in_est_sdid17 <- synthdid_estimate(setup_q_nhb_in_list[[9]]$Y, setup_q_nhb_in_list[[9]]$N0, setup_q_nhb_in_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_in_est_sdid19 <- synthdid_estimate(setup_q_nhb_in_list[[10]]$Y, setup_q_nhb_in_list[[10]]$N0, setup_q_nhb_in_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_in_est_sdid21 <- synthdid_estimate(setup_q_nhb_in_list[[11]]$Y, setup_q_nhb_in_list[[11]]$N0, setup_q_nhb_in_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_in_est_sdid23 <- synthdid_estimate(setup_q_nhb_in_list[[12]]$Y, setup_q_nhb_in_list[[12]]$N0, setup_q_nhb_in_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_in_est_sdid24 <- synthdid_estimate(setup_q_nhb_in_list[[13]]$Y, setup_q_nhb_in_list[[13]]$N0, setup_q_nhb_in_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_in_est_sdid25 <- synthdid_estimate(setup_q_nhb_in_list[[14]]$Y, setup_q_nhb_in_list[[14]]$N0, setup_q_nhb_in_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_in_est_sdid26 <- synthdid_estimate(setup_q_nhb_in_list[[15]]$Y, setup_q_nhb_in_list[[15]]$N0, setup_q_nhb_in_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_in_est_sdid28 <- synthdid_estimate(setup_q_nhb_in_list[[16]]$Y, setup_q_nhb_in_list[[16]]$N0, setup_q_nhb_in_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_in_est_sdid29 <- synthdid_estimate(setup_q_nhb_in_list[[17]]$Y, setup_q_nhb_in_list[[17]]$N0, setup_q_nhb_in_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_in_est_sdid30 <- synthdid_estimate(setup_q_nhb_in_list[[18]]$Y, setup_q_nhb_in_list[[18]]$N0, setup_q_nhb_in_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_in_est_sdid31 <- synthdid_estimate(setup_q_nhb_in_list[[19]]$Y, setup_q_nhb_in_list[[19]]$N0, setup_q_nhb_in_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_in_est_sdid32 <- synthdid_estimate(setup_q_nhb_in_list[[20]]$Y, setup_q_nhb_in_list[[20]]$N0, setup_q_nhb_in_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_in_est_sdid33 <- synthdid_estimate(setup_q_nhb_in_list[[21]]$Y, setup_q_nhb_in_list[[21]]$N0, setup_q_nhb_in_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_in_est_sdid34 <- synthdid_estimate(setup_q_nhb_in_list[[22]]$Y, setup_q_nhb_in_list[[22]]$N0, setup_q_nhb_in_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_in_est_sdid36 <- synthdid_estimate(setup_q_nhb_in_list[[23]]$Y, setup_q_nhb_in_list[[23]]$N0, setup_q_nhb_in_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_in_est_sdid37 <- synthdid_estimate(setup_q_nhb_in_list[[24]]$Y, setup_q_nhb_in_list[[24]]$N0, setup_q_nhb_in_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_in_est_sdid39 <- synthdid_estimate(setup_q_nhb_in_list[[25]]$Y, setup_q_nhb_in_list[[25]]$N0, setup_q_nhb_in_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_in_est_sdid40 <- synthdid_estimate(setup_q_nhb_in_list[[26]]$Y, setup_q_nhb_in_list[[26]]$N0, setup_q_nhb_in_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_in_est_sdid41 <- synthdid_estimate(setup_q_nhb_in_list[[27]]$Y, setup_q_nhb_in_list[[27]]$N0, setup_q_nhb_in_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_in_est_sdid44 <- synthdid_estimate(setup_q_nhb_in_list[[28]]$Y, setup_q_nhb_in_list[[28]]$N0, setup_q_nhb_in_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_in_est_sdid45 <- synthdid_estimate(setup_q_nhb_in_list[[29]]$Y, setup_q_nhb_in_list[[29]]$N0, setup_q_nhb_in_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_in_est_sdid47 <- synthdid_estimate(setup_q_nhb_in_list[[30]]$Y, setup_q_nhb_in_list[[30]]$N0, setup_q_nhb_in_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_in_est_sdid50 <- synthdid_estimate(setup_q_nhb_in_list[[31]]$Y, setup_q_nhb_in_list[[31]]$N0, setup_q_nhb_in_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_in_est_sdid51 <- synthdid_estimate(setup_q_nhb_in_list[[32]]$Y, setup_q_nhb_in_list[[32]]$N0, setup_q_nhb_in_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_in_est_sdid53 <- synthdid_estimate(setup_q_nhb_in_list[[33]]$Y, setup_q_nhb_in_list[[33]]$N0, setup_q_nhb_in_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_in_est_sdid54 <- synthdid_estimate(setup_q_nhb_in_list[[34]]$Y, setup_q_nhb_in_list[[34]]$N0, setup_q_nhb_in_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_in_est_sdid55 <- synthdid_estimate(setup_q_nhb_in_list[[35]]$Y, setup_q_nhb_in_list[[35]]$N0, setup_q_nhb_in_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_in_est_sdid_list <- list(q_nhb_in_est_sdid1,q_nhb_in_est_sdid2,q_nhb_in_est_sdid5,
                               q_nhb_in_est_sdid10,q_nhb_in_est_sdid11,q_nhb_in_est_sdid12,
                               q_nhb_in_est_sdid13,q_nhb_in_est_sdid15,q_nhb_in_est_sdid17,
                               q_nhb_in_est_sdid19,q_nhb_in_est_sdid21,q_nhb_in_est_sdid23,
                               q_nhb_in_est_sdid24,q_nhb_in_est_sdid25,q_nhb_in_est_sdid26,
                               q_nhb_in_est_sdid28,q_nhb_in_est_sdid29,q_nhb_in_est_sdid30,
                               q_nhb_in_est_sdid31,q_nhb_in_est_sdid32,q_nhb_in_est_sdid33,
                               q_nhb_in_est_sdid34,q_nhb_in_est_sdid36,q_nhb_in_est_sdid37,
                               q_nhb_in_est_sdid39,q_nhb_in_est_sdid40,q_nhb_in_est_sdid41,
                               q_nhb_in_est_sdid44,q_nhb_in_est_sdid45,q_nhb_in_est_sdid47,
                               q_nhb_in_est_sdid50,q_nhb_in_est_sdid51,q_nhb_in_est_sdid53,
                               q_nhb_in_est_sdid54,q_nhb_in_est_sdid55)
rm(q_nhb_in_est_sdid1,q_nhb_in_est_sdid2,q_nhb_in_est_sdid5,
   q_nhb_in_est_sdid10,q_nhb_in_est_sdid11,q_nhb_in_est_sdid12,
   q_nhb_in_est_sdid13,q_nhb_in_est_sdid15,q_nhb_in_est_sdid17,
   q_nhb_in_est_sdid19,q_nhb_in_est_sdid21,q_nhb_in_est_sdid23,
   q_nhb_in_est_sdid24,q_nhb_in_est_sdid25,q_nhb_in_est_sdid26,
   q_nhb_in_est_sdid28,q_nhb_in_est_sdid29,q_nhb_in_est_sdid30,
   q_nhb_in_est_sdid31,q_nhb_in_est_sdid32,q_nhb_in_est_sdid33,
   q_nhb_in_est_sdid34,q_nhb_in_est_sdid36,q_nhb_in_est_sdid37,
   q_nhb_in_est_sdid39,q_nhb_in_est_sdid40,q_nhb_in_est_sdid41,
   q_nhb_in_est_sdid44,q_nhb_in_est_sdid45,q_nhb_in_est_sdid47,
   q_nhb_in_est_sdid50,q_nhb_in_est_sdid51,q_nhb_in_est_sdid53,
   q_nhb_in_est_sdid54,q_nhb_in_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sdid_plot", i), synthdid_plot(q_nhb_in_est_sdid_list[i]))
}
q_nhb_in_est_sdid_plot_data_aux1 <- ggplot_build(q_nhb_in_est_sdid_plot1)
q_nhb_in_est_sdid_plot_data_aux2 <- ggplot_build(q_nhb_in_est_sdid_plot2)
q_nhb_in_est_sdid_plot_data_aux3 <- ggplot_build(q_nhb_in_est_sdid_plot3)
q_nhb_in_est_sdid_plot_data_aux4 <- ggplot_build(q_nhb_in_est_sdid_plot4)
q_nhb_in_est_sdid_plot_data_aux5 <- ggplot_build(q_nhb_in_est_sdid_plot5)
q_nhb_in_est_sdid_plot_data_aux6 <- ggplot_build(q_nhb_in_est_sdid_plot6)
q_nhb_in_est_sdid_plot_data_aux7 <- ggplot_build(q_nhb_in_est_sdid_plot7)
q_nhb_in_est_sdid_plot_data_aux8 <- ggplot_build(q_nhb_in_est_sdid_plot8)
q_nhb_in_est_sdid_plot_data_aux9 <- ggplot_build(q_nhb_in_est_sdid_plot9)
q_nhb_in_est_sdid_plot_data_aux10 <- ggplot_build(q_nhb_in_est_sdid_plot10)
q_nhb_in_est_sdid_plot_data_aux11 <- ggplot_build(q_nhb_in_est_sdid_plot11)
q_nhb_in_est_sdid_plot_data_aux12 <- ggplot_build(q_nhb_in_est_sdid_plot12)
q_nhb_in_est_sdid_plot_data_aux13 <- ggplot_build(q_nhb_in_est_sdid_plot13)
q_nhb_in_est_sdid_plot_data_aux14 <- ggplot_build(q_nhb_in_est_sdid_plot14)
q_nhb_in_est_sdid_plot_data_aux15 <- ggplot_build(q_nhb_in_est_sdid_plot15)
q_nhb_in_est_sdid_plot_data_aux16 <- ggplot_build(q_nhb_in_est_sdid_plot16)
q_nhb_in_est_sdid_plot_data_aux17 <- ggplot_build(q_nhb_in_est_sdid_plot17)
q_nhb_in_est_sdid_plot_data_aux18 <- ggplot_build(q_nhb_in_est_sdid_plot18)
q_nhb_in_est_sdid_plot_data_aux19 <- ggplot_build(q_nhb_in_est_sdid_plot19)
q_nhb_in_est_sdid_plot_data_aux20 <- ggplot_build(q_nhb_in_est_sdid_plot20)
q_nhb_in_est_sdid_plot_data_aux21 <- ggplot_build(q_nhb_in_est_sdid_plot21)
q_nhb_in_est_sdid_plot_data_aux22 <- ggplot_build(q_nhb_in_est_sdid_plot22)
q_nhb_in_est_sdid_plot_data_aux23 <- ggplot_build(q_nhb_in_est_sdid_plot23)
q_nhb_in_est_sdid_plot_data_aux24 <- ggplot_build(q_nhb_in_est_sdid_plot24)
q_nhb_in_est_sdid_plot_data_aux25 <- ggplot_build(q_nhb_in_est_sdid_plot25)
q_nhb_in_est_sdid_plot_data_aux26 <- ggplot_build(q_nhb_in_est_sdid_plot26)
q_nhb_in_est_sdid_plot_data_aux27 <- ggplot_build(q_nhb_in_est_sdid_plot27)
q_nhb_in_est_sdid_plot_data_aux28 <- ggplot_build(q_nhb_in_est_sdid_plot28)
q_nhb_in_est_sdid_plot_data_aux29 <- ggplot_build(q_nhb_in_est_sdid_plot29)
q_nhb_in_est_sdid_plot_data_aux30 <- ggplot_build(q_nhb_in_est_sdid_plot30)
q_nhb_in_est_sdid_plot_data_aux31 <- ggplot_build(q_nhb_in_est_sdid_plot31)
q_nhb_in_est_sdid_plot_data_aux32 <- ggplot_build(q_nhb_in_est_sdid_plot32)
q_nhb_in_est_sdid_plot_data_aux33 <- ggplot_build(q_nhb_in_est_sdid_plot33)
q_nhb_in_est_sdid_plot_data_aux34 <- ggplot_build(q_nhb_in_est_sdid_plot34)
q_nhb_in_est_sdid_plot_data_aux35 <- ggplot_build(q_nhb_in_est_sdid_plot35)
q_nhb_in_est_sdid_plot_data_aux_list <- list(q_nhb_in_est_sdid_plot_data_aux1,q_nhb_in_est_sdid_plot_data_aux2,q_nhb_in_est_sdid_plot_data_aux3,
                                             q_nhb_in_est_sdid_plot_data_aux4,q_nhb_in_est_sdid_plot_data_aux5,q_nhb_in_est_sdid_plot_data_aux6,
                                             q_nhb_in_est_sdid_plot_data_aux7,q_nhb_in_est_sdid_plot_data_aux8,q_nhb_in_est_sdid_plot_data_aux9,
                                             q_nhb_in_est_sdid_plot_data_aux10,q_nhb_in_est_sdid_plot_data_aux11,q_nhb_in_est_sdid_plot_data_aux12,
                                             q_nhb_in_est_sdid_plot_data_aux13,q_nhb_in_est_sdid_plot_data_aux14,q_nhb_in_est_sdid_plot_data_aux15,
                                             q_nhb_in_est_sdid_plot_data_aux16,q_nhb_in_est_sdid_plot_data_aux17,q_nhb_in_est_sdid_plot_data_aux18,
                                             q_nhb_in_est_sdid_plot_data_aux19,q_nhb_in_est_sdid_plot_data_aux20,q_nhb_in_est_sdid_plot_data_aux21,
                                             q_nhb_in_est_sdid_plot_data_aux22,q_nhb_in_est_sdid_plot_data_aux23,q_nhb_in_est_sdid_plot_data_aux24,
                                             q_nhb_in_est_sdid_plot_data_aux25,q_nhb_in_est_sdid_plot_data_aux26,q_nhb_in_est_sdid_plot_data_aux27,
                                             q_nhb_in_est_sdid_plot_data_aux28,q_nhb_in_est_sdid_plot_data_aux29,q_nhb_in_est_sdid_plot_data_aux30,
                                             q_nhb_in_est_sdid_plot_data_aux31,q_nhb_in_est_sdid_plot_data_aux32,q_nhb_in_est_sdid_plot_data_aux33,
                                             q_nhb_in_est_sdid_plot_data_aux34,q_nhb_in_est_sdid_plot_data_aux35)
rm(q_nhb_in_est_sdid_plot_data_aux1,q_nhb_in_est_sdid_plot_data_aux2,q_nhb_in_est_sdid_plot_data_aux3,
   q_nhb_in_est_sdid_plot_data_aux4,q_nhb_in_est_sdid_plot_data_aux5,q_nhb_in_est_sdid_plot_data_aux6,
   q_nhb_in_est_sdid_plot_data_aux7,q_nhb_in_est_sdid_plot_data_aux8,q_nhb_in_est_sdid_plot_data_aux9,
   q_nhb_in_est_sdid_plot_data_aux10,q_nhb_in_est_sdid_plot_data_aux11,q_nhb_in_est_sdid_plot_data_aux12,
   q_nhb_in_est_sdid_plot_data_aux13,q_nhb_in_est_sdid_plot_data_aux14,q_nhb_in_est_sdid_plot_data_aux15,
   q_nhb_in_est_sdid_plot_data_aux16,q_nhb_in_est_sdid_plot_data_aux17,q_nhb_in_est_sdid_plot_data_aux18,
   q_nhb_in_est_sdid_plot_data_aux19,q_nhb_in_est_sdid_plot_data_aux20,q_nhb_in_est_sdid_plot_data_aux21,
   q_nhb_in_est_sdid_plot_data_aux22,q_nhb_in_est_sdid_plot_data_aux23,q_nhb_in_est_sdid_plot_data_aux24,
   q_nhb_in_est_sdid_plot_data_aux25,q_nhb_in_est_sdid_plot_data_aux26,q_nhb_in_est_sdid_plot_data_aux27,
   q_nhb_in_est_sdid_plot_data_aux28,q_nhb_in_est_sdid_plot_data_aux29,q_nhb_in_est_sdid_plot_data_aux30,
   q_nhb_in_est_sdid_plot_data_aux31,q_nhb_in_est_sdid_plot_data_aux32,q_nhb_in_est_sdid_plot_data_aux33,
   q_nhb_in_est_sdid_plot_data_aux34,q_nhb_in_est_sdid_plot_data_aux35)
rm(q_nhb_in_est_sdid_plot1,q_nhb_in_est_sdid_plot2,q_nhb_in_est_sdid_plot3,
   q_nhb_in_est_sdid_plot4,q_nhb_in_est_sdid_plot5,q_nhb_in_est_sdid_plot6,
   q_nhb_in_est_sdid_plot7,q_nhb_in_est_sdid_plot8,q_nhb_in_est_sdid_plot9,
   q_nhb_in_est_sdid_plot10,q_nhb_in_est_sdid_plot11,q_nhb_in_est_sdid_plot12,
   q_nhb_in_est_sdid_plot13,q_nhb_in_est_sdid_plot14,q_nhb_in_est_sdid_plot15,
   q_nhb_in_est_sdid_plot16,q_nhb_in_est_sdid_plot17,q_nhb_in_est_sdid_plot18,
   q_nhb_in_est_sdid_plot19,q_nhb_in_est_sdid_plot20,q_nhb_in_est_sdid_plot21,
   q_nhb_in_est_sdid_plot22,q_nhb_in_est_sdid_plot23,q_nhb_in_est_sdid_plot24,
   q_nhb_in_est_sdid_plot25,q_nhb_in_est_sdid_plot26,q_nhb_in_est_sdid_plot27,
   q_nhb_in_est_sdid_plot28,q_nhb_in_est_sdid_plot29,q_nhb_in_est_sdid_plot30,
   q_nhb_in_est_sdid_plot31,q_nhb_in_est_sdid_plot32,q_nhb_in_est_sdid_plot33,
   q_nhb_in_est_sdid_plot34,q_nhb_in_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sdid_plot_data_long", i), data.frame(q_nhb_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_in_est_sdid_plot_data_long_list <- list(q_nhb_in_est_sdid_plot_data_long1,q_nhb_in_est_sdid_plot_data_long2,q_nhb_in_est_sdid_plot_data_long3,
                                              q_nhb_in_est_sdid_plot_data_long4,q_nhb_in_est_sdid_plot_data_long5,q_nhb_in_est_sdid_plot_data_long6,
                                              q_nhb_in_est_sdid_plot_data_long7,q_nhb_in_est_sdid_plot_data_long8,q_nhb_in_est_sdid_plot_data_long9,
                                              q_nhb_in_est_sdid_plot_data_long10,q_nhb_in_est_sdid_plot_data_long11,q_nhb_in_est_sdid_plot_data_long12,
                                              q_nhb_in_est_sdid_plot_data_long13,q_nhb_in_est_sdid_plot_data_long14,q_nhb_in_est_sdid_plot_data_long15,
                                              q_nhb_in_est_sdid_plot_data_long16,q_nhb_in_est_sdid_plot_data_long17,q_nhb_in_est_sdid_plot_data_long18,
                                              q_nhb_in_est_sdid_plot_data_long19,q_nhb_in_est_sdid_plot_data_long20,q_nhb_in_est_sdid_plot_data_long21,
                                              q_nhb_in_est_sdid_plot_data_long22,q_nhb_in_est_sdid_plot_data_long23,q_nhb_in_est_sdid_plot_data_long24,
                                              q_nhb_in_est_sdid_plot_data_long25,q_nhb_in_est_sdid_plot_data_long26,q_nhb_in_est_sdid_plot_data_long27,
                                              q_nhb_in_est_sdid_plot_data_long28,q_nhb_in_est_sdid_plot_data_long29,q_nhb_in_est_sdid_plot_data_long30,
                                              q_nhb_in_est_sdid_plot_data_long31,q_nhb_in_est_sdid_plot_data_long32,q_nhb_in_est_sdid_plot_data_long33,
                                              q_nhb_in_est_sdid_plot_data_long34,q_nhb_in_est_sdid_plot_data_long35)
rm(q_nhb_in_est_sdid_plot_data_long1,q_nhb_in_est_sdid_plot_data_long2,q_nhb_in_est_sdid_plot_data_long3,
   q_nhb_in_est_sdid_plot_data_long4,q_nhb_in_est_sdid_plot_data_long5,q_nhb_in_est_sdid_plot_data_long6,
   q_nhb_in_est_sdid_plot_data_long7,q_nhb_in_est_sdid_plot_data_long8,q_nhb_in_est_sdid_plot_data_long9,
   q_nhb_in_est_sdid_plot_data_long10,q_nhb_in_est_sdid_plot_data_long11,q_nhb_in_est_sdid_plot_data_long12,
   q_nhb_in_est_sdid_plot_data_long13,q_nhb_in_est_sdid_plot_data_long14,q_nhb_in_est_sdid_plot_data_long15,
   q_nhb_in_est_sdid_plot_data_long16,q_nhb_in_est_sdid_plot_data_long17,q_nhb_in_est_sdid_plot_data_long18,
   q_nhb_in_est_sdid_plot_data_long19,q_nhb_in_est_sdid_plot_data_long20,q_nhb_in_est_sdid_plot_data_long21,
   q_nhb_in_est_sdid_plot_data_long22,q_nhb_in_est_sdid_plot_data_long23,q_nhb_in_est_sdid_plot_data_long24,
   q_nhb_in_est_sdid_plot_data_long25,q_nhb_in_est_sdid_plot_data_long26,q_nhb_in_est_sdid_plot_data_long27,
   q_nhb_in_est_sdid_plot_data_long28,q_nhb_in_est_sdid_plot_data_long29,q_nhb_in_est_sdid_plot_data_long30,
   q_nhb_in_est_sdid_plot_data_long31,q_nhb_in_est_sdid_plot_data_long32,q_nhb_in_est_sdid_plot_data_long33,
   q_nhb_in_est_sdid_plot_data_long34,q_nhb_in_est_sdid_plot_data_long35)
q_nhb_in_est_sdid_plot_data_long_list <- lapply(q_nhb_in_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_in_est_sdid_plot_data_wide", i), reshape(data=q_nhb_in_est_sdid_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
q_nhb_in_est_sdid_plot_data_wide_list <- list(q_nhb_in_est_sdid_plot_data_wide1,q_nhb_in_est_sdid_plot_data_wide2,q_nhb_in_est_sdid_plot_data_wide3,
                                              q_nhb_in_est_sdid_plot_data_wide4,q_nhb_in_est_sdid_plot_data_wide5,q_nhb_in_est_sdid_plot_data_wide6,
                                              q_nhb_in_est_sdid_plot_data_wide7,q_nhb_in_est_sdid_plot_data_wide8,q_nhb_in_est_sdid_plot_data_wide9,
                                              q_nhb_in_est_sdid_plot_data_wide10,q_nhb_in_est_sdid_plot_data_wide11,q_nhb_in_est_sdid_plot_data_wide12,
                                              q_nhb_in_est_sdid_plot_data_wide13,q_nhb_in_est_sdid_plot_data_wide14,q_nhb_in_est_sdid_plot_data_wide15,
                                              q_nhb_in_est_sdid_plot_data_wide16,q_nhb_in_est_sdid_plot_data_wide17,q_nhb_in_est_sdid_plot_data_wide18,
                                              q_nhb_in_est_sdid_plot_data_wide19,q_nhb_in_est_sdid_plot_data_wide20,q_nhb_in_est_sdid_plot_data_wide21,
                                              q_nhb_in_est_sdid_plot_data_wide22,q_nhb_in_est_sdid_plot_data_wide23,q_nhb_in_est_sdid_plot_data_wide24,
                                              q_nhb_in_est_sdid_plot_data_wide25,q_nhb_in_est_sdid_plot_data_wide26,q_nhb_in_est_sdid_plot_data_wide27,
                                              q_nhb_in_est_sdid_plot_data_wide28,q_nhb_in_est_sdid_plot_data_wide29,q_nhb_in_est_sdid_plot_data_wide30,
                                              q_nhb_in_est_sdid_plot_data_wide31,q_nhb_in_est_sdid_plot_data_wide32,q_nhb_in_est_sdid_plot_data_wide33,
                                              q_nhb_in_est_sdid_plot_data_wide34,q_nhb_in_est_sdid_plot_data_wide35)
rm(q_nhb_in_est_sdid_plot_data_wide1,q_nhb_in_est_sdid_plot_data_wide2,q_nhb_in_est_sdid_plot_data_wide3,
   q_nhb_in_est_sdid_plot_data_wide4,q_nhb_in_est_sdid_plot_data_wide5,q_nhb_in_est_sdid_plot_data_wide6,
   q_nhb_in_est_sdid_plot_data_wide7,q_nhb_in_est_sdid_plot_data_wide8,q_nhb_in_est_sdid_plot_data_wide9,
   q_nhb_in_est_sdid_plot_data_wide10,q_nhb_in_est_sdid_plot_data_wide11,q_nhb_in_est_sdid_plot_data_wide12,
   q_nhb_in_est_sdid_plot_data_wide13,q_nhb_in_est_sdid_plot_data_wide14,q_nhb_in_est_sdid_plot_data_wide15,
   q_nhb_in_est_sdid_plot_data_wide16,q_nhb_in_est_sdid_plot_data_wide17,q_nhb_in_est_sdid_plot_data_wide18,
   q_nhb_in_est_sdid_plot_data_wide19,q_nhb_in_est_sdid_plot_data_wide20,q_nhb_in_est_sdid_plot_data_wide21,
   q_nhb_in_est_sdid_plot_data_wide22,q_nhb_in_est_sdid_plot_data_wide23,q_nhb_in_est_sdid_plot_data_wide24,
   q_nhb_in_est_sdid_plot_data_wide25,q_nhb_in_est_sdid_plot_data_wide26,q_nhb_in_est_sdid_plot_data_wide27,
   q_nhb_in_est_sdid_plot_data_wide28,q_nhb_in_est_sdid_plot_data_wide29,q_nhb_in_est_sdid_plot_data_wide30,
   q_nhb_in_est_sdid_plot_data_wide31,q_nhb_in_est_sdid_plot_data_wide32,q_nhb_in_est_sdid_plot_data_wide33,
   q_nhb_in_est_sdid_plot_data_wide34,q_nhb_in_est_sdid_plot_data_wide35)
q_nhb_in_est_sdid_plot_data_wide_list <- lapply(q_nhb_in_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nhb_est_did_plot_data_wide_in$did_facet_title <- "Diff-in-Diff"
q_nhb_est_sc_plot_data_wide_in$sc_facet_title <- "Synthetic Control"
q_nhb_est_sdid_plot_data_wide_in$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nhb_est_did_plot_data_wide_in$diff_relative <- q_nhb_est_did_plot_data_wide_in$diff - q_nhb_est_did_plot_data_wide_in$diff[8]
for(i in 1:35) {
  q_nhb_in_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nhb_in_est_did_plot_data_wide_list[[i]]$diff - q_nhb_in_est_did_plot_data_wide_list[[i]]$diff[8]
}
q_nhb_in_spag_did_plot <- ggplot(q_nhb_est_did_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Home Beds \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_in_spag_sc_plot <- ggplot(q_nhb_est_sc_plot_data_wide_in, aes(year,diff)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nhb_in_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Indiana"),data = q_nhb_est_sc_plot_data_wide_in, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Indiana" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_est_sdid_plot_data_wide_in$diff_relative <- q_nhb_est_sdid_plot_data_wide_in$diff - q_nhb_est_sdid_plot_data_wide_in$diff[8]
for(i in 1:35) {
  q_nhb_in_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nhb_in_est_sdid_plot_data_wide_list[[i]]$diff - q_nhb_in_est_sdid_plot_data_wide_list[[i]]$diff[8]
}
q_nhb_in_spag_sdid_plot <- ggplot(q_nhb_est_sdid_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_in_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nhb_in_est_did_vec <- c(q_nhb_est_did_in)
for (i in 1:35) {
  q_nhb_in_est_did_vec_aux <- q_nhb_in_est_did_list[[i]][1]
  q_nhb_in_est_did_vec <- c(q_nhb_in_est_did_vec,q_nhb_in_est_did_vec_aux)
}
q_nhb_in_est_did_df <- data.frame(q_nhb_in_est_did_vec)
q_nhb_in_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_in_est_did_vec)) +
  geom_histogram(data = q_nhb_in_est_did_df, aes(x = q_nhb_in_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_in_hist_did_plot1_ylim <- ggplot_build(q_nhb_in_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_in_hist_did_plot <- q_nhb_in_hist_did_plot_aux +
  expand_limits(y=q_nhb_in_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_in_est_did_vec[1], mean(q_nhb_in_est_did_vec[2:36])), xend = c(q_nhb_in_est_did_vec[1],mean(q_nhb_in_est_did_vec[2:36])), y = c(0,0), yend = c(q_nhb_in_hist_did_plot1_ylim,q_nhb_in_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_in_est_did_vec[1], mean(q_nhb_in_est_did_vec[2:36])), y = c(q_nhb_in_hist_did_plot1_ylim,q_nhb_in_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_in_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_in_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_in_est_sc_vec <- c(q_nhb_est_sc_in)
for (i in 1:35) {
  q_nhb_in_est_sc_vec_aux <- q_nhb_in_est_sc_list[[i]][1]
  q_nhb_in_est_sc_vec <- c(q_nhb_in_est_sc_vec,q_nhb_in_est_sc_vec_aux)
}
q_nhb_in_est_sc_df <- data.frame(q_nhb_in_est_sc_vec)
q_nhb_in_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_in_est_sc_vec)) +
  geom_histogram(data = q_nhb_in_est_sc_df, aes(x = q_nhb_in_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_in_hist_sc_plot1_ylim <- ggplot_build(q_nhb_in_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_in_hist_sc_plot <- q_nhb_in_hist_sc_plot_aux +
  expand_limits(y=q_nhb_in_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_in_est_sc_vec[1], mean(q_nhb_in_est_sc_vec[2:36])), xend = c(q_nhb_in_est_sc_vec[1],mean(q_nhb_in_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nhb_in_hist_sc_plot1_ylim,q_nhb_in_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_in_est_sc_vec[1], mean(q_nhb_in_est_sc_vec[2:36])), y = c(q_nhb_in_hist_sc_plot1_ylim,q_nhb_in_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_in_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(q_nhb_in_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0,1), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_in_est_sdid_vec <- c(q_nhb_est_sdid_in)
for (i in 1:35) {
  q_nhb_in_est_sdid_vec_aux <- q_nhb_in_est_sdid_list[[i]][1]
  q_nhb_in_est_sdid_vec <- c(q_nhb_in_est_sdid_vec,q_nhb_in_est_sdid_vec_aux)
}
q_nhb_in_est_sdid_df <- data.frame(q_nhb_in_est_sdid_vec)
q_nhb_in_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_in_est_sdid_vec)) +
  geom_histogram(data = q_nhb_in_est_sdid_df, aes(x = q_nhb_in_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_in_hist_sdid_plot1_ylim <- ggplot_build(q_nhb_in_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_in_hist_sdid_plot <- q_nhb_in_hist_sdid_plot_aux +
  expand_limits(y=q_nhb_in_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_in_est_sdid_vec[1], mean(q_nhb_in_est_sdid_vec[2:36])), xend = c(q_nhb_in_est_sdid_vec[1],mean(q_nhb_in_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nhb_in_hist_sdid_plot1_ylim,q_nhb_in_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_in_est_sdid_vec[1], mean(q_nhb_in_est_sdid_vec[2:36])), y = c(q_nhb_in_hist_sdid_plot1_ylim,q_nhb_in_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_in_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_in_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nhb_spag_dist_plots_IN.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nhb_in_spag_dist_plots_in <- q_nhb_in_spag_did_plot + q_nhb_in_spag_sc_plot + q_nhb_in_spag_sdid_plot + q_nhb_in_hist_did_plot + q_nhb_in_hist_sc_plot + q_nhb_in_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Total Expenditure #####
### IN - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
tot_exp_in_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
tot_exp_in_df$treated <- as.integer(ifelse(tot_exp_in_df$name == "Indiana" & tot_exp_in_df$year >= 1999, 1, 0))
tot_exp_in_df <- tot_exp_in_df[order(tot_exp_in_df$year, tot_exp_in_df$treated_in_aux, tot_exp_in_df$name),]
tot_exp_in_df <- subset(tot_exp_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, total_exp, treated))
setup_tot_exp_in <- panel.matrices(tot_exp_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
tot_exp_est_did_in <- did_estimate(setup_tot_exp_in$Y, setup_tot_exp_in$N0, setup_tot_exp_in$T0, X = covariates_exp_in_array)
tot_exp_est_did_plot_in <- synthdid_plot(tot_exp_est_did_in)
tot_exp_est_did_plot_data_aux_in <- ggplot_build(tot_exp_est_did_plot_in)
tot_exp_est_did_plot_data_long_in <- data.frame(tot_exp_est_did_plot_data_aux_in$data[[1]]$x, tot_exp_est_did_plot_data_aux_in$data[[1]]$y, tot_exp_est_did_plot_data_aux_in$data[[1]]$group)
colnames(tot_exp_est_did_plot_data_long_in) <- c('year', 'outcome', 'treated')
tot_exp_est_did_plot_data_long_in$treated <- tot_exp_est_did_plot_data_long_in$treated - 1
tot_exp_est_did_plot_data_wide_in <- reshape(data=tot_exp_est_did_plot_data_long_in,
                                             idvar = "year",
                                             v.names = "outcome",
                                             timevar = "treated",
                                             direction = "wide")
tot_exp_est_did_plot_data_wide_in$diff <- tot_exp_est_did_plot_data_wide_in$outcome.1 - tot_exp_est_did_plot_data_wide_in$outcome.0
# SC #
tot_exp_est_sc_in <- sc_estimate(setup_tot_exp_in$Y, setup_tot_exp_in$N0, setup_tot_exp_in$T0, X = covariates_exp_in_array)
tot_exp_est_sc_plot_in <- synthdid_plot(tot_exp_est_sc_in)
tot_exp_est_sc_plot_data_aux_in <- ggplot_build(tot_exp_est_sc_plot_in)
tot_exp_est_sc_plot_data_long_in <- data.frame(tot_exp_est_sc_plot_data_aux_in$data[[1]]$x, tot_exp_est_sc_plot_data_aux_in$data[[1]]$y, tot_exp_est_sc_plot_data_aux_in$data[[1]]$group)
colnames(tot_exp_est_sc_plot_data_long_in) <- c('year', 'outcome', 'treated')
tot_exp_est_sc_plot_data_long_in$treated <- tot_exp_est_sc_plot_data_long_in$treated - 1
tot_exp_est_sc_plot_data_wide_in <- reshape(data=tot_exp_est_sc_plot_data_long_in,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
tot_exp_est_sc_plot_data_wide_in$diff <- tot_exp_est_sc_plot_data_wide_in$outcome.1 - tot_exp_est_sc_plot_data_wide_in$outcome.0
# SDID #
tot_exp_est_sdid_in <- synthdid_estimate(setup_tot_exp_in$Y, setup_tot_exp_in$N0, setup_tot_exp_in$T0, X = covariates_exp_in_array)
tot_exp_est_sdid_plot_in <- synthdid_plot(tot_exp_est_sdid_in)
tot_exp_est_sdid_plot_data_aux_in <- ggplot_build(tot_exp_est_sdid_plot_in)
tot_exp_est_sdid_plot_data_long_in <- data.frame(tot_exp_est_sdid_plot_data_aux_in$data[[1]]$x, tot_exp_est_sdid_plot_data_aux_in$data[[1]]$y, tot_exp_est_sdid_plot_data_aux_in$data[[1]]$group)
colnames(tot_exp_est_sdid_plot_data_long_in) <- c('year', 'outcome', 'treated')
tot_exp_est_sdid_plot_data_long_in$treated <- tot_exp_est_sdid_plot_data_long_in$treated - 1
tot_exp_est_sdid_plot_data_wide_in <- reshape(data=tot_exp_est_sdid_plot_data_long_in,
                                              idvar = "year",
                                              v.names = "outcome",
                                              timevar = "treated",
                                              direction = "wide")
tot_exp_est_sdid_plot_data_wide_in$diff <- tot_exp_est_sdid_plot_data_wide_in$outcome.1 - tot_exp_est_sdid_plot_data_wide_in$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("tot_exp_in_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
tot_exp_in_df1$treated_aux <- ifelse(tot_exp_in_df1$id == 1, 1, 0)
tot_exp_in_df2$treated_aux <- ifelse(tot_exp_in_df2$id == 2, 1, 0)
tot_exp_in_df5$treated_aux <- ifelse(tot_exp_in_df5$id == 5, 1, 0)
tot_exp_in_df10$treated_aux <- ifelse(tot_exp_in_df10$id == 10, 1, 0)
tot_exp_in_df11$treated_aux <- ifelse(tot_exp_in_df11$id == 11, 1, 0)
tot_exp_in_df12$treated_aux <- ifelse(tot_exp_in_df12$id == 12, 1, 0)
tot_exp_in_df13$treated_aux <- ifelse(tot_exp_in_df13$id == 13, 1, 0)
tot_exp_in_df15$treated_aux <- ifelse(tot_exp_in_df15$id == 15, 1, 0)
tot_exp_in_df17$treated_aux <- ifelse(tot_exp_in_df17$id == 17, 1, 0)
tot_exp_in_df19$treated_aux <- ifelse(tot_exp_in_df19$id == 19, 1, 0)
tot_exp_in_df21$treated_aux <- ifelse(tot_exp_in_df21$id == 21, 1, 0)
tot_exp_in_df23$treated_aux <- ifelse(tot_exp_in_df23$id == 23, 1, 0)
tot_exp_in_df24$treated_aux <- ifelse(tot_exp_in_df24$id == 24, 1, 0)
tot_exp_in_df25$treated_aux <- ifelse(tot_exp_in_df25$id == 25, 1, 0)
tot_exp_in_df26$treated_aux <- ifelse(tot_exp_in_df26$id == 26, 1, 0)
tot_exp_in_df28$treated_aux <- ifelse(tot_exp_in_df28$id == 28, 1, 0)
tot_exp_in_df29$treated_aux <- ifelse(tot_exp_in_df29$id == 29, 1, 0)
tot_exp_in_df30$treated_aux <- ifelse(tot_exp_in_df30$id == 30, 1, 0)
tot_exp_in_df31$treated_aux <- ifelse(tot_exp_in_df31$id == 31, 1, 0)
tot_exp_in_df32$treated_aux <- ifelse(tot_exp_in_df32$id == 32, 1, 0)
tot_exp_in_df33$treated_aux <- ifelse(tot_exp_in_df33$id == 33, 1, 0)
tot_exp_in_df34$treated_aux <- ifelse(tot_exp_in_df34$id == 34, 1, 0)
tot_exp_in_df36$treated_aux <- ifelse(tot_exp_in_df36$id == 36, 1, 0)
tot_exp_in_df37$treated_aux <- ifelse(tot_exp_in_df37$id == 37, 1, 0)
tot_exp_in_df39$treated_aux <- ifelse(tot_exp_in_df39$id == 39, 1, 0)
tot_exp_in_df40$treated_aux <- ifelse(tot_exp_in_df40$id == 40, 1, 0)
tot_exp_in_df41$treated_aux <- ifelse(tot_exp_in_df41$id == 41, 1, 0)
tot_exp_in_df44$treated_aux <- ifelse(tot_exp_in_df44$id == 44, 1, 0)
tot_exp_in_df45$treated_aux <- ifelse(tot_exp_in_df45$id == 45, 1, 0)
tot_exp_in_df47$treated_aux <- ifelse(tot_exp_in_df47$id == 47, 1, 0)
tot_exp_in_df50$treated_aux <- ifelse(tot_exp_in_df50$id == 50, 1, 0)
tot_exp_in_df51$treated_aux <- ifelse(tot_exp_in_df51$id == 51, 1, 0)
tot_exp_in_df53$treated_aux <- ifelse(tot_exp_in_df53$id == 53, 1, 0)
tot_exp_in_df54$treated_aux <- ifelse(tot_exp_in_df54$id == 54, 1, 0)
tot_exp_in_df55$treated_aux <- ifelse(tot_exp_in_df55$id == 55, 1, 0)
tot_exp_in_df1$treated <- as.integer(ifelse(tot_exp_in_df1$id == 1 & tot_exp_in_df1$year >= 1999, 1, 0))
tot_exp_in_df2$treated <- as.integer(ifelse(tot_exp_in_df2$id == 2 & tot_exp_in_df2$year >= 1999, 1, 0))
tot_exp_in_df5$treated <- as.integer(ifelse(tot_exp_in_df5$id == 5 & tot_exp_in_df5$year >= 1999, 1, 0))
tot_exp_in_df10$treated <- as.integer(ifelse(tot_exp_in_df10$id == 10 & tot_exp_in_df10$year >= 1999, 1, 0))
tot_exp_in_df11$treated <- as.integer(ifelse(tot_exp_in_df11$id == 11 & tot_exp_in_df11$year >= 1999, 1, 0))
tot_exp_in_df12$treated <- as.integer(ifelse(tot_exp_in_df12$id == 12 & tot_exp_in_df12$year >= 1999, 1, 0))
tot_exp_in_df13$treated <- as.integer(ifelse(tot_exp_in_df13$id == 13 & tot_exp_in_df13$year >= 1999, 1, 0))
tot_exp_in_df15$treated <- as.integer(ifelse(tot_exp_in_df15$id == 15 & tot_exp_in_df15$year >= 1999, 1, 0))
tot_exp_in_df17$treated <- as.integer(ifelse(tot_exp_in_df17$id == 17 & tot_exp_in_df17$year >= 1999, 1, 0))
tot_exp_in_df19$treated <- as.integer(ifelse(tot_exp_in_df19$id == 19 & tot_exp_in_df19$year >= 1999, 1, 0))
tot_exp_in_df21$treated <- as.integer(ifelse(tot_exp_in_df21$id == 21 & tot_exp_in_df21$year >= 1999, 1, 0))
tot_exp_in_df23$treated <- as.integer(ifelse(tot_exp_in_df23$id == 23 & tot_exp_in_df23$year >= 1999, 1, 0))
tot_exp_in_df24$treated <- as.integer(ifelse(tot_exp_in_df24$id == 24 & tot_exp_in_df24$year >= 1999, 1, 0))
tot_exp_in_df25$treated <- as.integer(ifelse(tot_exp_in_df25$id == 25 & tot_exp_in_df25$year >= 1999, 1, 0))
tot_exp_in_df26$treated <- as.integer(ifelse(tot_exp_in_df26$id == 26 & tot_exp_in_df26$year >= 1999, 1, 0))
tot_exp_in_df28$treated <- as.integer(ifelse(tot_exp_in_df28$id == 28 & tot_exp_in_df28$year >= 1999, 1, 0))
tot_exp_in_df29$treated <- as.integer(ifelse(tot_exp_in_df29$id == 29 & tot_exp_in_df29$year >= 1999, 1, 0))
tot_exp_in_df30$treated <- as.integer(ifelse(tot_exp_in_df30$id == 30 & tot_exp_in_df30$year >= 1999, 1, 0))
tot_exp_in_df31$treated <- as.integer(ifelse(tot_exp_in_df31$id == 31 & tot_exp_in_df31$year >= 1999, 1, 0))
tot_exp_in_df32$treated <- as.integer(ifelse(tot_exp_in_df32$id == 32 & tot_exp_in_df32$year >= 1999, 1, 0))
tot_exp_in_df33$treated <- as.integer(ifelse(tot_exp_in_df33$id == 33 & tot_exp_in_df33$year >= 1999, 1, 0))
tot_exp_in_df34$treated <- as.integer(ifelse(tot_exp_in_df34$id == 34 & tot_exp_in_df34$year >= 1999, 1, 0))
tot_exp_in_df36$treated <- as.integer(ifelse(tot_exp_in_df36$id == 36 & tot_exp_in_df36$year >= 1999, 1, 0))
tot_exp_in_df37$treated <- as.integer(ifelse(tot_exp_in_df37$id == 37 & tot_exp_in_df37$year >= 1999, 1, 0))
tot_exp_in_df39$treated <- as.integer(ifelse(tot_exp_in_df39$id == 39 & tot_exp_in_df39$year >= 1999, 1, 0))
tot_exp_in_df40$treated <- as.integer(ifelse(tot_exp_in_df40$id == 40 & tot_exp_in_df40$year >= 1999, 1, 0))
tot_exp_in_df41$treated <- as.integer(ifelse(tot_exp_in_df41$id == 41 & tot_exp_in_df41$year >= 1999, 1, 0))
tot_exp_in_df44$treated <- as.integer(ifelse(tot_exp_in_df44$id == 44 & tot_exp_in_df44$year >= 1999, 1, 0))
tot_exp_in_df45$treated <- as.integer(ifelse(tot_exp_in_df45$id == 45 & tot_exp_in_df45$year >= 1999, 1, 0))
tot_exp_in_df47$treated <- as.integer(ifelse(tot_exp_in_df47$id == 47 & tot_exp_in_df47$year >= 1999, 1, 0))
tot_exp_in_df50$treated <- as.integer(ifelse(tot_exp_in_df50$id == 50 & tot_exp_in_df50$year >= 1999, 1, 0))
tot_exp_in_df51$treated <- as.integer(ifelse(tot_exp_in_df51$id == 51 & tot_exp_in_df51$year >= 1999, 1, 0))
tot_exp_in_df53$treated <- as.integer(ifelse(tot_exp_in_df53$id == 53 & tot_exp_in_df53$year >= 1999, 1, 0))
tot_exp_in_df54$treated <- as.integer(ifelse(tot_exp_in_df54$id == 54 & tot_exp_in_df54$year >= 1999, 1, 0))
tot_exp_in_df55$treated <- as.integer(ifelse(tot_exp_in_df55$id == 55 & tot_exp_in_df55$year >= 1999, 1, 0))
tot_exp_in_df_list <- list(tot_exp_in_df1,tot_exp_in_df2,tot_exp_in_df5,
                           tot_exp_in_df10,tot_exp_in_df11,tot_exp_in_df12,
                           tot_exp_in_df13,tot_exp_in_df15,tot_exp_in_df17,
                           tot_exp_in_df19,tot_exp_in_df21,tot_exp_in_df23,
                           tot_exp_in_df24,tot_exp_in_df25,tot_exp_in_df26,
                           tot_exp_in_df28,tot_exp_in_df29,tot_exp_in_df30,
                           tot_exp_in_df31,tot_exp_in_df32,tot_exp_in_df33,
                           tot_exp_in_df34,tot_exp_in_df36,tot_exp_in_df37,
                           tot_exp_in_df39,tot_exp_in_df40,tot_exp_in_df41,
                           tot_exp_in_df44,tot_exp_in_df45,tot_exp_in_df47,
                           tot_exp_in_df50,tot_exp_in_df51,tot_exp_in_df53,
                           tot_exp_in_df54,tot_exp_in_df55)
rm(tot_exp_in_df1,tot_exp_in_df2,tot_exp_in_df5,
   tot_exp_in_df10,tot_exp_in_df11,tot_exp_in_df12,
   tot_exp_in_df13,tot_exp_in_df15,tot_exp_in_df17,
   tot_exp_in_df19,tot_exp_in_df21,tot_exp_in_df23,
   tot_exp_in_df24,tot_exp_in_df25,tot_exp_in_df26,
   tot_exp_in_df28,tot_exp_in_df29,tot_exp_in_df30,
   tot_exp_in_df31,tot_exp_in_df32,tot_exp_in_df33,
   tot_exp_in_df34,tot_exp_in_df36,tot_exp_in_df37,
   tot_exp_in_df39,tot_exp_in_df40,tot_exp_in_df41,
   tot_exp_in_df44,tot_exp_in_df45,tot_exp_in_df47,
   tot_exp_in_df50,tot_exp_in_df51,tot_exp_in_df53,
   tot_exp_in_df54,tot_exp_in_df55)
tot_exp_in_df_list <- lapply(tot_exp_in_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
tot_exp_in_df_list <- lapply(tot_exp_in_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, total_exp, treated)))
}
)
setup_tot_exp_in1 <- panel.matrices(tot_exp_in_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in2 <- panel.matrices(tot_exp_in_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in5 <- panel.matrices(tot_exp_in_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in10 <- panel.matrices(tot_exp_in_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in11 <- panel.matrices(tot_exp_in_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in12 <- panel.matrices(tot_exp_in_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in13 <- panel.matrices(tot_exp_in_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in15 <- panel.matrices(tot_exp_in_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in17 <- panel.matrices(tot_exp_in_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in19 <- panel.matrices(tot_exp_in_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in21 <- panel.matrices(tot_exp_in_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in23 <- panel.matrices(tot_exp_in_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in24 <- panel.matrices(tot_exp_in_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in25 <- panel.matrices(tot_exp_in_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in26 <- panel.matrices(tot_exp_in_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in28 <- panel.matrices(tot_exp_in_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in29 <- panel.matrices(tot_exp_in_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in30 <- panel.matrices(tot_exp_in_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in31 <- panel.matrices(tot_exp_in_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in32 <- panel.matrices(tot_exp_in_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in33 <- panel.matrices(tot_exp_in_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in34 <- panel.matrices(tot_exp_in_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in36 <- panel.matrices(tot_exp_in_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in37 <- panel.matrices(tot_exp_in_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in39 <- panel.matrices(tot_exp_in_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in40 <- panel.matrices(tot_exp_in_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in41 <- panel.matrices(tot_exp_in_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in44 <- panel.matrices(tot_exp_in_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in45 <- panel.matrices(tot_exp_in_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in47 <- panel.matrices(tot_exp_in_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in50 <- panel.matrices(tot_exp_in_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in51 <- panel.matrices(tot_exp_in_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in53 <- panel.matrices(tot_exp_in_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in54 <- panel.matrices(tot_exp_in_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in55 <- panel.matrices(tot_exp_in_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_in_list <- list(setup_tot_exp_in1,setup_tot_exp_in2,setup_tot_exp_in5,
                              setup_tot_exp_in10,setup_tot_exp_in11,setup_tot_exp_in12,
                              setup_tot_exp_in13,setup_tot_exp_in15,setup_tot_exp_in17,
                              setup_tot_exp_in19,setup_tot_exp_in21,setup_tot_exp_in23,
                              setup_tot_exp_in24,setup_tot_exp_in25,setup_tot_exp_in26,
                              setup_tot_exp_in28,setup_tot_exp_in29,setup_tot_exp_in30,
                              setup_tot_exp_in31,setup_tot_exp_in32,setup_tot_exp_in33,
                              setup_tot_exp_in34,setup_tot_exp_in36,setup_tot_exp_in37,
                              setup_tot_exp_in39,setup_tot_exp_in40,setup_tot_exp_in41,
                              setup_tot_exp_in44,setup_tot_exp_in45,setup_tot_exp_in47,
                              setup_tot_exp_in50,setup_tot_exp_in51,setup_tot_exp_in53,
                              setup_tot_exp_in54,setup_tot_exp_in55)
rm(setup_tot_exp_in1,setup_tot_exp_in2,setup_tot_exp_in5,
   setup_tot_exp_in10,setup_tot_exp_in11,setup_tot_exp_in12,
   setup_tot_exp_in13,setup_tot_exp_in15,setup_tot_exp_in17,
   setup_tot_exp_in19,setup_tot_exp_in21,setup_tot_exp_in23,
   setup_tot_exp_in24,setup_tot_exp_in25,setup_tot_exp_in26,
   setup_tot_exp_in28,setup_tot_exp_in29,setup_tot_exp_in30,
   setup_tot_exp_in31,setup_tot_exp_in32,setup_tot_exp_in33,
   setup_tot_exp_in34,setup_tot_exp_in36,setup_tot_exp_in37,
   setup_tot_exp_in39,setup_tot_exp_in40,setup_tot_exp_in41,
   setup_tot_exp_in44,setup_tot_exp_in45,setup_tot_exp_in47,
   setup_tot_exp_in50,setup_tot_exp_in51,setup_tot_exp_in53,
   setup_tot_exp_in54,setup_tot_exp_in55)
# DID #
tot_exp_in_est_did1 <- did_estimate(setup_tot_exp_in_list[[1]]$Y, setup_tot_exp_in_list[[1]]$N0, setup_tot_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_in_est_did2 <- did_estimate(setup_tot_exp_in_list[[2]]$Y, setup_tot_exp_in_list[[2]]$N0, setup_tot_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_in_est_did5 <- did_estimate(setup_tot_exp_in_list[[3]]$Y, setup_tot_exp_in_list[[3]]$N0, setup_tot_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_in_est_did10 <- did_estimate(setup_tot_exp_in_list[[4]]$Y, setup_tot_exp_in_list[[4]]$N0, setup_tot_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_in_est_did11 <- did_estimate(setup_tot_exp_in_list[[5]]$Y, setup_tot_exp_in_list[[5]]$N0, setup_tot_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_in_est_did12 <- did_estimate(setup_tot_exp_in_list[[6]]$Y, setup_tot_exp_in_list[[6]]$N0, setup_tot_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_in_est_did13 <- did_estimate(setup_tot_exp_in_list[[7]]$Y, setup_tot_exp_in_list[[7]]$N0, setup_tot_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_in_est_did15 <- did_estimate(setup_tot_exp_in_list[[8]]$Y, setup_tot_exp_in_list[[8]]$N0, setup_tot_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_in_est_did17 <- did_estimate(setup_tot_exp_in_list[[9]]$Y, setup_tot_exp_in_list[[9]]$N0, setup_tot_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_in_est_did19 <- did_estimate(setup_tot_exp_in_list[[10]]$Y, setup_tot_exp_in_list[[10]]$N0, setup_tot_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_in_est_did21 <- did_estimate(setup_tot_exp_in_list[[11]]$Y, setup_tot_exp_in_list[[11]]$N0, setup_tot_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_in_est_did23 <- did_estimate(setup_tot_exp_in_list[[12]]$Y, setup_tot_exp_in_list[[12]]$N0, setup_tot_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_in_est_did24 <- did_estimate(setup_tot_exp_in_list[[13]]$Y, setup_tot_exp_in_list[[13]]$N0, setup_tot_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_in_est_did25 <- did_estimate(setup_tot_exp_in_list[[14]]$Y, setup_tot_exp_in_list[[14]]$N0, setup_tot_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_in_est_did26 <- did_estimate(setup_tot_exp_in_list[[15]]$Y, setup_tot_exp_in_list[[15]]$N0, setup_tot_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_in_est_did28 <- did_estimate(setup_tot_exp_in_list[[16]]$Y, setup_tot_exp_in_list[[16]]$N0, setup_tot_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_in_est_did29 <- did_estimate(setup_tot_exp_in_list[[17]]$Y, setup_tot_exp_in_list[[17]]$N0, setup_tot_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_in_est_did30 <- did_estimate(setup_tot_exp_in_list[[18]]$Y, setup_tot_exp_in_list[[18]]$N0, setup_tot_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_in_est_did31 <- did_estimate(setup_tot_exp_in_list[[19]]$Y, setup_tot_exp_in_list[[19]]$N0, setup_tot_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_in_est_did32 <- did_estimate(setup_tot_exp_in_list[[20]]$Y, setup_tot_exp_in_list[[20]]$N0, setup_tot_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_in_est_did33 <- did_estimate(setup_tot_exp_in_list[[21]]$Y, setup_tot_exp_in_list[[21]]$N0, setup_tot_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_in_est_did34 <- did_estimate(setup_tot_exp_in_list[[22]]$Y, setup_tot_exp_in_list[[22]]$N0, setup_tot_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_in_est_did36 <- did_estimate(setup_tot_exp_in_list[[23]]$Y, setup_tot_exp_in_list[[23]]$N0, setup_tot_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_in_est_did37 <- did_estimate(setup_tot_exp_in_list[[24]]$Y, setup_tot_exp_in_list[[24]]$N0, setup_tot_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_in_est_did39 <- did_estimate(setup_tot_exp_in_list[[25]]$Y, setup_tot_exp_in_list[[25]]$N0, setup_tot_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_in_est_did40 <- did_estimate(setup_tot_exp_in_list[[26]]$Y, setup_tot_exp_in_list[[26]]$N0, setup_tot_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_in_est_did41 <- did_estimate(setup_tot_exp_in_list[[27]]$Y, setup_tot_exp_in_list[[27]]$N0, setup_tot_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_in_est_did44 <- did_estimate(setup_tot_exp_in_list[[28]]$Y, setup_tot_exp_in_list[[28]]$N0, setup_tot_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_in_est_did45 <- did_estimate(setup_tot_exp_in_list[[29]]$Y, setup_tot_exp_in_list[[29]]$N0, setup_tot_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_in_est_did47 <- did_estimate(setup_tot_exp_in_list[[30]]$Y, setup_tot_exp_in_list[[30]]$N0, setup_tot_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_in_est_did50 <- did_estimate(setup_tot_exp_in_list[[31]]$Y, setup_tot_exp_in_list[[31]]$N0, setup_tot_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_in_est_did51 <- did_estimate(setup_tot_exp_in_list[[32]]$Y, setup_tot_exp_in_list[[32]]$N0, setup_tot_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_in_est_did53 <- did_estimate(setup_tot_exp_in_list[[33]]$Y, setup_tot_exp_in_list[[33]]$N0, setup_tot_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_in_est_did54 <- did_estimate(setup_tot_exp_in_list[[34]]$Y, setup_tot_exp_in_list[[34]]$N0, setup_tot_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_in_est_did55 <- did_estimate(setup_tot_exp_in_list[[35]]$Y, setup_tot_exp_in_list[[35]]$N0, setup_tot_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_in_est_did_list <- list(tot_exp_in_est_did1,tot_exp_in_est_did2,tot_exp_in_est_did5,
                                tot_exp_in_est_did10,tot_exp_in_est_did11,tot_exp_in_est_did12,
                                tot_exp_in_est_did13,tot_exp_in_est_did15,tot_exp_in_est_did17,
                                tot_exp_in_est_did19,tot_exp_in_est_did21,tot_exp_in_est_did23,
                                tot_exp_in_est_did24,tot_exp_in_est_did25,tot_exp_in_est_did26,
                                tot_exp_in_est_did28,tot_exp_in_est_did29,tot_exp_in_est_did30,
                                tot_exp_in_est_did31,tot_exp_in_est_did32,tot_exp_in_est_did33,
                                tot_exp_in_est_did34,tot_exp_in_est_did36,tot_exp_in_est_did37,
                                tot_exp_in_est_did39,tot_exp_in_est_did40,tot_exp_in_est_did41,
                                tot_exp_in_est_did44,tot_exp_in_est_did45,tot_exp_in_est_did47,
                                tot_exp_in_est_did50,tot_exp_in_est_did51,tot_exp_in_est_did53,
                                tot_exp_in_est_did54,tot_exp_in_est_did55)
rm(tot_exp_in_est_did1,tot_exp_in_est_did2,tot_exp_in_est_did5,
   tot_exp_in_est_did10,tot_exp_in_est_did11,tot_exp_in_est_did12,
   tot_exp_in_est_did13,tot_exp_in_est_did15,tot_exp_in_est_did17,
   tot_exp_in_est_did19,tot_exp_in_est_did21,tot_exp_in_est_did23,
   tot_exp_in_est_did24,tot_exp_in_est_did25,tot_exp_in_est_did26,
   tot_exp_in_est_did28,tot_exp_in_est_did29,tot_exp_in_est_did30,
   tot_exp_in_est_did31,tot_exp_in_est_did32,tot_exp_in_est_did33,
   tot_exp_in_est_did34,tot_exp_in_est_did36,tot_exp_in_est_did37,
   tot_exp_in_est_did39,tot_exp_in_est_did40,tot_exp_in_est_did41,
   tot_exp_in_est_did44,tot_exp_in_est_did45,tot_exp_in_est_did47,
   tot_exp_in_est_did50,tot_exp_in_est_did51,tot_exp_in_est_did53,
   tot_exp_in_est_did54,tot_exp_in_est_did55)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_did_plot", i), synthdid_plot(tot_exp_in_est_did_list[i]))
}
tot_exp_in_est_did_plot_data_aux1 <- ggplot_build(tot_exp_in_est_did_plot1)
tot_exp_in_est_did_plot_data_aux2 <- ggplot_build(tot_exp_in_est_did_plot2)
tot_exp_in_est_did_plot_data_aux3 <- ggplot_build(tot_exp_in_est_did_plot3)
tot_exp_in_est_did_plot_data_aux4 <- ggplot_build(tot_exp_in_est_did_plot4)
tot_exp_in_est_did_plot_data_aux5 <- ggplot_build(tot_exp_in_est_did_plot5)
tot_exp_in_est_did_plot_data_aux6 <- ggplot_build(tot_exp_in_est_did_plot6)
tot_exp_in_est_did_plot_data_aux7 <- ggplot_build(tot_exp_in_est_did_plot7)
tot_exp_in_est_did_plot_data_aux8 <- ggplot_build(tot_exp_in_est_did_plot8)
tot_exp_in_est_did_plot_data_aux9 <- ggplot_build(tot_exp_in_est_did_plot9)
tot_exp_in_est_did_plot_data_aux10 <- ggplot_build(tot_exp_in_est_did_plot10)
tot_exp_in_est_did_plot_data_aux11 <- ggplot_build(tot_exp_in_est_did_plot11)
tot_exp_in_est_did_plot_data_aux12 <- ggplot_build(tot_exp_in_est_did_plot12)
tot_exp_in_est_did_plot_data_aux13 <- ggplot_build(tot_exp_in_est_did_plot13)
tot_exp_in_est_did_plot_data_aux14 <- ggplot_build(tot_exp_in_est_did_plot14)
tot_exp_in_est_did_plot_data_aux15 <- ggplot_build(tot_exp_in_est_did_plot15)
tot_exp_in_est_did_plot_data_aux16 <- ggplot_build(tot_exp_in_est_did_plot16)
tot_exp_in_est_did_plot_data_aux17 <- ggplot_build(tot_exp_in_est_did_plot17)
tot_exp_in_est_did_plot_data_aux18 <- ggplot_build(tot_exp_in_est_did_plot18)
tot_exp_in_est_did_plot_data_aux19 <- ggplot_build(tot_exp_in_est_did_plot19)
tot_exp_in_est_did_plot_data_aux20 <- ggplot_build(tot_exp_in_est_did_plot20)
tot_exp_in_est_did_plot_data_aux21 <- ggplot_build(tot_exp_in_est_did_plot21)
tot_exp_in_est_did_plot_data_aux22 <- ggplot_build(tot_exp_in_est_did_plot22)
tot_exp_in_est_did_plot_data_aux23 <- ggplot_build(tot_exp_in_est_did_plot23)
tot_exp_in_est_did_plot_data_aux24 <- ggplot_build(tot_exp_in_est_did_plot24)
tot_exp_in_est_did_plot_data_aux25 <- ggplot_build(tot_exp_in_est_did_plot25)
tot_exp_in_est_did_plot_data_aux26 <- ggplot_build(tot_exp_in_est_did_plot26)
tot_exp_in_est_did_plot_data_aux27 <- ggplot_build(tot_exp_in_est_did_plot27)
tot_exp_in_est_did_plot_data_aux28 <- ggplot_build(tot_exp_in_est_did_plot28)
tot_exp_in_est_did_plot_data_aux29 <- ggplot_build(tot_exp_in_est_did_plot29)
tot_exp_in_est_did_plot_data_aux30 <- ggplot_build(tot_exp_in_est_did_plot30)
tot_exp_in_est_did_plot_data_aux31 <- ggplot_build(tot_exp_in_est_did_plot31)
tot_exp_in_est_did_plot_data_aux32 <- ggplot_build(tot_exp_in_est_did_plot32)
tot_exp_in_est_did_plot_data_aux33 <- ggplot_build(tot_exp_in_est_did_plot33)
tot_exp_in_est_did_plot_data_aux34 <- ggplot_build(tot_exp_in_est_did_plot34)
tot_exp_in_est_did_plot_data_aux35 <- ggplot_build(tot_exp_in_est_did_plot35)
tot_exp_in_est_did_plot_data_aux_list <- list(tot_exp_in_est_did_plot_data_aux1,tot_exp_in_est_did_plot_data_aux2,tot_exp_in_est_did_plot_data_aux3,
                                              tot_exp_in_est_did_plot_data_aux4,tot_exp_in_est_did_plot_data_aux5,tot_exp_in_est_did_plot_data_aux6,
                                              tot_exp_in_est_did_plot_data_aux7,tot_exp_in_est_did_plot_data_aux8,tot_exp_in_est_did_plot_data_aux9,
                                              tot_exp_in_est_did_plot_data_aux10,tot_exp_in_est_did_plot_data_aux11,tot_exp_in_est_did_plot_data_aux12,
                                              tot_exp_in_est_did_plot_data_aux13,tot_exp_in_est_did_plot_data_aux14,tot_exp_in_est_did_plot_data_aux15,
                                              tot_exp_in_est_did_plot_data_aux16,tot_exp_in_est_did_plot_data_aux17,tot_exp_in_est_did_plot_data_aux18,
                                              tot_exp_in_est_did_plot_data_aux19,tot_exp_in_est_did_plot_data_aux20,tot_exp_in_est_did_plot_data_aux21,
                                              tot_exp_in_est_did_plot_data_aux22,tot_exp_in_est_did_plot_data_aux23,tot_exp_in_est_did_plot_data_aux24,
                                              tot_exp_in_est_did_plot_data_aux25,tot_exp_in_est_did_plot_data_aux26,tot_exp_in_est_did_plot_data_aux27,
                                              tot_exp_in_est_did_plot_data_aux28,tot_exp_in_est_did_plot_data_aux29,tot_exp_in_est_did_plot_data_aux30,
                                              tot_exp_in_est_did_plot_data_aux31,tot_exp_in_est_did_plot_data_aux32,tot_exp_in_est_did_plot_data_aux33,
                                              tot_exp_in_est_did_plot_data_aux34,tot_exp_in_est_did_plot_data_aux35)
rm(tot_exp_in_est_did_plot_data_aux1,tot_exp_in_est_did_plot_data_aux2,tot_exp_in_est_did_plot_data_aux3,
   tot_exp_in_est_did_plot_data_aux4,tot_exp_in_est_did_plot_data_aux5,tot_exp_in_est_did_plot_data_aux6,
   tot_exp_in_est_did_plot_data_aux7,tot_exp_in_est_did_plot_data_aux8,tot_exp_in_est_did_plot_data_aux9,
   tot_exp_in_est_did_plot_data_aux10,tot_exp_in_est_did_plot_data_aux11,tot_exp_in_est_did_plot_data_aux12,
   tot_exp_in_est_did_plot_data_aux13,tot_exp_in_est_did_plot_data_aux14,tot_exp_in_est_did_plot_data_aux15,
   tot_exp_in_est_did_plot_data_aux16,tot_exp_in_est_did_plot_data_aux17,tot_exp_in_est_did_plot_data_aux18,
   tot_exp_in_est_did_plot_data_aux19,tot_exp_in_est_did_plot_data_aux20,tot_exp_in_est_did_plot_data_aux21,
   tot_exp_in_est_did_plot_data_aux22,tot_exp_in_est_did_plot_data_aux23,tot_exp_in_est_did_plot_data_aux24,
   tot_exp_in_est_did_plot_data_aux25,tot_exp_in_est_did_plot_data_aux26,tot_exp_in_est_did_plot_data_aux27,
   tot_exp_in_est_did_plot_data_aux28,tot_exp_in_est_did_plot_data_aux29,tot_exp_in_est_did_plot_data_aux30,
   tot_exp_in_est_did_plot_data_aux31,tot_exp_in_est_did_plot_data_aux32,tot_exp_in_est_did_plot_data_aux33,
   tot_exp_in_est_did_plot_data_aux34,tot_exp_in_est_did_plot_data_aux35)
rm(tot_exp_in_est_did_plot1,tot_exp_in_est_did_plot2,tot_exp_in_est_did_plot3,
   tot_exp_in_est_did_plot4,tot_exp_in_est_did_plot5,tot_exp_in_est_did_plot6,
   tot_exp_in_est_did_plot7,tot_exp_in_est_did_plot8,tot_exp_in_est_did_plot9,
   tot_exp_in_est_did_plot10,tot_exp_in_est_did_plot11,tot_exp_in_est_did_plot12,
   tot_exp_in_est_did_plot13,tot_exp_in_est_did_plot14,tot_exp_in_est_did_plot15,
   tot_exp_in_est_did_plot16,tot_exp_in_est_did_plot17,tot_exp_in_est_did_plot18,
   tot_exp_in_est_did_plot19,tot_exp_in_est_did_plot20,tot_exp_in_est_did_plot21,
   tot_exp_in_est_did_plot22,tot_exp_in_est_did_plot23,tot_exp_in_est_did_plot24,
   tot_exp_in_est_did_plot25,tot_exp_in_est_did_plot26,tot_exp_in_est_did_plot27,
   tot_exp_in_est_did_plot28,tot_exp_in_est_did_plot29,tot_exp_in_est_did_plot30,
   tot_exp_in_est_did_plot31,tot_exp_in_est_did_plot32,tot_exp_in_est_did_plot33,
   tot_exp_in_est_did_plot34,tot_exp_in_est_did_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_did_plot_data_long", i), data.frame(tot_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_in_est_did_plot_data_long_list <- list(tot_exp_in_est_did_plot_data_long1,tot_exp_in_est_did_plot_data_long2,tot_exp_in_est_did_plot_data_long3,
                                               tot_exp_in_est_did_plot_data_long4,tot_exp_in_est_did_plot_data_long5,tot_exp_in_est_did_plot_data_long6,
                                               tot_exp_in_est_did_plot_data_long7,tot_exp_in_est_did_plot_data_long8,tot_exp_in_est_did_plot_data_long9,
                                               tot_exp_in_est_did_plot_data_long10,tot_exp_in_est_did_plot_data_long11,tot_exp_in_est_did_plot_data_long12,
                                               tot_exp_in_est_did_plot_data_long13,tot_exp_in_est_did_plot_data_long14,tot_exp_in_est_did_plot_data_long15,
                                               tot_exp_in_est_did_plot_data_long16,tot_exp_in_est_did_plot_data_long17,tot_exp_in_est_did_plot_data_long18,
                                               tot_exp_in_est_did_plot_data_long19,tot_exp_in_est_did_plot_data_long20,tot_exp_in_est_did_plot_data_long21,
                                               tot_exp_in_est_did_plot_data_long22,tot_exp_in_est_did_plot_data_long23,tot_exp_in_est_did_plot_data_long24,
                                               tot_exp_in_est_did_plot_data_long25,tot_exp_in_est_did_plot_data_long26,tot_exp_in_est_did_plot_data_long27,
                                               tot_exp_in_est_did_plot_data_long28,tot_exp_in_est_did_plot_data_long29,tot_exp_in_est_did_plot_data_long30,
                                               tot_exp_in_est_did_plot_data_long31,tot_exp_in_est_did_plot_data_long32,tot_exp_in_est_did_plot_data_long33,
                                               tot_exp_in_est_did_plot_data_long34,tot_exp_in_est_did_plot_data_long35)
rm(tot_exp_in_est_did_plot_data_long1,tot_exp_in_est_did_plot_data_long2,tot_exp_in_est_did_plot_data_long3,
   tot_exp_in_est_did_plot_data_long4,tot_exp_in_est_did_plot_data_long5,tot_exp_in_est_did_plot_data_long6,
   tot_exp_in_est_did_plot_data_long7,tot_exp_in_est_did_plot_data_long8,tot_exp_in_est_did_plot_data_long9,
   tot_exp_in_est_did_plot_data_long10,tot_exp_in_est_did_plot_data_long11,tot_exp_in_est_did_plot_data_long12,
   tot_exp_in_est_did_plot_data_long13,tot_exp_in_est_did_plot_data_long14,tot_exp_in_est_did_plot_data_long15,
   tot_exp_in_est_did_plot_data_long16,tot_exp_in_est_did_plot_data_long17,tot_exp_in_est_did_plot_data_long18,
   tot_exp_in_est_did_plot_data_long19,tot_exp_in_est_did_plot_data_long20,tot_exp_in_est_did_plot_data_long21,
   tot_exp_in_est_did_plot_data_long22,tot_exp_in_est_did_plot_data_long23,tot_exp_in_est_did_plot_data_long24,
   tot_exp_in_est_did_plot_data_long25,tot_exp_in_est_did_plot_data_long26,tot_exp_in_est_did_plot_data_long27,
   tot_exp_in_est_did_plot_data_long28,tot_exp_in_est_did_plot_data_long29,tot_exp_in_est_did_plot_data_long30,
   tot_exp_in_est_did_plot_data_long31,tot_exp_in_est_did_plot_data_long32,tot_exp_in_est_did_plot_data_long33,
   tot_exp_in_est_did_plot_data_long34,tot_exp_in_est_did_plot_data_long35)
tot_exp_in_est_did_plot_data_long_list <- lapply(tot_exp_in_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_did_plot_data_wide", i), reshape(data=tot_exp_in_est_did_plot_data_long_list[[i]],
                                                                 idvar = "year",
                                                                 v.names = "outcome",
                                                                 timevar = "treated",
                                                                 direction = "wide"))
}
tot_exp_in_est_did_plot_data_wide_list <- list(tot_exp_in_est_did_plot_data_wide1,tot_exp_in_est_did_plot_data_wide2,tot_exp_in_est_did_plot_data_wide3,
                                               tot_exp_in_est_did_plot_data_wide4,tot_exp_in_est_did_plot_data_wide5,tot_exp_in_est_did_plot_data_wide6,
                                               tot_exp_in_est_did_plot_data_wide7,tot_exp_in_est_did_plot_data_wide8,tot_exp_in_est_did_plot_data_wide9,
                                               tot_exp_in_est_did_plot_data_wide10,tot_exp_in_est_did_plot_data_wide11,tot_exp_in_est_did_plot_data_wide12,
                                               tot_exp_in_est_did_plot_data_wide13,tot_exp_in_est_did_plot_data_wide14,tot_exp_in_est_did_plot_data_wide15,
                                               tot_exp_in_est_did_plot_data_wide16,tot_exp_in_est_did_plot_data_wide17,tot_exp_in_est_did_plot_data_wide18,
                                               tot_exp_in_est_did_plot_data_wide19,tot_exp_in_est_did_plot_data_wide20,tot_exp_in_est_did_plot_data_wide21,
                                               tot_exp_in_est_did_plot_data_wide22,tot_exp_in_est_did_plot_data_wide23,tot_exp_in_est_did_plot_data_wide24,
                                               tot_exp_in_est_did_plot_data_wide25,tot_exp_in_est_did_plot_data_wide26,tot_exp_in_est_did_plot_data_wide27,
                                               tot_exp_in_est_did_plot_data_wide28,tot_exp_in_est_did_plot_data_wide29,tot_exp_in_est_did_plot_data_wide30,
                                               tot_exp_in_est_did_plot_data_wide31,tot_exp_in_est_did_plot_data_wide32,tot_exp_in_est_did_plot_data_wide33,
                                               tot_exp_in_est_did_plot_data_wide34,tot_exp_in_est_did_plot_data_wide35)
rm(tot_exp_in_est_did_plot_data_wide1,tot_exp_in_est_did_plot_data_wide2,tot_exp_in_est_did_plot_data_wide3,
   tot_exp_in_est_did_plot_data_wide4,tot_exp_in_est_did_plot_data_wide5,tot_exp_in_est_did_plot_data_wide6,
   tot_exp_in_est_did_plot_data_wide7,tot_exp_in_est_did_plot_data_wide8,tot_exp_in_est_did_plot_data_wide9,
   tot_exp_in_est_did_plot_data_wide10,tot_exp_in_est_did_plot_data_wide11,tot_exp_in_est_did_plot_data_wide12,
   tot_exp_in_est_did_plot_data_wide13,tot_exp_in_est_did_plot_data_wide14,tot_exp_in_est_did_plot_data_wide15,
   tot_exp_in_est_did_plot_data_wide16,tot_exp_in_est_did_plot_data_wide17,tot_exp_in_est_did_plot_data_wide18,
   tot_exp_in_est_did_plot_data_wide19,tot_exp_in_est_did_plot_data_wide20,tot_exp_in_est_did_plot_data_wide21,
   tot_exp_in_est_did_plot_data_wide22,tot_exp_in_est_did_plot_data_wide23,tot_exp_in_est_did_plot_data_wide24,
   tot_exp_in_est_did_plot_data_wide25,tot_exp_in_est_did_plot_data_wide26,tot_exp_in_est_did_plot_data_wide27,
   tot_exp_in_est_did_plot_data_wide28,tot_exp_in_est_did_plot_data_wide29,tot_exp_in_est_did_plot_data_wide30,
   tot_exp_in_est_did_plot_data_wide31,tot_exp_in_est_did_plot_data_wide32,tot_exp_in_est_did_plot_data_wide33,
   tot_exp_in_est_did_plot_data_wide34,tot_exp_in_est_did_plot_data_wide35)
tot_exp_in_est_did_plot_data_wide_list <- lapply(tot_exp_in_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
tot_exp_in_est_sc1 <- sc_estimate(setup_tot_exp_in_list[[1]]$Y, setup_tot_exp_in_list[[1]]$N0, setup_tot_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_in_est_sc2 <- sc_estimate(setup_tot_exp_in_list[[2]]$Y, setup_tot_exp_in_list[[2]]$N0, setup_tot_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_in_est_sc5 <- sc_estimate(setup_tot_exp_in_list[[3]]$Y, setup_tot_exp_in_list[[3]]$N0, setup_tot_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_in_est_sc10 <- sc_estimate(setup_tot_exp_in_list[[4]]$Y, setup_tot_exp_in_list[[4]]$N0, setup_tot_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_in_est_sc11 <- sc_estimate(setup_tot_exp_in_list[[5]]$Y, setup_tot_exp_in_list[[5]]$N0, setup_tot_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_in_est_sc12 <- sc_estimate(setup_tot_exp_in_list[[6]]$Y, setup_tot_exp_in_list[[6]]$N0, setup_tot_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_in_est_sc13 <- sc_estimate(setup_tot_exp_in_list[[7]]$Y, setup_tot_exp_in_list[[7]]$N0, setup_tot_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_in_est_sc15 <- sc_estimate(setup_tot_exp_in_list[[8]]$Y, setup_tot_exp_in_list[[8]]$N0, setup_tot_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_in_est_sc17 <- sc_estimate(setup_tot_exp_in_list[[9]]$Y, setup_tot_exp_in_list[[9]]$N0, setup_tot_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_in_est_sc19 <- sc_estimate(setup_tot_exp_in_list[[10]]$Y, setup_tot_exp_in_list[[10]]$N0, setup_tot_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_in_est_sc21 <- sc_estimate(setup_tot_exp_in_list[[11]]$Y, setup_tot_exp_in_list[[11]]$N0, setup_tot_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_in_est_sc23 <- sc_estimate(setup_tot_exp_in_list[[12]]$Y, setup_tot_exp_in_list[[12]]$N0, setup_tot_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_in_est_sc24 <- sc_estimate(setup_tot_exp_in_list[[13]]$Y, setup_tot_exp_in_list[[13]]$N0, setup_tot_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_in_est_sc25 <- sc_estimate(setup_tot_exp_in_list[[14]]$Y, setup_tot_exp_in_list[[14]]$N0, setup_tot_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_in_est_sc26 <- sc_estimate(setup_tot_exp_in_list[[15]]$Y, setup_tot_exp_in_list[[15]]$N0, setup_tot_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_in_est_sc28 <- sc_estimate(setup_tot_exp_in_list[[16]]$Y, setup_tot_exp_in_list[[16]]$N0, setup_tot_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_in_est_sc29 <- sc_estimate(setup_tot_exp_in_list[[17]]$Y, setup_tot_exp_in_list[[17]]$N0, setup_tot_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_in_est_sc30 <- sc_estimate(setup_tot_exp_in_list[[18]]$Y, setup_tot_exp_in_list[[18]]$N0, setup_tot_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_in_est_sc31 <- sc_estimate(setup_tot_exp_in_list[[19]]$Y, setup_tot_exp_in_list[[19]]$N0, setup_tot_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_in_est_sc32 <- sc_estimate(setup_tot_exp_in_list[[20]]$Y, setup_tot_exp_in_list[[20]]$N0, setup_tot_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_in_est_sc33 <- sc_estimate(setup_tot_exp_in_list[[21]]$Y, setup_tot_exp_in_list[[21]]$N0, setup_tot_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_in_est_sc34 <- sc_estimate(setup_tot_exp_in_list[[22]]$Y, setup_tot_exp_in_list[[22]]$N0, setup_tot_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_in_est_sc36 <- sc_estimate(setup_tot_exp_in_list[[23]]$Y, setup_tot_exp_in_list[[23]]$N0, setup_tot_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_in_est_sc37 <- sc_estimate(setup_tot_exp_in_list[[24]]$Y, setup_tot_exp_in_list[[24]]$N0, setup_tot_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_in_est_sc39 <- sc_estimate(setup_tot_exp_in_list[[25]]$Y, setup_tot_exp_in_list[[25]]$N0, setup_tot_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_in_est_sc40 <- sc_estimate(setup_tot_exp_in_list[[26]]$Y, setup_tot_exp_in_list[[26]]$N0, setup_tot_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_in_est_sc41 <- sc_estimate(setup_tot_exp_in_list[[27]]$Y, setup_tot_exp_in_list[[27]]$N0, setup_tot_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_in_est_sc44 <- sc_estimate(setup_tot_exp_in_list[[28]]$Y, setup_tot_exp_in_list[[28]]$N0, setup_tot_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_in_est_sc45 <- sc_estimate(setup_tot_exp_in_list[[29]]$Y, setup_tot_exp_in_list[[29]]$N0, setup_tot_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_in_est_sc47 <- sc_estimate(setup_tot_exp_in_list[[30]]$Y, setup_tot_exp_in_list[[30]]$N0, setup_tot_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_in_est_sc50 <- sc_estimate(setup_tot_exp_in_list[[31]]$Y, setup_tot_exp_in_list[[31]]$N0, setup_tot_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_in_est_sc51 <- sc_estimate(setup_tot_exp_in_list[[32]]$Y, setup_tot_exp_in_list[[32]]$N0, setup_tot_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_in_est_sc53 <- sc_estimate(setup_tot_exp_in_list[[33]]$Y, setup_tot_exp_in_list[[33]]$N0, setup_tot_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_in_est_sc54 <- sc_estimate(setup_tot_exp_in_list[[34]]$Y, setup_tot_exp_in_list[[34]]$N0, setup_tot_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_in_est_sc55 <- sc_estimate(setup_tot_exp_in_list[[35]]$Y, setup_tot_exp_in_list[[35]]$N0, setup_tot_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_in_est_sc_list <- list(tot_exp_in_est_sc1,tot_exp_in_est_sc2,tot_exp_in_est_sc5,
                               tot_exp_in_est_sc10,tot_exp_in_est_sc11,tot_exp_in_est_sc12,
                               tot_exp_in_est_sc13,tot_exp_in_est_sc15,tot_exp_in_est_sc17,
                               tot_exp_in_est_sc19,tot_exp_in_est_sc21,tot_exp_in_est_sc23,
                               tot_exp_in_est_sc24,tot_exp_in_est_sc25,tot_exp_in_est_sc26,
                               tot_exp_in_est_sc28,tot_exp_in_est_sc29,tot_exp_in_est_sc30,
                               tot_exp_in_est_sc31,tot_exp_in_est_sc32,tot_exp_in_est_sc33,
                               tot_exp_in_est_sc34,tot_exp_in_est_sc36,tot_exp_in_est_sc37,
                               tot_exp_in_est_sc39,tot_exp_in_est_sc40,tot_exp_in_est_sc41,
                               tot_exp_in_est_sc44,tot_exp_in_est_sc45,tot_exp_in_est_sc47,
                               tot_exp_in_est_sc50,tot_exp_in_est_sc51,tot_exp_in_est_sc53,
                               tot_exp_in_est_sc54,tot_exp_in_est_sc55)
rm(tot_exp_in_est_sc1,tot_exp_in_est_sc2,tot_exp_in_est_sc5,
   tot_exp_in_est_sc10,tot_exp_in_est_sc11,tot_exp_in_est_sc12,
   tot_exp_in_est_sc13,tot_exp_in_est_sc15,tot_exp_in_est_sc17,
   tot_exp_in_est_sc19,tot_exp_in_est_sc21,tot_exp_in_est_sc23,
   tot_exp_in_est_sc24,tot_exp_in_est_sc25,tot_exp_in_est_sc26,
   tot_exp_in_est_sc28,tot_exp_in_est_sc29,tot_exp_in_est_sc30,
   tot_exp_in_est_sc31,tot_exp_in_est_sc32,tot_exp_in_est_sc33,
   tot_exp_in_est_sc34,tot_exp_in_est_sc36,tot_exp_in_est_sc37,
   tot_exp_in_est_sc39,tot_exp_in_est_sc40,tot_exp_in_est_sc41,
   tot_exp_in_est_sc44,tot_exp_in_est_sc45,tot_exp_in_est_sc47,
   tot_exp_in_est_sc50,tot_exp_in_est_sc51,tot_exp_in_est_sc53,
   tot_exp_in_est_sc54,tot_exp_in_est_sc55)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sc_plot", i), synthdid_plot(tot_exp_in_est_sc_list[i]))
}
tot_exp_in_est_sc_plot_data_aux1 <- ggplot_build(tot_exp_in_est_sc_plot1)
tot_exp_in_est_sc_plot_data_aux2 <- ggplot_build(tot_exp_in_est_sc_plot2)
tot_exp_in_est_sc_plot_data_aux3 <- ggplot_build(tot_exp_in_est_sc_plot3)
tot_exp_in_est_sc_plot_data_aux4 <- ggplot_build(tot_exp_in_est_sc_plot4)
tot_exp_in_est_sc_plot_data_aux5 <- ggplot_build(tot_exp_in_est_sc_plot5)
tot_exp_in_est_sc_plot_data_aux6 <- ggplot_build(tot_exp_in_est_sc_plot6)
tot_exp_in_est_sc_plot_data_aux7 <- ggplot_build(tot_exp_in_est_sc_plot7)
tot_exp_in_est_sc_plot_data_aux8 <- ggplot_build(tot_exp_in_est_sc_plot8)
tot_exp_in_est_sc_plot_data_aux9 <- ggplot_build(tot_exp_in_est_sc_plot9)
tot_exp_in_est_sc_plot_data_aux10 <- ggplot_build(tot_exp_in_est_sc_plot10)
tot_exp_in_est_sc_plot_data_aux11 <- ggplot_build(tot_exp_in_est_sc_plot11)
tot_exp_in_est_sc_plot_data_aux12 <- ggplot_build(tot_exp_in_est_sc_plot12)
tot_exp_in_est_sc_plot_data_aux13 <- ggplot_build(tot_exp_in_est_sc_plot13)
tot_exp_in_est_sc_plot_data_aux14 <- ggplot_build(tot_exp_in_est_sc_plot14)
tot_exp_in_est_sc_plot_data_aux15 <- ggplot_build(tot_exp_in_est_sc_plot15)
tot_exp_in_est_sc_plot_data_aux16 <- ggplot_build(tot_exp_in_est_sc_plot16)
tot_exp_in_est_sc_plot_data_aux17 <- ggplot_build(tot_exp_in_est_sc_plot17)
tot_exp_in_est_sc_plot_data_aux18 <- ggplot_build(tot_exp_in_est_sc_plot18)
tot_exp_in_est_sc_plot_data_aux19 <- ggplot_build(tot_exp_in_est_sc_plot19)
tot_exp_in_est_sc_plot_data_aux20 <- ggplot_build(tot_exp_in_est_sc_plot20)
tot_exp_in_est_sc_plot_data_aux21 <- ggplot_build(tot_exp_in_est_sc_plot21)
tot_exp_in_est_sc_plot_data_aux22 <- ggplot_build(tot_exp_in_est_sc_plot22)
tot_exp_in_est_sc_plot_data_aux23 <- ggplot_build(tot_exp_in_est_sc_plot23)
tot_exp_in_est_sc_plot_data_aux24 <- ggplot_build(tot_exp_in_est_sc_plot24)
tot_exp_in_est_sc_plot_data_aux25 <- ggplot_build(tot_exp_in_est_sc_plot25)
tot_exp_in_est_sc_plot_data_aux26 <- ggplot_build(tot_exp_in_est_sc_plot26)
tot_exp_in_est_sc_plot_data_aux27 <- ggplot_build(tot_exp_in_est_sc_plot27)
tot_exp_in_est_sc_plot_data_aux28 <- ggplot_build(tot_exp_in_est_sc_plot28)
tot_exp_in_est_sc_plot_data_aux29 <- ggplot_build(tot_exp_in_est_sc_plot29)
tot_exp_in_est_sc_plot_data_aux30 <- ggplot_build(tot_exp_in_est_sc_plot30)
tot_exp_in_est_sc_plot_data_aux31 <- ggplot_build(tot_exp_in_est_sc_plot31)
tot_exp_in_est_sc_plot_data_aux32 <- ggplot_build(tot_exp_in_est_sc_plot32)
tot_exp_in_est_sc_plot_data_aux33 <- ggplot_build(tot_exp_in_est_sc_plot33)
tot_exp_in_est_sc_plot_data_aux34 <- ggplot_build(tot_exp_in_est_sc_plot34)
tot_exp_in_est_sc_plot_data_aux35 <- ggplot_build(tot_exp_in_est_sc_plot35)
tot_exp_in_est_sc_plot_data_aux_list <- list(tot_exp_in_est_sc_plot_data_aux1,tot_exp_in_est_sc_plot_data_aux2,tot_exp_in_est_sc_plot_data_aux3,
                                             tot_exp_in_est_sc_plot_data_aux4,tot_exp_in_est_sc_plot_data_aux5,tot_exp_in_est_sc_plot_data_aux6,
                                             tot_exp_in_est_sc_plot_data_aux7,tot_exp_in_est_sc_plot_data_aux8,tot_exp_in_est_sc_plot_data_aux9,
                                             tot_exp_in_est_sc_plot_data_aux10,tot_exp_in_est_sc_plot_data_aux11,tot_exp_in_est_sc_plot_data_aux12,
                                             tot_exp_in_est_sc_plot_data_aux13,tot_exp_in_est_sc_plot_data_aux14,tot_exp_in_est_sc_plot_data_aux15,
                                             tot_exp_in_est_sc_plot_data_aux16,tot_exp_in_est_sc_plot_data_aux17,tot_exp_in_est_sc_plot_data_aux18,
                                             tot_exp_in_est_sc_plot_data_aux19,tot_exp_in_est_sc_plot_data_aux20,tot_exp_in_est_sc_plot_data_aux21,
                                             tot_exp_in_est_sc_plot_data_aux22,tot_exp_in_est_sc_plot_data_aux23,tot_exp_in_est_sc_plot_data_aux24,
                                             tot_exp_in_est_sc_plot_data_aux25,tot_exp_in_est_sc_plot_data_aux26,tot_exp_in_est_sc_plot_data_aux27,
                                             tot_exp_in_est_sc_plot_data_aux28,tot_exp_in_est_sc_plot_data_aux29,tot_exp_in_est_sc_plot_data_aux30,
                                             tot_exp_in_est_sc_plot_data_aux31,tot_exp_in_est_sc_plot_data_aux32,tot_exp_in_est_sc_plot_data_aux33,
                                             tot_exp_in_est_sc_plot_data_aux34,tot_exp_in_est_sc_plot_data_aux35)
rm(tot_exp_in_est_sc_plot_data_aux1,tot_exp_in_est_sc_plot_data_aux2,tot_exp_in_est_sc_plot_data_aux3,
   tot_exp_in_est_sc_plot_data_aux4,tot_exp_in_est_sc_plot_data_aux5,tot_exp_in_est_sc_plot_data_aux6,
   tot_exp_in_est_sc_plot_data_aux7,tot_exp_in_est_sc_plot_data_aux8,tot_exp_in_est_sc_plot_data_aux9,
   tot_exp_in_est_sc_plot_data_aux10,tot_exp_in_est_sc_plot_data_aux11,tot_exp_in_est_sc_plot_data_aux12,
   tot_exp_in_est_sc_plot_data_aux13,tot_exp_in_est_sc_plot_data_aux14,tot_exp_in_est_sc_plot_data_aux15,
   tot_exp_in_est_sc_plot_data_aux16,tot_exp_in_est_sc_plot_data_aux17,tot_exp_in_est_sc_plot_data_aux18,
   tot_exp_in_est_sc_plot_data_aux19,tot_exp_in_est_sc_plot_data_aux20,tot_exp_in_est_sc_plot_data_aux21,
   tot_exp_in_est_sc_plot_data_aux22,tot_exp_in_est_sc_plot_data_aux23,tot_exp_in_est_sc_plot_data_aux24,
   tot_exp_in_est_sc_plot_data_aux25,tot_exp_in_est_sc_plot_data_aux26,tot_exp_in_est_sc_plot_data_aux27,
   tot_exp_in_est_sc_plot_data_aux28,tot_exp_in_est_sc_plot_data_aux29,tot_exp_in_est_sc_plot_data_aux30,
   tot_exp_in_est_sc_plot_data_aux31,tot_exp_in_est_sc_plot_data_aux32,tot_exp_in_est_sc_plot_data_aux33,
   tot_exp_in_est_sc_plot_data_aux34,tot_exp_in_est_sc_plot_data_aux35)
rm(tot_exp_in_est_sc_plot1,tot_exp_in_est_sc_plot2,tot_exp_in_est_sc_plot3,
   tot_exp_in_est_sc_plot4,tot_exp_in_est_sc_plot5,tot_exp_in_est_sc_plot6,
   tot_exp_in_est_sc_plot7,tot_exp_in_est_sc_plot8,tot_exp_in_est_sc_plot9,
   tot_exp_in_est_sc_plot10,tot_exp_in_est_sc_plot11,tot_exp_in_est_sc_plot12,
   tot_exp_in_est_sc_plot13,tot_exp_in_est_sc_plot14,tot_exp_in_est_sc_plot15,
   tot_exp_in_est_sc_plot16,tot_exp_in_est_sc_plot17,tot_exp_in_est_sc_plot18,
   tot_exp_in_est_sc_plot19,tot_exp_in_est_sc_plot20,tot_exp_in_est_sc_plot21,
   tot_exp_in_est_sc_plot22,tot_exp_in_est_sc_plot23,tot_exp_in_est_sc_plot24,
   tot_exp_in_est_sc_plot25,tot_exp_in_est_sc_plot26,tot_exp_in_est_sc_plot27,
   tot_exp_in_est_sc_plot28,tot_exp_in_est_sc_plot29,tot_exp_in_est_sc_plot30,
   tot_exp_in_est_sc_plot31,tot_exp_in_est_sc_plot32,tot_exp_in_est_sc_plot33,
   tot_exp_in_est_sc_plot34,tot_exp_in_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sc_plot_data_long", i), data.frame(tot_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_in_est_sc_plot_data_long_list <- list(tot_exp_in_est_sc_plot_data_long1,tot_exp_in_est_sc_plot_data_long2,tot_exp_in_est_sc_plot_data_long3,
                                              tot_exp_in_est_sc_plot_data_long4,tot_exp_in_est_sc_plot_data_long5,tot_exp_in_est_sc_plot_data_long6,
                                              tot_exp_in_est_sc_plot_data_long7,tot_exp_in_est_sc_plot_data_long8,tot_exp_in_est_sc_plot_data_long9,
                                              tot_exp_in_est_sc_plot_data_long10,tot_exp_in_est_sc_plot_data_long11,tot_exp_in_est_sc_plot_data_long12,
                                              tot_exp_in_est_sc_plot_data_long13,tot_exp_in_est_sc_plot_data_long14,tot_exp_in_est_sc_plot_data_long15,
                                              tot_exp_in_est_sc_plot_data_long16,tot_exp_in_est_sc_plot_data_long17,tot_exp_in_est_sc_plot_data_long18,
                                              tot_exp_in_est_sc_plot_data_long19,tot_exp_in_est_sc_plot_data_long20,tot_exp_in_est_sc_plot_data_long21,
                                              tot_exp_in_est_sc_plot_data_long22,tot_exp_in_est_sc_plot_data_long23,tot_exp_in_est_sc_plot_data_long24,
                                              tot_exp_in_est_sc_plot_data_long25,tot_exp_in_est_sc_plot_data_long26,tot_exp_in_est_sc_plot_data_long27,
                                              tot_exp_in_est_sc_plot_data_long28,tot_exp_in_est_sc_plot_data_long29,tot_exp_in_est_sc_plot_data_long30,
                                              tot_exp_in_est_sc_plot_data_long31,tot_exp_in_est_sc_plot_data_long32,tot_exp_in_est_sc_plot_data_long33,
                                              tot_exp_in_est_sc_plot_data_long34,tot_exp_in_est_sc_plot_data_long35)
rm(tot_exp_in_est_sc_plot_data_long1,tot_exp_in_est_sc_plot_data_long2,tot_exp_in_est_sc_plot_data_long3,
   tot_exp_in_est_sc_plot_data_long4,tot_exp_in_est_sc_plot_data_long5,tot_exp_in_est_sc_plot_data_long6,
   tot_exp_in_est_sc_plot_data_long7,tot_exp_in_est_sc_plot_data_long8,tot_exp_in_est_sc_plot_data_long9,
   tot_exp_in_est_sc_plot_data_long10,tot_exp_in_est_sc_plot_data_long11,tot_exp_in_est_sc_plot_data_long12,
   tot_exp_in_est_sc_plot_data_long13,tot_exp_in_est_sc_plot_data_long14,tot_exp_in_est_sc_plot_data_long15,
   tot_exp_in_est_sc_plot_data_long16,tot_exp_in_est_sc_plot_data_long17,tot_exp_in_est_sc_plot_data_long18,
   tot_exp_in_est_sc_plot_data_long19,tot_exp_in_est_sc_plot_data_long20,tot_exp_in_est_sc_plot_data_long21,
   tot_exp_in_est_sc_plot_data_long22,tot_exp_in_est_sc_plot_data_long23,tot_exp_in_est_sc_plot_data_long24,
   tot_exp_in_est_sc_plot_data_long25,tot_exp_in_est_sc_plot_data_long26,tot_exp_in_est_sc_plot_data_long27,
   tot_exp_in_est_sc_plot_data_long28,tot_exp_in_est_sc_plot_data_long29,tot_exp_in_est_sc_plot_data_long30,
   tot_exp_in_est_sc_plot_data_long31,tot_exp_in_est_sc_plot_data_long32,tot_exp_in_est_sc_plot_data_long33,
   tot_exp_in_est_sc_plot_data_long34,tot_exp_in_est_sc_plot_data_long35)
tot_exp_in_est_sc_plot_data_long_list <- lapply(tot_exp_in_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sc_plot_data_wide", i), reshape(data=tot_exp_in_est_sc_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
tot_exp_in_est_sc_plot_data_wide_list <- list(tot_exp_in_est_sc_plot_data_wide1,tot_exp_in_est_sc_plot_data_wide2,tot_exp_in_est_sc_plot_data_wide3,
                                              tot_exp_in_est_sc_plot_data_wide4,tot_exp_in_est_sc_plot_data_wide5,tot_exp_in_est_sc_plot_data_wide6,
                                              tot_exp_in_est_sc_plot_data_wide7,tot_exp_in_est_sc_plot_data_wide8,tot_exp_in_est_sc_plot_data_wide9,
                                              tot_exp_in_est_sc_plot_data_wide10,tot_exp_in_est_sc_plot_data_wide11,tot_exp_in_est_sc_plot_data_wide12,
                                              tot_exp_in_est_sc_plot_data_wide13,tot_exp_in_est_sc_plot_data_wide14,tot_exp_in_est_sc_plot_data_wide15,
                                              tot_exp_in_est_sc_plot_data_wide16,tot_exp_in_est_sc_plot_data_wide17,tot_exp_in_est_sc_plot_data_wide18,
                                              tot_exp_in_est_sc_plot_data_wide19,tot_exp_in_est_sc_plot_data_wide20,tot_exp_in_est_sc_plot_data_wide21,
                                              tot_exp_in_est_sc_plot_data_wide22,tot_exp_in_est_sc_plot_data_wide23,tot_exp_in_est_sc_plot_data_wide24,
                                              tot_exp_in_est_sc_plot_data_wide25,tot_exp_in_est_sc_plot_data_wide26,tot_exp_in_est_sc_plot_data_wide27,
                                              tot_exp_in_est_sc_plot_data_wide28,tot_exp_in_est_sc_plot_data_wide29,tot_exp_in_est_sc_plot_data_wide30,
                                              tot_exp_in_est_sc_plot_data_wide31,tot_exp_in_est_sc_plot_data_wide32,tot_exp_in_est_sc_plot_data_wide33,
                                              tot_exp_in_est_sc_plot_data_wide34,tot_exp_in_est_sc_plot_data_wide35)
rm(tot_exp_in_est_sc_plot_data_wide1,tot_exp_in_est_sc_plot_data_wide2,tot_exp_in_est_sc_plot_data_wide3,
   tot_exp_in_est_sc_plot_data_wide4,tot_exp_in_est_sc_plot_data_wide5,tot_exp_in_est_sc_plot_data_wide6,
   tot_exp_in_est_sc_plot_data_wide7,tot_exp_in_est_sc_plot_data_wide8,tot_exp_in_est_sc_plot_data_wide9,
   tot_exp_in_est_sc_plot_data_wide10,tot_exp_in_est_sc_plot_data_wide11,tot_exp_in_est_sc_plot_data_wide12,
   tot_exp_in_est_sc_plot_data_wide13,tot_exp_in_est_sc_plot_data_wide14,tot_exp_in_est_sc_plot_data_wide15,
   tot_exp_in_est_sc_plot_data_wide16,tot_exp_in_est_sc_plot_data_wide17,tot_exp_in_est_sc_plot_data_wide18,
   tot_exp_in_est_sc_plot_data_wide19,tot_exp_in_est_sc_plot_data_wide20,tot_exp_in_est_sc_plot_data_wide21,
   tot_exp_in_est_sc_plot_data_wide22,tot_exp_in_est_sc_plot_data_wide23,tot_exp_in_est_sc_plot_data_wide24,
   tot_exp_in_est_sc_plot_data_wide25,tot_exp_in_est_sc_plot_data_wide26,tot_exp_in_est_sc_plot_data_wide27,
   tot_exp_in_est_sc_plot_data_wide28,tot_exp_in_est_sc_plot_data_wide29,tot_exp_in_est_sc_plot_data_wide30,
   tot_exp_in_est_sc_plot_data_wide31,tot_exp_in_est_sc_plot_data_wide32,tot_exp_in_est_sc_plot_data_wide33,
   tot_exp_in_est_sc_plot_data_wide34,tot_exp_in_est_sc_plot_data_wide35)
tot_exp_in_est_sc_plot_data_wide_list <- lapply(tot_exp_in_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
tot_exp_in_est_sdid1 <- synthdid_estimate(setup_tot_exp_in_list[[1]]$Y, setup_tot_exp_in_list[[1]]$N0, setup_tot_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_in_est_sdid2 <- synthdid_estimate(setup_tot_exp_in_list[[2]]$Y, setup_tot_exp_in_list[[2]]$N0, setup_tot_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_in_est_sdid5 <- synthdid_estimate(setup_tot_exp_in_list[[3]]$Y, setup_tot_exp_in_list[[3]]$N0, setup_tot_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_in_est_sdid10 <- synthdid_estimate(setup_tot_exp_in_list[[4]]$Y, setup_tot_exp_in_list[[4]]$N0, setup_tot_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_in_est_sdid11 <- synthdid_estimate(setup_tot_exp_in_list[[5]]$Y, setup_tot_exp_in_list[[5]]$N0, setup_tot_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_in_est_sdid12 <- synthdid_estimate(setup_tot_exp_in_list[[6]]$Y, setup_tot_exp_in_list[[6]]$N0, setup_tot_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_in_est_sdid13 <- synthdid_estimate(setup_tot_exp_in_list[[7]]$Y, setup_tot_exp_in_list[[7]]$N0, setup_tot_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_in_est_sdid15 <- synthdid_estimate(setup_tot_exp_in_list[[8]]$Y, setup_tot_exp_in_list[[8]]$N0, setup_tot_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_in_est_sdid17 <- synthdid_estimate(setup_tot_exp_in_list[[9]]$Y, setup_tot_exp_in_list[[9]]$N0, setup_tot_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_in_est_sdid19 <- synthdid_estimate(setup_tot_exp_in_list[[10]]$Y, setup_tot_exp_in_list[[10]]$N0, setup_tot_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_in_est_sdid21 <- synthdid_estimate(setup_tot_exp_in_list[[11]]$Y, setup_tot_exp_in_list[[11]]$N0, setup_tot_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_in_est_sdid23 <- synthdid_estimate(setup_tot_exp_in_list[[12]]$Y, setup_tot_exp_in_list[[12]]$N0, setup_tot_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_in_est_sdid24 <- synthdid_estimate(setup_tot_exp_in_list[[13]]$Y, setup_tot_exp_in_list[[13]]$N0, setup_tot_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_in_est_sdid25 <- synthdid_estimate(setup_tot_exp_in_list[[14]]$Y, setup_tot_exp_in_list[[14]]$N0, setup_tot_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_in_est_sdid26 <- synthdid_estimate(setup_tot_exp_in_list[[15]]$Y, setup_tot_exp_in_list[[15]]$N0, setup_tot_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_in_est_sdid28 <- synthdid_estimate(setup_tot_exp_in_list[[16]]$Y, setup_tot_exp_in_list[[16]]$N0, setup_tot_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_in_est_sdid29 <- synthdid_estimate(setup_tot_exp_in_list[[17]]$Y, setup_tot_exp_in_list[[17]]$N0, setup_tot_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_in_est_sdid30 <- synthdid_estimate(setup_tot_exp_in_list[[18]]$Y, setup_tot_exp_in_list[[18]]$N0, setup_tot_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_in_est_sdid31 <- synthdid_estimate(setup_tot_exp_in_list[[19]]$Y, setup_tot_exp_in_list[[19]]$N0, setup_tot_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_in_est_sdid32 <- synthdid_estimate(setup_tot_exp_in_list[[20]]$Y, setup_tot_exp_in_list[[20]]$N0, setup_tot_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_in_est_sdid33 <- synthdid_estimate(setup_tot_exp_in_list[[21]]$Y, setup_tot_exp_in_list[[21]]$N0, setup_tot_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_in_est_sdid34 <- synthdid_estimate(setup_tot_exp_in_list[[22]]$Y, setup_tot_exp_in_list[[22]]$N0, setup_tot_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_in_est_sdid36 <- synthdid_estimate(setup_tot_exp_in_list[[23]]$Y, setup_tot_exp_in_list[[23]]$N0, setup_tot_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_in_est_sdid37 <- synthdid_estimate(setup_tot_exp_in_list[[24]]$Y, setup_tot_exp_in_list[[24]]$N0, setup_tot_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_in_est_sdid39 <- synthdid_estimate(setup_tot_exp_in_list[[25]]$Y, setup_tot_exp_in_list[[25]]$N0, setup_tot_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_in_est_sdid40 <- synthdid_estimate(setup_tot_exp_in_list[[26]]$Y, setup_tot_exp_in_list[[26]]$N0, setup_tot_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_in_est_sdid41 <- synthdid_estimate(setup_tot_exp_in_list[[27]]$Y, setup_tot_exp_in_list[[27]]$N0, setup_tot_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_in_est_sdid44 <- synthdid_estimate(setup_tot_exp_in_list[[28]]$Y, setup_tot_exp_in_list[[28]]$N0, setup_tot_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_in_est_sdid45 <- synthdid_estimate(setup_tot_exp_in_list[[29]]$Y, setup_tot_exp_in_list[[29]]$N0, setup_tot_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_in_est_sdid47 <- synthdid_estimate(setup_tot_exp_in_list[[30]]$Y, setup_tot_exp_in_list[[30]]$N0, setup_tot_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_in_est_sdid50 <- synthdid_estimate(setup_tot_exp_in_list[[31]]$Y, setup_tot_exp_in_list[[31]]$N0, setup_tot_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_in_est_sdid51 <- synthdid_estimate(setup_tot_exp_in_list[[32]]$Y, setup_tot_exp_in_list[[32]]$N0, setup_tot_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_in_est_sdid53 <- synthdid_estimate(setup_tot_exp_in_list[[33]]$Y, setup_tot_exp_in_list[[33]]$N0, setup_tot_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_in_est_sdid54 <- synthdid_estimate(setup_tot_exp_in_list[[34]]$Y, setup_tot_exp_in_list[[34]]$N0, setup_tot_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_in_est_sdid55 <- synthdid_estimate(setup_tot_exp_in_list[[35]]$Y, setup_tot_exp_in_list[[35]]$N0, setup_tot_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_in_est_sdid_list <- list(tot_exp_in_est_sdid1,tot_exp_in_est_sdid2,tot_exp_in_est_sdid5,
                                 tot_exp_in_est_sdid10,tot_exp_in_est_sdid11,tot_exp_in_est_sdid12,
                                 tot_exp_in_est_sdid13,tot_exp_in_est_sdid15,tot_exp_in_est_sdid17,
                                 tot_exp_in_est_sdid19,tot_exp_in_est_sdid21,tot_exp_in_est_sdid23,
                                 tot_exp_in_est_sdid24,tot_exp_in_est_sdid25,tot_exp_in_est_sdid26,
                                 tot_exp_in_est_sdid28,tot_exp_in_est_sdid29,tot_exp_in_est_sdid30,
                                 tot_exp_in_est_sdid31,tot_exp_in_est_sdid32,tot_exp_in_est_sdid33,
                                 tot_exp_in_est_sdid34,tot_exp_in_est_sdid36,tot_exp_in_est_sdid37,
                                 tot_exp_in_est_sdid39,tot_exp_in_est_sdid40,tot_exp_in_est_sdid41,
                                 tot_exp_in_est_sdid44,tot_exp_in_est_sdid45,tot_exp_in_est_sdid47,
                                 tot_exp_in_est_sdid50,tot_exp_in_est_sdid51,tot_exp_in_est_sdid53,
                                 tot_exp_in_est_sdid54,tot_exp_in_est_sdid55)
rm(tot_exp_in_est_sdid1,tot_exp_in_est_sdid2,tot_exp_in_est_sdid5,
   tot_exp_in_est_sdid10,tot_exp_in_est_sdid11,tot_exp_in_est_sdid12,
   tot_exp_in_est_sdid13,tot_exp_in_est_sdid15,tot_exp_in_est_sdid17,
   tot_exp_in_est_sdid19,tot_exp_in_est_sdid21,tot_exp_in_est_sdid23,
   tot_exp_in_est_sdid24,tot_exp_in_est_sdid25,tot_exp_in_est_sdid26,
   tot_exp_in_est_sdid28,tot_exp_in_est_sdid29,tot_exp_in_est_sdid30,
   tot_exp_in_est_sdid31,tot_exp_in_est_sdid32,tot_exp_in_est_sdid33,
   tot_exp_in_est_sdid34,tot_exp_in_est_sdid36,tot_exp_in_est_sdid37,
   tot_exp_in_est_sdid39,tot_exp_in_est_sdid40,tot_exp_in_est_sdid41,
   tot_exp_in_est_sdid44,tot_exp_in_est_sdid45,tot_exp_in_est_sdid47,
   tot_exp_in_est_sdid50,tot_exp_in_est_sdid51,tot_exp_in_est_sdid53,
   tot_exp_in_est_sdid54,tot_exp_in_est_sdid55)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sdid_plot", i), synthdid_plot(tot_exp_in_est_sdid_list[i]))
}
tot_exp_in_est_sdid_plot_data_aux1 <- ggplot_build(tot_exp_in_est_sdid_plot1)
tot_exp_in_est_sdid_plot_data_aux2 <- ggplot_build(tot_exp_in_est_sdid_plot2)
tot_exp_in_est_sdid_plot_data_aux3 <- ggplot_build(tot_exp_in_est_sdid_plot3)
tot_exp_in_est_sdid_plot_data_aux4 <- ggplot_build(tot_exp_in_est_sdid_plot4)
tot_exp_in_est_sdid_plot_data_aux5 <- ggplot_build(tot_exp_in_est_sdid_plot5)
tot_exp_in_est_sdid_plot_data_aux6 <- ggplot_build(tot_exp_in_est_sdid_plot6)
tot_exp_in_est_sdid_plot_data_aux7 <- ggplot_build(tot_exp_in_est_sdid_plot7)
tot_exp_in_est_sdid_plot_data_aux8 <- ggplot_build(tot_exp_in_est_sdid_plot8)
tot_exp_in_est_sdid_plot_data_aux9 <- ggplot_build(tot_exp_in_est_sdid_plot9)
tot_exp_in_est_sdid_plot_data_aux10 <- ggplot_build(tot_exp_in_est_sdid_plot10)
tot_exp_in_est_sdid_plot_data_aux11 <- ggplot_build(tot_exp_in_est_sdid_plot11)
tot_exp_in_est_sdid_plot_data_aux12 <- ggplot_build(tot_exp_in_est_sdid_plot12)
tot_exp_in_est_sdid_plot_data_aux13 <- ggplot_build(tot_exp_in_est_sdid_plot13)
tot_exp_in_est_sdid_plot_data_aux14 <- ggplot_build(tot_exp_in_est_sdid_plot14)
tot_exp_in_est_sdid_plot_data_aux15 <- ggplot_build(tot_exp_in_est_sdid_plot15)
tot_exp_in_est_sdid_plot_data_aux16 <- ggplot_build(tot_exp_in_est_sdid_plot16)
tot_exp_in_est_sdid_plot_data_aux17 <- ggplot_build(tot_exp_in_est_sdid_plot17)
tot_exp_in_est_sdid_plot_data_aux18 <- ggplot_build(tot_exp_in_est_sdid_plot18)
tot_exp_in_est_sdid_plot_data_aux19 <- ggplot_build(tot_exp_in_est_sdid_plot19)
tot_exp_in_est_sdid_plot_data_aux20 <- ggplot_build(tot_exp_in_est_sdid_plot20)
tot_exp_in_est_sdid_plot_data_aux21 <- ggplot_build(tot_exp_in_est_sdid_plot21)
tot_exp_in_est_sdid_plot_data_aux22 <- ggplot_build(tot_exp_in_est_sdid_plot22)
tot_exp_in_est_sdid_plot_data_aux23 <- ggplot_build(tot_exp_in_est_sdid_plot23)
tot_exp_in_est_sdid_plot_data_aux24 <- ggplot_build(tot_exp_in_est_sdid_plot24)
tot_exp_in_est_sdid_plot_data_aux25 <- ggplot_build(tot_exp_in_est_sdid_plot25)
tot_exp_in_est_sdid_plot_data_aux26 <- ggplot_build(tot_exp_in_est_sdid_plot26)
tot_exp_in_est_sdid_plot_data_aux27 <- ggplot_build(tot_exp_in_est_sdid_plot27)
tot_exp_in_est_sdid_plot_data_aux28 <- ggplot_build(tot_exp_in_est_sdid_plot28)
tot_exp_in_est_sdid_plot_data_aux29 <- ggplot_build(tot_exp_in_est_sdid_plot29)
tot_exp_in_est_sdid_plot_data_aux30 <- ggplot_build(tot_exp_in_est_sdid_plot30)
tot_exp_in_est_sdid_plot_data_aux31 <- ggplot_build(tot_exp_in_est_sdid_plot31)
tot_exp_in_est_sdid_plot_data_aux32 <- ggplot_build(tot_exp_in_est_sdid_plot32)
tot_exp_in_est_sdid_plot_data_aux33 <- ggplot_build(tot_exp_in_est_sdid_plot33)
tot_exp_in_est_sdid_plot_data_aux34 <- ggplot_build(tot_exp_in_est_sdid_plot34)
tot_exp_in_est_sdid_plot_data_aux35 <- ggplot_build(tot_exp_in_est_sdid_plot35)
tot_exp_in_est_sdid_plot_data_aux_list <- list(tot_exp_in_est_sdid_plot_data_aux1,tot_exp_in_est_sdid_plot_data_aux2,tot_exp_in_est_sdid_plot_data_aux3,
                                               tot_exp_in_est_sdid_plot_data_aux4,tot_exp_in_est_sdid_plot_data_aux5,tot_exp_in_est_sdid_plot_data_aux6,
                                               tot_exp_in_est_sdid_plot_data_aux7,tot_exp_in_est_sdid_plot_data_aux8,tot_exp_in_est_sdid_plot_data_aux9,
                                               tot_exp_in_est_sdid_plot_data_aux10,tot_exp_in_est_sdid_plot_data_aux11,tot_exp_in_est_sdid_plot_data_aux12,
                                               tot_exp_in_est_sdid_plot_data_aux13,tot_exp_in_est_sdid_plot_data_aux14,tot_exp_in_est_sdid_plot_data_aux15,
                                               tot_exp_in_est_sdid_plot_data_aux16,tot_exp_in_est_sdid_plot_data_aux17,tot_exp_in_est_sdid_plot_data_aux18,
                                               tot_exp_in_est_sdid_plot_data_aux19,tot_exp_in_est_sdid_plot_data_aux20,tot_exp_in_est_sdid_plot_data_aux21,
                                               tot_exp_in_est_sdid_plot_data_aux22,tot_exp_in_est_sdid_plot_data_aux23,tot_exp_in_est_sdid_plot_data_aux24,
                                               tot_exp_in_est_sdid_plot_data_aux25,tot_exp_in_est_sdid_plot_data_aux26,tot_exp_in_est_sdid_plot_data_aux27,
                                               tot_exp_in_est_sdid_plot_data_aux28,tot_exp_in_est_sdid_plot_data_aux29,tot_exp_in_est_sdid_plot_data_aux30,
                                               tot_exp_in_est_sdid_plot_data_aux31,tot_exp_in_est_sdid_plot_data_aux32,tot_exp_in_est_sdid_plot_data_aux33,
                                               tot_exp_in_est_sdid_plot_data_aux34,tot_exp_in_est_sdid_plot_data_aux35)
rm(tot_exp_in_est_sdid_plot_data_aux1,tot_exp_in_est_sdid_plot_data_aux2,tot_exp_in_est_sdid_plot_data_aux3,
   tot_exp_in_est_sdid_plot_data_aux4,tot_exp_in_est_sdid_plot_data_aux5,tot_exp_in_est_sdid_plot_data_aux6,
   tot_exp_in_est_sdid_plot_data_aux7,tot_exp_in_est_sdid_plot_data_aux8,tot_exp_in_est_sdid_plot_data_aux9,
   tot_exp_in_est_sdid_plot_data_aux10,tot_exp_in_est_sdid_plot_data_aux11,tot_exp_in_est_sdid_plot_data_aux12,
   tot_exp_in_est_sdid_plot_data_aux13,tot_exp_in_est_sdid_plot_data_aux14,tot_exp_in_est_sdid_plot_data_aux15,
   tot_exp_in_est_sdid_plot_data_aux16,tot_exp_in_est_sdid_plot_data_aux17,tot_exp_in_est_sdid_plot_data_aux18,
   tot_exp_in_est_sdid_plot_data_aux19,tot_exp_in_est_sdid_plot_data_aux20,tot_exp_in_est_sdid_plot_data_aux21,
   tot_exp_in_est_sdid_plot_data_aux22,tot_exp_in_est_sdid_plot_data_aux23,tot_exp_in_est_sdid_plot_data_aux24,
   tot_exp_in_est_sdid_plot_data_aux25,tot_exp_in_est_sdid_plot_data_aux26,tot_exp_in_est_sdid_plot_data_aux27,
   tot_exp_in_est_sdid_plot_data_aux28,tot_exp_in_est_sdid_plot_data_aux29,tot_exp_in_est_sdid_plot_data_aux30,
   tot_exp_in_est_sdid_plot_data_aux31,tot_exp_in_est_sdid_plot_data_aux32,tot_exp_in_est_sdid_plot_data_aux33,
   tot_exp_in_est_sdid_plot_data_aux34,tot_exp_in_est_sdid_plot_data_aux35)
rm(tot_exp_in_est_sdid_plot1,tot_exp_in_est_sdid_plot2,tot_exp_in_est_sdid_plot3,
   tot_exp_in_est_sdid_plot4,tot_exp_in_est_sdid_plot5,tot_exp_in_est_sdid_plot6,
   tot_exp_in_est_sdid_plot7,tot_exp_in_est_sdid_plot8,tot_exp_in_est_sdid_plot9,
   tot_exp_in_est_sdid_plot10,tot_exp_in_est_sdid_plot11,tot_exp_in_est_sdid_plot12,
   tot_exp_in_est_sdid_plot13,tot_exp_in_est_sdid_plot14,tot_exp_in_est_sdid_plot15,
   tot_exp_in_est_sdid_plot16,tot_exp_in_est_sdid_plot17,tot_exp_in_est_sdid_plot18,
   tot_exp_in_est_sdid_plot19,tot_exp_in_est_sdid_plot20,tot_exp_in_est_sdid_plot21,
   tot_exp_in_est_sdid_plot22,tot_exp_in_est_sdid_plot23,tot_exp_in_est_sdid_plot24,
   tot_exp_in_est_sdid_plot25,tot_exp_in_est_sdid_plot26,tot_exp_in_est_sdid_plot27,
   tot_exp_in_est_sdid_plot28,tot_exp_in_est_sdid_plot29,tot_exp_in_est_sdid_plot30,
   tot_exp_in_est_sdid_plot31,tot_exp_in_est_sdid_plot32,tot_exp_in_est_sdid_plot33,
   tot_exp_in_est_sdid_plot34,tot_exp_in_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sdid_plot_data_long", i), data.frame(tot_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_in_est_sdid_plot_data_long_list <- list(tot_exp_in_est_sdid_plot_data_long1,tot_exp_in_est_sdid_plot_data_long2,tot_exp_in_est_sdid_plot_data_long3,
                                                tot_exp_in_est_sdid_plot_data_long4,tot_exp_in_est_sdid_plot_data_long5,tot_exp_in_est_sdid_plot_data_long6,
                                                tot_exp_in_est_sdid_plot_data_long7,tot_exp_in_est_sdid_plot_data_long8,tot_exp_in_est_sdid_plot_data_long9,
                                                tot_exp_in_est_sdid_plot_data_long10,tot_exp_in_est_sdid_plot_data_long11,tot_exp_in_est_sdid_plot_data_long12,
                                                tot_exp_in_est_sdid_plot_data_long13,tot_exp_in_est_sdid_plot_data_long14,tot_exp_in_est_sdid_plot_data_long15,
                                                tot_exp_in_est_sdid_plot_data_long16,tot_exp_in_est_sdid_plot_data_long17,tot_exp_in_est_sdid_plot_data_long18,
                                                tot_exp_in_est_sdid_plot_data_long19,tot_exp_in_est_sdid_plot_data_long20,tot_exp_in_est_sdid_plot_data_long21,
                                                tot_exp_in_est_sdid_plot_data_long22,tot_exp_in_est_sdid_plot_data_long23,tot_exp_in_est_sdid_plot_data_long24,
                                                tot_exp_in_est_sdid_plot_data_long25,tot_exp_in_est_sdid_plot_data_long26,tot_exp_in_est_sdid_plot_data_long27,
                                                tot_exp_in_est_sdid_plot_data_long28,tot_exp_in_est_sdid_plot_data_long29,tot_exp_in_est_sdid_plot_data_long30,
                                                tot_exp_in_est_sdid_plot_data_long31,tot_exp_in_est_sdid_plot_data_long32,tot_exp_in_est_sdid_plot_data_long33,
                                                tot_exp_in_est_sdid_plot_data_long34,tot_exp_in_est_sdid_plot_data_long35)
rm(tot_exp_in_est_sdid_plot_data_long1,tot_exp_in_est_sdid_plot_data_long2,tot_exp_in_est_sdid_plot_data_long3,
   tot_exp_in_est_sdid_plot_data_long4,tot_exp_in_est_sdid_plot_data_long5,tot_exp_in_est_sdid_plot_data_long6,
   tot_exp_in_est_sdid_plot_data_long7,tot_exp_in_est_sdid_plot_data_long8,tot_exp_in_est_sdid_plot_data_long9,
   tot_exp_in_est_sdid_plot_data_long10,tot_exp_in_est_sdid_plot_data_long11,tot_exp_in_est_sdid_plot_data_long12,
   tot_exp_in_est_sdid_plot_data_long13,tot_exp_in_est_sdid_plot_data_long14,tot_exp_in_est_sdid_plot_data_long15,
   tot_exp_in_est_sdid_plot_data_long16,tot_exp_in_est_sdid_plot_data_long17,tot_exp_in_est_sdid_plot_data_long18,
   tot_exp_in_est_sdid_plot_data_long19,tot_exp_in_est_sdid_plot_data_long20,tot_exp_in_est_sdid_plot_data_long21,
   tot_exp_in_est_sdid_plot_data_long22,tot_exp_in_est_sdid_plot_data_long23,tot_exp_in_est_sdid_plot_data_long24,
   tot_exp_in_est_sdid_plot_data_long25,tot_exp_in_est_sdid_plot_data_long26,tot_exp_in_est_sdid_plot_data_long27,
   tot_exp_in_est_sdid_plot_data_long28,tot_exp_in_est_sdid_plot_data_long29,tot_exp_in_est_sdid_plot_data_long30,
   tot_exp_in_est_sdid_plot_data_long31,tot_exp_in_est_sdid_plot_data_long32,tot_exp_in_est_sdid_plot_data_long33,
   tot_exp_in_est_sdid_plot_data_long34,tot_exp_in_est_sdid_plot_data_long35)
tot_exp_in_est_sdid_plot_data_long_list <- lapply(tot_exp_in_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_in_est_sdid_plot_data_wide", i), reshape(data=tot_exp_in_est_sdid_plot_data_long_list[[i]],
                                                                  idvar = "year",
                                                                  v.names = "outcome",
                                                                  timevar = "treated",
                                                                  direction = "wide"))
}
tot_exp_in_est_sdid_plot_data_wide_list <- list(tot_exp_in_est_sdid_plot_data_wide1,tot_exp_in_est_sdid_plot_data_wide2,tot_exp_in_est_sdid_plot_data_wide3,
                                                tot_exp_in_est_sdid_plot_data_wide4,tot_exp_in_est_sdid_plot_data_wide5,tot_exp_in_est_sdid_plot_data_wide6,
                                                tot_exp_in_est_sdid_plot_data_wide7,tot_exp_in_est_sdid_plot_data_wide8,tot_exp_in_est_sdid_plot_data_wide9,
                                                tot_exp_in_est_sdid_plot_data_wide10,tot_exp_in_est_sdid_plot_data_wide11,tot_exp_in_est_sdid_plot_data_wide12,
                                                tot_exp_in_est_sdid_plot_data_wide13,tot_exp_in_est_sdid_plot_data_wide14,tot_exp_in_est_sdid_plot_data_wide15,
                                                tot_exp_in_est_sdid_plot_data_wide16,tot_exp_in_est_sdid_plot_data_wide17,tot_exp_in_est_sdid_plot_data_wide18,
                                                tot_exp_in_est_sdid_plot_data_wide19,tot_exp_in_est_sdid_plot_data_wide20,tot_exp_in_est_sdid_plot_data_wide21,
                                                tot_exp_in_est_sdid_plot_data_wide22,tot_exp_in_est_sdid_plot_data_wide23,tot_exp_in_est_sdid_plot_data_wide24,
                                                tot_exp_in_est_sdid_plot_data_wide25,tot_exp_in_est_sdid_plot_data_wide26,tot_exp_in_est_sdid_plot_data_wide27,
                                                tot_exp_in_est_sdid_plot_data_wide28,tot_exp_in_est_sdid_plot_data_wide29,tot_exp_in_est_sdid_plot_data_wide30,
                                                tot_exp_in_est_sdid_plot_data_wide31,tot_exp_in_est_sdid_plot_data_wide32,tot_exp_in_est_sdid_plot_data_wide33,
                                                tot_exp_in_est_sdid_plot_data_wide34,tot_exp_in_est_sdid_plot_data_wide35)
rm(tot_exp_in_est_sdid_plot_data_wide1,tot_exp_in_est_sdid_plot_data_wide2,tot_exp_in_est_sdid_plot_data_wide3,
   tot_exp_in_est_sdid_plot_data_wide4,tot_exp_in_est_sdid_plot_data_wide5,tot_exp_in_est_sdid_plot_data_wide6,
   tot_exp_in_est_sdid_plot_data_wide7,tot_exp_in_est_sdid_plot_data_wide8,tot_exp_in_est_sdid_plot_data_wide9,
   tot_exp_in_est_sdid_plot_data_wide10,tot_exp_in_est_sdid_plot_data_wide11,tot_exp_in_est_sdid_plot_data_wide12,
   tot_exp_in_est_sdid_plot_data_wide13,tot_exp_in_est_sdid_plot_data_wide14,tot_exp_in_est_sdid_plot_data_wide15,
   tot_exp_in_est_sdid_plot_data_wide16,tot_exp_in_est_sdid_plot_data_wide17,tot_exp_in_est_sdid_plot_data_wide18,
   tot_exp_in_est_sdid_plot_data_wide19,tot_exp_in_est_sdid_plot_data_wide20,tot_exp_in_est_sdid_plot_data_wide21,
   tot_exp_in_est_sdid_plot_data_wide22,tot_exp_in_est_sdid_plot_data_wide23,tot_exp_in_est_sdid_plot_data_wide24,
   tot_exp_in_est_sdid_plot_data_wide25,tot_exp_in_est_sdid_plot_data_wide26,tot_exp_in_est_sdid_plot_data_wide27,
   tot_exp_in_est_sdid_plot_data_wide28,tot_exp_in_est_sdid_plot_data_wide29,tot_exp_in_est_sdid_plot_data_wide30,
   tot_exp_in_est_sdid_plot_data_wide31,tot_exp_in_est_sdid_plot_data_wide32,tot_exp_in_est_sdid_plot_data_wide33,
   tot_exp_in_est_sdid_plot_data_wide34,tot_exp_in_est_sdid_plot_data_wide35)
tot_exp_in_est_sdid_plot_data_wide_list <- lapply(tot_exp_in_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
tot_exp_est_did_plot_data_wide_in$did_facet_title <- "Diff-in-Diff"
tot_exp_est_sc_plot_data_wide_in$sc_facet_title <- "Synthetic Control"
tot_exp_est_sdid_plot_data_wide_in$sdid_facet_title <- "Synthetic Diff-in-Diff"
tot_exp_est_did_plot_data_wide_in$diff_relative <- tot_exp_est_did_plot_data_wide_in$diff - tot_exp_est_did_plot_data_wide_in$diff[19]
for(i in 1:35) {
  tot_exp_in_est_did_plot_data_wide_list[[i]]$diff_relative <- tot_exp_in_est_did_plot_data_wide_list[[i]]$diff - tot_exp_in_est_did_plot_data_wide_list[[i]]$diff[19]
}
tot_exp_in_spag_did_plot <- ggplot(tot_exp_est_did_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Total Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_in_spag_sc_plot <- ggplot(tot_exp_est_sc_plot_data_wide_in, aes(year,diff)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = tot_exp_in_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Indiana"),data = tot_exp_est_sc_plot_data_wide_in, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Indiana" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_est_sdid_plot_data_wide_in$diff_relative <- tot_exp_est_sdid_plot_data_wide_in$diff - tot_exp_est_sdid_plot_data_wide_in$diff[19]
for(i in 1:35) {
  tot_exp_in_est_sdid_plot_data_wide_list[[i]]$diff_relative <- tot_exp_in_est_sdid_plot_data_wide_list[[i]]$diff - tot_exp_in_est_sdid_plot_data_wide_list[[i]]$diff[19]
}
tot_exp_in_spag_sdid_plot <- ggplot(tot_exp_est_sdid_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_in_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
tot_exp_in_est_did_vec <- c(tot_exp_est_did_in)
for (i in c(1:4,6:35)) {
  tot_exp_in_est_did_vec_aux <- tot_exp_in_est_did_list[[i]][1]
  tot_exp_in_est_did_vec <- c(tot_exp_in_est_did_vec,tot_exp_in_est_did_vec_aux)
}
tot_exp_in_est_did_df <- data.frame(tot_exp_in_est_did_vec)
tot_exp_in_hist_did_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_in_est_did_vec)) +
  geom_histogram(data = tot_exp_in_est_did_df, aes(x = tot_exp_in_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_in_hist_did_plot1_ylim <- ggplot_build(tot_exp_in_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_in_hist_did_plot <- tot_exp_in_hist_did_plot_aux +
  expand_limits(y=tot_exp_in_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_in_est_did_vec[1], mean(tot_exp_in_est_did_vec[2:35])), xend = c(tot_exp_in_est_did_vec[1],mean(tot_exp_in_est_did_vec[2:35])), y = c(0,0), yend = c(tot_exp_in_hist_did_plot1_ylim,tot_exp_in_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_in_est_did_vec[1], mean(tot_exp_in_est_did_vec[2:35])), y = c(tot_exp_in_hist_did_plot1_ylim,tot_exp_in_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_in_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_in_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(1,0), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_in_est_sc_vec <- c(tot_exp_est_sc_in)
for (i in c(1:4,6:35)) {
  tot_exp_in_est_sc_vec_aux <- tot_exp_in_est_sc_list[[i]][1]
  tot_exp_in_est_sc_vec <- c(tot_exp_in_est_sc_vec,tot_exp_in_est_sc_vec_aux)
}
tot_exp_in_est_sc_df <- data.frame(tot_exp_in_est_sc_vec)
tot_exp_in_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_in_est_sc_vec)) +
  geom_histogram(data = tot_exp_in_est_sc_df, aes(x = tot_exp_in_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_in_hist_sc_plot1_ylim <- ggplot_build(tot_exp_in_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_in_hist_sc_plot <- tot_exp_in_hist_sc_plot_aux +
  expand_limits(y=tot_exp_in_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_in_est_sc_vec[1], mean(tot_exp_in_est_sc_vec[2:35])), xend = c(tot_exp_in_est_sc_vec[1],mean(tot_exp_in_est_sc_vec[2:35])), y = c(0,0), yend = c(tot_exp_in_hist_sc_plot1_ylim,tot_exp_in_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_in_est_sc_vec[1], mean(tot_exp_in_est_sc_vec[2:35])), y = c(tot_exp_in_hist_sc_plot1_ylim,tot_exp_in_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_in_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_in_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.8, .2), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_in_est_sdid_vec <- c(tot_exp_est_sdid_in)
for (i in c(1:4,6:35)) {
  tot_exp_in_est_sdid_vec_aux <- tot_exp_in_est_sdid_list[[i]][1]
  tot_exp_in_est_sdid_vec <- c(tot_exp_in_est_sdid_vec,tot_exp_in_est_sdid_vec_aux)
}
tot_exp_in_est_sdid_df <- data.frame(tot_exp_in_est_sdid_vec)
tot_exp_in_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_in_est_sdid_vec)) +
  geom_histogram(data = tot_exp_in_est_sdid_df, aes(x = tot_exp_in_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_in_hist_sdid_plot1_ylim <- ggplot_build(tot_exp_in_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_in_hist_sdid_plot <- tot_exp_in_hist_sdid_plot_aux +
  expand_limits(y=tot_exp_in_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_in_est_sdid_vec[1], mean(tot_exp_in_est_sdid_vec[2:35])), xend = c(tot_exp_in_est_sdid_vec[1],mean(tot_exp_in_est_sdid_vec[2:35])), y = c(0,0), yend = c(tot_exp_in_hist_sdid_plot1_ylim,tot_exp_in_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_in_est_sdid_vec[1], mean(tot_exp_in_est_sdid_vec[2:35])), y = c(tot_exp_in_hist_sdid_plot1_ylim,tot_exp_in_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_in_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_in_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0,1), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/tot_exp_spag_dist_plots_IN.pdf', paper = "USr", width = 10.9, height = 8.4)
(tot_exp_in_spag_dist_plots_in <- tot_exp_in_spag_did_plot + tot_exp_in_spag_sc_plot + tot_exp_in_spag_sdid_plot + tot_exp_in_hist_did_plot + tot_exp_in_hist_sc_plot + tot_exp_in_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Medicaid Expenditure #####
### IN - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
med_exp_in_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
med_exp_in_df$treated <- as.integer(ifelse(med_exp_in_df$name == "Indiana" & med_exp_in_df$year >= 1999, 1, 0))
med_exp_in_df <- med_exp_in_df[order(med_exp_in_df$year, med_exp_in_df$treated_in_aux, med_exp_in_df$name),]
med_exp_in_df <- subset(med_exp_in_df, alwaysconpa == 1 | name == "Indiana", select=c(name, year, medicaid_exp, treated))
setup_med_exp_in <- panel.matrices(med_exp_in_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
med_exp_est_did_in <- did_estimate(setup_med_exp_in$Y, setup_med_exp_in$N0, setup_med_exp_in$T0, X = covariates_exp_in_array)
med_exp_est_did_plot_in <- synthdid_plot(med_exp_est_did_in)
med_exp_est_did_plot_data_aux_in <- ggplot_build(med_exp_est_did_plot_in)
med_exp_est_did_plot_data_long_in <- data.frame(med_exp_est_did_plot_data_aux_in$data[[1]]$x, med_exp_est_did_plot_data_aux_in$data[[1]]$y, med_exp_est_did_plot_data_aux_in$data[[1]]$group)
colnames(med_exp_est_did_plot_data_long_in) <- c('year', 'outcome', 'treated')
med_exp_est_did_plot_data_long_in$treated <- med_exp_est_did_plot_data_long_in$treated - 1
med_exp_est_did_plot_data_wide_in <- reshape(data=med_exp_est_did_plot_data_long_in,
                                             idvar = "year",
                                             v.names = "outcome",
                                             timevar = "treated",
                                             direction = "wide")
med_exp_est_did_plot_data_wide_in$diff <- med_exp_est_did_plot_data_wide_in$outcome.1 - med_exp_est_did_plot_data_wide_in$outcome.0
# SC #
med_exp_est_sc_in <- sc_estimate(setup_med_exp_in$Y, setup_med_exp_in$N0, setup_med_exp_in$T0, X = covariates_exp_in_array)
med_exp_est_sc_plot_in <- synthdid_plot(med_exp_est_sc_in)
med_exp_est_sc_plot_data_aux_in <- ggplot_build(med_exp_est_sc_plot_in)
med_exp_est_sc_plot_data_long_in <- data.frame(med_exp_est_sc_plot_data_aux_in$data[[1]]$x, med_exp_est_sc_plot_data_aux_in$data[[1]]$y, med_exp_est_sc_plot_data_aux_in$data[[1]]$group)
colnames(med_exp_est_sc_plot_data_long_in) <- c('year', 'outcome', 'treated')
med_exp_est_sc_plot_data_long_in$treated <- med_exp_est_sc_plot_data_long_in$treated - 1
med_exp_est_sc_plot_data_wide_in <- reshape(data=med_exp_est_sc_plot_data_long_in,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
med_exp_est_sc_plot_data_wide_in$diff <- med_exp_est_sc_plot_data_wide_in$outcome.1 - med_exp_est_sc_plot_data_wide_in$outcome.0
# SDID #
med_exp_est_sdid_in <- synthdid_estimate(setup_med_exp_in$Y, setup_med_exp_in$N0, setup_med_exp_in$T0, X = covariates_exp_in_array)
med_exp_est_sdid_plot_in <- synthdid_plot(med_exp_est_sdid_in)
med_exp_est_sdid_plot_data_aux_in <- ggplot_build(med_exp_est_sdid_plot_in)
med_exp_est_sdid_plot_data_long_in <- data.frame(med_exp_est_sdid_plot_data_aux_in$data[[1]]$x, med_exp_est_sdid_plot_data_aux_in$data[[1]]$y, med_exp_est_sdid_plot_data_aux_in$data[[1]]$group)
colnames(med_exp_est_sdid_plot_data_long_in) <- c('year', 'outcome', 'treated')
med_exp_est_sdid_plot_data_long_in$treated <- med_exp_est_sdid_plot_data_long_in$treated - 1
med_exp_est_sdid_plot_data_wide_in <- reshape(data=med_exp_est_sdid_plot_data_long_in,
                                              idvar = "year",
                                              v.names = "outcome",
                                              timevar = "treated",
                                              direction = "wide")
med_exp_est_sdid_plot_data_wide_in$diff <- med_exp_est_sdid_plot_data_wide_in$outcome.1 - med_exp_est_sdid_plot_data_wide_in$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("med_exp_in_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
med_exp_in_df1$treated_aux <- ifelse(med_exp_in_df1$id == 1, 1, 0)
med_exp_in_df2$treated_aux <- ifelse(med_exp_in_df2$id == 2, 1, 0)
med_exp_in_df5$treated_aux <- ifelse(med_exp_in_df5$id == 5, 1, 0)
med_exp_in_df10$treated_aux <- ifelse(med_exp_in_df10$id == 10, 1, 0)
med_exp_in_df11$treated_aux <- ifelse(med_exp_in_df11$id == 11, 1, 0)
med_exp_in_df12$treated_aux <- ifelse(med_exp_in_df12$id == 12, 1, 0)
med_exp_in_df13$treated_aux <- ifelse(med_exp_in_df13$id == 13, 1, 0)
med_exp_in_df15$treated_aux <- ifelse(med_exp_in_df15$id == 15, 1, 0)
med_exp_in_df17$treated_aux <- ifelse(med_exp_in_df17$id == 17, 1, 0)
med_exp_in_df19$treated_aux <- ifelse(med_exp_in_df19$id == 19, 1, 0)
med_exp_in_df21$treated_aux <- ifelse(med_exp_in_df21$id == 21, 1, 0)
med_exp_in_df23$treated_aux <- ifelse(med_exp_in_df23$id == 23, 1, 0)
med_exp_in_df24$treated_aux <- ifelse(med_exp_in_df24$id == 24, 1, 0)
med_exp_in_df25$treated_aux <- ifelse(med_exp_in_df25$id == 25, 1, 0)
med_exp_in_df26$treated_aux <- ifelse(med_exp_in_df26$id == 26, 1, 0)
med_exp_in_df28$treated_aux <- ifelse(med_exp_in_df28$id == 28, 1, 0)
med_exp_in_df29$treated_aux <- ifelse(med_exp_in_df29$id == 29, 1, 0)
med_exp_in_df30$treated_aux <- ifelse(med_exp_in_df30$id == 30, 1, 0)
med_exp_in_df31$treated_aux <- ifelse(med_exp_in_df31$id == 31, 1, 0)
med_exp_in_df32$treated_aux <- ifelse(med_exp_in_df32$id == 32, 1, 0)
med_exp_in_df33$treated_aux <- ifelse(med_exp_in_df33$id == 33, 1, 0)
med_exp_in_df34$treated_aux <- ifelse(med_exp_in_df34$id == 34, 1, 0)
med_exp_in_df36$treated_aux <- ifelse(med_exp_in_df36$id == 36, 1, 0)
med_exp_in_df37$treated_aux <- ifelse(med_exp_in_df37$id == 37, 1, 0)
med_exp_in_df39$treated_aux <- ifelse(med_exp_in_df39$id == 39, 1, 0)
med_exp_in_df40$treated_aux <- ifelse(med_exp_in_df40$id == 40, 1, 0)
med_exp_in_df41$treated_aux <- ifelse(med_exp_in_df41$id == 41, 1, 0)
med_exp_in_df44$treated_aux <- ifelse(med_exp_in_df44$id == 44, 1, 0)
med_exp_in_df45$treated_aux <- ifelse(med_exp_in_df45$id == 45, 1, 0)
med_exp_in_df47$treated_aux <- ifelse(med_exp_in_df47$id == 47, 1, 0)
med_exp_in_df50$treated_aux <- ifelse(med_exp_in_df50$id == 50, 1, 0)
med_exp_in_df51$treated_aux <- ifelse(med_exp_in_df51$id == 51, 1, 0)
med_exp_in_df53$treated_aux <- ifelse(med_exp_in_df53$id == 53, 1, 0)
med_exp_in_df54$treated_aux <- ifelse(med_exp_in_df54$id == 54, 1, 0)
med_exp_in_df55$treated_aux <- ifelse(med_exp_in_df55$id == 55, 1, 0)
med_exp_in_df1$treated <- as.integer(ifelse(med_exp_in_df1$id == 1 & med_exp_in_df1$year >= 1999, 1, 0))
med_exp_in_df2$treated <- as.integer(ifelse(med_exp_in_df2$id == 2 & med_exp_in_df2$year >= 1999, 1, 0))
med_exp_in_df5$treated <- as.integer(ifelse(med_exp_in_df5$id == 5 & med_exp_in_df5$year >= 1999, 1, 0))
med_exp_in_df10$treated <- as.integer(ifelse(med_exp_in_df10$id == 10 & med_exp_in_df10$year >= 1999, 1, 0))
med_exp_in_df11$treated <- as.integer(ifelse(med_exp_in_df11$id == 11 & med_exp_in_df11$year >= 1999, 1, 0))
med_exp_in_df12$treated <- as.integer(ifelse(med_exp_in_df12$id == 12 & med_exp_in_df12$year >= 1999, 1, 0))
med_exp_in_df13$treated <- as.integer(ifelse(med_exp_in_df13$id == 13 & med_exp_in_df13$year >= 1999, 1, 0))
med_exp_in_df15$treated <- as.integer(ifelse(med_exp_in_df15$id == 15 & med_exp_in_df15$year >= 1999, 1, 0))
med_exp_in_df17$treated <- as.integer(ifelse(med_exp_in_df17$id == 17 & med_exp_in_df17$year >= 1999, 1, 0))
med_exp_in_df19$treated <- as.integer(ifelse(med_exp_in_df19$id == 19 & med_exp_in_df19$year >= 1999, 1, 0))
med_exp_in_df21$treated <- as.integer(ifelse(med_exp_in_df21$id == 21 & med_exp_in_df21$year >= 1999, 1, 0))
med_exp_in_df23$treated <- as.integer(ifelse(med_exp_in_df23$id == 23 & med_exp_in_df23$year >= 1999, 1, 0))
med_exp_in_df24$treated <- as.integer(ifelse(med_exp_in_df24$id == 24 & med_exp_in_df24$year >= 1999, 1, 0))
med_exp_in_df25$treated <- as.integer(ifelse(med_exp_in_df25$id == 25 & med_exp_in_df25$year >= 1999, 1, 0))
med_exp_in_df26$treated <- as.integer(ifelse(med_exp_in_df26$id == 26 & med_exp_in_df26$year >= 1999, 1, 0))
med_exp_in_df28$treated <- as.integer(ifelse(med_exp_in_df28$id == 28 & med_exp_in_df28$year >= 1999, 1, 0))
med_exp_in_df29$treated <- as.integer(ifelse(med_exp_in_df29$id == 29 & med_exp_in_df29$year >= 1999, 1, 0))
med_exp_in_df30$treated <- as.integer(ifelse(med_exp_in_df30$id == 30 & med_exp_in_df30$year >= 1999, 1, 0))
med_exp_in_df31$treated <- as.integer(ifelse(med_exp_in_df31$id == 31 & med_exp_in_df31$year >= 1999, 1, 0))
med_exp_in_df32$treated <- as.integer(ifelse(med_exp_in_df32$id == 32 & med_exp_in_df32$year >= 1999, 1, 0))
med_exp_in_df33$treated <- as.integer(ifelse(med_exp_in_df33$id == 33 & med_exp_in_df33$year >= 1999, 1, 0))
med_exp_in_df34$treated <- as.integer(ifelse(med_exp_in_df34$id == 34 & med_exp_in_df34$year >= 1999, 1, 0))
med_exp_in_df36$treated <- as.integer(ifelse(med_exp_in_df36$id == 36 & med_exp_in_df36$year >= 1999, 1, 0))
med_exp_in_df37$treated <- as.integer(ifelse(med_exp_in_df37$id == 37 & med_exp_in_df37$year >= 1999, 1, 0))
med_exp_in_df39$treated <- as.integer(ifelse(med_exp_in_df39$id == 39 & med_exp_in_df39$year >= 1999, 1, 0))
med_exp_in_df40$treated <- as.integer(ifelse(med_exp_in_df40$id == 40 & med_exp_in_df40$year >= 1999, 1, 0))
med_exp_in_df41$treated <- as.integer(ifelse(med_exp_in_df41$id == 41 & med_exp_in_df41$year >= 1999, 1, 0))
med_exp_in_df44$treated <- as.integer(ifelse(med_exp_in_df44$id == 44 & med_exp_in_df44$year >= 1999, 1, 0))
med_exp_in_df45$treated <- as.integer(ifelse(med_exp_in_df45$id == 45 & med_exp_in_df45$year >= 1999, 1, 0))
med_exp_in_df47$treated <- as.integer(ifelse(med_exp_in_df47$id == 47 & med_exp_in_df47$year >= 1999, 1, 0))
med_exp_in_df50$treated <- as.integer(ifelse(med_exp_in_df50$id == 50 & med_exp_in_df50$year >= 1999, 1, 0))
med_exp_in_df51$treated <- as.integer(ifelse(med_exp_in_df51$id == 51 & med_exp_in_df51$year >= 1999, 1, 0))
med_exp_in_df53$treated <- as.integer(ifelse(med_exp_in_df53$id == 53 & med_exp_in_df53$year >= 1999, 1, 0))
med_exp_in_df54$treated <- as.integer(ifelse(med_exp_in_df54$id == 54 & med_exp_in_df54$year >= 1999, 1, 0))
med_exp_in_df55$treated <- as.integer(ifelse(med_exp_in_df55$id == 55 & med_exp_in_df55$year >= 1999, 1, 0))
med_exp_in_df_list <- list(med_exp_in_df1,med_exp_in_df2,med_exp_in_df5,
                           med_exp_in_df10,med_exp_in_df11,med_exp_in_df12,
                           med_exp_in_df13,med_exp_in_df15,med_exp_in_df17,
                           med_exp_in_df19,med_exp_in_df21,med_exp_in_df23,
                           med_exp_in_df24,med_exp_in_df25,med_exp_in_df26,
                           med_exp_in_df28,med_exp_in_df29,med_exp_in_df30,
                           med_exp_in_df31,med_exp_in_df32,med_exp_in_df33,
                           med_exp_in_df34,med_exp_in_df36,med_exp_in_df37,
                           med_exp_in_df39,med_exp_in_df40,med_exp_in_df41,
                           med_exp_in_df44,med_exp_in_df45,med_exp_in_df47,
                           med_exp_in_df50,med_exp_in_df51,med_exp_in_df53,
                           med_exp_in_df54,med_exp_in_df55)
rm(med_exp_in_df1,med_exp_in_df2,med_exp_in_df5,
   med_exp_in_df10,med_exp_in_df11,med_exp_in_df12,
   med_exp_in_df13,med_exp_in_df15,med_exp_in_df17,
   med_exp_in_df19,med_exp_in_df21,med_exp_in_df23,
   med_exp_in_df24,med_exp_in_df25,med_exp_in_df26,
   med_exp_in_df28,med_exp_in_df29,med_exp_in_df30,
   med_exp_in_df31,med_exp_in_df32,med_exp_in_df33,
   med_exp_in_df34,med_exp_in_df36,med_exp_in_df37,
   med_exp_in_df39,med_exp_in_df40,med_exp_in_df41,
   med_exp_in_df44,med_exp_in_df45,med_exp_in_df47,
   med_exp_in_df50,med_exp_in_df51,med_exp_in_df53,
   med_exp_in_df54,med_exp_in_df55)
med_exp_in_df_list <- lapply(med_exp_in_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
med_exp_in_df_list <- lapply(med_exp_in_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, medicaid_exp, treated)))
}
)
setup_med_exp_in1 <- panel.matrices(med_exp_in_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in2 <- panel.matrices(med_exp_in_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in5 <- panel.matrices(med_exp_in_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in10 <- panel.matrices(med_exp_in_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in11 <- panel.matrices(med_exp_in_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in12 <- panel.matrices(med_exp_in_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in13 <- panel.matrices(med_exp_in_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in15 <- panel.matrices(med_exp_in_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in17 <- panel.matrices(med_exp_in_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in19 <- panel.matrices(med_exp_in_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in21 <- panel.matrices(med_exp_in_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in23 <- panel.matrices(med_exp_in_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in24 <- panel.matrices(med_exp_in_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in25 <- panel.matrices(med_exp_in_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in26 <- panel.matrices(med_exp_in_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in28 <- panel.matrices(med_exp_in_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in29 <- panel.matrices(med_exp_in_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in30 <- panel.matrices(med_exp_in_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in31 <- panel.matrices(med_exp_in_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in32 <- panel.matrices(med_exp_in_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in33 <- panel.matrices(med_exp_in_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in34 <- panel.matrices(med_exp_in_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in36 <- panel.matrices(med_exp_in_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in37 <- panel.matrices(med_exp_in_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in39 <- panel.matrices(med_exp_in_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in40 <- panel.matrices(med_exp_in_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in41 <- panel.matrices(med_exp_in_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in44 <- panel.matrices(med_exp_in_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in45 <- panel.matrices(med_exp_in_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in47 <- panel.matrices(med_exp_in_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in50 <- panel.matrices(med_exp_in_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in51 <- panel.matrices(med_exp_in_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in53 <- panel.matrices(med_exp_in_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in54 <- panel.matrices(med_exp_in_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in55 <- panel.matrices(med_exp_in_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_in_list <- list(setup_med_exp_in1,setup_med_exp_in2,setup_med_exp_in5,
                              setup_med_exp_in10,setup_med_exp_in11,setup_med_exp_in12,
                              setup_med_exp_in13,setup_med_exp_in15,setup_med_exp_in17,
                              setup_med_exp_in19,setup_med_exp_in21,setup_med_exp_in23,
                              setup_med_exp_in24,setup_med_exp_in25,setup_med_exp_in26,
                              setup_med_exp_in28,setup_med_exp_in29,setup_med_exp_in30,
                              setup_med_exp_in31,setup_med_exp_in32,setup_med_exp_in33,
                              setup_med_exp_in34,setup_med_exp_in36,setup_med_exp_in37,
                              setup_med_exp_in39,setup_med_exp_in40,setup_med_exp_in41,
                              setup_med_exp_in44,setup_med_exp_in45,setup_med_exp_in47,
                              setup_med_exp_in50,setup_med_exp_in51,setup_med_exp_in53,
                              setup_med_exp_in54,setup_med_exp_in55)
rm(setup_med_exp_in1,setup_med_exp_in2,setup_med_exp_in5,
   setup_med_exp_in10,setup_med_exp_in11,setup_med_exp_in12,
   setup_med_exp_in13,setup_med_exp_in15,setup_med_exp_in17,
   setup_med_exp_in19,setup_med_exp_in21,setup_med_exp_in23,
   setup_med_exp_in24,setup_med_exp_in25,setup_med_exp_in26,
   setup_med_exp_in28,setup_med_exp_in29,setup_med_exp_in30,
   setup_med_exp_in31,setup_med_exp_in32,setup_med_exp_in33,
   setup_med_exp_in34,setup_med_exp_in36,setup_med_exp_in37,
   setup_med_exp_in39,setup_med_exp_in40,setup_med_exp_in41,
   setup_med_exp_in44,setup_med_exp_in45,setup_med_exp_in47,
   setup_med_exp_in50,setup_med_exp_in51,setup_med_exp_in53,
   setup_med_exp_in54,setup_med_exp_in55)
# DID #
med_exp_in_est_did1 <- did_estimate(setup_med_exp_in_list[[1]]$Y, setup_med_exp_in_list[[1]]$N0, setup_med_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_in_est_did2 <- did_estimate(setup_med_exp_in_list[[2]]$Y, setup_med_exp_in_list[[2]]$N0, setup_med_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_in_est_did5 <- did_estimate(setup_med_exp_in_list[[3]]$Y, setup_med_exp_in_list[[3]]$N0, setup_med_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_in_est_did10 <- did_estimate(setup_med_exp_in_list[[4]]$Y, setup_med_exp_in_list[[4]]$N0, setup_med_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_in_est_did11 <- did_estimate(setup_med_exp_in_list[[5]]$Y, setup_med_exp_in_list[[5]]$N0, setup_med_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_in_est_did12 <- did_estimate(setup_med_exp_in_list[[6]]$Y, setup_med_exp_in_list[[6]]$N0, setup_med_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_in_est_did13 <- did_estimate(setup_med_exp_in_list[[7]]$Y, setup_med_exp_in_list[[7]]$N0, setup_med_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_in_est_did15 <- did_estimate(setup_med_exp_in_list[[8]]$Y, setup_med_exp_in_list[[8]]$N0, setup_med_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_in_est_did17 <- did_estimate(setup_med_exp_in_list[[9]]$Y, setup_med_exp_in_list[[9]]$N0, setup_med_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_in_est_did19 <- did_estimate(setup_med_exp_in_list[[10]]$Y, setup_med_exp_in_list[[10]]$N0, setup_med_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_in_est_did21 <- did_estimate(setup_med_exp_in_list[[11]]$Y, setup_med_exp_in_list[[11]]$N0, setup_med_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_in_est_did23 <- did_estimate(setup_med_exp_in_list[[12]]$Y, setup_med_exp_in_list[[12]]$N0, setup_med_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_in_est_did24 <- did_estimate(setup_med_exp_in_list[[13]]$Y, setup_med_exp_in_list[[13]]$N0, setup_med_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_in_est_did25 <- did_estimate(setup_med_exp_in_list[[14]]$Y, setup_med_exp_in_list[[14]]$N0, setup_med_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_in_est_did26 <- did_estimate(setup_med_exp_in_list[[15]]$Y, setup_med_exp_in_list[[15]]$N0, setup_med_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_in_est_did28 <- did_estimate(setup_med_exp_in_list[[16]]$Y, setup_med_exp_in_list[[16]]$N0, setup_med_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_in_est_did29 <- did_estimate(setup_med_exp_in_list[[17]]$Y, setup_med_exp_in_list[[17]]$N0, setup_med_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_in_est_did30 <- did_estimate(setup_med_exp_in_list[[18]]$Y, setup_med_exp_in_list[[18]]$N0, setup_med_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_in_est_did31 <- did_estimate(setup_med_exp_in_list[[19]]$Y, setup_med_exp_in_list[[19]]$N0, setup_med_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_in_est_did32 <- did_estimate(setup_med_exp_in_list[[20]]$Y, setup_med_exp_in_list[[20]]$N0, setup_med_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_in_est_did33 <- did_estimate(setup_med_exp_in_list[[21]]$Y, setup_med_exp_in_list[[21]]$N0, setup_med_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_in_est_did34 <- did_estimate(setup_med_exp_in_list[[22]]$Y, setup_med_exp_in_list[[22]]$N0, setup_med_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_in_est_did36 <- did_estimate(setup_med_exp_in_list[[23]]$Y, setup_med_exp_in_list[[23]]$N0, setup_med_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_in_est_did37 <- did_estimate(setup_med_exp_in_list[[24]]$Y, setup_med_exp_in_list[[24]]$N0, setup_med_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_in_est_did39 <- did_estimate(setup_med_exp_in_list[[25]]$Y, setup_med_exp_in_list[[25]]$N0, setup_med_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_in_est_did40 <- did_estimate(setup_med_exp_in_list[[26]]$Y, setup_med_exp_in_list[[26]]$N0, setup_med_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_in_est_did41 <- did_estimate(setup_med_exp_in_list[[27]]$Y, setup_med_exp_in_list[[27]]$N0, setup_med_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_in_est_did44 <- did_estimate(setup_med_exp_in_list[[28]]$Y, setup_med_exp_in_list[[28]]$N0, setup_med_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_in_est_did45 <- did_estimate(setup_med_exp_in_list[[29]]$Y, setup_med_exp_in_list[[29]]$N0, setup_med_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_in_est_did47 <- did_estimate(setup_med_exp_in_list[[30]]$Y, setup_med_exp_in_list[[30]]$N0, setup_med_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_in_est_did50 <- did_estimate(setup_med_exp_in_list[[31]]$Y, setup_med_exp_in_list[[31]]$N0, setup_med_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_in_est_did51 <- did_estimate(setup_med_exp_in_list[[32]]$Y, setup_med_exp_in_list[[32]]$N0, setup_med_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_in_est_did53 <- did_estimate(setup_med_exp_in_list[[33]]$Y, setup_med_exp_in_list[[33]]$N0, setup_med_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_in_est_did54 <- did_estimate(setup_med_exp_in_list[[34]]$Y, setup_med_exp_in_list[[34]]$N0, setup_med_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_in_est_did55 <- did_estimate(setup_med_exp_in_list[[35]]$Y, setup_med_exp_in_list[[35]]$N0, setup_med_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_in_est_did_list <- list(med_exp_in_est_did1,med_exp_in_est_did2,med_exp_in_est_did5,
                                med_exp_in_est_did10,med_exp_in_est_did11,med_exp_in_est_did12,
                                med_exp_in_est_did13,med_exp_in_est_did15,med_exp_in_est_did17,
                                med_exp_in_est_did19,med_exp_in_est_did21,med_exp_in_est_did23,
                                med_exp_in_est_did24,med_exp_in_est_did25,med_exp_in_est_did26,
                                med_exp_in_est_did28,med_exp_in_est_did29,med_exp_in_est_did30,
                                med_exp_in_est_did31,med_exp_in_est_did32,med_exp_in_est_did33,
                                med_exp_in_est_did34,med_exp_in_est_did36,med_exp_in_est_did37,
                                med_exp_in_est_did39,med_exp_in_est_did40,med_exp_in_est_did41,
                                med_exp_in_est_did44,med_exp_in_est_did45,med_exp_in_est_did47,
                                med_exp_in_est_did50,med_exp_in_est_did51,med_exp_in_est_did53,
                                med_exp_in_est_did54,med_exp_in_est_did55)
rm(med_exp_in_est_did1,med_exp_in_est_did2,med_exp_in_est_did5,
   med_exp_in_est_did10,med_exp_in_est_did11,med_exp_in_est_did12,
   med_exp_in_est_did13,med_exp_in_est_did15,med_exp_in_est_did17,
   med_exp_in_est_did19,med_exp_in_est_did21,med_exp_in_est_did23,
   med_exp_in_est_did24,med_exp_in_est_did25,med_exp_in_est_did26,
   med_exp_in_est_did28,med_exp_in_est_did29,med_exp_in_est_did30,
   med_exp_in_est_did31,med_exp_in_est_did32,med_exp_in_est_did33,
   med_exp_in_est_did34,med_exp_in_est_did36,med_exp_in_est_did37,
   med_exp_in_est_did39,med_exp_in_est_did40,med_exp_in_est_did41,
   med_exp_in_est_did44,med_exp_in_est_did45,med_exp_in_est_did47,
   med_exp_in_est_did50,med_exp_in_est_did51,med_exp_in_est_did53,
   med_exp_in_est_did54,med_exp_in_est_did55)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_did_plot", i), synthdid_plot(med_exp_in_est_did_list[i]))
}
med_exp_in_est_did_plot_data_aux1 <- ggplot_build(med_exp_in_est_did_plot1)
med_exp_in_est_did_plot_data_aux2 <- ggplot_build(med_exp_in_est_did_plot2)
med_exp_in_est_did_plot_data_aux3 <- ggplot_build(med_exp_in_est_did_plot3)
med_exp_in_est_did_plot_data_aux4 <- ggplot_build(med_exp_in_est_did_plot4)
med_exp_in_est_did_plot_data_aux5 <- ggplot_build(med_exp_in_est_did_plot5)
med_exp_in_est_did_plot_data_aux6 <- ggplot_build(med_exp_in_est_did_plot6)
med_exp_in_est_did_plot_data_aux7 <- ggplot_build(med_exp_in_est_did_plot7)
med_exp_in_est_did_plot_data_aux8 <- ggplot_build(med_exp_in_est_did_plot8)
med_exp_in_est_did_plot_data_aux9 <- ggplot_build(med_exp_in_est_did_plot9)
med_exp_in_est_did_plot_data_aux10 <- ggplot_build(med_exp_in_est_did_plot10)
med_exp_in_est_did_plot_data_aux11 <- ggplot_build(med_exp_in_est_did_plot11)
med_exp_in_est_did_plot_data_aux12 <- ggplot_build(med_exp_in_est_did_plot12)
med_exp_in_est_did_plot_data_aux13 <- ggplot_build(med_exp_in_est_did_plot13)
med_exp_in_est_did_plot_data_aux14 <- ggplot_build(med_exp_in_est_did_plot14)
med_exp_in_est_did_plot_data_aux15 <- ggplot_build(med_exp_in_est_did_plot15)
med_exp_in_est_did_plot_data_aux16 <- ggplot_build(med_exp_in_est_did_plot16)
med_exp_in_est_did_plot_data_aux17 <- ggplot_build(med_exp_in_est_did_plot17)
med_exp_in_est_did_plot_data_aux18 <- ggplot_build(med_exp_in_est_did_plot18)
med_exp_in_est_did_plot_data_aux19 <- ggplot_build(med_exp_in_est_did_plot19)
med_exp_in_est_did_plot_data_aux20 <- ggplot_build(med_exp_in_est_did_plot20)
med_exp_in_est_did_plot_data_aux21 <- ggplot_build(med_exp_in_est_did_plot21)
med_exp_in_est_did_plot_data_aux22 <- ggplot_build(med_exp_in_est_did_plot22)
med_exp_in_est_did_plot_data_aux23 <- ggplot_build(med_exp_in_est_did_plot23)
med_exp_in_est_did_plot_data_aux24 <- ggplot_build(med_exp_in_est_did_plot24)
med_exp_in_est_did_plot_data_aux25 <- ggplot_build(med_exp_in_est_did_plot25)
med_exp_in_est_did_plot_data_aux26 <- ggplot_build(med_exp_in_est_did_plot26)
med_exp_in_est_did_plot_data_aux27 <- ggplot_build(med_exp_in_est_did_plot27)
med_exp_in_est_did_plot_data_aux28 <- ggplot_build(med_exp_in_est_did_plot28)
med_exp_in_est_did_plot_data_aux29 <- ggplot_build(med_exp_in_est_did_plot29)
med_exp_in_est_did_plot_data_aux30 <- ggplot_build(med_exp_in_est_did_plot30)
med_exp_in_est_did_plot_data_aux31 <- ggplot_build(med_exp_in_est_did_plot31)
med_exp_in_est_did_plot_data_aux32 <- ggplot_build(med_exp_in_est_did_plot32)
med_exp_in_est_did_plot_data_aux33 <- ggplot_build(med_exp_in_est_did_plot33)
med_exp_in_est_did_plot_data_aux34 <- ggplot_build(med_exp_in_est_did_plot34)
med_exp_in_est_did_plot_data_aux35 <- ggplot_build(med_exp_in_est_did_plot35)
med_exp_in_est_did_plot_data_aux_list <- list(med_exp_in_est_did_plot_data_aux1,med_exp_in_est_did_plot_data_aux2,med_exp_in_est_did_plot_data_aux3,
                                              med_exp_in_est_did_plot_data_aux4,med_exp_in_est_did_plot_data_aux5,med_exp_in_est_did_plot_data_aux6,
                                              med_exp_in_est_did_plot_data_aux7,med_exp_in_est_did_plot_data_aux8,med_exp_in_est_did_plot_data_aux9,
                                              med_exp_in_est_did_plot_data_aux10,med_exp_in_est_did_plot_data_aux11,med_exp_in_est_did_plot_data_aux12,
                                              med_exp_in_est_did_plot_data_aux13,med_exp_in_est_did_plot_data_aux14,med_exp_in_est_did_plot_data_aux15,
                                              med_exp_in_est_did_plot_data_aux16,med_exp_in_est_did_plot_data_aux17,med_exp_in_est_did_plot_data_aux18,
                                              med_exp_in_est_did_plot_data_aux19,med_exp_in_est_did_plot_data_aux20,med_exp_in_est_did_plot_data_aux21,
                                              med_exp_in_est_did_plot_data_aux22,med_exp_in_est_did_plot_data_aux23,med_exp_in_est_did_plot_data_aux24,
                                              med_exp_in_est_did_plot_data_aux25,med_exp_in_est_did_plot_data_aux26,med_exp_in_est_did_plot_data_aux27,
                                              med_exp_in_est_did_plot_data_aux28,med_exp_in_est_did_plot_data_aux29,med_exp_in_est_did_plot_data_aux30,
                                              med_exp_in_est_did_plot_data_aux31,med_exp_in_est_did_plot_data_aux32,med_exp_in_est_did_plot_data_aux33,
                                              med_exp_in_est_did_plot_data_aux34,med_exp_in_est_did_plot_data_aux35)
rm(med_exp_in_est_did_plot_data_aux1,med_exp_in_est_did_plot_data_aux2,med_exp_in_est_did_plot_data_aux3,
   med_exp_in_est_did_plot_data_aux4,med_exp_in_est_did_plot_data_aux5,med_exp_in_est_did_plot_data_aux6,
   med_exp_in_est_did_plot_data_aux7,med_exp_in_est_did_plot_data_aux8,med_exp_in_est_did_plot_data_aux9,
   med_exp_in_est_did_plot_data_aux10,med_exp_in_est_did_plot_data_aux11,med_exp_in_est_did_plot_data_aux12,
   med_exp_in_est_did_plot_data_aux13,med_exp_in_est_did_plot_data_aux14,med_exp_in_est_did_plot_data_aux15,
   med_exp_in_est_did_plot_data_aux16,med_exp_in_est_did_plot_data_aux17,med_exp_in_est_did_plot_data_aux18,
   med_exp_in_est_did_plot_data_aux19,med_exp_in_est_did_plot_data_aux20,med_exp_in_est_did_plot_data_aux21,
   med_exp_in_est_did_plot_data_aux22,med_exp_in_est_did_plot_data_aux23,med_exp_in_est_did_plot_data_aux24,
   med_exp_in_est_did_plot_data_aux25,med_exp_in_est_did_plot_data_aux26,med_exp_in_est_did_plot_data_aux27,
   med_exp_in_est_did_plot_data_aux28,med_exp_in_est_did_plot_data_aux29,med_exp_in_est_did_plot_data_aux30,
   med_exp_in_est_did_plot_data_aux31,med_exp_in_est_did_plot_data_aux32,med_exp_in_est_did_plot_data_aux33,
   med_exp_in_est_did_plot_data_aux34,med_exp_in_est_did_plot_data_aux35)
rm(med_exp_in_est_did_plot1,med_exp_in_est_did_plot2,med_exp_in_est_did_plot3,
   med_exp_in_est_did_plot4,med_exp_in_est_did_plot5,med_exp_in_est_did_plot6,
   med_exp_in_est_did_plot7,med_exp_in_est_did_plot8,med_exp_in_est_did_plot9,
   med_exp_in_est_did_plot10,med_exp_in_est_did_plot11,med_exp_in_est_did_plot12,
   med_exp_in_est_did_plot13,med_exp_in_est_did_plot14,med_exp_in_est_did_plot15,
   med_exp_in_est_did_plot16,med_exp_in_est_did_plot17,med_exp_in_est_did_plot18,
   med_exp_in_est_did_plot19,med_exp_in_est_did_plot20,med_exp_in_est_did_plot21,
   med_exp_in_est_did_plot22,med_exp_in_est_did_plot23,med_exp_in_est_did_plot24,
   med_exp_in_est_did_plot25,med_exp_in_est_did_plot26,med_exp_in_est_did_plot27,
   med_exp_in_est_did_plot28,med_exp_in_est_did_plot29,med_exp_in_est_did_plot30,
   med_exp_in_est_did_plot31,med_exp_in_est_did_plot32,med_exp_in_est_did_plot33,
   med_exp_in_est_did_plot34,med_exp_in_est_did_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_did_plot_data_long", i), data.frame(med_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_in_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_in_est_did_plot_data_long_list <- list(med_exp_in_est_did_plot_data_long1,med_exp_in_est_did_plot_data_long2,med_exp_in_est_did_plot_data_long3,
                                               med_exp_in_est_did_plot_data_long4,med_exp_in_est_did_plot_data_long5,med_exp_in_est_did_plot_data_long6,
                                               med_exp_in_est_did_plot_data_long7,med_exp_in_est_did_plot_data_long8,med_exp_in_est_did_plot_data_long9,
                                               med_exp_in_est_did_plot_data_long10,med_exp_in_est_did_plot_data_long11,med_exp_in_est_did_plot_data_long12,
                                               med_exp_in_est_did_plot_data_long13,med_exp_in_est_did_plot_data_long14,med_exp_in_est_did_plot_data_long15,
                                               med_exp_in_est_did_plot_data_long16,med_exp_in_est_did_plot_data_long17,med_exp_in_est_did_plot_data_long18,
                                               med_exp_in_est_did_plot_data_long19,med_exp_in_est_did_plot_data_long20,med_exp_in_est_did_plot_data_long21,
                                               med_exp_in_est_did_plot_data_long22,med_exp_in_est_did_plot_data_long23,med_exp_in_est_did_plot_data_long24,
                                               med_exp_in_est_did_plot_data_long25,med_exp_in_est_did_plot_data_long26,med_exp_in_est_did_plot_data_long27,
                                               med_exp_in_est_did_plot_data_long28,med_exp_in_est_did_plot_data_long29,med_exp_in_est_did_plot_data_long30,
                                               med_exp_in_est_did_plot_data_long31,med_exp_in_est_did_plot_data_long32,med_exp_in_est_did_plot_data_long33,
                                               med_exp_in_est_did_plot_data_long34,med_exp_in_est_did_plot_data_long35)
rm(med_exp_in_est_did_plot_data_long1,med_exp_in_est_did_plot_data_long2,med_exp_in_est_did_plot_data_long3,
   med_exp_in_est_did_plot_data_long4,med_exp_in_est_did_plot_data_long5,med_exp_in_est_did_plot_data_long6,
   med_exp_in_est_did_plot_data_long7,med_exp_in_est_did_plot_data_long8,med_exp_in_est_did_plot_data_long9,
   med_exp_in_est_did_plot_data_long10,med_exp_in_est_did_plot_data_long11,med_exp_in_est_did_plot_data_long12,
   med_exp_in_est_did_plot_data_long13,med_exp_in_est_did_plot_data_long14,med_exp_in_est_did_plot_data_long15,
   med_exp_in_est_did_plot_data_long16,med_exp_in_est_did_plot_data_long17,med_exp_in_est_did_plot_data_long18,
   med_exp_in_est_did_plot_data_long19,med_exp_in_est_did_plot_data_long20,med_exp_in_est_did_plot_data_long21,
   med_exp_in_est_did_plot_data_long22,med_exp_in_est_did_plot_data_long23,med_exp_in_est_did_plot_data_long24,
   med_exp_in_est_did_plot_data_long25,med_exp_in_est_did_plot_data_long26,med_exp_in_est_did_plot_data_long27,
   med_exp_in_est_did_plot_data_long28,med_exp_in_est_did_plot_data_long29,med_exp_in_est_did_plot_data_long30,
   med_exp_in_est_did_plot_data_long31,med_exp_in_est_did_plot_data_long32,med_exp_in_est_did_plot_data_long33,
   med_exp_in_est_did_plot_data_long34,med_exp_in_est_did_plot_data_long35)
med_exp_in_est_did_plot_data_long_list <- lapply(med_exp_in_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_did_plot_data_wide", i), reshape(data=med_exp_in_est_did_plot_data_long_list[[i]],
                                                                 idvar = "year",
                                                                 v.names = "outcome",
                                                                 timevar = "treated",
                                                                 direction = "wide"))
}
med_exp_in_est_did_plot_data_wide_list <- list(med_exp_in_est_did_plot_data_wide1,med_exp_in_est_did_plot_data_wide2,med_exp_in_est_did_plot_data_wide3,
                                               med_exp_in_est_did_plot_data_wide4,med_exp_in_est_did_plot_data_wide5,med_exp_in_est_did_plot_data_wide6,
                                               med_exp_in_est_did_plot_data_wide7,med_exp_in_est_did_plot_data_wide8,med_exp_in_est_did_plot_data_wide9,
                                               med_exp_in_est_did_plot_data_wide10,med_exp_in_est_did_plot_data_wide11,med_exp_in_est_did_plot_data_wide12,
                                               med_exp_in_est_did_plot_data_wide13,med_exp_in_est_did_plot_data_wide14,med_exp_in_est_did_plot_data_wide15,
                                               med_exp_in_est_did_plot_data_wide16,med_exp_in_est_did_plot_data_wide17,med_exp_in_est_did_plot_data_wide18,
                                               med_exp_in_est_did_plot_data_wide19,med_exp_in_est_did_plot_data_wide20,med_exp_in_est_did_plot_data_wide21,
                                               med_exp_in_est_did_plot_data_wide22,med_exp_in_est_did_plot_data_wide23,med_exp_in_est_did_plot_data_wide24,
                                               med_exp_in_est_did_plot_data_wide25,med_exp_in_est_did_plot_data_wide26,med_exp_in_est_did_plot_data_wide27,
                                               med_exp_in_est_did_plot_data_wide28,med_exp_in_est_did_plot_data_wide29,med_exp_in_est_did_plot_data_wide30,
                                               med_exp_in_est_did_plot_data_wide31,med_exp_in_est_did_plot_data_wide32,med_exp_in_est_did_plot_data_wide33,
                                               med_exp_in_est_did_plot_data_wide34,med_exp_in_est_did_plot_data_wide35)
rm(med_exp_in_est_did_plot_data_wide1,med_exp_in_est_did_plot_data_wide2,med_exp_in_est_did_plot_data_wide3,
   med_exp_in_est_did_plot_data_wide4,med_exp_in_est_did_plot_data_wide5,med_exp_in_est_did_plot_data_wide6,
   med_exp_in_est_did_plot_data_wide7,med_exp_in_est_did_plot_data_wide8,med_exp_in_est_did_plot_data_wide9,
   med_exp_in_est_did_plot_data_wide10,med_exp_in_est_did_plot_data_wide11,med_exp_in_est_did_plot_data_wide12,
   med_exp_in_est_did_plot_data_wide13,med_exp_in_est_did_plot_data_wide14,med_exp_in_est_did_plot_data_wide15,
   med_exp_in_est_did_plot_data_wide16,med_exp_in_est_did_plot_data_wide17,med_exp_in_est_did_plot_data_wide18,
   med_exp_in_est_did_plot_data_wide19,med_exp_in_est_did_plot_data_wide20,med_exp_in_est_did_plot_data_wide21,
   med_exp_in_est_did_plot_data_wide22,med_exp_in_est_did_plot_data_wide23,med_exp_in_est_did_plot_data_wide24,
   med_exp_in_est_did_plot_data_wide25,med_exp_in_est_did_plot_data_wide26,med_exp_in_est_did_plot_data_wide27,
   med_exp_in_est_did_plot_data_wide28,med_exp_in_est_did_plot_data_wide29,med_exp_in_est_did_plot_data_wide30,
   med_exp_in_est_did_plot_data_wide31,med_exp_in_est_did_plot_data_wide32,med_exp_in_est_did_plot_data_wide33,
   med_exp_in_est_did_plot_data_wide34,med_exp_in_est_did_plot_data_wide35)
med_exp_in_est_did_plot_data_wide_list <- lapply(med_exp_in_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
med_exp_in_est_sc1 <- sc_estimate(setup_med_exp_in_list[[1]]$Y, setup_med_exp_in_list[[1]]$N0, setup_med_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_in_est_sc2 <- sc_estimate(setup_med_exp_in_list[[2]]$Y, setup_med_exp_in_list[[2]]$N0, setup_med_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_in_est_sc5 <- sc_estimate(setup_med_exp_in_list[[3]]$Y, setup_med_exp_in_list[[3]]$N0, setup_med_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_in_est_sc10 <- sc_estimate(setup_med_exp_in_list[[4]]$Y, setup_med_exp_in_list[[4]]$N0, setup_med_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_in_est_sc11 <- sc_estimate(setup_med_exp_in_list[[5]]$Y, setup_med_exp_in_list[[5]]$N0, setup_med_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_in_est_sc12 <- sc_estimate(setup_med_exp_in_list[[6]]$Y, setup_med_exp_in_list[[6]]$N0, setup_med_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_in_est_sc13 <- sc_estimate(setup_med_exp_in_list[[7]]$Y, setup_med_exp_in_list[[7]]$N0, setup_med_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_in_est_sc15 <- sc_estimate(setup_med_exp_in_list[[8]]$Y, setup_med_exp_in_list[[8]]$N0, setup_med_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_in_est_sc17 <- sc_estimate(setup_med_exp_in_list[[9]]$Y, setup_med_exp_in_list[[9]]$N0, setup_med_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_in_est_sc19 <- sc_estimate(setup_med_exp_in_list[[10]]$Y, setup_med_exp_in_list[[10]]$N0, setup_med_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_in_est_sc21 <- sc_estimate(setup_med_exp_in_list[[11]]$Y, setup_med_exp_in_list[[11]]$N0, setup_med_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_in_est_sc23 <- sc_estimate(setup_med_exp_in_list[[12]]$Y, setup_med_exp_in_list[[12]]$N0, setup_med_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_in_est_sc24 <- sc_estimate(setup_med_exp_in_list[[13]]$Y, setup_med_exp_in_list[[13]]$N0, setup_med_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_in_est_sc25 <- sc_estimate(setup_med_exp_in_list[[14]]$Y, setup_med_exp_in_list[[14]]$N0, setup_med_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_in_est_sc26 <- sc_estimate(setup_med_exp_in_list[[15]]$Y, setup_med_exp_in_list[[15]]$N0, setup_med_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_in_est_sc28 <- sc_estimate(setup_med_exp_in_list[[16]]$Y, setup_med_exp_in_list[[16]]$N0, setup_med_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_in_est_sc29 <- sc_estimate(setup_med_exp_in_list[[17]]$Y, setup_med_exp_in_list[[17]]$N0, setup_med_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_in_est_sc30 <- sc_estimate(setup_med_exp_in_list[[18]]$Y, setup_med_exp_in_list[[18]]$N0, setup_med_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_in_est_sc31 <- sc_estimate(setup_med_exp_in_list[[19]]$Y, setup_med_exp_in_list[[19]]$N0, setup_med_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_in_est_sc32 <- sc_estimate(setup_med_exp_in_list[[20]]$Y, setup_med_exp_in_list[[20]]$N0, setup_med_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_in_est_sc33 <- sc_estimate(setup_med_exp_in_list[[21]]$Y, setup_med_exp_in_list[[21]]$N0, setup_med_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_in_est_sc34 <- sc_estimate(setup_med_exp_in_list[[22]]$Y, setup_med_exp_in_list[[22]]$N0, setup_med_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_in_est_sc36 <- sc_estimate(setup_med_exp_in_list[[23]]$Y, setup_med_exp_in_list[[23]]$N0, setup_med_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_in_est_sc37 <- sc_estimate(setup_med_exp_in_list[[24]]$Y, setup_med_exp_in_list[[24]]$N0, setup_med_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_in_est_sc39 <- sc_estimate(setup_med_exp_in_list[[25]]$Y, setup_med_exp_in_list[[25]]$N0, setup_med_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_in_est_sc40 <- sc_estimate(setup_med_exp_in_list[[26]]$Y, setup_med_exp_in_list[[26]]$N0, setup_med_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_in_est_sc41 <- sc_estimate(setup_med_exp_in_list[[27]]$Y, setup_med_exp_in_list[[27]]$N0, setup_med_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_in_est_sc44 <- sc_estimate(setup_med_exp_in_list[[28]]$Y, setup_med_exp_in_list[[28]]$N0, setup_med_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_in_est_sc45 <- sc_estimate(setup_med_exp_in_list[[29]]$Y, setup_med_exp_in_list[[29]]$N0, setup_med_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_in_est_sc47 <- sc_estimate(setup_med_exp_in_list[[30]]$Y, setup_med_exp_in_list[[30]]$N0, setup_med_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_in_est_sc50 <- sc_estimate(setup_med_exp_in_list[[31]]$Y, setup_med_exp_in_list[[31]]$N0, setup_med_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_in_est_sc51 <- sc_estimate(setup_med_exp_in_list[[32]]$Y, setup_med_exp_in_list[[32]]$N0, setup_med_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_in_est_sc53 <- sc_estimate(setup_med_exp_in_list[[33]]$Y, setup_med_exp_in_list[[33]]$N0, setup_med_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_in_est_sc54 <- sc_estimate(setup_med_exp_in_list[[34]]$Y, setup_med_exp_in_list[[34]]$N0, setup_med_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_in_est_sc55 <- sc_estimate(setup_med_exp_in_list[[35]]$Y, setup_med_exp_in_list[[35]]$N0, setup_med_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_in_est_sc_list <- list(med_exp_in_est_sc1,med_exp_in_est_sc2,med_exp_in_est_sc5,
                               med_exp_in_est_sc10,med_exp_in_est_sc11,med_exp_in_est_sc12,
                               med_exp_in_est_sc13,med_exp_in_est_sc15,med_exp_in_est_sc17,
                               med_exp_in_est_sc19,med_exp_in_est_sc21,med_exp_in_est_sc23,
                               med_exp_in_est_sc24,med_exp_in_est_sc25,med_exp_in_est_sc26,
                               med_exp_in_est_sc28,med_exp_in_est_sc29,med_exp_in_est_sc30,
                               med_exp_in_est_sc31,med_exp_in_est_sc32,med_exp_in_est_sc33,
                               med_exp_in_est_sc34,med_exp_in_est_sc36,med_exp_in_est_sc37,
                               med_exp_in_est_sc39,med_exp_in_est_sc40,med_exp_in_est_sc41,
                               med_exp_in_est_sc44,med_exp_in_est_sc45,med_exp_in_est_sc47,
                               med_exp_in_est_sc50,med_exp_in_est_sc51,med_exp_in_est_sc53,
                               med_exp_in_est_sc54,med_exp_in_est_sc55)
rm(med_exp_in_est_sc1,med_exp_in_est_sc2,med_exp_in_est_sc5,
   med_exp_in_est_sc10,med_exp_in_est_sc11,med_exp_in_est_sc12,
   med_exp_in_est_sc13,med_exp_in_est_sc15,med_exp_in_est_sc17,
   med_exp_in_est_sc19,med_exp_in_est_sc21,med_exp_in_est_sc23,
   med_exp_in_est_sc24,med_exp_in_est_sc25,med_exp_in_est_sc26,
   med_exp_in_est_sc28,med_exp_in_est_sc29,med_exp_in_est_sc30,
   med_exp_in_est_sc31,med_exp_in_est_sc32,med_exp_in_est_sc33,
   med_exp_in_est_sc34,med_exp_in_est_sc36,med_exp_in_est_sc37,
   med_exp_in_est_sc39,med_exp_in_est_sc40,med_exp_in_est_sc41,
   med_exp_in_est_sc44,med_exp_in_est_sc45,med_exp_in_est_sc47,
   med_exp_in_est_sc50,med_exp_in_est_sc51,med_exp_in_est_sc53,
   med_exp_in_est_sc54,med_exp_in_est_sc55)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sc_plot", i), synthdid_plot(med_exp_in_est_sc_list[i]))
}
med_exp_in_est_sc_plot_data_aux1 <- ggplot_build(med_exp_in_est_sc_plot1)
med_exp_in_est_sc_plot_data_aux2 <- ggplot_build(med_exp_in_est_sc_plot2)
med_exp_in_est_sc_plot_data_aux3 <- ggplot_build(med_exp_in_est_sc_plot3)
med_exp_in_est_sc_plot_data_aux4 <- ggplot_build(med_exp_in_est_sc_plot4)
med_exp_in_est_sc_plot_data_aux5 <- ggplot_build(med_exp_in_est_sc_plot5)
med_exp_in_est_sc_plot_data_aux6 <- ggplot_build(med_exp_in_est_sc_plot6)
med_exp_in_est_sc_plot_data_aux7 <- ggplot_build(med_exp_in_est_sc_plot7)
med_exp_in_est_sc_plot_data_aux8 <- ggplot_build(med_exp_in_est_sc_plot8)
med_exp_in_est_sc_plot_data_aux9 <- ggplot_build(med_exp_in_est_sc_plot9)
med_exp_in_est_sc_plot_data_aux10 <- ggplot_build(med_exp_in_est_sc_plot10)
med_exp_in_est_sc_plot_data_aux11 <- ggplot_build(med_exp_in_est_sc_plot11)
med_exp_in_est_sc_plot_data_aux12 <- ggplot_build(med_exp_in_est_sc_plot12)
med_exp_in_est_sc_plot_data_aux13 <- ggplot_build(med_exp_in_est_sc_plot13)
med_exp_in_est_sc_plot_data_aux14 <- ggplot_build(med_exp_in_est_sc_plot14)
med_exp_in_est_sc_plot_data_aux15 <- ggplot_build(med_exp_in_est_sc_plot15)
med_exp_in_est_sc_plot_data_aux16 <- ggplot_build(med_exp_in_est_sc_plot16)
med_exp_in_est_sc_plot_data_aux17 <- ggplot_build(med_exp_in_est_sc_plot17)
med_exp_in_est_sc_plot_data_aux18 <- ggplot_build(med_exp_in_est_sc_plot18)
med_exp_in_est_sc_plot_data_aux19 <- ggplot_build(med_exp_in_est_sc_plot19)
med_exp_in_est_sc_plot_data_aux20 <- ggplot_build(med_exp_in_est_sc_plot20)
med_exp_in_est_sc_plot_data_aux21 <- ggplot_build(med_exp_in_est_sc_plot21)
med_exp_in_est_sc_plot_data_aux22 <- ggplot_build(med_exp_in_est_sc_plot22)
med_exp_in_est_sc_plot_data_aux23 <- ggplot_build(med_exp_in_est_sc_plot23)
med_exp_in_est_sc_plot_data_aux24 <- ggplot_build(med_exp_in_est_sc_plot24)
med_exp_in_est_sc_plot_data_aux25 <- ggplot_build(med_exp_in_est_sc_plot25)
med_exp_in_est_sc_plot_data_aux26 <- ggplot_build(med_exp_in_est_sc_plot26)
med_exp_in_est_sc_plot_data_aux27 <- ggplot_build(med_exp_in_est_sc_plot27)
med_exp_in_est_sc_plot_data_aux28 <- ggplot_build(med_exp_in_est_sc_plot28)
med_exp_in_est_sc_plot_data_aux29 <- ggplot_build(med_exp_in_est_sc_plot29)
med_exp_in_est_sc_plot_data_aux30 <- ggplot_build(med_exp_in_est_sc_plot30)
med_exp_in_est_sc_plot_data_aux31 <- ggplot_build(med_exp_in_est_sc_plot31)
med_exp_in_est_sc_plot_data_aux32 <- ggplot_build(med_exp_in_est_sc_plot32)
med_exp_in_est_sc_plot_data_aux33 <- ggplot_build(med_exp_in_est_sc_plot33)
med_exp_in_est_sc_plot_data_aux34 <- ggplot_build(med_exp_in_est_sc_plot34)
med_exp_in_est_sc_plot_data_aux35 <- ggplot_build(med_exp_in_est_sc_plot35)
med_exp_in_est_sc_plot_data_aux_list <- list(med_exp_in_est_sc_plot_data_aux1,med_exp_in_est_sc_plot_data_aux2,med_exp_in_est_sc_plot_data_aux3,
                                             med_exp_in_est_sc_plot_data_aux4,med_exp_in_est_sc_plot_data_aux5,med_exp_in_est_sc_plot_data_aux6,
                                             med_exp_in_est_sc_plot_data_aux7,med_exp_in_est_sc_plot_data_aux8,med_exp_in_est_sc_plot_data_aux9,
                                             med_exp_in_est_sc_plot_data_aux10,med_exp_in_est_sc_plot_data_aux11,med_exp_in_est_sc_plot_data_aux12,
                                             med_exp_in_est_sc_plot_data_aux13,med_exp_in_est_sc_plot_data_aux14,med_exp_in_est_sc_plot_data_aux15,
                                             med_exp_in_est_sc_plot_data_aux16,med_exp_in_est_sc_plot_data_aux17,med_exp_in_est_sc_plot_data_aux18,
                                             med_exp_in_est_sc_plot_data_aux19,med_exp_in_est_sc_plot_data_aux20,med_exp_in_est_sc_plot_data_aux21,
                                             med_exp_in_est_sc_plot_data_aux22,med_exp_in_est_sc_plot_data_aux23,med_exp_in_est_sc_plot_data_aux24,
                                             med_exp_in_est_sc_plot_data_aux25,med_exp_in_est_sc_plot_data_aux26,med_exp_in_est_sc_plot_data_aux27,
                                             med_exp_in_est_sc_plot_data_aux28,med_exp_in_est_sc_plot_data_aux29,med_exp_in_est_sc_plot_data_aux30,
                                             med_exp_in_est_sc_plot_data_aux31,med_exp_in_est_sc_plot_data_aux32,med_exp_in_est_sc_plot_data_aux33,
                                             med_exp_in_est_sc_plot_data_aux34,med_exp_in_est_sc_plot_data_aux35)
rm(med_exp_in_est_sc_plot_data_aux1,med_exp_in_est_sc_plot_data_aux2,med_exp_in_est_sc_plot_data_aux3,
   med_exp_in_est_sc_plot_data_aux4,med_exp_in_est_sc_plot_data_aux5,med_exp_in_est_sc_plot_data_aux6,
   med_exp_in_est_sc_plot_data_aux7,med_exp_in_est_sc_plot_data_aux8,med_exp_in_est_sc_plot_data_aux9,
   med_exp_in_est_sc_plot_data_aux10,med_exp_in_est_sc_plot_data_aux11,med_exp_in_est_sc_plot_data_aux12,
   med_exp_in_est_sc_plot_data_aux13,med_exp_in_est_sc_plot_data_aux14,med_exp_in_est_sc_plot_data_aux15,
   med_exp_in_est_sc_plot_data_aux16,med_exp_in_est_sc_plot_data_aux17,med_exp_in_est_sc_plot_data_aux18,
   med_exp_in_est_sc_plot_data_aux19,med_exp_in_est_sc_plot_data_aux20,med_exp_in_est_sc_plot_data_aux21,
   med_exp_in_est_sc_plot_data_aux22,med_exp_in_est_sc_plot_data_aux23,med_exp_in_est_sc_plot_data_aux24,
   med_exp_in_est_sc_plot_data_aux25,med_exp_in_est_sc_plot_data_aux26,med_exp_in_est_sc_plot_data_aux27,
   med_exp_in_est_sc_plot_data_aux28,med_exp_in_est_sc_plot_data_aux29,med_exp_in_est_sc_plot_data_aux30,
   med_exp_in_est_sc_plot_data_aux31,med_exp_in_est_sc_plot_data_aux32,med_exp_in_est_sc_plot_data_aux33,
   med_exp_in_est_sc_plot_data_aux34,med_exp_in_est_sc_plot_data_aux35)
rm(med_exp_in_est_sc_plot1,med_exp_in_est_sc_plot2,med_exp_in_est_sc_plot3,
   med_exp_in_est_sc_plot4,med_exp_in_est_sc_plot5,med_exp_in_est_sc_plot6,
   med_exp_in_est_sc_plot7,med_exp_in_est_sc_plot8,med_exp_in_est_sc_plot9,
   med_exp_in_est_sc_plot10,med_exp_in_est_sc_plot11,med_exp_in_est_sc_plot12,
   med_exp_in_est_sc_plot13,med_exp_in_est_sc_plot14,med_exp_in_est_sc_plot15,
   med_exp_in_est_sc_plot16,med_exp_in_est_sc_plot17,med_exp_in_est_sc_plot18,
   med_exp_in_est_sc_plot19,med_exp_in_est_sc_plot20,med_exp_in_est_sc_plot21,
   med_exp_in_est_sc_plot22,med_exp_in_est_sc_plot23,med_exp_in_est_sc_plot24,
   med_exp_in_est_sc_plot25,med_exp_in_est_sc_plot26,med_exp_in_est_sc_plot27,
   med_exp_in_est_sc_plot28,med_exp_in_est_sc_plot29,med_exp_in_est_sc_plot30,
   med_exp_in_est_sc_plot31,med_exp_in_est_sc_plot32,med_exp_in_est_sc_plot33,
   med_exp_in_est_sc_plot34,med_exp_in_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sc_plot_data_long", i), data.frame(med_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_in_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_in_est_sc_plot_data_long_list <- list(med_exp_in_est_sc_plot_data_long1,med_exp_in_est_sc_plot_data_long2,med_exp_in_est_sc_plot_data_long3,
                                              med_exp_in_est_sc_plot_data_long4,med_exp_in_est_sc_plot_data_long5,med_exp_in_est_sc_plot_data_long6,
                                              med_exp_in_est_sc_plot_data_long7,med_exp_in_est_sc_plot_data_long8,med_exp_in_est_sc_plot_data_long9,
                                              med_exp_in_est_sc_plot_data_long10,med_exp_in_est_sc_plot_data_long11,med_exp_in_est_sc_plot_data_long12,
                                              med_exp_in_est_sc_plot_data_long13,med_exp_in_est_sc_plot_data_long14,med_exp_in_est_sc_plot_data_long15,
                                              med_exp_in_est_sc_plot_data_long16,med_exp_in_est_sc_plot_data_long17,med_exp_in_est_sc_plot_data_long18,
                                              med_exp_in_est_sc_plot_data_long19,med_exp_in_est_sc_plot_data_long20,med_exp_in_est_sc_plot_data_long21,
                                              med_exp_in_est_sc_plot_data_long22,med_exp_in_est_sc_plot_data_long23,med_exp_in_est_sc_plot_data_long24,
                                              med_exp_in_est_sc_plot_data_long25,med_exp_in_est_sc_plot_data_long26,med_exp_in_est_sc_plot_data_long27,
                                              med_exp_in_est_sc_plot_data_long28,med_exp_in_est_sc_plot_data_long29,med_exp_in_est_sc_plot_data_long30,
                                              med_exp_in_est_sc_plot_data_long31,med_exp_in_est_sc_plot_data_long32,med_exp_in_est_sc_plot_data_long33,
                                              med_exp_in_est_sc_plot_data_long34,med_exp_in_est_sc_plot_data_long35)
rm(med_exp_in_est_sc_plot_data_long1,med_exp_in_est_sc_plot_data_long2,med_exp_in_est_sc_plot_data_long3,
   med_exp_in_est_sc_plot_data_long4,med_exp_in_est_sc_plot_data_long5,med_exp_in_est_sc_plot_data_long6,
   med_exp_in_est_sc_plot_data_long7,med_exp_in_est_sc_plot_data_long8,med_exp_in_est_sc_plot_data_long9,
   med_exp_in_est_sc_plot_data_long10,med_exp_in_est_sc_plot_data_long11,med_exp_in_est_sc_plot_data_long12,
   med_exp_in_est_sc_plot_data_long13,med_exp_in_est_sc_plot_data_long14,med_exp_in_est_sc_plot_data_long15,
   med_exp_in_est_sc_plot_data_long16,med_exp_in_est_sc_plot_data_long17,med_exp_in_est_sc_plot_data_long18,
   med_exp_in_est_sc_plot_data_long19,med_exp_in_est_sc_plot_data_long20,med_exp_in_est_sc_plot_data_long21,
   med_exp_in_est_sc_plot_data_long22,med_exp_in_est_sc_plot_data_long23,med_exp_in_est_sc_plot_data_long24,
   med_exp_in_est_sc_plot_data_long25,med_exp_in_est_sc_plot_data_long26,med_exp_in_est_sc_plot_data_long27,
   med_exp_in_est_sc_plot_data_long28,med_exp_in_est_sc_plot_data_long29,med_exp_in_est_sc_plot_data_long30,
   med_exp_in_est_sc_plot_data_long31,med_exp_in_est_sc_plot_data_long32,med_exp_in_est_sc_plot_data_long33,
   med_exp_in_est_sc_plot_data_long34,med_exp_in_est_sc_plot_data_long35)
med_exp_in_est_sc_plot_data_long_list <- lapply(med_exp_in_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sc_plot_data_wide", i), reshape(data=med_exp_in_est_sc_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
med_exp_in_est_sc_plot_data_wide_list <- list(med_exp_in_est_sc_plot_data_wide1,med_exp_in_est_sc_plot_data_wide2,med_exp_in_est_sc_plot_data_wide3,
                                              med_exp_in_est_sc_plot_data_wide4,med_exp_in_est_sc_plot_data_wide5,med_exp_in_est_sc_plot_data_wide6,
                                              med_exp_in_est_sc_plot_data_wide7,med_exp_in_est_sc_plot_data_wide8,med_exp_in_est_sc_plot_data_wide9,
                                              med_exp_in_est_sc_plot_data_wide10,med_exp_in_est_sc_plot_data_wide11,med_exp_in_est_sc_plot_data_wide12,
                                              med_exp_in_est_sc_plot_data_wide13,med_exp_in_est_sc_plot_data_wide14,med_exp_in_est_sc_plot_data_wide15,
                                              med_exp_in_est_sc_plot_data_wide16,med_exp_in_est_sc_plot_data_wide17,med_exp_in_est_sc_plot_data_wide18,
                                              med_exp_in_est_sc_plot_data_wide19,med_exp_in_est_sc_plot_data_wide20,med_exp_in_est_sc_plot_data_wide21,
                                              med_exp_in_est_sc_plot_data_wide22,med_exp_in_est_sc_plot_data_wide23,med_exp_in_est_sc_plot_data_wide24,
                                              med_exp_in_est_sc_plot_data_wide25,med_exp_in_est_sc_plot_data_wide26,med_exp_in_est_sc_plot_data_wide27,
                                              med_exp_in_est_sc_plot_data_wide28,med_exp_in_est_sc_plot_data_wide29,med_exp_in_est_sc_plot_data_wide30,
                                              med_exp_in_est_sc_plot_data_wide31,med_exp_in_est_sc_plot_data_wide32,med_exp_in_est_sc_plot_data_wide33,
                                              med_exp_in_est_sc_plot_data_wide34,med_exp_in_est_sc_plot_data_wide35)
rm(med_exp_in_est_sc_plot_data_wide1,med_exp_in_est_sc_plot_data_wide2,med_exp_in_est_sc_plot_data_wide3,
   med_exp_in_est_sc_plot_data_wide4,med_exp_in_est_sc_plot_data_wide5,med_exp_in_est_sc_plot_data_wide6,
   med_exp_in_est_sc_plot_data_wide7,med_exp_in_est_sc_plot_data_wide8,med_exp_in_est_sc_plot_data_wide9,
   med_exp_in_est_sc_plot_data_wide10,med_exp_in_est_sc_plot_data_wide11,med_exp_in_est_sc_plot_data_wide12,
   med_exp_in_est_sc_plot_data_wide13,med_exp_in_est_sc_plot_data_wide14,med_exp_in_est_sc_plot_data_wide15,
   med_exp_in_est_sc_plot_data_wide16,med_exp_in_est_sc_plot_data_wide17,med_exp_in_est_sc_plot_data_wide18,
   med_exp_in_est_sc_plot_data_wide19,med_exp_in_est_sc_plot_data_wide20,med_exp_in_est_sc_plot_data_wide21,
   med_exp_in_est_sc_plot_data_wide22,med_exp_in_est_sc_plot_data_wide23,med_exp_in_est_sc_plot_data_wide24,
   med_exp_in_est_sc_plot_data_wide25,med_exp_in_est_sc_plot_data_wide26,med_exp_in_est_sc_plot_data_wide27,
   med_exp_in_est_sc_plot_data_wide28,med_exp_in_est_sc_plot_data_wide29,med_exp_in_est_sc_plot_data_wide30,
   med_exp_in_est_sc_plot_data_wide31,med_exp_in_est_sc_plot_data_wide32,med_exp_in_est_sc_plot_data_wide33,
   med_exp_in_est_sc_plot_data_wide34,med_exp_in_est_sc_plot_data_wide35)
med_exp_in_est_sc_plot_data_wide_list <- lapply(med_exp_in_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
med_exp_in_est_sdid1 <- synthdid_estimate(setup_med_exp_in_list[[1]]$Y, setup_med_exp_in_list[[1]]$N0, setup_med_exp_in_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_in_est_sdid2 <- synthdid_estimate(setup_med_exp_in_list[[2]]$Y, setup_med_exp_in_list[[2]]$N0, setup_med_exp_in_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_in_est_sdid5 <- synthdid_estimate(setup_med_exp_in_list[[3]]$Y, setup_med_exp_in_list[[3]]$N0, setup_med_exp_in_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_in_est_sdid10 <- synthdid_estimate(setup_med_exp_in_list[[4]]$Y, setup_med_exp_in_list[[4]]$N0, setup_med_exp_in_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_in_est_sdid11 <- synthdid_estimate(setup_med_exp_in_list[[5]]$Y, setup_med_exp_in_list[[5]]$N0, setup_med_exp_in_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_in_est_sdid12 <- synthdid_estimate(setup_med_exp_in_list[[6]]$Y, setup_med_exp_in_list[[6]]$N0, setup_med_exp_in_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_in_est_sdid13 <- synthdid_estimate(setup_med_exp_in_list[[7]]$Y, setup_med_exp_in_list[[7]]$N0, setup_med_exp_in_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_in_est_sdid15 <- synthdid_estimate(setup_med_exp_in_list[[8]]$Y, setup_med_exp_in_list[[8]]$N0, setup_med_exp_in_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_in_est_sdid17 <- synthdid_estimate(setup_med_exp_in_list[[9]]$Y, setup_med_exp_in_list[[9]]$N0, setup_med_exp_in_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_in_est_sdid19 <- synthdid_estimate(setup_med_exp_in_list[[10]]$Y, setup_med_exp_in_list[[10]]$N0, setup_med_exp_in_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_in_est_sdid21 <- synthdid_estimate(setup_med_exp_in_list[[11]]$Y, setup_med_exp_in_list[[11]]$N0, setup_med_exp_in_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_in_est_sdid23 <- synthdid_estimate(setup_med_exp_in_list[[12]]$Y, setup_med_exp_in_list[[12]]$N0, setup_med_exp_in_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_in_est_sdid24 <- synthdid_estimate(setup_med_exp_in_list[[13]]$Y, setup_med_exp_in_list[[13]]$N0, setup_med_exp_in_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_in_est_sdid25 <- synthdid_estimate(setup_med_exp_in_list[[14]]$Y, setup_med_exp_in_list[[14]]$N0, setup_med_exp_in_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_in_est_sdid26 <- synthdid_estimate(setup_med_exp_in_list[[15]]$Y, setup_med_exp_in_list[[15]]$N0, setup_med_exp_in_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_in_est_sdid28 <- synthdid_estimate(setup_med_exp_in_list[[16]]$Y, setup_med_exp_in_list[[16]]$N0, setup_med_exp_in_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_in_est_sdid29 <- synthdid_estimate(setup_med_exp_in_list[[17]]$Y, setup_med_exp_in_list[[17]]$N0, setup_med_exp_in_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_in_est_sdid30 <- synthdid_estimate(setup_med_exp_in_list[[18]]$Y, setup_med_exp_in_list[[18]]$N0, setup_med_exp_in_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_in_est_sdid31 <- synthdid_estimate(setup_med_exp_in_list[[19]]$Y, setup_med_exp_in_list[[19]]$N0, setup_med_exp_in_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_in_est_sdid32 <- synthdid_estimate(setup_med_exp_in_list[[20]]$Y, setup_med_exp_in_list[[20]]$N0, setup_med_exp_in_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_in_est_sdid33 <- synthdid_estimate(setup_med_exp_in_list[[21]]$Y, setup_med_exp_in_list[[21]]$N0, setup_med_exp_in_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_in_est_sdid34 <- synthdid_estimate(setup_med_exp_in_list[[22]]$Y, setup_med_exp_in_list[[22]]$N0, setup_med_exp_in_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_in_est_sdid36 <- synthdid_estimate(setup_med_exp_in_list[[23]]$Y, setup_med_exp_in_list[[23]]$N0, setup_med_exp_in_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_in_est_sdid37 <- synthdid_estimate(setup_med_exp_in_list[[24]]$Y, setup_med_exp_in_list[[24]]$N0, setup_med_exp_in_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_in_est_sdid39 <- synthdid_estimate(setup_med_exp_in_list[[25]]$Y, setup_med_exp_in_list[[25]]$N0, setup_med_exp_in_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_in_est_sdid40 <- synthdid_estimate(setup_med_exp_in_list[[26]]$Y, setup_med_exp_in_list[[26]]$N0, setup_med_exp_in_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_in_est_sdid41 <- synthdid_estimate(setup_med_exp_in_list[[27]]$Y, setup_med_exp_in_list[[27]]$N0, setup_med_exp_in_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_in_est_sdid44 <- synthdid_estimate(setup_med_exp_in_list[[28]]$Y, setup_med_exp_in_list[[28]]$N0, setup_med_exp_in_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_in_est_sdid45 <- synthdid_estimate(setup_med_exp_in_list[[29]]$Y, setup_med_exp_in_list[[29]]$N0, setup_med_exp_in_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_in_est_sdid47 <- synthdid_estimate(setup_med_exp_in_list[[30]]$Y, setup_med_exp_in_list[[30]]$N0, setup_med_exp_in_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_in_est_sdid50 <- synthdid_estimate(setup_med_exp_in_list[[31]]$Y, setup_med_exp_in_list[[31]]$N0, setup_med_exp_in_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_in_est_sdid51 <- synthdid_estimate(setup_med_exp_in_list[[32]]$Y, setup_med_exp_in_list[[32]]$N0, setup_med_exp_in_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_in_est_sdid53 <- synthdid_estimate(setup_med_exp_in_list[[33]]$Y, setup_med_exp_in_list[[33]]$N0, setup_med_exp_in_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_in_est_sdid54 <- synthdid_estimate(setup_med_exp_in_list[[34]]$Y, setup_med_exp_in_list[[34]]$N0, setup_med_exp_in_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_in_est_sdid55 <- synthdid_estimate(setup_med_exp_in_list[[35]]$Y, setup_med_exp_in_list[[35]]$N0, setup_med_exp_in_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_in_est_sdid_list <- list(med_exp_in_est_sdid1,med_exp_in_est_sdid2,med_exp_in_est_sdid5,
                                 med_exp_in_est_sdid10,med_exp_in_est_sdid11,med_exp_in_est_sdid12,
                                 med_exp_in_est_sdid13,med_exp_in_est_sdid15,med_exp_in_est_sdid17,
                                 med_exp_in_est_sdid19,med_exp_in_est_sdid21,med_exp_in_est_sdid23,
                                 med_exp_in_est_sdid24,med_exp_in_est_sdid25,med_exp_in_est_sdid26,
                                 med_exp_in_est_sdid28,med_exp_in_est_sdid29,med_exp_in_est_sdid30,
                                 med_exp_in_est_sdid31,med_exp_in_est_sdid32,med_exp_in_est_sdid33,
                                 med_exp_in_est_sdid34,med_exp_in_est_sdid36,med_exp_in_est_sdid37,
                                 med_exp_in_est_sdid39,med_exp_in_est_sdid40,med_exp_in_est_sdid41,
                                 med_exp_in_est_sdid44,med_exp_in_est_sdid45,med_exp_in_est_sdid47,
                                 med_exp_in_est_sdid50,med_exp_in_est_sdid51,med_exp_in_est_sdid53,
                                 med_exp_in_est_sdid54,med_exp_in_est_sdid55)
rm(med_exp_in_est_sdid1,med_exp_in_est_sdid2,med_exp_in_est_sdid5,
   med_exp_in_est_sdid10,med_exp_in_est_sdid11,med_exp_in_est_sdid12,
   med_exp_in_est_sdid13,med_exp_in_est_sdid15,med_exp_in_est_sdid17,
   med_exp_in_est_sdid19,med_exp_in_est_sdid21,med_exp_in_est_sdid23,
   med_exp_in_est_sdid24,med_exp_in_est_sdid25,med_exp_in_est_sdid26,
   med_exp_in_est_sdid28,med_exp_in_est_sdid29,med_exp_in_est_sdid30,
   med_exp_in_est_sdid31,med_exp_in_est_sdid32,med_exp_in_est_sdid33,
   med_exp_in_est_sdid34,med_exp_in_est_sdid36,med_exp_in_est_sdid37,
   med_exp_in_est_sdid39,med_exp_in_est_sdid40,med_exp_in_est_sdid41,
   med_exp_in_est_sdid44,med_exp_in_est_sdid45,med_exp_in_est_sdid47,
   med_exp_in_est_sdid50,med_exp_in_est_sdid51,med_exp_in_est_sdid53,
   med_exp_in_est_sdid54,med_exp_in_est_sdid55)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sdid_plot", i), synthdid_plot(med_exp_in_est_sdid_list[i]))
}
med_exp_in_est_sdid_plot_data_aux1 <- ggplot_build(med_exp_in_est_sdid_plot1)
med_exp_in_est_sdid_plot_data_aux2 <- ggplot_build(med_exp_in_est_sdid_plot2)
med_exp_in_est_sdid_plot_data_aux3 <- ggplot_build(med_exp_in_est_sdid_plot3)
med_exp_in_est_sdid_plot_data_aux4 <- ggplot_build(med_exp_in_est_sdid_plot4)
med_exp_in_est_sdid_plot_data_aux5 <- ggplot_build(med_exp_in_est_sdid_plot5)
med_exp_in_est_sdid_plot_data_aux6 <- ggplot_build(med_exp_in_est_sdid_plot6)
med_exp_in_est_sdid_plot_data_aux7 <- ggplot_build(med_exp_in_est_sdid_plot7)
med_exp_in_est_sdid_plot_data_aux8 <- ggplot_build(med_exp_in_est_sdid_plot8)
med_exp_in_est_sdid_plot_data_aux9 <- ggplot_build(med_exp_in_est_sdid_plot9)
med_exp_in_est_sdid_plot_data_aux10 <- ggplot_build(med_exp_in_est_sdid_plot10)
med_exp_in_est_sdid_plot_data_aux11 <- ggplot_build(med_exp_in_est_sdid_plot11)
med_exp_in_est_sdid_plot_data_aux12 <- ggplot_build(med_exp_in_est_sdid_plot12)
med_exp_in_est_sdid_plot_data_aux13 <- ggplot_build(med_exp_in_est_sdid_plot13)
med_exp_in_est_sdid_plot_data_aux14 <- ggplot_build(med_exp_in_est_sdid_plot14)
med_exp_in_est_sdid_plot_data_aux15 <- ggplot_build(med_exp_in_est_sdid_plot15)
med_exp_in_est_sdid_plot_data_aux16 <- ggplot_build(med_exp_in_est_sdid_plot16)
med_exp_in_est_sdid_plot_data_aux17 <- ggplot_build(med_exp_in_est_sdid_plot17)
med_exp_in_est_sdid_plot_data_aux18 <- ggplot_build(med_exp_in_est_sdid_plot18)
med_exp_in_est_sdid_plot_data_aux19 <- ggplot_build(med_exp_in_est_sdid_plot19)
med_exp_in_est_sdid_plot_data_aux20 <- ggplot_build(med_exp_in_est_sdid_plot20)
med_exp_in_est_sdid_plot_data_aux21 <- ggplot_build(med_exp_in_est_sdid_plot21)
med_exp_in_est_sdid_plot_data_aux22 <- ggplot_build(med_exp_in_est_sdid_plot22)
med_exp_in_est_sdid_plot_data_aux23 <- ggplot_build(med_exp_in_est_sdid_plot23)
med_exp_in_est_sdid_plot_data_aux24 <- ggplot_build(med_exp_in_est_sdid_plot24)
med_exp_in_est_sdid_plot_data_aux25 <- ggplot_build(med_exp_in_est_sdid_plot25)
med_exp_in_est_sdid_plot_data_aux26 <- ggplot_build(med_exp_in_est_sdid_plot26)
med_exp_in_est_sdid_plot_data_aux27 <- ggplot_build(med_exp_in_est_sdid_plot27)
med_exp_in_est_sdid_plot_data_aux28 <- ggplot_build(med_exp_in_est_sdid_plot28)
med_exp_in_est_sdid_plot_data_aux29 <- ggplot_build(med_exp_in_est_sdid_plot29)
med_exp_in_est_sdid_plot_data_aux30 <- ggplot_build(med_exp_in_est_sdid_plot30)
med_exp_in_est_sdid_plot_data_aux31 <- ggplot_build(med_exp_in_est_sdid_plot31)
med_exp_in_est_sdid_plot_data_aux32 <- ggplot_build(med_exp_in_est_sdid_plot32)
med_exp_in_est_sdid_plot_data_aux33 <- ggplot_build(med_exp_in_est_sdid_plot33)
med_exp_in_est_sdid_plot_data_aux34 <- ggplot_build(med_exp_in_est_sdid_plot34)
med_exp_in_est_sdid_plot_data_aux35 <- ggplot_build(med_exp_in_est_sdid_plot35)
med_exp_in_est_sdid_plot_data_aux_list <- list(med_exp_in_est_sdid_plot_data_aux1,med_exp_in_est_sdid_plot_data_aux2,med_exp_in_est_sdid_plot_data_aux3,
                                               med_exp_in_est_sdid_plot_data_aux4,med_exp_in_est_sdid_plot_data_aux5,med_exp_in_est_sdid_plot_data_aux6,
                                               med_exp_in_est_sdid_plot_data_aux7,med_exp_in_est_sdid_plot_data_aux8,med_exp_in_est_sdid_plot_data_aux9,
                                               med_exp_in_est_sdid_plot_data_aux10,med_exp_in_est_sdid_plot_data_aux11,med_exp_in_est_sdid_plot_data_aux12,
                                               med_exp_in_est_sdid_plot_data_aux13,med_exp_in_est_sdid_plot_data_aux14,med_exp_in_est_sdid_plot_data_aux15,
                                               med_exp_in_est_sdid_plot_data_aux16,med_exp_in_est_sdid_plot_data_aux17,med_exp_in_est_sdid_plot_data_aux18,
                                               med_exp_in_est_sdid_plot_data_aux19,med_exp_in_est_sdid_plot_data_aux20,med_exp_in_est_sdid_plot_data_aux21,
                                               med_exp_in_est_sdid_plot_data_aux22,med_exp_in_est_sdid_plot_data_aux23,med_exp_in_est_sdid_plot_data_aux24,
                                               med_exp_in_est_sdid_plot_data_aux25,med_exp_in_est_sdid_plot_data_aux26,med_exp_in_est_sdid_plot_data_aux27,
                                               med_exp_in_est_sdid_plot_data_aux28,med_exp_in_est_sdid_plot_data_aux29,med_exp_in_est_sdid_plot_data_aux30,
                                               med_exp_in_est_sdid_plot_data_aux31,med_exp_in_est_sdid_plot_data_aux32,med_exp_in_est_sdid_plot_data_aux33,
                                               med_exp_in_est_sdid_plot_data_aux34,med_exp_in_est_sdid_plot_data_aux35)
rm(med_exp_in_est_sdid_plot_data_aux1,med_exp_in_est_sdid_plot_data_aux2,med_exp_in_est_sdid_plot_data_aux3,
   med_exp_in_est_sdid_plot_data_aux4,med_exp_in_est_sdid_plot_data_aux5,med_exp_in_est_sdid_plot_data_aux6,
   med_exp_in_est_sdid_plot_data_aux7,med_exp_in_est_sdid_plot_data_aux8,med_exp_in_est_sdid_plot_data_aux9,
   med_exp_in_est_sdid_plot_data_aux10,med_exp_in_est_sdid_plot_data_aux11,med_exp_in_est_sdid_plot_data_aux12,
   med_exp_in_est_sdid_plot_data_aux13,med_exp_in_est_sdid_plot_data_aux14,med_exp_in_est_sdid_plot_data_aux15,
   med_exp_in_est_sdid_plot_data_aux16,med_exp_in_est_sdid_plot_data_aux17,med_exp_in_est_sdid_plot_data_aux18,
   med_exp_in_est_sdid_plot_data_aux19,med_exp_in_est_sdid_plot_data_aux20,med_exp_in_est_sdid_plot_data_aux21,
   med_exp_in_est_sdid_plot_data_aux22,med_exp_in_est_sdid_plot_data_aux23,med_exp_in_est_sdid_plot_data_aux24,
   med_exp_in_est_sdid_plot_data_aux25,med_exp_in_est_sdid_plot_data_aux26,med_exp_in_est_sdid_plot_data_aux27,
   med_exp_in_est_sdid_plot_data_aux28,med_exp_in_est_sdid_plot_data_aux29,med_exp_in_est_sdid_plot_data_aux30,
   med_exp_in_est_sdid_plot_data_aux31,med_exp_in_est_sdid_plot_data_aux32,med_exp_in_est_sdid_plot_data_aux33,
   med_exp_in_est_sdid_plot_data_aux34,med_exp_in_est_sdid_plot_data_aux35)
rm(med_exp_in_est_sdid_plot1,med_exp_in_est_sdid_plot2,med_exp_in_est_sdid_plot3,
   med_exp_in_est_sdid_plot4,med_exp_in_est_sdid_plot5,med_exp_in_est_sdid_plot6,
   med_exp_in_est_sdid_plot7,med_exp_in_est_sdid_plot8,med_exp_in_est_sdid_plot9,
   med_exp_in_est_sdid_plot10,med_exp_in_est_sdid_plot11,med_exp_in_est_sdid_plot12,
   med_exp_in_est_sdid_plot13,med_exp_in_est_sdid_plot14,med_exp_in_est_sdid_plot15,
   med_exp_in_est_sdid_plot16,med_exp_in_est_sdid_plot17,med_exp_in_est_sdid_plot18,
   med_exp_in_est_sdid_plot19,med_exp_in_est_sdid_plot20,med_exp_in_est_sdid_plot21,
   med_exp_in_est_sdid_plot22,med_exp_in_est_sdid_plot23,med_exp_in_est_sdid_plot24,
   med_exp_in_est_sdid_plot25,med_exp_in_est_sdid_plot26,med_exp_in_est_sdid_plot27,
   med_exp_in_est_sdid_plot28,med_exp_in_est_sdid_plot29,med_exp_in_est_sdid_plot30,
   med_exp_in_est_sdid_plot31,med_exp_in_est_sdid_plot32,med_exp_in_est_sdid_plot33,
   med_exp_in_est_sdid_plot34,med_exp_in_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sdid_plot_data_long", i), data.frame(med_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_in_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_in_est_sdid_plot_data_long_list <- list(med_exp_in_est_sdid_plot_data_long1,med_exp_in_est_sdid_plot_data_long2,med_exp_in_est_sdid_plot_data_long3,
                                                med_exp_in_est_sdid_plot_data_long4,med_exp_in_est_sdid_plot_data_long5,med_exp_in_est_sdid_plot_data_long6,
                                                med_exp_in_est_sdid_plot_data_long7,med_exp_in_est_sdid_plot_data_long8,med_exp_in_est_sdid_plot_data_long9,
                                                med_exp_in_est_sdid_plot_data_long10,med_exp_in_est_sdid_plot_data_long11,med_exp_in_est_sdid_plot_data_long12,
                                                med_exp_in_est_sdid_plot_data_long13,med_exp_in_est_sdid_plot_data_long14,med_exp_in_est_sdid_plot_data_long15,
                                                med_exp_in_est_sdid_plot_data_long16,med_exp_in_est_sdid_plot_data_long17,med_exp_in_est_sdid_plot_data_long18,
                                                med_exp_in_est_sdid_plot_data_long19,med_exp_in_est_sdid_plot_data_long20,med_exp_in_est_sdid_plot_data_long21,
                                                med_exp_in_est_sdid_plot_data_long22,med_exp_in_est_sdid_plot_data_long23,med_exp_in_est_sdid_plot_data_long24,
                                                med_exp_in_est_sdid_plot_data_long25,med_exp_in_est_sdid_plot_data_long26,med_exp_in_est_sdid_plot_data_long27,
                                                med_exp_in_est_sdid_plot_data_long28,med_exp_in_est_sdid_plot_data_long29,med_exp_in_est_sdid_plot_data_long30,
                                                med_exp_in_est_sdid_plot_data_long31,med_exp_in_est_sdid_plot_data_long32,med_exp_in_est_sdid_plot_data_long33,
                                                med_exp_in_est_sdid_plot_data_long34,med_exp_in_est_sdid_plot_data_long35)
rm(med_exp_in_est_sdid_plot_data_long1,med_exp_in_est_sdid_plot_data_long2,med_exp_in_est_sdid_plot_data_long3,
   med_exp_in_est_sdid_plot_data_long4,med_exp_in_est_sdid_plot_data_long5,med_exp_in_est_sdid_plot_data_long6,
   med_exp_in_est_sdid_plot_data_long7,med_exp_in_est_sdid_plot_data_long8,med_exp_in_est_sdid_plot_data_long9,
   med_exp_in_est_sdid_plot_data_long10,med_exp_in_est_sdid_plot_data_long11,med_exp_in_est_sdid_plot_data_long12,
   med_exp_in_est_sdid_plot_data_long13,med_exp_in_est_sdid_plot_data_long14,med_exp_in_est_sdid_plot_data_long15,
   med_exp_in_est_sdid_plot_data_long16,med_exp_in_est_sdid_plot_data_long17,med_exp_in_est_sdid_plot_data_long18,
   med_exp_in_est_sdid_plot_data_long19,med_exp_in_est_sdid_plot_data_long20,med_exp_in_est_sdid_plot_data_long21,
   med_exp_in_est_sdid_plot_data_long22,med_exp_in_est_sdid_plot_data_long23,med_exp_in_est_sdid_plot_data_long24,
   med_exp_in_est_sdid_plot_data_long25,med_exp_in_est_sdid_plot_data_long26,med_exp_in_est_sdid_plot_data_long27,
   med_exp_in_est_sdid_plot_data_long28,med_exp_in_est_sdid_plot_data_long29,med_exp_in_est_sdid_plot_data_long30,
   med_exp_in_est_sdid_plot_data_long31,med_exp_in_est_sdid_plot_data_long32,med_exp_in_est_sdid_plot_data_long33,
   med_exp_in_est_sdid_plot_data_long34,med_exp_in_est_sdid_plot_data_long35)
med_exp_in_est_sdid_plot_data_long_list <- lapply(med_exp_in_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_in_est_sdid_plot_data_wide", i), reshape(data=med_exp_in_est_sdid_plot_data_long_list[[i]],
                                                                  idvar = "year",
                                                                  v.names = "outcome",
                                                                  timevar = "treated",
                                                                  direction = "wide"))
}
med_exp_in_est_sdid_plot_data_wide_list <- list(med_exp_in_est_sdid_plot_data_wide1,med_exp_in_est_sdid_plot_data_wide2,med_exp_in_est_sdid_plot_data_wide3,
                                                med_exp_in_est_sdid_plot_data_wide4,med_exp_in_est_sdid_plot_data_wide5,med_exp_in_est_sdid_plot_data_wide6,
                                                med_exp_in_est_sdid_plot_data_wide7,med_exp_in_est_sdid_plot_data_wide8,med_exp_in_est_sdid_plot_data_wide9,
                                                med_exp_in_est_sdid_plot_data_wide10,med_exp_in_est_sdid_plot_data_wide11,med_exp_in_est_sdid_plot_data_wide12,
                                                med_exp_in_est_sdid_plot_data_wide13,med_exp_in_est_sdid_plot_data_wide14,med_exp_in_est_sdid_plot_data_wide15,
                                                med_exp_in_est_sdid_plot_data_wide16,med_exp_in_est_sdid_plot_data_wide17,med_exp_in_est_sdid_plot_data_wide18,
                                                med_exp_in_est_sdid_plot_data_wide19,med_exp_in_est_sdid_plot_data_wide20,med_exp_in_est_sdid_plot_data_wide21,
                                                med_exp_in_est_sdid_plot_data_wide22,med_exp_in_est_sdid_plot_data_wide23,med_exp_in_est_sdid_plot_data_wide24,
                                                med_exp_in_est_sdid_plot_data_wide25,med_exp_in_est_sdid_plot_data_wide26,med_exp_in_est_sdid_plot_data_wide27,
                                                med_exp_in_est_sdid_plot_data_wide28,med_exp_in_est_sdid_plot_data_wide29,med_exp_in_est_sdid_plot_data_wide30,
                                                med_exp_in_est_sdid_plot_data_wide31,med_exp_in_est_sdid_plot_data_wide32,med_exp_in_est_sdid_plot_data_wide33,
                                                med_exp_in_est_sdid_plot_data_wide34,med_exp_in_est_sdid_plot_data_wide35)
rm(med_exp_in_est_sdid_plot_data_wide1,med_exp_in_est_sdid_plot_data_wide2,med_exp_in_est_sdid_plot_data_wide3,
   med_exp_in_est_sdid_plot_data_wide4,med_exp_in_est_sdid_plot_data_wide5,med_exp_in_est_sdid_plot_data_wide6,
   med_exp_in_est_sdid_plot_data_wide7,med_exp_in_est_sdid_plot_data_wide8,med_exp_in_est_sdid_plot_data_wide9,
   med_exp_in_est_sdid_plot_data_wide10,med_exp_in_est_sdid_plot_data_wide11,med_exp_in_est_sdid_plot_data_wide12,
   med_exp_in_est_sdid_plot_data_wide13,med_exp_in_est_sdid_plot_data_wide14,med_exp_in_est_sdid_plot_data_wide15,
   med_exp_in_est_sdid_plot_data_wide16,med_exp_in_est_sdid_plot_data_wide17,med_exp_in_est_sdid_plot_data_wide18,
   med_exp_in_est_sdid_plot_data_wide19,med_exp_in_est_sdid_plot_data_wide20,med_exp_in_est_sdid_plot_data_wide21,
   med_exp_in_est_sdid_plot_data_wide22,med_exp_in_est_sdid_plot_data_wide23,med_exp_in_est_sdid_plot_data_wide24,
   med_exp_in_est_sdid_plot_data_wide25,med_exp_in_est_sdid_plot_data_wide26,med_exp_in_est_sdid_plot_data_wide27,
   med_exp_in_est_sdid_plot_data_wide28,med_exp_in_est_sdid_plot_data_wide29,med_exp_in_est_sdid_plot_data_wide30,
   med_exp_in_est_sdid_plot_data_wide31,med_exp_in_est_sdid_plot_data_wide32,med_exp_in_est_sdid_plot_data_wide33,
   med_exp_in_est_sdid_plot_data_wide34,med_exp_in_est_sdid_plot_data_wide35)
med_exp_in_est_sdid_plot_data_wide_list <- lapply(med_exp_in_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
med_exp_est_did_plot_data_wide_in$did_facet_title <- "Diff-in-Diff"
med_exp_est_sc_plot_data_wide_in$sc_facet_title <- "Synthetic Control"
med_exp_est_sdid_plot_data_wide_in$sdid_facet_title <- "Synthetic Diff-in-Diff"
med_exp_est_did_plot_data_wide_in$diff_relative <- med_exp_est_did_plot_data_wide_in$diff - med_exp_est_did_plot_data_wide_in$diff[19]
for(i in 1:35) {
  med_exp_in_est_did_plot_data_wide_list[[i]]$diff_relative <- med_exp_in_est_did_plot_data_wide_list[[i]]$diff - med_exp_in_est_did_plot_data_wide_list[[i]]$diff[19]
}
med_exp_in_spag_did_plot <- ggplot(med_exp_est_did_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_in_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Medicaid Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_in_spag_sc_plot <- ggplot(med_exp_est_sc_plot_data_wide_in, aes(year,diff)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = med_exp_in_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "Indiana"),data = med_exp_est_sc_plot_data_wide_in, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "Indiana" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_est_sdid_plot_data_wide_in$diff_relative <- med_exp_est_sdid_plot_data_wide_in$diff - med_exp_est_sdid_plot_data_wide_in$diff[19]
for(i in 1:35) {
  med_exp_in_est_sdid_plot_data_wide_list[[i]]$diff_relative <- med_exp_in_est_sdid_plot_data_wide_list[[i]]$diff - med_exp_in_est_sdid_plot_data_wide_list[[i]]$diff[19]
}
med_exp_in_spag_sdid_plot <- ggplot(med_exp_est_sdid_plot_data_wide_in, aes(year,diff_relative)) +
  geom_vline(xintercept = 1998, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_in_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
med_exp_in_est_did_vec <- c(med_exp_est_did_in)
for (i in c(1:4,6:35)) {
  med_exp_in_est_did_vec_aux <- med_exp_in_est_did_list[[i]][1]
  med_exp_in_est_did_vec <- c(med_exp_in_est_did_vec,med_exp_in_est_did_vec_aux)
}
med_exp_in_est_did_df <- data.frame(med_exp_in_est_did_vec)
med_exp_in_hist_did_plot_aux <- ggplot(data = NULL, aes(x = med_exp_in_est_did_vec)) +
  geom_histogram(data = med_exp_in_est_did_df, aes(x = med_exp_in_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_in_hist_did_plot1_ylim <- ggplot_build(med_exp_in_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_in_hist_did_plot <- med_exp_in_hist_did_plot_aux +
  expand_limits(y=med_exp_in_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_in_est_did_vec[1], mean(med_exp_in_est_did_vec[2:35])), xend = c(med_exp_in_est_did_vec[1],mean(med_exp_in_est_did_vec[2:35])), y = c(0,0), yend = c(med_exp_in_hist_did_plot1_ylim,med_exp_in_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_in_est_did_vec[1], mean(med_exp_in_est_did_vec[2:35])), y = c(med_exp_in_hist_did_plot1_ylim,med_exp_in_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_in_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_in_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0,1), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_in_est_sc_vec <- c(med_exp_est_sc_in)
for (i in c(1:4,6:35)) {
  med_exp_in_est_sc_vec_aux <- med_exp_in_est_sc_list[[i]][1]
  med_exp_in_est_sc_vec <- c(med_exp_in_est_sc_vec,med_exp_in_est_sc_vec_aux)
}
med_exp_in_est_sc_df <- data.frame(med_exp_in_est_sc_vec)
med_exp_in_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = med_exp_in_est_sc_vec)) +
  geom_histogram(data = med_exp_in_est_sc_df, aes(x = med_exp_in_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_in_hist_sc_plot1_ylim <- ggplot_build(med_exp_in_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_in_hist_sc_plot <- med_exp_in_hist_sc_plot_aux +
  expand_limits(y=med_exp_in_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_in_est_sc_vec[1], mean(med_exp_in_est_sc_vec[2:35])), xend = c(med_exp_in_est_sc_vec[1],mean(med_exp_in_est_sc_vec[2:35])), y = c(0,0), yend = c(med_exp_in_hist_sc_plot1_ylim,med_exp_in_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_in_est_sc_vec[1], mean(med_exp_in_est_sc_vec[2:35])), y = c(med_exp_in_hist_sc_plot1_ylim,med_exp_in_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_in_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_in_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.3,.7), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_in_est_sdid_vec <- c(med_exp_est_sdid_in)
for (i in c(1:4,6:35)) {
  med_exp_in_est_sdid_vec_aux <- med_exp_in_est_sdid_list[[i]][1]
  med_exp_in_est_sdid_vec <- c(med_exp_in_est_sdid_vec,med_exp_in_est_sdid_vec_aux)
}
med_exp_in_est_sdid_df <- data.frame(med_exp_in_est_sdid_vec)
med_exp_in_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = med_exp_in_est_sdid_vec)) +
  geom_histogram(data = med_exp_in_est_sdid_df, aes(x = med_exp_in_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_in_hist_sdid_plot1_ylim <- ggplot_build(med_exp_in_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_in_hist_sdid_plot <- med_exp_in_hist_sdid_plot_aux +
  expand_limits(y=med_exp_in_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_in_est_sdid_vec[1], mean(med_exp_in_est_sdid_vec[2:35])), xend = c(med_exp_in_est_sdid_vec[1],mean(med_exp_in_est_sdid_vec[2:35])), y = c(0,0), yend = c(med_exp_in_hist_sdid_plot1_ylim,med_exp_in_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_in_est_sdid_vec[1], mean(med_exp_in_est_sdid_vec[2:35])), y = c(med_exp_in_hist_sdid_plot1_ylim,med_exp_in_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_in_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_in_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/med_exp_spag_dist_plots_IN.pdf', paper = "USr", width = 10.9, height = 8.4)
(med_exp_in_spag_dist_plots_in <- med_exp_in_spag_did_plot + med_exp_in_spag_sc_plot + med_exp_in_spag_sdid_plot + med_exp_in_hist_did_plot + med_exp_in_hist_sc_plot + med_exp_in_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()








########## North Dakota ##########

##### Quantity of Nursing Homes #####
### ND - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_homes_nd_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_homes_nd_df$treated <- as.integer(ifelse(q_nursing_homes_nd_df$name == "North Dakota" & q_nursing_homes_nd_df$year >= 1995, 1, 0))
q_nursing_homes_nd_df <- q_nursing_homes_nd_df[order(q_nursing_homes_nd_df$year, q_nursing_homes_nd_df$treated_nd_aux, q_nursing_homes_nd_df$name),]
q_nursing_homes_nd_df <- subset(q_nursing_homes_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, Q_SkilledNursingHomes_pcp, treated))
setup_q_nh_nd <- panel.matrices(q_nursing_homes_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nh_est_did_nd <- did_estimate(setup_q_nh_nd$Y, setup_q_nh_nd$N0, setup_q_nh_nd$T0, X = covariates_acc_nd_array)
q_nh_est_did_plot_nd <- synthdid_plot(q_nh_est_did_nd)
q_nh_est_did_plot_data_aux_nd <- ggplot_build(q_nh_est_did_plot_nd)
q_nh_est_did_plot_data_long_nd <- data.frame(q_nh_est_did_plot_data_aux_nd$data[[1]]$x, q_nh_est_did_plot_data_aux_nd$data[[1]]$y, q_nh_est_did_plot_data_aux_nd$data[[1]]$group)
colnames(q_nh_est_did_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nh_est_did_plot_data_long_nd$treated <- q_nh_est_did_plot_data_long_nd$treated - 1
q_nh_est_did_plot_data_wide_nd <- reshape(data=q_nh_est_did_plot_data_long_nd,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nh_est_did_plot_data_wide_nd$diff <- q_nh_est_did_plot_data_wide_nd$outcome.1 - q_nh_est_did_plot_data_wide_nd$outcome.0
# SC #
q_nh_est_sc_nd <- sc_estimate(setup_q_nh_nd$Y, setup_q_nh_nd$N0, setup_q_nh_nd$T0, X = covariates_acc_nd_array)
q_nh_est_sc_plot_nd <- synthdid_plot(q_nh_est_sc_nd)
q_nh_est_sc_plot_data_aux_nd <- ggplot_build(q_nh_est_sc_plot_nd)
q_nh_est_sc_plot_data_long_nd <- data.frame(q_nh_est_sc_plot_data_aux_nd$data[[1]]$x, q_nh_est_sc_plot_data_aux_nd$data[[1]]$y, q_nh_est_sc_plot_data_aux_nd$data[[1]]$group)
colnames(q_nh_est_sc_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nh_est_sc_plot_data_long_nd$treated <- q_nh_est_sc_plot_data_long_nd$treated - 1
q_nh_est_sc_plot_data_wide_nd <- reshape(data=q_nh_est_sc_plot_data_long_nd,
                                         idvar = "year",
                                         v.names = "outcome",
                                         timevar = "treated",
                                         direction = "wide")
q_nh_est_sc_plot_data_wide_nd$diff <- q_nh_est_sc_plot_data_wide_nd$outcome.1 - q_nh_est_sc_plot_data_wide_nd$outcome.0
# SDID #
q_nh_est_sdid_nd <- synthdid_estimate(setup_q_nh_nd$Y, setup_q_nh_nd$N0, setup_q_nh_nd$T0, X = covariates_acc_nd_array)
q_nh_est_sdid_plot_nd <- synthdid_plot(q_nh_est_sdid_nd)
q_nh_est_sdid_plot_data_aux_nd <- ggplot_build(q_nh_est_sdid_plot_nd)
q_nh_est_sdid_plot_data_long_nd <- data.frame(q_nh_est_sdid_plot_data_aux_nd$data[[1]]$x, q_nh_est_sdid_plot_data_aux_nd$data[[1]]$y, q_nh_est_sdid_plot_data_aux_nd$data[[1]]$group)
colnames(q_nh_est_sdid_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nh_est_sdid_plot_data_long_nd$treated <- q_nh_est_sdid_plot_data_long_nd$treated - 1
q_nh_est_sdid_plot_data_wide_nd <- reshape(data=q_nh_est_sdid_plot_data_long_nd,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nh_est_sdid_plot_data_wide_nd$diff <- q_nh_est_sdid_plot_data_wide_nd$outcome.1 - q_nh_est_sdid_plot_data_wide_nd$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nh_nd_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nh_nd_df1$treated_aux <- ifelse(q_nh_nd_df1$id == 1, 1, 0)
q_nh_nd_df2$treated_aux <- ifelse(q_nh_nd_df2$id == 2, 1, 0)
q_nh_nd_df5$treated_aux <- ifelse(q_nh_nd_df5$id == 5, 1, 0)
q_nh_nd_df10$treated_aux <- ifelse(q_nh_nd_df10$id == 10, 1, 0)
q_nh_nd_df11$treated_aux <- ifelse(q_nh_nd_df11$id == 11, 1, 0)
q_nh_nd_df12$treated_aux <- ifelse(q_nh_nd_df12$id == 12, 1, 0)
q_nh_nd_df13$treated_aux <- ifelse(q_nh_nd_df13$id == 13, 1, 0)
q_nh_nd_df15$treated_aux <- ifelse(q_nh_nd_df15$id == 15, 1, 0)
q_nh_nd_df17$treated_aux <- ifelse(q_nh_nd_df17$id == 17, 1, 0)
q_nh_nd_df19$treated_aux <- ifelse(q_nh_nd_df19$id == 19, 1, 0)
q_nh_nd_df21$treated_aux <- ifelse(q_nh_nd_df21$id == 21, 1, 0)
q_nh_nd_df23$treated_aux <- ifelse(q_nh_nd_df23$id == 23, 1, 0)
q_nh_nd_df24$treated_aux <- ifelse(q_nh_nd_df24$id == 24, 1, 0)
q_nh_nd_df25$treated_aux <- ifelse(q_nh_nd_df25$id == 25, 1, 0)
q_nh_nd_df26$treated_aux <- ifelse(q_nh_nd_df26$id == 26, 1, 0)
q_nh_nd_df28$treated_aux <- ifelse(q_nh_nd_df28$id == 28, 1, 0)
q_nh_nd_df29$treated_aux <- ifelse(q_nh_nd_df29$id == 29, 1, 0)
q_nh_nd_df30$treated_aux <- ifelse(q_nh_nd_df30$id == 30, 1, 0)
q_nh_nd_df31$treated_aux <- ifelse(q_nh_nd_df31$id == 31, 1, 0)
q_nh_nd_df32$treated_aux <- ifelse(q_nh_nd_df32$id == 32, 1, 0)
q_nh_nd_df33$treated_aux <- ifelse(q_nh_nd_df33$id == 33, 1, 0)
q_nh_nd_df34$treated_aux <- ifelse(q_nh_nd_df34$id == 34, 1, 0)
q_nh_nd_df36$treated_aux <- ifelse(q_nh_nd_df36$id == 36, 1, 0)
q_nh_nd_df37$treated_aux <- ifelse(q_nh_nd_df37$id == 37, 1, 0)
q_nh_nd_df39$treated_aux <- ifelse(q_nh_nd_df39$id == 39, 1, 0)
q_nh_nd_df40$treated_aux <- ifelse(q_nh_nd_df40$id == 40, 1, 0)
q_nh_nd_df41$treated_aux <- ifelse(q_nh_nd_df41$id == 41, 1, 0)
q_nh_nd_df44$treated_aux <- ifelse(q_nh_nd_df44$id == 44, 1, 0)
q_nh_nd_df45$treated_aux <- ifelse(q_nh_nd_df45$id == 45, 1, 0)
q_nh_nd_df47$treated_aux <- ifelse(q_nh_nd_df47$id == 47, 1, 0)
q_nh_nd_df50$treated_aux <- ifelse(q_nh_nd_df50$id == 50, 1, 0)
q_nh_nd_df51$treated_aux <- ifelse(q_nh_nd_df51$id == 51, 1, 0)
q_nh_nd_df53$treated_aux <- ifelse(q_nh_nd_df53$id == 53, 1, 0)
q_nh_nd_df54$treated_aux <- ifelse(q_nh_nd_df54$id == 54, 1, 0)
q_nh_nd_df55$treated_aux <- ifelse(q_nh_nd_df55$id == 55, 1, 0)
q_nh_nd_df1$treated <- as.integer(ifelse(q_nh_nd_df1$id == 1 & q_nh_nd_df1$year >= 1995, 1, 0))
q_nh_nd_df2$treated <- as.integer(ifelse(q_nh_nd_df2$id == 2 & q_nh_nd_df2$year >= 1995, 1, 0))
q_nh_nd_df5$treated <- as.integer(ifelse(q_nh_nd_df5$id == 5 & q_nh_nd_df5$year >= 1995, 1, 0))
q_nh_nd_df10$treated <- as.integer(ifelse(q_nh_nd_df10$id == 10 & q_nh_nd_df10$year >= 1995, 1, 0))
q_nh_nd_df11$treated <- as.integer(ifelse(q_nh_nd_df11$id == 11 & q_nh_nd_df11$year >= 1995, 1, 0))
q_nh_nd_df12$treated <- as.integer(ifelse(q_nh_nd_df12$id == 12 & q_nh_nd_df12$year >= 1995, 1, 0))
q_nh_nd_df13$treated <- as.integer(ifelse(q_nh_nd_df13$id == 13 & q_nh_nd_df13$year >= 1995, 1, 0))
q_nh_nd_df15$treated <- as.integer(ifelse(q_nh_nd_df15$id == 15 & q_nh_nd_df15$year >= 1995, 1, 0))
q_nh_nd_df17$treated <- as.integer(ifelse(q_nh_nd_df17$id == 17 & q_nh_nd_df17$year >= 1995, 1, 0))
q_nh_nd_df19$treated <- as.integer(ifelse(q_nh_nd_df19$id == 19 & q_nh_nd_df19$year >= 1995, 1, 0))
q_nh_nd_df21$treated <- as.integer(ifelse(q_nh_nd_df21$id == 21 & q_nh_nd_df21$year >= 1995, 1, 0))
q_nh_nd_df23$treated <- as.integer(ifelse(q_nh_nd_df23$id == 23 & q_nh_nd_df23$year >= 1995, 1, 0))
q_nh_nd_df24$treated <- as.integer(ifelse(q_nh_nd_df24$id == 24 & q_nh_nd_df24$year >= 1995, 1, 0))
q_nh_nd_df25$treated <- as.integer(ifelse(q_nh_nd_df25$id == 25 & q_nh_nd_df25$year >= 1995, 1, 0))
q_nh_nd_df26$treated <- as.integer(ifelse(q_nh_nd_df26$id == 26 & q_nh_nd_df26$year >= 1995, 1, 0))
q_nh_nd_df28$treated <- as.integer(ifelse(q_nh_nd_df28$id == 28 & q_nh_nd_df28$year >= 1995, 1, 0))
q_nh_nd_df29$treated <- as.integer(ifelse(q_nh_nd_df29$id == 29 & q_nh_nd_df29$year >= 1995, 1, 0))
q_nh_nd_df30$treated <- as.integer(ifelse(q_nh_nd_df30$id == 30 & q_nh_nd_df30$year >= 1995, 1, 0))
q_nh_nd_df31$treated <- as.integer(ifelse(q_nh_nd_df31$id == 31 & q_nh_nd_df31$year >= 1995, 1, 0))
q_nh_nd_df32$treated <- as.integer(ifelse(q_nh_nd_df32$id == 32 & q_nh_nd_df32$year >= 1995, 1, 0))
q_nh_nd_df33$treated <- as.integer(ifelse(q_nh_nd_df33$id == 33 & q_nh_nd_df33$year >= 1995, 1, 0))
q_nh_nd_df34$treated <- as.integer(ifelse(q_nh_nd_df34$id == 34 & q_nh_nd_df34$year >= 1995, 1, 0))
q_nh_nd_df36$treated <- as.integer(ifelse(q_nh_nd_df36$id == 36 & q_nh_nd_df36$year >= 1995, 1, 0))
q_nh_nd_df37$treated <- as.integer(ifelse(q_nh_nd_df37$id == 37 & q_nh_nd_df37$year >= 1995, 1, 0))
q_nh_nd_df39$treated <- as.integer(ifelse(q_nh_nd_df39$id == 39 & q_nh_nd_df39$year >= 1995, 1, 0))
q_nh_nd_df40$treated <- as.integer(ifelse(q_nh_nd_df40$id == 40 & q_nh_nd_df40$year >= 1995, 1, 0))
q_nh_nd_df41$treated <- as.integer(ifelse(q_nh_nd_df41$id == 41 & q_nh_nd_df41$year >= 1995, 1, 0))
q_nh_nd_df44$treated <- as.integer(ifelse(q_nh_nd_df44$id == 44 & q_nh_nd_df44$year >= 1995, 1, 0))
q_nh_nd_df45$treated <- as.integer(ifelse(q_nh_nd_df45$id == 45 & q_nh_nd_df45$year >= 1995, 1, 0))
q_nh_nd_df47$treated <- as.integer(ifelse(q_nh_nd_df47$id == 47 & q_nh_nd_df47$year >= 1995, 1, 0))
q_nh_nd_df50$treated <- as.integer(ifelse(q_nh_nd_df50$id == 50 & q_nh_nd_df50$year >= 1995, 1, 0))
q_nh_nd_df51$treated <- as.integer(ifelse(q_nh_nd_df51$id == 51 & q_nh_nd_df51$year >= 1995, 1, 0))
q_nh_nd_df53$treated <- as.integer(ifelse(q_nh_nd_df53$id == 53 & q_nh_nd_df53$year >= 1995, 1, 0))
q_nh_nd_df54$treated <- as.integer(ifelse(q_nh_nd_df54$id == 54 & q_nh_nd_df54$year >= 1995, 1, 0))
q_nh_nd_df55$treated <- as.integer(ifelse(q_nh_nd_df55$id == 55 & q_nh_nd_df55$year >= 1995, 1, 0))
q_nh_nd_df_list <- list(q_nh_nd_df1,q_nh_nd_df2,q_nh_nd_df5,
                        q_nh_nd_df10,q_nh_nd_df11,q_nh_nd_df12,
                        q_nh_nd_df13,q_nh_nd_df15,q_nh_nd_df17,
                        q_nh_nd_df19,q_nh_nd_df21,q_nh_nd_df23,
                        q_nh_nd_df24,q_nh_nd_df25,q_nh_nd_df26,
                        q_nh_nd_df28,q_nh_nd_df29,q_nh_nd_df30,
                        q_nh_nd_df31,q_nh_nd_df32,q_nh_nd_df33,
                        q_nh_nd_df34,q_nh_nd_df36,q_nh_nd_df37,
                        q_nh_nd_df39,q_nh_nd_df40,q_nh_nd_df41,
                        q_nh_nd_df44,q_nh_nd_df45,q_nh_nd_df47,
                        q_nh_nd_df50,q_nh_nd_df51,q_nh_nd_df53,
                        q_nh_nd_df54,q_nh_nd_df55)
rm(q_nh_nd_df1,q_nh_nd_df2,q_nh_nd_df5,
   q_nh_nd_df10,q_nh_nd_df11,q_nh_nd_df12,
   q_nh_nd_df13,q_nh_nd_df15,q_nh_nd_df17,
   q_nh_nd_df19,q_nh_nd_df21,q_nh_nd_df23,
   q_nh_nd_df24,q_nh_nd_df25,q_nh_nd_df26,
   q_nh_nd_df28,q_nh_nd_df29,q_nh_nd_df30,
   q_nh_nd_df31,q_nh_nd_df32,q_nh_nd_df33,
   q_nh_nd_df34,q_nh_nd_df36,q_nh_nd_df37,
   q_nh_nd_df39,q_nh_nd_df40,q_nh_nd_df41,
   q_nh_nd_df44,q_nh_nd_df45,q_nh_nd_df47,
   q_nh_nd_df50,q_nh_nd_df51,q_nh_nd_df53,
   q_nh_nd_df54,q_nh_nd_df55)
q_nh_nd_df_list <- lapply(q_nh_nd_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nh_nd_df_list <- lapply(q_nh_nd_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomes_pcp, treated)))
}
)
setup_q_nh_nd1 <- panel.matrices(q_nh_nd_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd2 <- panel.matrices(q_nh_nd_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd5 <- panel.matrices(q_nh_nd_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd10 <- panel.matrices(q_nh_nd_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd11 <- panel.matrices(q_nh_nd_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd12 <- panel.matrices(q_nh_nd_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd13 <- panel.matrices(q_nh_nd_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd15 <- panel.matrices(q_nh_nd_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd17 <- panel.matrices(q_nh_nd_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd19 <- panel.matrices(q_nh_nd_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd21 <- panel.matrices(q_nh_nd_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd23 <- panel.matrices(q_nh_nd_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd24 <- panel.matrices(q_nh_nd_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd25 <- panel.matrices(q_nh_nd_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd26 <- panel.matrices(q_nh_nd_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd28 <- panel.matrices(q_nh_nd_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd29 <- panel.matrices(q_nh_nd_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd30 <- panel.matrices(q_nh_nd_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd31 <- panel.matrices(q_nh_nd_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd32 <- panel.matrices(q_nh_nd_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd33 <- panel.matrices(q_nh_nd_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd34 <- panel.matrices(q_nh_nd_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd36 <- panel.matrices(q_nh_nd_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd37 <- panel.matrices(q_nh_nd_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd39 <- panel.matrices(q_nh_nd_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd40 <- panel.matrices(q_nh_nd_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd41 <- panel.matrices(q_nh_nd_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd44 <- panel.matrices(q_nh_nd_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd45 <- panel.matrices(q_nh_nd_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd47 <- panel.matrices(q_nh_nd_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd50 <- panel.matrices(q_nh_nd_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd51 <- panel.matrices(q_nh_nd_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd53 <- panel.matrices(q_nh_nd_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd54 <- panel.matrices(q_nh_nd_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd55 <- panel.matrices(q_nh_nd_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nh_nd_list <- list(setup_q_nh_nd1,setup_q_nh_nd2,setup_q_nh_nd5,
                           setup_q_nh_nd10,setup_q_nh_nd11,setup_q_nh_nd12,
                           setup_q_nh_nd13,setup_q_nh_nd15,setup_q_nh_nd17,
                           setup_q_nh_nd19,setup_q_nh_nd21,setup_q_nh_nd23,
                           setup_q_nh_nd24,setup_q_nh_nd25,setup_q_nh_nd26,
                           setup_q_nh_nd28,setup_q_nh_nd29,setup_q_nh_nd30,
                           setup_q_nh_nd31,setup_q_nh_nd32,setup_q_nh_nd33,
                           setup_q_nh_nd34,setup_q_nh_nd36,setup_q_nh_nd37,
                           setup_q_nh_nd39,setup_q_nh_nd40,setup_q_nh_nd41,
                           setup_q_nh_nd44,setup_q_nh_nd45,setup_q_nh_nd47,
                           setup_q_nh_nd50,setup_q_nh_nd51,setup_q_nh_nd53,
                           setup_q_nh_nd54,setup_q_nh_nd55)
rm(setup_q_nh_nd1,setup_q_nh_nd2,setup_q_nh_nd5,
   setup_q_nh_nd10,setup_q_nh_nd11,setup_q_nh_nd12,
   setup_q_nh_nd13,setup_q_nh_nd15,setup_q_nh_nd17,
   setup_q_nh_nd19,setup_q_nh_nd21,setup_q_nh_nd23,
   setup_q_nh_nd24,setup_q_nh_nd25,setup_q_nh_nd26,
   setup_q_nh_nd28,setup_q_nh_nd29,setup_q_nh_nd30,
   setup_q_nh_nd31,setup_q_nh_nd32,setup_q_nh_nd33,
   setup_q_nh_nd34,setup_q_nh_nd36,setup_q_nh_nd37,
   setup_q_nh_nd39,setup_q_nh_nd40,setup_q_nh_nd41,
   setup_q_nh_nd44,setup_q_nh_nd45,setup_q_nh_nd47,
   setup_q_nh_nd50,setup_q_nh_nd51,setup_q_nh_nd53,
   setup_q_nh_nd54,setup_q_nh_nd55)
# DID #
q_nh_nd_est_did1 <- did_estimate(setup_q_nh_nd_list[[1]]$Y, setup_q_nh_nd_list[[1]]$N0, setup_q_nh_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_nd_est_did2 <- did_estimate(setup_q_nh_nd_list[[2]]$Y, setup_q_nh_nd_list[[2]]$N0, setup_q_nh_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_nd_est_did5 <- did_estimate(setup_q_nh_nd_list[[3]]$Y, setup_q_nh_nd_list[[3]]$N0, setup_q_nh_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_nd_est_did10 <- did_estimate(setup_q_nh_nd_list[[4]]$Y, setup_q_nh_nd_list[[4]]$N0, setup_q_nh_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_nd_est_did11 <- did_estimate(setup_q_nh_nd_list[[5]]$Y, setup_q_nh_nd_list[[5]]$N0, setup_q_nh_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_nd_est_did12 <- did_estimate(setup_q_nh_nd_list[[6]]$Y, setup_q_nh_nd_list[[6]]$N0, setup_q_nh_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_nd_est_did13 <- did_estimate(setup_q_nh_nd_list[[7]]$Y, setup_q_nh_nd_list[[7]]$N0, setup_q_nh_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_nd_est_did15 <- did_estimate(setup_q_nh_nd_list[[8]]$Y, setup_q_nh_nd_list[[8]]$N0, setup_q_nh_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_nd_est_did17 <- did_estimate(setup_q_nh_nd_list[[9]]$Y, setup_q_nh_nd_list[[9]]$N0, setup_q_nh_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_nd_est_did19 <- did_estimate(setup_q_nh_nd_list[[10]]$Y, setup_q_nh_nd_list[[10]]$N0, setup_q_nh_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_nd_est_did21 <- did_estimate(setup_q_nh_nd_list[[11]]$Y, setup_q_nh_nd_list[[11]]$N0, setup_q_nh_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_nd_est_did23 <- did_estimate(setup_q_nh_nd_list[[12]]$Y, setup_q_nh_nd_list[[12]]$N0, setup_q_nh_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_nd_est_did24 <- did_estimate(setup_q_nh_nd_list[[13]]$Y, setup_q_nh_nd_list[[13]]$N0, setup_q_nh_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_nd_est_did25 <- did_estimate(setup_q_nh_nd_list[[14]]$Y, setup_q_nh_nd_list[[14]]$N0, setup_q_nh_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_nd_est_did26 <- did_estimate(setup_q_nh_nd_list[[15]]$Y, setup_q_nh_nd_list[[15]]$N0, setup_q_nh_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_nd_est_did28 <- did_estimate(setup_q_nh_nd_list[[16]]$Y, setup_q_nh_nd_list[[16]]$N0, setup_q_nh_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_nd_est_did29 <- did_estimate(setup_q_nh_nd_list[[17]]$Y, setup_q_nh_nd_list[[17]]$N0, setup_q_nh_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_nd_est_did30 <- did_estimate(setup_q_nh_nd_list[[18]]$Y, setup_q_nh_nd_list[[18]]$N0, setup_q_nh_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_nd_est_did31 <- did_estimate(setup_q_nh_nd_list[[19]]$Y, setup_q_nh_nd_list[[19]]$N0, setup_q_nh_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_nd_est_did32 <- did_estimate(setup_q_nh_nd_list[[20]]$Y, setup_q_nh_nd_list[[20]]$N0, setup_q_nh_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_nd_est_did33 <- did_estimate(setup_q_nh_nd_list[[21]]$Y, setup_q_nh_nd_list[[21]]$N0, setup_q_nh_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_nd_est_did34 <- did_estimate(setup_q_nh_nd_list[[22]]$Y, setup_q_nh_nd_list[[22]]$N0, setup_q_nh_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_nd_est_did36 <- did_estimate(setup_q_nh_nd_list[[23]]$Y, setup_q_nh_nd_list[[23]]$N0, setup_q_nh_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_nd_est_did37 <- did_estimate(setup_q_nh_nd_list[[24]]$Y, setup_q_nh_nd_list[[24]]$N0, setup_q_nh_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_nd_est_did39 <- did_estimate(setup_q_nh_nd_list[[25]]$Y, setup_q_nh_nd_list[[25]]$N0, setup_q_nh_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_nd_est_did40 <- did_estimate(setup_q_nh_nd_list[[26]]$Y, setup_q_nh_nd_list[[26]]$N0, setup_q_nh_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_nd_est_did41 <- did_estimate(setup_q_nh_nd_list[[27]]$Y, setup_q_nh_nd_list[[27]]$N0, setup_q_nh_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_nd_est_did44 <- did_estimate(setup_q_nh_nd_list[[28]]$Y, setup_q_nh_nd_list[[28]]$N0, setup_q_nh_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_nd_est_did45 <- did_estimate(setup_q_nh_nd_list[[29]]$Y, setup_q_nh_nd_list[[29]]$N0, setup_q_nh_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_nd_est_did47 <- did_estimate(setup_q_nh_nd_list[[30]]$Y, setup_q_nh_nd_list[[30]]$N0, setup_q_nh_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_nd_est_did50 <- did_estimate(setup_q_nh_nd_list[[31]]$Y, setup_q_nh_nd_list[[31]]$N0, setup_q_nh_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_nd_est_did51 <- did_estimate(setup_q_nh_nd_list[[32]]$Y, setup_q_nh_nd_list[[32]]$N0, setup_q_nh_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_nd_est_did53 <- did_estimate(setup_q_nh_nd_list[[33]]$Y, setup_q_nh_nd_list[[33]]$N0, setup_q_nh_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_nd_est_did54 <- did_estimate(setup_q_nh_nd_list[[34]]$Y, setup_q_nh_nd_list[[34]]$N0, setup_q_nh_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_nd_est_did55 <- did_estimate(setup_q_nh_nd_list[[35]]$Y, setup_q_nh_nd_list[[35]]$N0, setup_q_nh_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_nd_est_did_list <- list(q_nh_nd_est_did1,q_nh_nd_est_did2,q_nh_nd_est_did5,
                             q_nh_nd_est_did10,q_nh_nd_est_did11,q_nh_nd_est_did12,
                             q_nh_nd_est_did13,q_nh_nd_est_did15,q_nh_nd_est_did17,
                             q_nh_nd_est_did19,q_nh_nd_est_did21,q_nh_nd_est_did23,
                             q_nh_nd_est_did24,q_nh_nd_est_did25,q_nh_nd_est_did26,
                             q_nh_nd_est_did28,q_nh_nd_est_did29,q_nh_nd_est_did30,
                             q_nh_nd_est_did31,q_nh_nd_est_did32,q_nh_nd_est_did33,
                             q_nh_nd_est_did34,q_nh_nd_est_did36,q_nh_nd_est_did37,
                             q_nh_nd_est_did39,q_nh_nd_est_did40,q_nh_nd_est_did41,
                             q_nh_nd_est_did44,q_nh_nd_est_did45,q_nh_nd_est_did47,
                             q_nh_nd_est_did50,q_nh_nd_est_did51,q_nh_nd_est_did53,
                             q_nh_nd_est_did54,q_nh_nd_est_did55)
rm(q_nh_nd_est_did1,q_nh_nd_est_did2,q_nh_nd_est_did5,
   q_nh_nd_est_did10,q_nh_nd_est_did11,q_nh_nd_est_did12,
   q_nh_nd_est_did13,q_nh_nd_est_did15,q_nh_nd_est_did17,
   q_nh_nd_est_did19,q_nh_nd_est_did21,q_nh_nd_est_did23,
   q_nh_nd_est_did24,q_nh_nd_est_did25,q_nh_nd_est_did26,
   q_nh_nd_est_did28,q_nh_nd_est_did29,q_nh_nd_est_did30,
   q_nh_nd_est_did31,q_nh_nd_est_did32,q_nh_nd_est_did33,
   q_nh_nd_est_did34,q_nh_nd_est_did36,q_nh_nd_est_did37,
   q_nh_nd_est_did39,q_nh_nd_est_did40,q_nh_nd_est_did41,
   q_nh_nd_est_did44,q_nh_nd_est_did45,q_nh_nd_est_did47,
   q_nh_nd_est_did50,q_nh_nd_est_did51,q_nh_nd_est_did53,
   q_nh_nd_est_did54,q_nh_nd_est_did55)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_did_plot", i), synthdid_plot(q_nh_nd_est_did_list[i]))
}
q_nh_nd_est_did_plot_data_aux1 <- ggplot_build(q_nh_nd_est_did_plot1)
q_nh_nd_est_did_plot_data_aux2 <- ggplot_build(q_nh_nd_est_did_plot2)
q_nh_nd_est_did_plot_data_aux3 <- ggplot_build(q_nh_nd_est_did_plot3)
q_nh_nd_est_did_plot_data_aux4 <- ggplot_build(q_nh_nd_est_did_plot4)
q_nh_nd_est_did_plot_data_aux5 <- ggplot_build(q_nh_nd_est_did_plot5)
q_nh_nd_est_did_plot_data_aux6 <- ggplot_build(q_nh_nd_est_did_plot6)
q_nh_nd_est_did_plot_data_aux7 <- ggplot_build(q_nh_nd_est_did_plot7)
q_nh_nd_est_did_plot_data_aux8 <- ggplot_build(q_nh_nd_est_did_plot8)
q_nh_nd_est_did_plot_data_aux9 <- ggplot_build(q_nh_nd_est_did_plot9)
q_nh_nd_est_did_plot_data_aux10 <- ggplot_build(q_nh_nd_est_did_plot10)
q_nh_nd_est_did_plot_data_aux11 <- ggplot_build(q_nh_nd_est_did_plot11)
q_nh_nd_est_did_plot_data_aux12 <- ggplot_build(q_nh_nd_est_did_plot12)
q_nh_nd_est_did_plot_data_aux13 <- ggplot_build(q_nh_nd_est_did_plot13)
q_nh_nd_est_did_plot_data_aux14 <- ggplot_build(q_nh_nd_est_did_plot14)
q_nh_nd_est_did_plot_data_aux15 <- ggplot_build(q_nh_nd_est_did_plot15)
q_nh_nd_est_did_plot_data_aux16 <- ggplot_build(q_nh_nd_est_did_plot16)
q_nh_nd_est_did_plot_data_aux17 <- ggplot_build(q_nh_nd_est_did_plot17)
q_nh_nd_est_did_plot_data_aux18 <- ggplot_build(q_nh_nd_est_did_plot18)
q_nh_nd_est_did_plot_data_aux19 <- ggplot_build(q_nh_nd_est_did_plot19)
q_nh_nd_est_did_plot_data_aux20 <- ggplot_build(q_nh_nd_est_did_plot20)
q_nh_nd_est_did_plot_data_aux21 <- ggplot_build(q_nh_nd_est_did_plot21)
q_nh_nd_est_did_plot_data_aux22 <- ggplot_build(q_nh_nd_est_did_plot22)
q_nh_nd_est_did_plot_data_aux23 <- ggplot_build(q_nh_nd_est_did_plot23)
q_nh_nd_est_did_plot_data_aux24 <- ggplot_build(q_nh_nd_est_did_plot24)
q_nh_nd_est_did_plot_data_aux25 <- ggplot_build(q_nh_nd_est_did_plot25)
q_nh_nd_est_did_plot_data_aux26 <- ggplot_build(q_nh_nd_est_did_plot26)
q_nh_nd_est_did_plot_data_aux27 <- ggplot_build(q_nh_nd_est_did_plot27)
q_nh_nd_est_did_plot_data_aux28 <- ggplot_build(q_nh_nd_est_did_plot28)
q_nh_nd_est_did_plot_data_aux29 <- ggplot_build(q_nh_nd_est_did_plot29)
q_nh_nd_est_did_plot_data_aux30 <- ggplot_build(q_nh_nd_est_did_plot30)
q_nh_nd_est_did_plot_data_aux31 <- ggplot_build(q_nh_nd_est_did_plot31)
q_nh_nd_est_did_plot_data_aux32 <- ggplot_build(q_nh_nd_est_did_plot32)
q_nh_nd_est_did_plot_data_aux33 <- ggplot_build(q_nh_nd_est_did_plot33)
q_nh_nd_est_did_plot_data_aux34 <- ggplot_build(q_nh_nd_est_did_plot34)
q_nh_nd_est_did_plot_data_aux35 <- ggplot_build(q_nh_nd_est_did_plot35)
q_nh_nd_est_did_plot_data_aux_list <- list(q_nh_nd_est_did_plot_data_aux1,q_nh_nd_est_did_plot_data_aux2,q_nh_nd_est_did_plot_data_aux3,
                                           q_nh_nd_est_did_plot_data_aux4,q_nh_nd_est_did_plot_data_aux5,q_nh_nd_est_did_plot_data_aux6,
                                           q_nh_nd_est_did_plot_data_aux7,q_nh_nd_est_did_plot_data_aux8,q_nh_nd_est_did_plot_data_aux9,
                                           q_nh_nd_est_did_plot_data_aux10,q_nh_nd_est_did_plot_data_aux11,q_nh_nd_est_did_plot_data_aux12,
                                           q_nh_nd_est_did_plot_data_aux13,q_nh_nd_est_did_plot_data_aux14,q_nh_nd_est_did_plot_data_aux15,
                                           q_nh_nd_est_did_plot_data_aux16,q_nh_nd_est_did_plot_data_aux17,q_nh_nd_est_did_plot_data_aux18,
                                           q_nh_nd_est_did_plot_data_aux19,q_nh_nd_est_did_plot_data_aux20,q_nh_nd_est_did_plot_data_aux21,
                                           q_nh_nd_est_did_plot_data_aux22,q_nh_nd_est_did_plot_data_aux23,q_nh_nd_est_did_plot_data_aux24,
                                           q_nh_nd_est_did_plot_data_aux25,q_nh_nd_est_did_plot_data_aux26,q_nh_nd_est_did_plot_data_aux27,
                                           q_nh_nd_est_did_plot_data_aux28,q_nh_nd_est_did_plot_data_aux29,q_nh_nd_est_did_plot_data_aux30,
                                           q_nh_nd_est_did_plot_data_aux31,q_nh_nd_est_did_plot_data_aux32,q_nh_nd_est_did_plot_data_aux33,
                                           q_nh_nd_est_did_plot_data_aux34,q_nh_nd_est_did_plot_data_aux35)
rm(q_nh_nd_est_did_plot_data_aux1,q_nh_nd_est_did_plot_data_aux2,q_nh_nd_est_did_plot_data_aux3,
   q_nh_nd_est_did_plot_data_aux4,q_nh_nd_est_did_plot_data_aux5,q_nh_nd_est_did_plot_data_aux6,
   q_nh_nd_est_did_plot_data_aux7,q_nh_nd_est_did_plot_data_aux8,q_nh_nd_est_did_plot_data_aux9,
   q_nh_nd_est_did_plot_data_aux10,q_nh_nd_est_did_plot_data_aux11,q_nh_nd_est_did_plot_data_aux12,
   q_nh_nd_est_did_plot_data_aux13,q_nh_nd_est_did_plot_data_aux14,q_nh_nd_est_did_plot_data_aux15,
   q_nh_nd_est_did_plot_data_aux16,q_nh_nd_est_did_plot_data_aux17,q_nh_nd_est_did_plot_data_aux18,
   q_nh_nd_est_did_plot_data_aux19,q_nh_nd_est_did_plot_data_aux20,q_nh_nd_est_did_plot_data_aux21,
   q_nh_nd_est_did_plot_data_aux22,q_nh_nd_est_did_plot_data_aux23,q_nh_nd_est_did_plot_data_aux24,
   q_nh_nd_est_did_plot_data_aux25,q_nh_nd_est_did_plot_data_aux26,q_nh_nd_est_did_plot_data_aux27,
   q_nh_nd_est_did_plot_data_aux28,q_nh_nd_est_did_plot_data_aux29,q_nh_nd_est_did_plot_data_aux30,
   q_nh_nd_est_did_plot_data_aux31,q_nh_nd_est_did_plot_data_aux32,q_nh_nd_est_did_plot_data_aux33,
   q_nh_nd_est_did_plot_data_aux34,q_nh_nd_est_did_plot_data_aux35)
rm(q_nh_nd_est_did_plot1,q_nh_nd_est_did_plot2,q_nh_nd_est_did_plot3,
   q_nh_nd_est_did_plot4,q_nh_nd_est_did_plot5,q_nh_nd_est_did_plot6,
   q_nh_nd_est_did_plot7,q_nh_nd_est_did_plot8,q_nh_nd_est_did_plot9,
   q_nh_nd_est_did_plot10,q_nh_nd_est_did_plot11,q_nh_nd_est_did_plot12,
   q_nh_nd_est_did_plot13,q_nh_nd_est_did_plot14,q_nh_nd_est_did_plot15,
   q_nh_nd_est_did_plot16,q_nh_nd_est_did_plot17,q_nh_nd_est_did_plot18,
   q_nh_nd_est_did_plot19,q_nh_nd_est_did_plot20,q_nh_nd_est_did_plot21,
   q_nh_nd_est_did_plot22,q_nh_nd_est_did_plot23,q_nh_nd_est_did_plot24,
   q_nh_nd_est_did_plot25,q_nh_nd_est_did_plot26,q_nh_nd_est_did_plot27,
   q_nh_nd_est_did_plot28,q_nh_nd_est_did_plot29,q_nh_nd_est_did_plot30,
   q_nh_nd_est_did_plot31,q_nh_nd_est_did_plot32,q_nh_nd_est_did_plot33,
   q_nh_nd_est_did_plot34,q_nh_nd_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_did_plot_data_long", i), data.frame(q_nh_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_nd_est_did_plot_data_long_list <- list(q_nh_nd_est_did_plot_data_long1,q_nh_nd_est_did_plot_data_long2,q_nh_nd_est_did_plot_data_long3,
                                            q_nh_nd_est_did_plot_data_long4,q_nh_nd_est_did_plot_data_long5,q_nh_nd_est_did_plot_data_long6,
                                            q_nh_nd_est_did_plot_data_long7,q_nh_nd_est_did_plot_data_long8,q_nh_nd_est_did_plot_data_long9,
                                            q_nh_nd_est_did_plot_data_long10,q_nh_nd_est_did_plot_data_long11,q_nh_nd_est_did_plot_data_long12,
                                            q_nh_nd_est_did_plot_data_long13,q_nh_nd_est_did_plot_data_long14,q_nh_nd_est_did_plot_data_long15,
                                            q_nh_nd_est_did_plot_data_long16,q_nh_nd_est_did_plot_data_long17,q_nh_nd_est_did_plot_data_long18,
                                            q_nh_nd_est_did_plot_data_long19,q_nh_nd_est_did_plot_data_long20,q_nh_nd_est_did_plot_data_long21,
                                            q_nh_nd_est_did_plot_data_long22,q_nh_nd_est_did_plot_data_long23,q_nh_nd_est_did_plot_data_long24,
                                            q_nh_nd_est_did_plot_data_long25,q_nh_nd_est_did_plot_data_long26,q_nh_nd_est_did_plot_data_long27,
                                            q_nh_nd_est_did_plot_data_long28,q_nh_nd_est_did_plot_data_long29,q_nh_nd_est_did_plot_data_long30,
                                            q_nh_nd_est_did_plot_data_long31,q_nh_nd_est_did_plot_data_long32,q_nh_nd_est_did_plot_data_long33,
                                            q_nh_nd_est_did_plot_data_long34,q_nh_nd_est_did_plot_data_long35)
rm(q_nh_nd_est_did_plot_data_long1,q_nh_nd_est_did_plot_data_long2,q_nh_nd_est_did_plot_data_long3,
   q_nh_nd_est_did_plot_data_long4,q_nh_nd_est_did_plot_data_long5,q_nh_nd_est_did_plot_data_long6,
   q_nh_nd_est_did_plot_data_long7,q_nh_nd_est_did_plot_data_long8,q_nh_nd_est_did_plot_data_long9,
   q_nh_nd_est_did_plot_data_long10,q_nh_nd_est_did_plot_data_long11,q_nh_nd_est_did_plot_data_long12,
   q_nh_nd_est_did_plot_data_long13,q_nh_nd_est_did_plot_data_long14,q_nh_nd_est_did_plot_data_long15,
   q_nh_nd_est_did_plot_data_long16,q_nh_nd_est_did_plot_data_long17,q_nh_nd_est_did_plot_data_long18,
   q_nh_nd_est_did_plot_data_long19,q_nh_nd_est_did_plot_data_long20,q_nh_nd_est_did_plot_data_long21,
   q_nh_nd_est_did_plot_data_long22,q_nh_nd_est_did_plot_data_long23,q_nh_nd_est_did_plot_data_long24,
   q_nh_nd_est_did_plot_data_long25,q_nh_nd_est_did_plot_data_long26,q_nh_nd_est_did_plot_data_long27,
   q_nh_nd_est_did_plot_data_long28,q_nh_nd_est_did_plot_data_long29,q_nh_nd_est_did_plot_data_long30,
   q_nh_nd_est_did_plot_data_long31,q_nh_nd_est_did_plot_data_long32,q_nh_nd_est_did_plot_data_long33,
   q_nh_nd_est_did_plot_data_long34,q_nh_nd_est_did_plot_data_long35)
q_nh_nd_est_did_plot_data_long_list <- lapply(q_nh_nd_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_did_plot_data_wide", i), reshape(data=q_nh_nd_est_did_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
q_nh_nd_est_did_plot_data_wide_list <- list(q_nh_nd_est_did_plot_data_wide1,q_nh_nd_est_did_plot_data_wide2,q_nh_nd_est_did_plot_data_wide3,
                                            q_nh_nd_est_did_plot_data_wide4,q_nh_nd_est_did_plot_data_wide5,q_nh_nd_est_did_plot_data_wide6,
                                            q_nh_nd_est_did_plot_data_wide7,q_nh_nd_est_did_plot_data_wide8,q_nh_nd_est_did_plot_data_wide9,
                                            q_nh_nd_est_did_plot_data_wide10,q_nh_nd_est_did_plot_data_wide11,q_nh_nd_est_did_plot_data_wide12,
                                            q_nh_nd_est_did_plot_data_wide13,q_nh_nd_est_did_plot_data_wide14,q_nh_nd_est_did_plot_data_wide15,
                                            q_nh_nd_est_did_plot_data_wide16,q_nh_nd_est_did_plot_data_wide17,q_nh_nd_est_did_plot_data_wide18,
                                            q_nh_nd_est_did_plot_data_wide19,q_nh_nd_est_did_plot_data_wide20,q_nh_nd_est_did_plot_data_wide21,
                                            q_nh_nd_est_did_plot_data_wide22,q_nh_nd_est_did_plot_data_wide23,q_nh_nd_est_did_plot_data_wide24,
                                            q_nh_nd_est_did_plot_data_wide25,q_nh_nd_est_did_plot_data_wide26,q_nh_nd_est_did_plot_data_wide27,
                                            q_nh_nd_est_did_plot_data_wide28,q_nh_nd_est_did_plot_data_wide29,q_nh_nd_est_did_plot_data_wide30,
                                            q_nh_nd_est_did_plot_data_wide31,q_nh_nd_est_did_plot_data_wide32,q_nh_nd_est_did_plot_data_wide33,
                                            q_nh_nd_est_did_plot_data_wide34,q_nh_nd_est_did_plot_data_wide35)
rm(q_nh_nd_est_did_plot_data_wide1,q_nh_nd_est_did_plot_data_wide2,q_nh_nd_est_did_plot_data_wide3,
   q_nh_nd_est_did_plot_data_wide4,q_nh_nd_est_did_plot_data_wide5,q_nh_nd_est_did_plot_data_wide6,
   q_nh_nd_est_did_plot_data_wide7,q_nh_nd_est_did_plot_data_wide8,q_nh_nd_est_did_plot_data_wide9,
   q_nh_nd_est_did_plot_data_wide10,q_nh_nd_est_did_plot_data_wide11,q_nh_nd_est_did_plot_data_wide12,
   q_nh_nd_est_did_plot_data_wide13,q_nh_nd_est_did_plot_data_wide14,q_nh_nd_est_did_plot_data_wide15,
   q_nh_nd_est_did_plot_data_wide16,q_nh_nd_est_did_plot_data_wide17,q_nh_nd_est_did_plot_data_wide18,
   q_nh_nd_est_did_plot_data_wide19,q_nh_nd_est_did_plot_data_wide20,q_nh_nd_est_did_plot_data_wide21,
   q_nh_nd_est_did_plot_data_wide22,q_nh_nd_est_did_plot_data_wide23,q_nh_nd_est_did_plot_data_wide24,
   q_nh_nd_est_did_plot_data_wide25,q_nh_nd_est_did_plot_data_wide26,q_nh_nd_est_did_plot_data_wide27,
   q_nh_nd_est_did_plot_data_wide28,q_nh_nd_est_did_plot_data_wide29,q_nh_nd_est_did_plot_data_wide30,
   q_nh_nd_est_did_plot_data_wide31,q_nh_nd_est_did_plot_data_wide32,q_nh_nd_est_did_plot_data_wide33,
   q_nh_nd_est_did_plot_data_wide34,q_nh_nd_est_did_plot_data_wide35)
q_nh_nd_est_did_plot_data_wide_list <- lapply(q_nh_nd_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nh_nd_est_sc1 <- sc_estimate(setup_q_nh_nd_list[[1]]$Y, setup_q_nh_nd_list[[1]]$N0, setup_q_nh_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_nd_est_sc2 <- sc_estimate(setup_q_nh_nd_list[[2]]$Y, setup_q_nh_nd_list[[2]]$N0, setup_q_nh_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_nd_est_sc5 <- sc_estimate(setup_q_nh_nd_list[[3]]$Y, setup_q_nh_nd_list[[3]]$N0, setup_q_nh_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_nd_est_sc10 <- sc_estimate(setup_q_nh_nd_list[[4]]$Y, setup_q_nh_nd_list[[4]]$N0, setup_q_nh_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_nd_est_sc11 <- sc_estimate(setup_q_nh_nd_list[[5]]$Y, setup_q_nh_nd_list[[5]]$N0, setup_q_nh_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_nd_est_sc12 <- sc_estimate(setup_q_nh_nd_list[[6]]$Y, setup_q_nh_nd_list[[6]]$N0, setup_q_nh_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_nd_est_sc13 <- sc_estimate(setup_q_nh_nd_list[[7]]$Y, setup_q_nh_nd_list[[7]]$N0, setup_q_nh_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_nd_est_sc15 <- sc_estimate(setup_q_nh_nd_list[[8]]$Y, setup_q_nh_nd_list[[8]]$N0, setup_q_nh_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_nd_est_sc17 <- sc_estimate(setup_q_nh_nd_list[[9]]$Y, setup_q_nh_nd_list[[9]]$N0, setup_q_nh_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_nd_est_sc19 <- sc_estimate(setup_q_nh_nd_list[[10]]$Y, setup_q_nh_nd_list[[10]]$N0, setup_q_nh_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_nd_est_sc21 <- sc_estimate(setup_q_nh_nd_list[[11]]$Y, setup_q_nh_nd_list[[11]]$N0, setup_q_nh_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_nd_est_sc23 <- sc_estimate(setup_q_nh_nd_list[[12]]$Y, setup_q_nh_nd_list[[12]]$N0, setup_q_nh_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_nd_est_sc24 <- sc_estimate(setup_q_nh_nd_list[[13]]$Y, setup_q_nh_nd_list[[13]]$N0, setup_q_nh_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_nd_est_sc25 <- sc_estimate(setup_q_nh_nd_list[[14]]$Y, setup_q_nh_nd_list[[14]]$N0, setup_q_nh_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_nd_est_sc26 <- sc_estimate(setup_q_nh_nd_list[[15]]$Y, setup_q_nh_nd_list[[15]]$N0, setup_q_nh_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_nd_est_sc28 <- sc_estimate(setup_q_nh_nd_list[[16]]$Y, setup_q_nh_nd_list[[16]]$N0, setup_q_nh_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_nd_est_sc29 <- sc_estimate(setup_q_nh_nd_list[[17]]$Y, setup_q_nh_nd_list[[17]]$N0, setup_q_nh_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_nd_est_sc30 <- sc_estimate(setup_q_nh_nd_list[[18]]$Y, setup_q_nh_nd_list[[18]]$N0, setup_q_nh_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_nd_est_sc31 <- sc_estimate(setup_q_nh_nd_list[[19]]$Y, setup_q_nh_nd_list[[19]]$N0, setup_q_nh_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_nd_est_sc32 <- sc_estimate(setup_q_nh_nd_list[[20]]$Y, setup_q_nh_nd_list[[20]]$N0, setup_q_nh_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_nd_est_sc33 <- sc_estimate(setup_q_nh_nd_list[[21]]$Y, setup_q_nh_nd_list[[21]]$N0, setup_q_nh_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_nd_est_sc34 <- sc_estimate(setup_q_nh_nd_list[[22]]$Y, setup_q_nh_nd_list[[22]]$N0, setup_q_nh_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_nd_est_sc36 <- sc_estimate(setup_q_nh_nd_list[[23]]$Y, setup_q_nh_nd_list[[23]]$N0, setup_q_nh_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_nd_est_sc37 <- sc_estimate(setup_q_nh_nd_list[[24]]$Y, setup_q_nh_nd_list[[24]]$N0, setup_q_nh_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_nd_est_sc39 <- sc_estimate(setup_q_nh_nd_list[[25]]$Y, setup_q_nh_nd_list[[25]]$N0, setup_q_nh_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_nd_est_sc40 <- sc_estimate(setup_q_nh_nd_list[[26]]$Y, setup_q_nh_nd_list[[26]]$N0, setup_q_nh_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_nd_est_sc41 <- sc_estimate(setup_q_nh_nd_list[[27]]$Y, setup_q_nh_nd_list[[27]]$N0, setup_q_nh_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_nd_est_sc44 <- sc_estimate(setup_q_nh_nd_list[[28]]$Y, setup_q_nh_nd_list[[28]]$N0, setup_q_nh_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_nd_est_sc45 <- sc_estimate(setup_q_nh_nd_list[[29]]$Y, setup_q_nh_nd_list[[29]]$N0, setup_q_nh_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_nd_est_sc47 <- sc_estimate(setup_q_nh_nd_list[[30]]$Y, setup_q_nh_nd_list[[30]]$N0, setup_q_nh_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_nd_est_sc50 <- sc_estimate(setup_q_nh_nd_list[[31]]$Y, setup_q_nh_nd_list[[31]]$N0, setup_q_nh_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_nd_est_sc51 <- sc_estimate(setup_q_nh_nd_list[[32]]$Y, setup_q_nh_nd_list[[32]]$N0, setup_q_nh_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_nd_est_sc53 <- sc_estimate(setup_q_nh_nd_list[[33]]$Y, setup_q_nh_nd_list[[33]]$N0, setup_q_nh_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_nd_est_sc54 <- sc_estimate(setup_q_nh_nd_list[[34]]$Y, setup_q_nh_nd_list[[34]]$N0, setup_q_nh_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_nd_est_sc55 <- sc_estimate(setup_q_nh_nd_list[[35]]$Y, setup_q_nh_nd_list[[35]]$N0, setup_q_nh_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_nd_est_sc_list <- list(q_nh_nd_est_sc1,q_nh_nd_est_sc2,q_nh_nd_est_sc5,
                            q_nh_nd_est_sc10,q_nh_nd_est_sc11,q_nh_nd_est_sc12,
                            q_nh_nd_est_sc13,q_nh_nd_est_sc15,q_nh_nd_est_sc17,
                            q_nh_nd_est_sc19,q_nh_nd_est_sc21,q_nh_nd_est_sc23,
                            q_nh_nd_est_sc24,q_nh_nd_est_sc25,q_nh_nd_est_sc26,
                            q_nh_nd_est_sc28,q_nh_nd_est_sc29,q_nh_nd_est_sc30,
                            q_nh_nd_est_sc31,q_nh_nd_est_sc32,q_nh_nd_est_sc33,
                            q_nh_nd_est_sc34,q_nh_nd_est_sc36,q_nh_nd_est_sc37,
                            q_nh_nd_est_sc39,q_nh_nd_est_sc40,q_nh_nd_est_sc41,
                            q_nh_nd_est_sc44,q_nh_nd_est_sc45,q_nh_nd_est_sc47,
                            q_nh_nd_est_sc50,q_nh_nd_est_sc51,q_nh_nd_est_sc53,
                            q_nh_nd_est_sc54,q_nh_nd_est_sc55)
rm(q_nh_nd_est_sc1,q_nh_nd_est_sc2,q_nh_nd_est_sc5,
   q_nh_nd_est_sc10,q_nh_nd_est_sc11,q_nh_nd_est_sc12,
   q_nh_nd_est_sc13,q_nh_nd_est_sc15,q_nh_nd_est_sc17,
   q_nh_nd_est_sc19,q_nh_nd_est_sc21,q_nh_nd_est_sc23,
   q_nh_nd_est_sc24,q_nh_nd_est_sc25,q_nh_nd_est_sc26,
   q_nh_nd_est_sc28,q_nh_nd_est_sc29,q_nh_nd_est_sc30,
   q_nh_nd_est_sc31,q_nh_nd_est_sc32,q_nh_nd_est_sc33,
   q_nh_nd_est_sc34,q_nh_nd_est_sc36,q_nh_nd_est_sc37,
   q_nh_nd_est_sc39,q_nh_nd_est_sc40,q_nh_nd_est_sc41,
   q_nh_nd_est_sc44,q_nh_nd_est_sc45,q_nh_nd_est_sc47,
   q_nh_nd_est_sc50,q_nh_nd_est_sc51,q_nh_nd_est_sc53,
   q_nh_nd_est_sc54,q_nh_nd_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sc_plot", i), synthdid_plot(q_nh_nd_est_sc_list[i]))
}
q_nh_nd_est_sc_plot_data_aux1 <- ggplot_build(q_nh_nd_est_sc_plot1)
q_nh_nd_est_sc_plot_data_aux2 <- ggplot_build(q_nh_nd_est_sc_plot2)
q_nh_nd_est_sc_plot_data_aux3 <- ggplot_build(q_nh_nd_est_sc_plot3)
q_nh_nd_est_sc_plot_data_aux4 <- ggplot_build(q_nh_nd_est_sc_plot4)
q_nh_nd_est_sc_plot_data_aux5 <- ggplot_build(q_nh_nd_est_sc_plot5)
q_nh_nd_est_sc_plot_data_aux6 <- ggplot_build(q_nh_nd_est_sc_plot6)
q_nh_nd_est_sc_plot_data_aux7 <- ggplot_build(q_nh_nd_est_sc_plot7)
q_nh_nd_est_sc_plot_data_aux8 <- ggplot_build(q_nh_nd_est_sc_plot8)
q_nh_nd_est_sc_plot_data_aux9 <- ggplot_build(q_nh_nd_est_sc_plot9)
q_nh_nd_est_sc_plot_data_aux10 <- ggplot_build(q_nh_nd_est_sc_plot10)
q_nh_nd_est_sc_plot_data_aux11 <- ggplot_build(q_nh_nd_est_sc_plot11)
q_nh_nd_est_sc_plot_data_aux12 <- ggplot_build(q_nh_nd_est_sc_plot12)
q_nh_nd_est_sc_plot_data_aux13 <- ggplot_build(q_nh_nd_est_sc_plot13)
q_nh_nd_est_sc_plot_data_aux14 <- ggplot_build(q_nh_nd_est_sc_plot14)
q_nh_nd_est_sc_plot_data_aux15 <- ggplot_build(q_nh_nd_est_sc_plot15)
q_nh_nd_est_sc_plot_data_aux16 <- ggplot_build(q_nh_nd_est_sc_plot16)
q_nh_nd_est_sc_plot_data_aux17 <- ggplot_build(q_nh_nd_est_sc_plot17)
q_nh_nd_est_sc_plot_data_aux18 <- ggplot_build(q_nh_nd_est_sc_plot18)
q_nh_nd_est_sc_plot_data_aux19 <- ggplot_build(q_nh_nd_est_sc_plot19)
q_nh_nd_est_sc_plot_data_aux20 <- ggplot_build(q_nh_nd_est_sc_plot20)
q_nh_nd_est_sc_plot_data_aux21 <- ggplot_build(q_nh_nd_est_sc_plot21)
q_nh_nd_est_sc_plot_data_aux22 <- ggplot_build(q_nh_nd_est_sc_plot22)
q_nh_nd_est_sc_plot_data_aux23 <- ggplot_build(q_nh_nd_est_sc_plot23)
q_nh_nd_est_sc_plot_data_aux24 <- ggplot_build(q_nh_nd_est_sc_plot24)
q_nh_nd_est_sc_plot_data_aux25 <- ggplot_build(q_nh_nd_est_sc_plot25)
q_nh_nd_est_sc_plot_data_aux26 <- ggplot_build(q_nh_nd_est_sc_plot26)
q_nh_nd_est_sc_plot_data_aux27 <- ggplot_build(q_nh_nd_est_sc_plot27)
q_nh_nd_est_sc_plot_data_aux28 <- ggplot_build(q_nh_nd_est_sc_plot28)
q_nh_nd_est_sc_plot_data_aux29 <- ggplot_build(q_nh_nd_est_sc_plot29)
q_nh_nd_est_sc_plot_data_aux30 <- ggplot_build(q_nh_nd_est_sc_plot30)
q_nh_nd_est_sc_plot_data_aux31 <- ggplot_build(q_nh_nd_est_sc_plot31)
q_nh_nd_est_sc_plot_data_aux32 <- ggplot_build(q_nh_nd_est_sc_plot32)
q_nh_nd_est_sc_plot_data_aux33 <- ggplot_build(q_nh_nd_est_sc_plot33)
q_nh_nd_est_sc_plot_data_aux34 <- ggplot_build(q_nh_nd_est_sc_plot34)
q_nh_nd_est_sc_plot_data_aux35 <- ggplot_build(q_nh_nd_est_sc_plot35)
q_nh_nd_est_sc_plot_data_aux_list <- list(q_nh_nd_est_sc_plot_data_aux1,q_nh_nd_est_sc_plot_data_aux2,q_nh_nd_est_sc_plot_data_aux3,
                                          q_nh_nd_est_sc_plot_data_aux4,q_nh_nd_est_sc_plot_data_aux5,q_nh_nd_est_sc_plot_data_aux6,
                                          q_nh_nd_est_sc_plot_data_aux7,q_nh_nd_est_sc_plot_data_aux8,q_nh_nd_est_sc_plot_data_aux9,
                                          q_nh_nd_est_sc_plot_data_aux10,q_nh_nd_est_sc_plot_data_aux11,q_nh_nd_est_sc_plot_data_aux12,
                                          q_nh_nd_est_sc_plot_data_aux13,q_nh_nd_est_sc_plot_data_aux14,q_nh_nd_est_sc_plot_data_aux15,
                                          q_nh_nd_est_sc_plot_data_aux16,q_nh_nd_est_sc_plot_data_aux17,q_nh_nd_est_sc_plot_data_aux18,
                                          q_nh_nd_est_sc_plot_data_aux19,q_nh_nd_est_sc_plot_data_aux20,q_nh_nd_est_sc_plot_data_aux21,
                                          q_nh_nd_est_sc_plot_data_aux22,q_nh_nd_est_sc_plot_data_aux23,q_nh_nd_est_sc_plot_data_aux24,
                                          q_nh_nd_est_sc_plot_data_aux25,q_nh_nd_est_sc_plot_data_aux26,q_nh_nd_est_sc_plot_data_aux27,
                                          q_nh_nd_est_sc_plot_data_aux28,q_nh_nd_est_sc_plot_data_aux29,q_nh_nd_est_sc_plot_data_aux30,
                                          q_nh_nd_est_sc_plot_data_aux31,q_nh_nd_est_sc_plot_data_aux32,q_nh_nd_est_sc_plot_data_aux33,
                                          q_nh_nd_est_sc_plot_data_aux34,q_nh_nd_est_sc_plot_data_aux35)
rm(q_nh_nd_est_sc_plot_data_aux1,q_nh_nd_est_sc_plot_data_aux2,q_nh_nd_est_sc_plot_data_aux3,
   q_nh_nd_est_sc_plot_data_aux4,q_nh_nd_est_sc_plot_data_aux5,q_nh_nd_est_sc_plot_data_aux6,
   q_nh_nd_est_sc_plot_data_aux7,q_nh_nd_est_sc_plot_data_aux8,q_nh_nd_est_sc_plot_data_aux9,
   q_nh_nd_est_sc_plot_data_aux10,q_nh_nd_est_sc_plot_data_aux11,q_nh_nd_est_sc_plot_data_aux12,
   q_nh_nd_est_sc_plot_data_aux13,q_nh_nd_est_sc_plot_data_aux14,q_nh_nd_est_sc_plot_data_aux15,
   q_nh_nd_est_sc_plot_data_aux16,q_nh_nd_est_sc_plot_data_aux17,q_nh_nd_est_sc_plot_data_aux18,
   q_nh_nd_est_sc_plot_data_aux19,q_nh_nd_est_sc_plot_data_aux20,q_nh_nd_est_sc_plot_data_aux21,
   q_nh_nd_est_sc_plot_data_aux22,q_nh_nd_est_sc_plot_data_aux23,q_nh_nd_est_sc_plot_data_aux24,
   q_nh_nd_est_sc_plot_data_aux25,q_nh_nd_est_sc_plot_data_aux26,q_nh_nd_est_sc_plot_data_aux27,
   q_nh_nd_est_sc_plot_data_aux28,q_nh_nd_est_sc_plot_data_aux29,q_nh_nd_est_sc_plot_data_aux30,
   q_nh_nd_est_sc_plot_data_aux31,q_nh_nd_est_sc_plot_data_aux32,q_nh_nd_est_sc_plot_data_aux33,
   q_nh_nd_est_sc_plot_data_aux34,q_nh_nd_est_sc_plot_data_aux35)
rm(q_nh_nd_est_sc_plot1,q_nh_nd_est_sc_plot2,q_nh_nd_est_sc_plot3,
   q_nh_nd_est_sc_plot4,q_nh_nd_est_sc_plot5,q_nh_nd_est_sc_plot6,
   q_nh_nd_est_sc_plot7,q_nh_nd_est_sc_plot8,q_nh_nd_est_sc_plot9,
   q_nh_nd_est_sc_plot10,q_nh_nd_est_sc_plot11,q_nh_nd_est_sc_plot12,
   q_nh_nd_est_sc_plot13,q_nh_nd_est_sc_plot14,q_nh_nd_est_sc_plot15,
   q_nh_nd_est_sc_plot16,q_nh_nd_est_sc_plot17,q_nh_nd_est_sc_plot18,
   q_nh_nd_est_sc_plot19,q_nh_nd_est_sc_plot20,q_nh_nd_est_sc_plot21,
   q_nh_nd_est_sc_plot22,q_nh_nd_est_sc_plot23,q_nh_nd_est_sc_plot24,
   q_nh_nd_est_sc_plot25,q_nh_nd_est_sc_plot26,q_nh_nd_est_sc_plot27,
   q_nh_nd_est_sc_plot28,q_nh_nd_est_sc_plot29,q_nh_nd_est_sc_plot30,
   q_nh_nd_est_sc_plot31,q_nh_nd_est_sc_plot32,q_nh_nd_est_sc_plot33,
   q_nh_nd_est_sc_plot34,q_nh_nd_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sc_plot_data_long", i), data.frame(q_nh_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_nd_est_sc_plot_data_long_list <- list(q_nh_nd_est_sc_plot_data_long1,q_nh_nd_est_sc_plot_data_long2,q_nh_nd_est_sc_plot_data_long3,
                                           q_nh_nd_est_sc_plot_data_long4,q_nh_nd_est_sc_plot_data_long5,q_nh_nd_est_sc_plot_data_long6,
                                           q_nh_nd_est_sc_plot_data_long7,q_nh_nd_est_sc_plot_data_long8,q_nh_nd_est_sc_plot_data_long9,
                                           q_nh_nd_est_sc_plot_data_long10,q_nh_nd_est_sc_plot_data_long11,q_nh_nd_est_sc_plot_data_long12,
                                           q_nh_nd_est_sc_plot_data_long13,q_nh_nd_est_sc_plot_data_long14,q_nh_nd_est_sc_plot_data_long15,
                                           q_nh_nd_est_sc_plot_data_long16,q_nh_nd_est_sc_plot_data_long17,q_nh_nd_est_sc_plot_data_long18,
                                           q_nh_nd_est_sc_plot_data_long19,q_nh_nd_est_sc_plot_data_long20,q_nh_nd_est_sc_plot_data_long21,
                                           q_nh_nd_est_sc_plot_data_long22,q_nh_nd_est_sc_plot_data_long23,q_nh_nd_est_sc_plot_data_long24,
                                           q_nh_nd_est_sc_plot_data_long25,q_nh_nd_est_sc_plot_data_long26,q_nh_nd_est_sc_plot_data_long27,
                                           q_nh_nd_est_sc_plot_data_long28,q_nh_nd_est_sc_plot_data_long29,q_nh_nd_est_sc_plot_data_long30,
                                           q_nh_nd_est_sc_plot_data_long31,q_nh_nd_est_sc_plot_data_long32,q_nh_nd_est_sc_plot_data_long33,
                                           q_nh_nd_est_sc_plot_data_long34,q_nh_nd_est_sc_plot_data_long35)
rm(q_nh_nd_est_sc_plot_data_long1,q_nh_nd_est_sc_plot_data_long2,q_nh_nd_est_sc_plot_data_long3,
   q_nh_nd_est_sc_plot_data_long4,q_nh_nd_est_sc_plot_data_long5,q_nh_nd_est_sc_plot_data_long6,
   q_nh_nd_est_sc_plot_data_long7,q_nh_nd_est_sc_plot_data_long8,q_nh_nd_est_sc_plot_data_long9,
   q_nh_nd_est_sc_plot_data_long10,q_nh_nd_est_sc_plot_data_long11,q_nh_nd_est_sc_plot_data_long12,
   q_nh_nd_est_sc_plot_data_long13,q_nh_nd_est_sc_plot_data_long14,q_nh_nd_est_sc_plot_data_long15,
   q_nh_nd_est_sc_plot_data_long16,q_nh_nd_est_sc_plot_data_long17,q_nh_nd_est_sc_plot_data_long18,
   q_nh_nd_est_sc_plot_data_long19,q_nh_nd_est_sc_plot_data_long20,q_nh_nd_est_sc_plot_data_long21,
   q_nh_nd_est_sc_plot_data_long22,q_nh_nd_est_sc_plot_data_long23,q_nh_nd_est_sc_plot_data_long24,
   q_nh_nd_est_sc_plot_data_long25,q_nh_nd_est_sc_plot_data_long26,q_nh_nd_est_sc_plot_data_long27,
   q_nh_nd_est_sc_plot_data_long28,q_nh_nd_est_sc_plot_data_long29,q_nh_nd_est_sc_plot_data_long30,
   q_nh_nd_est_sc_plot_data_long31,q_nh_nd_est_sc_plot_data_long32,q_nh_nd_est_sc_plot_data_long33,
   q_nh_nd_est_sc_plot_data_long34,q_nh_nd_est_sc_plot_data_long35)
q_nh_nd_est_sc_plot_data_long_list <- lapply(q_nh_nd_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sc_plot_data_wide", i), reshape(data=q_nh_nd_est_sc_plot_data_long_list[[i]],
                                                             idvar = "year",
                                                             v.names = "outcome",
                                                             timevar = "treated",
                                                             direction = "wide"))
}
q_nh_nd_est_sc_plot_data_wide_list <- list(q_nh_nd_est_sc_plot_data_wide1,q_nh_nd_est_sc_plot_data_wide2,q_nh_nd_est_sc_plot_data_wide3,
                                           q_nh_nd_est_sc_plot_data_wide4,q_nh_nd_est_sc_plot_data_wide5,q_nh_nd_est_sc_plot_data_wide6,
                                           q_nh_nd_est_sc_plot_data_wide7,q_nh_nd_est_sc_plot_data_wide8,q_nh_nd_est_sc_plot_data_wide9,
                                           q_nh_nd_est_sc_plot_data_wide10,q_nh_nd_est_sc_plot_data_wide11,q_nh_nd_est_sc_plot_data_wide12,
                                           q_nh_nd_est_sc_plot_data_wide13,q_nh_nd_est_sc_plot_data_wide14,q_nh_nd_est_sc_plot_data_wide15,
                                           q_nh_nd_est_sc_plot_data_wide16,q_nh_nd_est_sc_plot_data_wide17,q_nh_nd_est_sc_plot_data_wide18,
                                           q_nh_nd_est_sc_plot_data_wide19,q_nh_nd_est_sc_plot_data_wide20,q_nh_nd_est_sc_plot_data_wide21,
                                           q_nh_nd_est_sc_plot_data_wide22,q_nh_nd_est_sc_plot_data_wide23,q_nh_nd_est_sc_plot_data_wide24,
                                           q_nh_nd_est_sc_plot_data_wide25,q_nh_nd_est_sc_plot_data_wide26,q_nh_nd_est_sc_plot_data_wide27,
                                           q_nh_nd_est_sc_plot_data_wide28,q_nh_nd_est_sc_plot_data_wide29,q_nh_nd_est_sc_plot_data_wide30,
                                           q_nh_nd_est_sc_plot_data_wide31,q_nh_nd_est_sc_plot_data_wide32,q_nh_nd_est_sc_plot_data_wide33,
                                           q_nh_nd_est_sc_plot_data_wide34,q_nh_nd_est_sc_plot_data_wide35)
rm(q_nh_nd_est_sc_plot_data_wide1,q_nh_nd_est_sc_plot_data_wide2,q_nh_nd_est_sc_plot_data_wide3,
   q_nh_nd_est_sc_plot_data_wide4,q_nh_nd_est_sc_plot_data_wide5,q_nh_nd_est_sc_plot_data_wide6,
   q_nh_nd_est_sc_plot_data_wide7,q_nh_nd_est_sc_plot_data_wide8,q_nh_nd_est_sc_plot_data_wide9,
   q_nh_nd_est_sc_plot_data_wide10,q_nh_nd_est_sc_plot_data_wide11,q_nh_nd_est_sc_plot_data_wide12,
   q_nh_nd_est_sc_plot_data_wide13,q_nh_nd_est_sc_plot_data_wide14,q_nh_nd_est_sc_plot_data_wide15,
   q_nh_nd_est_sc_plot_data_wide16,q_nh_nd_est_sc_plot_data_wide17,q_nh_nd_est_sc_plot_data_wide18,
   q_nh_nd_est_sc_plot_data_wide19,q_nh_nd_est_sc_plot_data_wide20,q_nh_nd_est_sc_plot_data_wide21,
   q_nh_nd_est_sc_plot_data_wide22,q_nh_nd_est_sc_plot_data_wide23,q_nh_nd_est_sc_plot_data_wide24,
   q_nh_nd_est_sc_plot_data_wide25,q_nh_nd_est_sc_plot_data_wide26,q_nh_nd_est_sc_plot_data_wide27,
   q_nh_nd_est_sc_plot_data_wide28,q_nh_nd_est_sc_plot_data_wide29,q_nh_nd_est_sc_plot_data_wide30,
   q_nh_nd_est_sc_plot_data_wide31,q_nh_nd_est_sc_plot_data_wide32,q_nh_nd_est_sc_plot_data_wide33,
   q_nh_nd_est_sc_plot_data_wide34,q_nh_nd_est_sc_plot_data_wide35)
q_nh_nd_est_sc_plot_data_wide_list <- lapply(q_nh_nd_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nh_nd_est_sdid1 <- synthdid_estimate(setup_q_nh_nd_list[[1]]$Y, setup_q_nh_nd_list[[1]]$N0, setup_q_nh_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nh_nd_est_sdid2 <- synthdid_estimate(setup_q_nh_nd_list[[2]]$Y, setup_q_nh_nd_list[[2]]$N0, setup_q_nh_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nh_nd_est_sdid5 <- synthdid_estimate(setup_q_nh_nd_list[[3]]$Y, setup_q_nh_nd_list[[3]]$N0, setup_q_nh_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nh_nd_est_sdid10 <- synthdid_estimate(setup_q_nh_nd_list[[4]]$Y, setup_q_nh_nd_list[[4]]$N0, setup_q_nh_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nh_nd_est_sdid11 <- synthdid_estimate(setup_q_nh_nd_list[[5]]$Y, setup_q_nh_nd_list[[5]]$N0, setup_q_nh_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nh_nd_est_sdid12 <- synthdid_estimate(setup_q_nh_nd_list[[6]]$Y, setup_q_nh_nd_list[[6]]$N0, setup_q_nh_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nh_nd_est_sdid13 <- synthdid_estimate(setup_q_nh_nd_list[[7]]$Y, setup_q_nh_nd_list[[7]]$N0, setup_q_nh_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nh_nd_est_sdid15 <- synthdid_estimate(setup_q_nh_nd_list[[8]]$Y, setup_q_nh_nd_list[[8]]$N0, setup_q_nh_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nh_nd_est_sdid17 <- synthdid_estimate(setup_q_nh_nd_list[[9]]$Y, setup_q_nh_nd_list[[9]]$N0, setup_q_nh_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nh_nd_est_sdid19 <- synthdid_estimate(setup_q_nh_nd_list[[10]]$Y, setup_q_nh_nd_list[[10]]$N0, setup_q_nh_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nh_nd_est_sdid21 <- synthdid_estimate(setup_q_nh_nd_list[[11]]$Y, setup_q_nh_nd_list[[11]]$N0, setup_q_nh_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nh_nd_est_sdid23 <- synthdid_estimate(setup_q_nh_nd_list[[12]]$Y, setup_q_nh_nd_list[[12]]$N0, setup_q_nh_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nh_nd_est_sdid24 <- synthdid_estimate(setup_q_nh_nd_list[[13]]$Y, setup_q_nh_nd_list[[13]]$N0, setup_q_nh_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nh_nd_est_sdid25 <- synthdid_estimate(setup_q_nh_nd_list[[14]]$Y, setup_q_nh_nd_list[[14]]$N0, setup_q_nh_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nh_nd_est_sdid26 <- synthdid_estimate(setup_q_nh_nd_list[[15]]$Y, setup_q_nh_nd_list[[15]]$N0, setup_q_nh_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nh_nd_est_sdid28 <- synthdid_estimate(setup_q_nh_nd_list[[16]]$Y, setup_q_nh_nd_list[[16]]$N0, setup_q_nh_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nh_nd_est_sdid29 <- synthdid_estimate(setup_q_nh_nd_list[[17]]$Y, setup_q_nh_nd_list[[17]]$N0, setup_q_nh_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nh_nd_est_sdid30 <- synthdid_estimate(setup_q_nh_nd_list[[18]]$Y, setup_q_nh_nd_list[[18]]$N0, setup_q_nh_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nh_nd_est_sdid31 <- synthdid_estimate(setup_q_nh_nd_list[[19]]$Y, setup_q_nh_nd_list[[19]]$N0, setup_q_nh_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nh_nd_est_sdid32 <- synthdid_estimate(setup_q_nh_nd_list[[20]]$Y, setup_q_nh_nd_list[[20]]$N0, setup_q_nh_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nh_nd_est_sdid33 <- synthdid_estimate(setup_q_nh_nd_list[[21]]$Y, setup_q_nh_nd_list[[21]]$N0, setup_q_nh_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nh_nd_est_sdid34 <- synthdid_estimate(setup_q_nh_nd_list[[22]]$Y, setup_q_nh_nd_list[[22]]$N0, setup_q_nh_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nh_nd_est_sdid36 <- synthdid_estimate(setup_q_nh_nd_list[[23]]$Y, setup_q_nh_nd_list[[23]]$N0, setup_q_nh_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nh_nd_est_sdid37 <- synthdid_estimate(setup_q_nh_nd_list[[24]]$Y, setup_q_nh_nd_list[[24]]$N0, setup_q_nh_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nh_nd_est_sdid39 <- synthdid_estimate(setup_q_nh_nd_list[[25]]$Y, setup_q_nh_nd_list[[25]]$N0, setup_q_nh_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nh_nd_est_sdid40 <- synthdid_estimate(setup_q_nh_nd_list[[26]]$Y, setup_q_nh_nd_list[[26]]$N0, setup_q_nh_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nh_nd_est_sdid41 <- synthdid_estimate(setup_q_nh_nd_list[[27]]$Y, setup_q_nh_nd_list[[27]]$N0, setup_q_nh_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nh_nd_est_sdid44 <- synthdid_estimate(setup_q_nh_nd_list[[28]]$Y, setup_q_nh_nd_list[[28]]$N0, setup_q_nh_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nh_nd_est_sdid45 <- synthdid_estimate(setup_q_nh_nd_list[[29]]$Y, setup_q_nh_nd_list[[29]]$N0, setup_q_nh_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nh_nd_est_sdid47 <- synthdid_estimate(setup_q_nh_nd_list[[30]]$Y, setup_q_nh_nd_list[[30]]$N0, setup_q_nh_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nh_nd_est_sdid50 <- synthdid_estimate(setup_q_nh_nd_list[[31]]$Y, setup_q_nh_nd_list[[31]]$N0, setup_q_nh_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nh_nd_est_sdid51 <- synthdid_estimate(setup_q_nh_nd_list[[32]]$Y, setup_q_nh_nd_list[[32]]$N0, setup_q_nh_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nh_nd_est_sdid53 <- synthdid_estimate(setup_q_nh_nd_list[[33]]$Y, setup_q_nh_nd_list[[33]]$N0, setup_q_nh_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nh_nd_est_sdid54 <- synthdid_estimate(setup_q_nh_nd_list[[34]]$Y, setup_q_nh_nd_list[[34]]$N0, setup_q_nh_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nh_nd_est_sdid55 <- synthdid_estimate(setup_q_nh_nd_list[[35]]$Y, setup_q_nh_nd_list[[35]]$N0, setup_q_nh_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nh_nd_est_sdid_list <- list(q_nh_nd_est_sdid1,q_nh_nd_est_sdid2,q_nh_nd_est_sdid5,
                              q_nh_nd_est_sdid10,q_nh_nd_est_sdid11,q_nh_nd_est_sdid12,
                              q_nh_nd_est_sdid13,q_nh_nd_est_sdid15,q_nh_nd_est_sdid17,
                              q_nh_nd_est_sdid19,q_nh_nd_est_sdid21,q_nh_nd_est_sdid23,
                              q_nh_nd_est_sdid24,q_nh_nd_est_sdid25,q_nh_nd_est_sdid26,
                              q_nh_nd_est_sdid28,q_nh_nd_est_sdid29,q_nh_nd_est_sdid30,
                              q_nh_nd_est_sdid31,q_nh_nd_est_sdid32,q_nh_nd_est_sdid33,
                              q_nh_nd_est_sdid34,q_nh_nd_est_sdid36,q_nh_nd_est_sdid37,
                              q_nh_nd_est_sdid39,q_nh_nd_est_sdid40,q_nh_nd_est_sdid41,
                              q_nh_nd_est_sdid44,q_nh_nd_est_sdid45,q_nh_nd_est_sdid47,
                              q_nh_nd_est_sdid50,q_nh_nd_est_sdid51,q_nh_nd_est_sdid53,
                              q_nh_nd_est_sdid54,q_nh_nd_est_sdid55)
rm(q_nh_nd_est_sdid1,q_nh_nd_est_sdid2,q_nh_nd_est_sdid5,
   q_nh_nd_est_sdid10,q_nh_nd_est_sdid11,q_nh_nd_est_sdid12,
   q_nh_nd_est_sdid13,q_nh_nd_est_sdid15,q_nh_nd_est_sdid17,
   q_nh_nd_est_sdid19,q_nh_nd_est_sdid21,q_nh_nd_est_sdid23,
   q_nh_nd_est_sdid24,q_nh_nd_est_sdid25,q_nh_nd_est_sdid26,
   q_nh_nd_est_sdid28,q_nh_nd_est_sdid29,q_nh_nd_est_sdid30,
   q_nh_nd_est_sdid31,q_nh_nd_est_sdid32,q_nh_nd_est_sdid33,
   q_nh_nd_est_sdid34,q_nh_nd_est_sdid36,q_nh_nd_est_sdid37,
   q_nh_nd_est_sdid39,q_nh_nd_est_sdid40,q_nh_nd_est_sdid41,
   q_nh_nd_est_sdid44,q_nh_nd_est_sdid45,q_nh_nd_est_sdid47,
   q_nh_nd_est_sdid50,q_nh_nd_est_sdid51,q_nh_nd_est_sdid53,
   q_nh_nd_est_sdid54,q_nh_nd_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sdid_plot", i), synthdid_plot(q_nh_nd_est_sdid_list[i]))
}
q_nh_nd_est_sdid_plot_data_aux1 <- ggplot_build(q_nh_nd_est_sdid_plot1)
q_nh_nd_est_sdid_plot_data_aux2 <- ggplot_build(q_nh_nd_est_sdid_plot2)
q_nh_nd_est_sdid_plot_data_aux3 <- ggplot_build(q_nh_nd_est_sdid_plot3)
q_nh_nd_est_sdid_plot_data_aux4 <- ggplot_build(q_nh_nd_est_sdid_plot4)
q_nh_nd_est_sdid_plot_data_aux5 <- ggplot_build(q_nh_nd_est_sdid_plot5)
q_nh_nd_est_sdid_plot_data_aux6 <- ggplot_build(q_nh_nd_est_sdid_plot6)
q_nh_nd_est_sdid_plot_data_aux7 <- ggplot_build(q_nh_nd_est_sdid_plot7)
q_nh_nd_est_sdid_plot_data_aux8 <- ggplot_build(q_nh_nd_est_sdid_plot8)
q_nh_nd_est_sdid_plot_data_aux9 <- ggplot_build(q_nh_nd_est_sdid_plot9)
q_nh_nd_est_sdid_plot_data_aux10 <- ggplot_build(q_nh_nd_est_sdid_plot10)
q_nh_nd_est_sdid_plot_data_aux11 <- ggplot_build(q_nh_nd_est_sdid_plot11)
q_nh_nd_est_sdid_plot_data_aux12 <- ggplot_build(q_nh_nd_est_sdid_plot12)
q_nh_nd_est_sdid_plot_data_aux13 <- ggplot_build(q_nh_nd_est_sdid_plot13)
q_nh_nd_est_sdid_plot_data_aux14 <- ggplot_build(q_nh_nd_est_sdid_plot14)
q_nh_nd_est_sdid_plot_data_aux15 <- ggplot_build(q_nh_nd_est_sdid_plot15)
q_nh_nd_est_sdid_plot_data_aux16 <- ggplot_build(q_nh_nd_est_sdid_plot16)
q_nh_nd_est_sdid_plot_data_aux17 <- ggplot_build(q_nh_nd_est_sdid_plot17)
q_nh_nd_est_sdid_plot_data_aux18 <- ggplot_build(q_nh_nd_est_sdid_plot18)
q_nh_nd_est_sdid_plot_data_aux19 <- ggplot_build(q_nh_nd_est_sdid_plot19)
q_nh_nd_est_sdid_plot_data_aux20 <- ggplot_build(q_nh_nd_est_sdid_plot20)
q_nh_nd_est_sdid_plot_data_aux21 <- ggplot_build(q_nh_nd_est_sdid_plot21)
q_nh_nd_est_sdid_plot_data_aux22 <- ggplot_build(q_nh_nd_est_sdid_plot22)
q_nh_nd_est_sdid_plot_data_aux23 <- ggplot_build(q_nh_nd_est_sdid_plot23)
q_nh_nd_est_sdid_plot_data_aux24 <- ggplot_build(q_nh_nd_est_sdid_plot24)
q_nh_nd_est_sdid_plot_data_aux25 <- ggplot_build(q_nh_nd_est_sdid_plot25)
q_nh_nd_est_sdid_plot_data_aux26 <- ggplot_build(q_nh_nd_est_sdid_plot26)
q_nh_nd_est_sdid_plot_data_aux27 <- ggplot_build(q_nh_nd_est_sdid_plot27)
q_nh_nd_est_sdid_plot_data_aux28 <- ggplot_build(q_nh_nd_est_sdid_plot28)
q_nh_nd_est_sdid_plot_data_aux29 <- ggplot_build(q_nh_nd_est_sdid_plot29)
q_nh_nd_est_sdid_plot_data_aux30 <- ggplot_build(q_nh_nd_est_sdid_plot30)
q_nh_nd_est_sdid_plot_data_aux31 <- ggplot_build(q_nh_nd_est_sdid_plot31)
q_nh_nd_est_sdid_plot_data_aux32 <- ggplot_build(q_nh_nd_est_sdid_plot32)
q_nh_nd_est_sdid_plot_data_aux33 <- ggplot_build(q_nh_nd_est_sdid_plot33)
q_nh_nd_est_sdid_plot_data_aux34 <- ggplot_build(q_nh_nd_est_sdid_plot34)
q_nh_nd_est_sdid_plot_data_aux35 <- ggplot_build(q_nh_nd_est_sdid_plot35)
q_nh_nd_est_sdid_plot_data_aux_list <- list(q_nh_nd_est_sdid_plot_data_aux1,q_nh_nd_est_sdid_plot_data_aux2,q_nh_nd_est_sdid_plot_data_aux3,
                                            q_nh_nd_est_sdid_plot_data_aux4,q_nh_nd_est_sdid_plot_data_aux5,q_nh_nd_est_sdid_plot_data_aux6,
                                            q_nh_nd_est_sdid_plot_data_aux7,q_nh_nd_est_sdid_plot_data_aux8,q_nh_nd_est_sdid_plot_data_aux9,
                                            q_nh_nd_est_sdid_plot_data_aux10,q_nh_nd_est_sdid_plot_data_aux11,q_nh_nd_est_sdid_plot_data_aux12,
                                            q_nh_nd_est_sdid_plot_data_aux13,q_nh_nd_est_sdid_plot_data_aux14,q_nh_nd_est_sdid_plot_data_aux15,
                                            q_nh_nd_est_sdid_plot_data_aux16,q_nh_nd_est_sdid_plot_data_aux17,q_nh_nd_est_sdid_plot_data_aux18,
                                            q_nh_nd_est_sdid_plot_data_aux19,q_nh_nd_est_sdid_plot_data_aux20,q_nh_nd_est_sdid_plot_data_aux21,
                                            q_nh_nd_est_sdid_plot_data_aux22,q_nh_nd_est_sdid_plot_data_aux23,q_nh_nd_est_sdid_plot_data_aux24,
                                            q_nh_nd_est_sdid_plot_data_aux25,q_nh_nd_est_sdid_plot_data_aux26,q_nh_nd_est_sdid_plot_data_aux27,
                                            q_nh_nd_est_sdid_plot_data_aux28,q_nh_nd_est_sdid_plot_data_aux29,q_nh_nd_est_sdid_plot_data_aux30,
                                            q_nh_nd_est_sdid_plot_data_aux31,q_nh_nd_est_sdid_plot_data_aux32,q_nh_nd_est_sdid_plot_data_aux33,
                                            q_nh_nd_est_sdid_plot_data_aux34,q_nh_nd_est_sdid_plot_data_aux35)
rm(q_nh_nd_est_sdid_plot_data_aux1,q_nh_nd_est_sdid_plot_data_aux2,q_nh_nd_est_sdid_plot_data_aux3,
   q_nh_nd_est_sdid_plot_data_aux4,q_nh_nd_est_sdid_plot_data_aux5,q_nh_nd_est_sdid_plot_data_aux6,
   q_nh_nd_est_sdid_plot_data_aux7,q_nh_nd_est_sdid_plot_data_aux8,q_nh_nd_est_sdid_plot_data_aux9,
   q_nh_nd_est_sdid_plot_data_aux10,q_nh_nd_est_sdid_plot_data_aux11,q_nh_nd_est_sdid_plot_data_aux12,
   q_nh_nd_est_sdid_plot_data_aux13,q_nh_nd_est_sdid_plot_data_aux14,q_nh_nd_est_sdid_plot_data_aux15,
   q_nh_nd_est_sdid_plot_data_aux16,q_nh_nd_est_sdid_plot_data_aux17,q_nh_nd_est_sdid_plot_data_aux18,
   q_nh_nd_est_sdid_plot_data_aux19,q_nh_nd_est_sdid_plot_data_aux20,q_nh_nd_est_sdid_plot_data_aux21,
   q_nh_nd_est_sdid_plot_data_aux22,q_nh_nd_est_sdid_plot_data_aux23,q_nh_nd_est_sdid_plot_data_aux24,
   q_nh_nd_est_sdid_plot_data_aux25,q_nh_nd_est_sdid_plot_data_aux26,q_nh_nd_est_sdid_plot_data_aux27,
   q_nh_nd_est_sdid_plot_data_aux28,q_nh_nd_est_sdid_plot_data_aux29,q_nh_nd_est_sdid_plot_data_aux30,
   q_nh_nd_est_sdid_plot_data_aux31,q_nh_nd_est_sdid_plot_data_aux32,q_nh_nd_est_sdid_plot_data_aux33,
   q_nh_nd_est_sdid_plot_data_aux34,q_nh_nd_est_sdid_plot_data_aux35)
rm(q_nh_nd_est_sdid_plot1,q_nh_nd_est_sdid_plot2,q_nh_nd_est_sdid_plot3,
   q_nh_nd_est_sdid_plot4,q_nh_nd_est_sdid_plot5,q_nh_nd_est_sdid_plot6,
   q_nh_nd_est_sdid_plot7,q_nh_nd_est_sdid_plot8,q_nh_nd_est_sdid_plot9,
   q_nh_nd_est_sdid_plot10,q_nh_nd_est_sdid_plot11,q_nh_nd_est_sdid_plot12,
   q_nh_nd_est_sdid_plot13,q_nh_nd_est_sdid_plot14,q_nh_nd_est_sdid_plot15,
   q_nh_nd_est_sdid_plot16,q_nh_nd_est_sdid_plot17,q_nh_nd_est_sdid_plot18,
   q_nh_nd_est_sdid_plot19,q_nh_nd_est_sdid_plot20,q_nh_nd_est_sdid_plot21,
   q_nh_nd_est_sdid_plot22,q_nh_nd_est_sdid_plot23,q_nh_nd_est_sdid_plot24,
   q_nh_nd_est_sdid_plot25,q_nh_nd_est_sdid_plot26,q_nh_nd_est_sdid_plot27,
   q_nh_nd_est_sdid_plot28,q_nh_nd_est_sdid_plot29,q_nh_nd_est_sdid_plot30,
   q_nh_nd_est_sdid_plot31,q_nh_nd_est_sdid_plot32,q_nh_nd_est_sdid_plot33,
   q_nh_nd_est_sdid_plot34,q_nh_nd_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sdid_plot_data_long", i), data.frame(q_nh_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nh_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nh_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nh_nd_est_sdid_plot_data_long_list <- list(q_nh_nd_est_sdid_plot_data_long1,q_nh_nd_est_sdid_plot_data_long2,q_nh_nd_est_sdid_plot_data_long3,
                                             q_nh_nd_est_sdid_plot_data_long4,q_nh_nd_est_sdid_plot_data_long5,q_nh_nd_est_sdid_plot_data_long6,
                                             q_nh_nd_est_sdid_plot_data_long7,q_nh_nd_est_sdid_plot_data_long8,q_nh_nd_est_sdid_plot_data_long9,
                                             q_nh_nd_est_sdid_plot_data_long10,q_nh_nd_est_sdid_plot_data_long11,q_nh_nd_est_sdid_plot_data_long12,
                                             q_nh_nd_est_sdid_plot_data_long13,q_nh_nd_est_sdid_plot_data_long14,q_nh_nd_est_sdid_plot_data_long15,
                                             q_nh_nd_est_sdid_plot_data_long16,q_nh_nd_est_sdid_plot_data_long17,q_nh_nd_est_sdid_plot_data_long18,
                                             q_nh_nd_est_sdid_plot_data_long19,q_nh_nd_est_sdid_plot_data_long20,q_nh_nd_est_sdid_plot_data_long21,
                                             q_nh_nd_est_sdid_plot_data_long22,q_nh_nd_est_sdid_plot_data_long23,q_nh_nd_est_sdid_plot_data_long24,
                                             q_nh_nd_est_sdid_plot_data_long25,q_nh_nd_est_sdid_plot_data_long26,q_nh_nd_est_sdid_plot_data_long27,
                                             q_nh_nd_est_sdid_plot_data_long28,q_nh_nd_est_sdid_plot_data_long29,q_nh_nd_est_sdid_plot_data_long30,
                                             q_nh_nd_est_sdid_plot_data_long31,q_nh_nd_est_sdid_plot_data_long32,q_nh_nd_est_sdid_plot_data_long33,
                                             q_nh_nd_est_sdid_plot_data_long34,q_nh_nd_est_sdid_plot_data_long35)
rm(q_nh_nd_est_sdid_plot_data_long1,q_nh_nd_est_sdid_plot_data_long2,q_nh_nd_est_sdid_plot_data_long3,
   q_nh_nd_est_sdid_plot_data_long4,q_nh_nd_est_sdid_plot_data_long5,q_nh_nd_est_sdid_plot_data_long6,
   q_nh_nd_est_sdid_plot_data_long7,q_nh_nd_est_sdid_plot_data_long8,q_nh_nd_est_sdid_plot_data_long9,
   q_nh_nd_est_sdid_plot_data_long10,q_nh_nd_est_sdid_plot_data_long11,q_nh_nd_est_sdid_plot_data_long12,
   q_nh_nd_est_sdid_plot_data_long13,q_nh_nd_est_sdid_plot_data_long14,q_nh_nd_est_sdid_plot_data_long15,
   q_nh_nd_est_sdid_plot_data_long16,q_nh_nd_est_sdid_plot_data_long17,q_nh_nd_est_sdid_plot_data_long18,
   q_nh_nd_est_sdid_plot_data_long19,q_nh_nd_est_sdid_plot_data_long20,q_nh_nd_est_sdid_plot_data_long21,
   q_nh_nd_est_sdid_plot_data_long22,q_nh_nd_est_sdid_plot_data_long23,q_nh_nd_est_sdid_plot_data_long24,
   q_nh_nd_est_sdid_plot_data_long25,q_nh_nd_est_sdid_plot_data_long26,q_nh_nd_est_sdid_plot_data_long27,
   q_nh_nd_est_sdid_plot_data_long28,q_nh_nd_est_sdid_plot_data_long29,q_nh_nd_est_sdid_plot_data_long30,
   q_nh_nd_est_sdid_plot_data_long31,q_nh_nd_est_sdid_plot_data_long32,q_nh_nd_est_sdid_plot_data_long33,
   q_nh_nd_est_sdid_plot_data_long34,q_nh_nd_est_sdid_plot_data_long35)
q_nh_nd_est_sdid_plot_data_long_list <- lapply(q_nh_nd_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nh_nd_est_sdid_plot_data_wide", i), reshape(data=q_nh_nd_est_sdid_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
q_nh_nd_est_sdid_plot_data_wide_list <- list(q_nh_nd_est_sdid_plot_data_wide1,q_nh_nd_est_sdid_plot_data_wide2,q_nh_nd_est_sdid_plot_data_wide3,
                                             q_nh_nd_est_sdid_plot_data_wide4,q_nh_nd_est_sdid_plot_data_wide5,q_nh_nd_est_sdid_plot_data_wide6,
                                             q_nh_nd_est_sdid_plot_data_wide7,q_nh_nd_est_sdid_plot_data_wide8,q_nh_nd_est_sdid_plot_data_wide9,
                                             q_nh_nd_est_sdid_plot_data_wide10,q_nh_nd_est_sdid_plot_data_wide11,q_nh_nd_est_sdid_plot_data_wide12,
                                             q_nh_nd_est_sdid_plot_data_wide13,q_nh_nd_est_sdid_plot_data_wide14,q_nh_nd_est_sdid_plot_data_wide15,
                                             q_nh_nd_est_sdid_plot_data_wide16,q_nh_nd_est_sdid_plot_data_wide17,q_nh_nd_est_sdid_plot_data_wide18,
                                             q_nh_nd_est_sdid_plot_data_wide19,q_nh_nd_est_sdid_plot_data_wide20,q_nh_nd_est_sdid_plot_data_wide21,
                                             q_nh_nd_est_sdid_plot_data_wide22,q_nh_nd_est_sdid_plot_data_wide23,q_nh_nd_est_sdid_plot_data_wide24,
                                             q_nh_nd_est_sdid_plot_data_wide25,q_nh_nd_est_sdid_plot_data_wide26,q_nh_nd_est_sdid_plot_data_wide27,
                                             q_nh_nd_est_sdid_plot_data_wide28,q_nh_nd_est_sdid_plot_data_wide29,q_nh_nd_est_sdid_plot_data_wide30,
                                             q_nh_nd_est_sdid_plot_data_wide31,q_nh_nd_est_sdid_plot_data_wide32,q_nh_nd_est_sdid_plot_data_wide33,
                                             q_nh_nd_est_sdid_plot_data_wide34,q_nh_nd_est_sdid_plot_data_wide35)
rm(q_nh_nd_est_sdid_plot_data_wide1,q_nh_nd_est_sdid_plot_data_wide2,q_nh_nd_est_sdid_plot_data_wide3,
   q_nh_nd_est_sdid_plot_data_wide4,q_nh_nd_est_sdid_plot_data_wide5,q_nh_nd_est_sdid_plot_data_wide6,
   q_nh_nd_est_sdid_plot_data_wide7,q_nh_nd_est_sdid_plot_data_wide8,q_nh_nd_est_sdid_plot_data_wide9,
   q_nh_nd_est_sdid_plot_data_wide10,q_nh_nd_est_sdid_plot_data_wide11,q_nh_nd_est_sdid_plot_data_wide12,
   q_nh_nd_est_sdid_plot_data_wide13,q_nh_nd_est_sdid_plot_data_wide14,q_nh_nd_est_sdid_plot_data_wide15,
   q_nh_nd_est_sdid_plot_data_wide16,q_nh_nd_est_sdid_plot_data_wide17,q_nh_nd_est_sdid_plot_data_wide18,
   q_nh_nd_est_sdid_plot_data_wide19,q_nh_nd_est_sdid_plot_data_wide20,q_nh_nd_est_sdid_plot_data_wide21,
   q_nh_nd_est_sdid_plot_data_wide22,q_nh_nd_est_sdid_plot_data_wide23,q_nh_nd_est_sdid_plot_data_wide24,
   q_nh_nd_est_sdid_plot_data_wide25,q_nh_nd_est_sdid_plot_data_wide26,q_nh_nd_est_sdid_plot_data_wide27,
   q_nh_nd_est_sdid_plot_data_wide28,q_nh_nd_est_sdid_plot_data_wide29,q_nh_nd_est_sdid_plot_data_wide30,
   q_nh_nd_est_sdid_plot_data_wide31,q_nh_nd_est_sdid_plot_data_wide32,q_nh_nd_est_sdid_plot_data_wide33,
   q_nh_nd_est_sdid_plot_data_wide34,q_nh_nd_est_sdid_plot_data_wide35)
q_nh_nd_est_sdid_plot_data_wide_list <- lapply(q_nh_nd_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nh_est_did_plot_data_wide_nd$did_facet_title <- "Diff-in-Diff"
q_nh_est_sc_plot_data_wide_nd$sc_facet_title <- "Synthetic Control"
q_nh_est_sdid_plot_data_wide_nd$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nh_est_did_plot_data_wide_nd$diff_relative <- q_nh_est_did_plot_data_wide_nd$diff - q_nh_est_did_plot_data_wide_nd$diff[4]
for(i in 1:35) {
  q_nh_nd_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nh_nd_est_did_plot_data_wide_list[[i]]$diff - q_nh_nd_est_did_plot_data_wide_list[[i]]$diff[4]
}
q_nh_nd_spag_did_plot <- ggplot(q_nh_est_did_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Homes \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_nd_spag_sc_plot <- ggplot(q_nh_est_sc_plot_data_wide_nd, aes(year,diff)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nh_nd_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "North Dakota"),data = q_nh_est_sc_plot_data_wide_nd, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "North Dakota" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_est_sdid_plot_data_wide_nd$diff_relative <- q_nh_est_sdid_plot_data_wide_nd$diff - q_nh_est_sdid_plot_data_wide_nd$diff[4]
for(i in 1:35) {
  q_nh_nd_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nh_nd_est_sdid_plot_data_wide_list[[i]]$diff - q_nh_nd_est_sdid_plot_data_wide_list[[i]]$diff[4]
}
q_nh_nd_spag_sdid_plot <- ggplot(q_nh_est_sdid_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nh_nd_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nh_nd_est_did_vec <- c(q_nh_est_did_nd)
for (i in 1:35) {
  q_nh_nd_est_did_vec_aux <- q_nh_nd_est_did_list[[i]][1]
  q_nh_nd_est_did_vec <- c(q_nh_nd_est_did_vec,q_nh_nd_est_did_vec_aux)
}
q_nh_nd_est_did_df <- data.frame(q_nh_nd_est_did_vec)
q_nh_nd_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nh_nd_est_did_vec)) +
  geom_histogram(data = q_nh_nd_est_did_df, aes(x = q_nh_nd_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_nd_hist_did_plot1_ylim <- ggplot_build(q_nh_nd_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_nd_hist_did_plot <- q_nh_nd_hist_did_plot_aux +
  expand_limits(y=q_nh_nd_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_nd_est_did_vec[1], mean(q_nh_nd_est_did_vec[2:36])), xend = c(q_nh_nd_est_did_vec[1],mean(q_nh_nd_est_did_vec[2:36])), y = c(0,0), yend = c(q_nh_nd_hist_did_plot1_ylim,q_nh_nd_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_nd_est_did_vec[1], mean(q_nh_nd_est_did_vec[2:36])), y = c(q_nh_nd_hist_did_plot1_ylim,q_nh_nd_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_nd_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_nd_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_nd_est_sc_vec <- c(q_nh_est_sc_nd)
for (i in 1:35) {
  q_nh_nd_est_sc_vec_aux <- q_nh_nd_est_sc_list[[i]][1]
  q_nh_nd_est_sc_vec <- c(q_nh_nd_est_sc_vec,q_nh_nd_est_sc_vec_aux)
}
q_nh_nd_est_sc_df <- data.frame(q_nh_nd_est_sc_vec)
q_nh_nd_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nh_nd_est_sc_vec)) +
  geom_histogram(data = q_nh_nd_est_sc_df, aes(x = q_nh_nd_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_nd_hist_sc_plot1_ylim <- ggplot_build(q_nh_nd_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_nd_hist_sc_plot <- q_nh_nd_hist_sc_plot_aux +
  expand_limits(y=q_nh_nd_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_nd_est_sc_vec[1], mean(q_nh_nd_est_sc_vec[2:36])), xend = c(q_nh_nd_est_sc_vec[1],mean(q_nh_nd_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nh_nd_hist_sc_plot1_ylim,q_nh_nd_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_nd_est_sc_vec[1], mean(q_nh_nd_est_sc_vec[2:36])), y = c(q_nh_nd_hist_sc_plot1_ylim,q_nh_nd_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_nd_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_nd_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

q_nh_nd_est_sdid_vec <- c(q_nh_est_sdid_nd)
for (i in 1:35) {
  q_nh_nd_est_sdid_vec_aux <- q_nh_nd_est_sdid_list[[i]][1]
  q_nh_nd_est_sdid_vec <- c(q_nh_nd_est_sdid_vec,q_nh_nd_est_sdid_vec_aux)
}
q_nh_nd_est_sdid_df <- data.frame(q_nh_nd_est_sdid_vec)
q_nh_nd_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nh_nd_est_sdid_vec)) +
  geom_histogram(data = q_nh_nd_est_sdid_df, aes(x = q_nh_nd_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nh_nd_hist_sdid_plot1_ylim <- ggplot_build(q_nh_nd_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nh_nd_hist_sdid_plot <- q_nh_nd_hist_sdid_plot_aux +
  expand_limits(y=q_nh_nd_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nh_nd_est_sdid_vec[1], mean(q_nh_nd_est_sdid_vec[2:36])), xend = c(q_nh_nd_est_sdid_vec[1],mean(q_nh_nd_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nh_nd_hist_sdid_plot1_ylim,q_nh_nd_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nh_nd_est_sdid_vec[1], mean(q_nh_nd_est_sdid_vec[2:36])), y = c(q_nh_nd_hist_sdid_plot1_ylim,q_nh_nd_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",signif(q_nh_nd_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nh_nd_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nh_spag_dist_plots_ND.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nh_nd_spag_dist_plots_nd <- q_nh_nd_spag_did_plot + q_nh_nd_spag_sc_plot + q_nh_nd_spag_sdid_plot + q_nh_nd_hist_did_plot + q_nh_nd_hist_sc_plot + q_nh_nd_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Quantity of Nursing Home Beds #####
### ND - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
q_nursing_home_beds_nd_df <- as.data.frame(subset(CON_NursingHome, code == 10))
q_nursing_home_beds_nd_df$treated <- as.integer(ifelse(q_nursing_home_beds_nd_df$name == "North Dakota" & q_nursing_home_beds_nd_df$year >= 1995, 1, 0))
q_nursing_home_beds_nd_df <- q_nursing_home_beds_nd_df[order(q_nursing_home_beds_nd_df$year, q_nursing_home_beds_nd_df$treated_nd_aux, q_nursing_home_beds_nd_df$name),]
q_nursing_home_beds_nd_df <- subset(q_nursing_home_beds_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated))
setup_q_nhb_nd <- panel.matrices(q_nursing_home_beds_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
q_nhb_est_did_nd <- did_estimate(setup_q_nhb_nd$Y, setup_q_nhb_nd$N0, setup_q_nhb_nd$T0, X = covariates_acc_nd_array)
q_nhb_est_did_plot_nd <- synthdid_plot(q_nhb_est_did_nd)
q_nhb_est_did_plot_data_aux_nd <- ggplot_build(q_nhb_est_did_plot_nd)
q_nhb_est_did_plot_data_long_nd <- data.frame(q_nhb_est_did_plot_data_aux_nd$data[[1]]$x, q_nhb_est_did_plot_data_aux_nd$data[[1]]$y, q_nhb_est_did_plot_data_aux_nd$data[[1]]$group)
colnames(q_nhb_est_did_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nhb_est_did_plot_data_long_nd$treated <- q_nhb_est_did_plot_data_long_nd$treated - 1
q_nhb_est_did_plot_data_wide_nd <- reshape(data=q_nhb_est_did_plot_data_long_nd,
                                           idvar = "year",
                                           v.names = "outcome",
                                           timevar = "treated",
                                           direction = "wide")
q_nhb_est_did_plot_data_wide_nd$diff <- q_nhb_est_did_plot_data_wide_nd$outcome.1 - q_nhb_est_did_plot_data_wide_nd$outcome.0
# SC #
q_nhb_est_sc_nd <- sc_estimate(setup_q_nhb_nd$Y, setup_q_nhb_nd$N0, setup_q_nhb_nd$T0, X = covariates_acc_nd_array)
q_nhb_est_sc_plot_nd <- synthdid_plot(q_nhb_est_sc_nd)
q_nhb_est_sc_plot_data_aux_nd <- ggplot_build(q_nhb_est_sc_plot_nd)
q_nhb_est_sc_plot_data_long_nd <- data.frame(q_nhb_est_sc_plot_data_aux_nd$data[[1]]$x, q_nhb_est_sc_plot_data_aux_nd$data[[1]]$y, q_nhb_est_sc_plot_data_aux_nd$data[[1]]$group)
colnames(q_nhb_est_sc_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nhb_est_sc_plot_data_long_nd$treated <- q_nhb_est_sc_plot_data_long_nd$treated - 1
q_nhb_est_sc_plot_data_wide_nd <- reshape(data=q_nhb_est_sc_plot_data_long_nd,
                                          idvar = "year",
                                          v.names = "outcome",
                                          timevar = "treated",
                                          direction = "wide")
q_nhb_est_sc_plot_data_wide_nd$diff <- q_nhb_est_sc_plot_data_wide_nd$outcome.1 - q_nhb_est_sc_plot_data_wide_nd$outcome.0
# SDID #
q_nhb_est_sdid_nd <- synthdid_estimate(setup_q_nhb_nd$Y, setup_q_nhb_nd$N0, setup_q_nhb_nd$T0, X = covariates_acc_nd_array)
q_nhb_est_sdid_plot_nd <- synthdid_plot(q_nhb_est_sdid_nd)
q_nhb_est_sdid_plot_data_aux_nd <- ggplot_build(q_nhb_est_sdid_plot_nd)
q_nhb_est_sdid_plot_data_long_nd <- data.frame(q_nhb_est_sdid_plot_data_aux_nd$data[[1]]$x, q_nhb_est_sdid_plot_data_aux_nd$data[[1]]$y, q_nhb_est_sdid_plot_data_aux_nd$data[[1]]$group)
colnames(q_nhb_est_sdid_plot_data_long_nd) <- c('year', 'outcome', 'treated')
q_nhb_est_sdid_plot_data_long_nd$treated <- q_nhb_est_sdid_plot_data_long_nd$treated - 1
q_nhb_est_sdid_plot_data_wide_nd <- reshape(data=q_nhb_est_sdid_plot_data_long_nd,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
q_nhb_est_sdid_plot_data_wide_nd$diff <- q_nhb_est_sdid_plot_data_wide_nd$outcome.1 - q_nhb_est_sdid_plot_data_wide_nd$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("q_nhb_nd_df", i), subset(CON_NursingHome, alwaysconpa == 1))
}
q_nhb_nd_df1$treated_aux <- ifelse(q_nhb_nd_df1$id == 1, 1, 0)
q_nhb_nd_df2$treated_aux <- ifelse(q_nhb_nd_df2$id == 2, 1, 0)
q_nhb_nd_df5$treated_aux <- ifelse(q_nhb_nd_df5$id == 5, 1, 0)
q_nhb_nd_df10$treated_aux <- ifelse(q_nhb_nd_df10$id == 10, 1, 0)
q_nhb_nd_df11$treated_aux <- ifelse(q_nhb_nd_df11$id == 11, 1, 0)
q_nhb_nd_df12$treated_aux <- ifelse(q_nhb_nd_df12$id == 12, 1, 0)
q_nhb_nd_df13$treated_aux <- ifelse(q_nhb_nd_df13$id == 13, 1, 0)
q_nhb_nd_df15$treated_aux <- ifelse(q_nhb_nd_df15$id == 15, 1, 0)
q_nhb_nd_df17$treated_aux <- ifelse(q_nhb_nd_df17$id == 17, 1, 0)
q_nhb_nd_df19$treated_aux <- ifelse(q_nhb_nd_df19$id == 19, 1, 0)
q_nhb_nd_df21$treated_aux <- ifelse(q_nhb_nd_df21$id == 21, 1, 0)
q_nhb_nd_df23$treated_aux <- ifelse(q_nhb_nd_df23$id == 23, 1, 0)
q_nhb_nd_df24$treated_aux <- ifelse(q_nhb_nd_df24$id == 24, 1, 0)
q_nhb_nd_df25$treated_aux <- ifelse(q_nhb_nd_df25$id == 25, 1, 0)
q_nhb_nd_df26$treated_aux <- ifelse(q_nhb_nd_df26$id == 26, 1, 0)
q_nhb_nd_df28$treated_aux <- ifelse(q_nhb_nd_df28$id == 28, 1, 0)
q_nhb_nd_df29$treated_aux <- ifelse(q_nhb_nd_df29$id == 29, 1, 0)
q_nhb_nd_df30$treated_aux <- ifelse(q_nhb_nd_df30$id == 30, 1, 0)
q_nhb_nd_df31$treated_aux <- ifelse(q_nhb_nd_df31$id == 31, 1, 0)
q_nhb_nd_df32$treated_aux <- ifelse(q_nhb_nd_df32$id == 32, 1, 0)
q_nhb_nd_df33$treated_aux <- ifelse(q_nhb_nd_df33$id == 33, 1, 0)
q_nhb_nd_df34$treated_aux <- ifelse(q_nhb_nd_df34$id == 34, 1, 0)
q_nhb_nd_df36$treated_aux <- ifelse(q_nhb_nd_df36$id == 36, 1, 0)
q_nhb_nd_df37$treated_aux <- ifelse(q_nhb_nd_df37$id == 37, 1, 0)
q_nhb_nd_df39$treated_aux <- ifelse(q_nhb_nd_df39$id == 39, 1, 0)
q_nhb_nd_df40$treated_aux <- ifelse(q_nhb_nd_df40$id == 40, 1, 0)
q_nhb_nd_df41$treated_aux <- ifelse(q_nhb_nd_df41$id == 41, 1, 0)
q_nhb_nd_df44$treated_aux <- ifelse(q_nhb_nd_df44$id == 44, 1, 0)
q_nhb_nd_df45$treated_aux <- ifelse(q_nhb_nd_df45$id == 45, 1, 0)
q_nhb_nd_df47$treated_aux <- ifelse(q_nhb_nd_df47$id == 47, 1, 0)
q_nhb_nd_df50$treated_aux <- ifelse(q_nhb_nd_df50$id == 50, 1, 0)
q_nhb_nd_df51$treated_aux <- ifelse(q_nhb_nd_df51$id == 51, 1, 0)
q_nhb_nd_df53$treated_aux <- ifelse(q_nhb_nd_df53$id == 53, 1, 0)
q_nhb_nd_df54$treated_aux <- ifelse(q_nhb_nd_df54$id == 54, 1, 0)
q_nhb_nd_df55$treated_aux <- ifelse(q_nhb_nd_df55$id == 55, 1, 0)
q_nhb_nd_df1$treated <- as.integer(ifelse(q_nhb_nd_df1$id == 1 & q_nhb_nd_df1$year >= 1995, 1, 0))
q_nhb_nd_df2$treated <- as.integer(ifelse(q_nhb_nd_df2$id == 2 & q_nhb_nd_df2$year >= 1995, 1, 0))
q_nhb_nd_df5$treated <- as.integer(ifelse(q_nhb_nd_df5$id == 5 & q_nhb_nd_df5$year >= 1995, 1, 0))
q_nhb_nd_df10$treated <- as.integer(ifelse(q_nhb_nd_df10$id == 10 & q_nhb_nd_df10$year >= 1995, 1, 0))
q_nhb_nd_df11$treated <- as.integer(ifelse(q_nhb_nd_df11$id == 11 & q_nhb_nd_df11$year >= 1995, 1, 0))
q_nhb_nd_df12$treated <- as.integer(ifelse(q_nhb_nd_df12$id == 12 & q_nhb_nd_df12$year >= 1995, 1, 0))
q_nhb_nd_df13$treated <- as.integer(ifelse(q_nhb_nd_df13$id == 13 & q_nhb_nd_df13$year >= 1995, 1, 0))
q_nhb_nd_df15$treated <- as.integer(ifelse(q_nhb_nd_df15$id == 15 & q_nhb_nd_df15$year >= 1995, 1, 0))
q_nhb_nd_df17$treated <- as.integer(ifelse(q_nhb_nd_df17$id == 17 & q_nhb_nd_df17$year >= 1995, 1, 0))
q_nhb_nd_df19$treated <- as.integer(ifelse(q_nhb_nd_df19$id == 19 & q_nhb_nd_df19$year >= 1995, 1, 0))
q_nhb_nd_df21$treated <- as.integer(ifelse(q_nhb_nd_df21$id == 21 & q_nhb_nd_df21$year >= 1995, 1, 0))
q_nhb_nd_df23$treated <- as.integer(ifelse(q_nhb_nd_df23$id == 23 & q_nhb_nd_df23$year >= 1995, 1, 0))
q_nhb_nd_df24$treated <- as.integer(ifelse(q_nhb_nd_df24$id == 24 & q_nhb_nd_df24$year >= 1995, 1, 0))
q_nhb_nd_df25$treated <- as.integer(ifelse(q_nhb_nd_df25$id == 25 & q_nhb_nd_df25$year >= 1995, 1, 0))
q_nhb_nd_df26$treated <- as.integer(ifelse(q_nhb_nd_df26$id == 26 & q_nhb_nd_df26$year >= 1995, 1, 0))
q_nhb_nd_df28$treated <- as.integer(ifelse(q_nhb_nd_df28$id == 28 & q_nhb_nd_df28$year >= 1995, 1, 0))
q_nhb_nd_df29$treated <- as.integer(ifelse(q_nhb_nd_df29$id == 29 & q_nhb_nd_df29$year >= 1995, 1, 0))
q_nhb_nd_df30$treated <- as.integer(ifelse(q_nhb_nd_df30$id == 30 & q_nhb_nd_df30$year >= 1995, 1, 0))
q_nhb_nd_df31$treated <- as.integer(ifelse(q_nhb_nd_df31$id == 31 & q_nhb_nd_df31$year >= 1995, 1, 0))
q_nhb_nd_df32$treated <- as.integer(ifelse(q_nhb_nd_df32$id == 32 & q_nhb_nd_df32$year >= 1995, 1, 0))
q_nhb_nd_df33$treated <- as.integer(ifelse(q_nhb_nd_df33$id == 33 & q_nhb_nd_df33$year >= 1995, 1, 0))
q_nhb_nd_df34$treated <- as.integer(ifelse(q_nhb_nd_df34$id == 34 & q_nhb_nd_df34$year >= 1995, 1, 0))
q_nhb_nd_df36$treated <- as.integer(ifelse(q_nhb_nd_df36$id == 36 & q_nhb_nd_df36$year >= 1995, 1, 0))
q_nhb_nd_df37$treated <- as.integer(ifelse(q_nhb_nd_df37$id == 37 & q_nhb_nd_df37$year >= 1995, 1, 0))
q_nhb_nd_df39$treated <- as.integer(ifelse(q_nhb_nd_df39$id == 39 & q_nhb_nd_df39$year >= 1995, 1, 0))
q_nhb_nd_df40$treated <- as.integer(ifelse(q_nhb_nd_df40$id == 40 & q_nhb_nd_df40$year >= 1995, 1, 0))
q_nhb_nd_df41$treated <- as.integer(ifelse(q_nhb_nd_df41$id == 41 & q_nhb_nd_df41$year >= 1995, 1, 0))
q_nhb_nd_df44$treated <- as.integer(ifelse(q_nhb_nd_df44$id == 44 & q_nhb_nd_df44$year >= 1995, 1, 0))
q_nhb_nd_df45$treated <- as.integer(ifelse(q_nhb_nd_df45$id == 45 & q_nhb_nd_df45$year >= 1995, 1, 0))
q_nhb_nd_df47$treated <- as.integer(ifelse(q_nhb_nd_df47$id == 47 & q_nhb_nd_df47$year >= 1995, 1, 0))
q_nhb_nd_df50$treated <- as.integer(ifelse(q_nhb_nd_df50$id == 50 & q_nhb_nd_df50$year >= 1995, 1, 0))
q_nhb_nd_df51$treated <- as.integer(ifelse(q_nhb_nd_df51$id == 51 & q_nhb_nd_df51$year >= 1995, 1, 0))
q_nhb_nd_df53$treated <- as.integer(ifelse(q_nhb_nd_df53$id == 53 & q_nhb_nd_df53$year >= 1995, 1, 0))
q_nhb_nd_df54$treated <- as.integer(ifelse(q_nhb_nd_df54$id == 54 & q_nhb_nd_df54$year >= 1995, 1, 0))
q_nhb_nd_df55$treated <- as.integer(ifelse(q_nhb_nd_df55$id == 55 & q_nhb_nd_df55$year >= 1995, 1, 0))
q_nhb_nd_df_list <- list(q_nhb_nd_df1,q_nhb_nd_df2,q_nhb_nd_df5,
                         q_nhb_nd_df10,q_nhb_nd_df11,q_nhb_nd_df12,
                         q_nhb_nd_df13,q_nhb_nd_df15,q_nhb_nd_df17,
                         q_nhb_nd_df19,q_nhb_nd_df21,q_nhb_nd_df23,
                         q_nhb_nd_df24,q_nhb_nd_df25,q_nhb_nd_df26,
                         q_nhb_nd_df28,q_nhb_nd_df29,q_nhb_nd_df30,
                         q_nhb_nd_df31,q_nhb_nd_df32,q_nhb_nd_df33,
                         q_nhb_nd_df34,q_nhb_nd_df36,q_nhb_nd_df37,
                         q_nhb_nd_df39,q_nhb_nd_df40,q_nhb_nd_df41,
                         q_nhb_nd_df44,q_nhb_nd_df45,q_nhb_nd_df47,
                         q_nhb_nd_df50,q_nhb_nd_df51,q_nhb_nd_df53,
                         q_nhb_nd_df54,q_nhb_nd_df55)
rm(q_nhb_nd_df1,q_nhb_nd_df2,q_nhb_nd_df5,
   q_nhb_nd_df10,q_nhb_nd_df11,q_nhb_nd_df12,
   q_nhb_nd_df13,q_nhb_nd_df15,q_nhb_nd_df17,
   q_nhb_nd_df19,q_nhb_nd_df21,q_nhb_nd_df23,
   q_nhb_nd_df24,q_nhb_nd_df25,q_nhb_nd_df26,
   q_nhb_nd_df28,q_nhb_nd_df29,q_nhb_nd_df30,
   q_nhb_nd_df31,q_nhb_nd_df32,q_nhb_nd_df33,
   q_nhb_nd_df34,q_nhb_nd_df36,q_nhb_nd_df37,
   q_nhb_nd_df39,q_nhb_nd_df40,q_nhb_nd_df41,
   q_nhb_nd_df44,q_nhb_nd_df45,q_nhb_nd_df47,
   q_nhb_nd_df50,q_nhb_nd_df51,q_nhb_nd_df53,
   q_nhb_nd_df54,q_nhb_nd_df55)
q_nhb_nd_df_list <- lapply(q_nhb_nd_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
q_nhb_nd_df_list <- lapply(q_nhb_nd_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, Q_SkilledNursingHomeBeds_pcp, treated)))
}
)
setup_q_nhb_nd1 <- panel.matrices(q_nhb_nd_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd2 <- panel.matrices(q_nhb_nd_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd5 <- panel.matrices(q_nhb_nd_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd10 <- panel.matrices(q_nhb_nd_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd11 <- panel.matrices(q_nhb_nd_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd12 <- panel.matrices(q_nhb_nd_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd13 <- panel.matrices(q_nhb_nd_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd15 <- panel.matrices(q_nhb_nd_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd17 <- panel.matrices(q_nhb_nd_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd19 <- panel.matrices(q_nhb_nd_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd21 <- panel.matrices(q_nhb_nd_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd23 <- panel.matrices(q_nhb_nd_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd24 <- panel.matrices(q_nhb_nd_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd25 <- panel.matrices(q_nhb_nd_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd26 <- panel.matrices(q_nhb_nd_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd28 <- panel.matrices(q_nhb_nd_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd29 <- panel.matrices(q_nhb_nd_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd30 <- panel.matrices(q_nhb_nd_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd31 <- panel.matrices(q_nhb_nd_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd32 <- panel.matrices(q_nhb_nd_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd33 <- panel.matrices(q_nhb_nd_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd34 <- panel.matrices(q_nhb_nd_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd36 <- panel.matrices(q_nhb_nd_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd37 <- panel.matrices(q_nhb_nd_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd39 <- panel.matrices(q_nhb_nd_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd40 <- panel.matrices(q_nhb_nd_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd41 <- panel.matrices(q_nhb_nd_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd44 <- panel.matrices(q_nhb_nd_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd45 <- panel.matrices(q_nhb_nd_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd47 <- panel.matrices(q_nhb_nd_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd50 <- panel.matrices(q_nhb_nd_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd51 <- panel.matrices(q_nhb_nd_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd53 <- panel.matrices(q_nhb_nd_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd54 <- panel.matrices(q_nhb_nd_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd55 <- panel.matrices(q_nhb_nd_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_q_nhb_nd_list <- list(setup_q_nhb_nd1,setup_q_nhb_nd2,setup_q_nhb_nd5,
                            setup_q_nhb_nd10,setup_q_nhb_nd11,setup_q_nhb_nd12,
                            setup_q_nhb_nd13,setup_q_nhb_nd15,setup_q_nhb_nd17,
                            setup_q_nhb_nd19,setup_q_nhb_nd21,setup_q_nhb_nd23,
                            setup_q_nhb_nd24,setup_q_nhb_nd25,setup_q_nhb_nd26,
                            setup_q_nhb_nd28,setup_q_nhb_nd29,setup_q_nhb_nd30,
                            setup_q_nhb_nd31,setup_q_nhb_nd32,setup_q_nhb_nd33,
                            setup_q_nhb_nd34,setup_q_nhb_nd36,setup_q_nhb_nd37,
                            setup_q_nhb_nd39,setup_q_nhb_nd40,setup_q_nhb_nd41,
                            setup_q_nhb_nd44,setup_q_nhb_nd45,setup_q_nhb_nd47,
                            setup_q_nhb_nd50,setup_q_nhb_nd51,setup_q_nhb_nd53,
                            setup_q_nhb_nd54,setup_q_nhb_nd55)
rm(setup_q_nhb_nd1,setup_q_nhb_nd2,setup_q_nhb_nd5,
   setup_q_nhb_nd10,setup_q_nhb_nd11,setup_q_nhb_nd12,
   setup_q_nhb_nd13,setup_q_nhb_nd15,setup_q_nhb_nd17,
   setup_q_nhb_nd19,setup_q_nhb_nd21,setup_q_nhb_nd23,
   setup_q_nhb_nd24,setup_q_nhb_nd25,setup_q_nhb_nd26,
   setup_q_nhb_nd28,setup_q_nhb_nd29,setup_q_nhb_nd30,
   setup_q_nhb_nd31,setup_q_nhb_nd32,setup_q_nhb_nd33,
   setup_q_nhb_nd34,setup_q_nhb_nd36,setup_q_nhb_nd37,
   setup_q_nhb_nd39,setup_q_nhb_nd40,setup_q_nhb_nd41,
   setup_q_nhb_nd44,setup_q_nhb_nd45,setup_q_nhb_nd47,
   setup_q_nhb_nd50,setup_q_nhb_nd51,setup_q_nhb_nd53,
   setup_q_nhb_nd54,setup_q_nhb_nd55)
# DID #
q_nhb_nd_est_did1 <- did_estimate(setup_q_nhb_nd_list[[1]]$Y, setup_q_nhb_nd_list[[1]]$N0, setup_q_nhb_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_nd_est_did2 <- did_estimate(setup_q_nhb_nd_list[[2]]$Y, setup_q_nhb_nd_list[[2]]$N0, setup_q_nhb_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_nd_est_did5 <- did_estimate(setup_q_nhb_nd_list[[3]]$Y, setup_q_nhb_nd_list[[3]]$N0, setup_q_nhb_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_nd_est_did10 <- did_estimate(setup_q_nhb_nd_list[[4]]$Y, setup_q_nhb_nd_list[[4]]$N0, setup_q_nhb_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_nd_est_did11 <- did_estimate(setup_q_nhb_nd_list[[5]]$Y, setup_q_nhb_nd_list[[5]]$N0, setup_q_nhb_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_nd_est_did12 <- did_estimate(setup_q_nhb_nd_list[[6]]$Y, setup_q_nhb_nd_list[[6]]$N0, setup_q_nhb_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_nd_est_did13 <- did_estimate(setup_q_nhb_nd_list[[7]]$Y, setup_q_nhb_nd_list[[7]]$N0, setup_q_nhb_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_nd_est_did15 <- did_estimate(setup_q_nhb_nd_list[[8]]$Y, setup_q_nhb_nd_list[[8]]$N0, setup_q_nhb_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_nd_est_did17 <- did_estimate(setup_q_nhb_nd_list[[9]]$Y, setup_q_nhb_nd_list[[9]]$N0, setup_q_nhb_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_nd_est_did19 <- did_estimate(setup_q_nhb_nd_list[[10]]$Y, setup_q_nhb_nd_list[[10]]$N0, setup_q_nhb_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_nd_est_did21 <- did_estimate(setup_q_nhb_nd_list[[11]]$Y, setup_q_nhb_nd_list[[11]]$N0, setup_q_nhb_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_nd_est_did23 <- did_estimate(setup_q_nhb_nd_list[[12]]$Y, setup_q_nhb_nd_list[[12]]$N0, setup_q_nhb_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_nd_est_did24 <- did_estimate(setup_q_nhb_nd_list[[13]]$Y, setup_q_nhb_nd_list[[13]]$N0, setup_q_nhb_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_nd_est_did25 <- did_estimate(setup_q_nhb_nd_list[[14]]$Y, setup_q_nhb_nd_list[[14]]$N0, setup_q_nhb_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_nd_est_did26 <- did_estimate(setup_q_nhb_nd_list[[15]]$Y, setup_q_nhb_nd_list[[15]]$N0, setup_q_nhb_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_nd_est_did28 <- did_estimate(setup_q_nhb_nd_list[[16]]$Y, setup_q_nhb_nd_list[[16]]$N0, setup_q_nhb_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_nd_est_did29 <- did_estimate(setup_q_nhb_nd_list[[17]]$Y, setup_q_nhb_nd_list[[17]]$N0, setup_q_nhb_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_nd_est_did30 <- did_estimate(setup_q_nhb_nd_list[[18]]$Y, setup_q_nhb_nd_list[[18]]$N0, setup_q_nhb_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_nd_est_did31 <- did_estimate(setup_q_nhb_nd_list[[19]]$Y, setup_q_nhb_nd_list[[19]]$N0, setup_q_nhb_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_nd_est_did32 <- did_estimate(setup_q_nhb_nd_list[[20]]$Y, setup_q_nhb_nd_list[[20]]$N0, setup_q_nhb_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_nd_est_did33 <- did_estimate(setup_q_nhb_nd_list[[21]]$Y, setup_q_nhb_nd_list[[21]]$N0, setup_q_nhb_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_nd_est_did34 <- did_estimate(setup_q_nhb_nd_list[[22]]$Y, setup_q_nhb_nd_list[[22]]$N0, setup_q_nhb_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_nd_est_did36 <- did_estimate(setup_q_nhb_nd_list[[23]]$Y, setup_q_nhb_nd_list[[23]]$N0, setup_q_nhb_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_nd_est_did37 <- did_estimate(setup_q_nhb_nd_list[[24]]$Y, setup_q_nhb_nd_list[[24]]$N0, setup_q_nhb_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_nd_est_did39 <- did_estimate(setup_q_nhb_nd_list[[25]]$Y, setup_q_nhb_nd_list[[25]]$N0, setup_q_nhb_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_nd_est_did40 <- did_estimate(setup_q_nhb_nd_list[[26]]$Y, setup_q_nhb_nd_list[[26]]$N0, setup_q_nhb_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_nd_est_did41 <- did_estimate(setup_q_nhb_nd_list[[27]]$Y, setup_q_nhb_nd_list[[27]]$N0, setup_q_nhb_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_nd_est_did44 <- did_estimate(setup_q_nhb_nd_list[[28]]$Y, setup_q_nhb_nd_list[[28]]$N0, setup_q_nhb_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_nd_est_did45 <- did_estimate(setup_q_nhb_nd_list[[29]]$Y, setup_q_nhb_nd_list[[29]]$N0, setup_q_nhb_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_nd_est_did47 <- did_estimate(setup_q_nhb_nd_list[[30]]$Y, setup_q_nhb_nd_list[[30]]$N0, setup_q_nhb_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_nd_est_did50 <- did_estimate(setup_q_nhb_nd_list[[31]]$Y, setup_q_nhb_nd_list[[31]]$N0, setup_q_nhb_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_nd_est_did51 <- did_estimate(setup_q_nhb_nd_list[[32]]$Y, setup_q_nhb_nd_list[[32]]$N0, setup_q_nhb_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_nd_est_did53 <- did_estimate(setup_q_nhb_nd_list[[33]]$Y, setup_q_nhb_nd_list[[33]]$N0, setup_q_nhb_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_nd_est_did54 <- did_estimate(setup_q_nhb_nd_list[[34]]$Y, setup_q_nhb_nd_list[[34]]$N0, setup_q_nhb_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_nd_est_did55 <- did_estimate(setup_q_nhb_nd_list[[35]]$Y, setup_q_nhb_nd_list[[35]]$N0, setup_q_nhb_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_nd_est_did_list <- list(q_nhb_nd_est_did1,q_nhb_nd_est_did2,q_nhb_nd_est_did5,
                              q_nhb_nd_est_did10,q_nhb_nd_est_did11,q_nhb_nd_est_did12,
                              q_nhb_nd_est_did13,q_nhb_nd_est_did15,q_nhb_nd_est_did17,
                              q_nhb_nd_est_did19,q_nhb_nd_est_did21,q_nhb_nd_est_did23,
                              q_nhb_nd_est_did24,q_nhb_nd_est_did25,q_nhb_nd_est_did26,
                              q_nhb_nd_est_did28,q_nhb_nd_est_did29,q_nhb_nd_est_did30,
                              q_nhb_nd_est_did31,q_nhb_nd_est_did32,q_nhb_nd_est_did33,
                              q_nhb_nd_est_did34,q_nhb_nd_est_did36,q_nhb_nd_est_did37,
                              q_nhb_nd_est_did39,q_nhb_nd_est_did40,q_nhb_nd_est_did41,
                              q_nhb_nd_est_did44,q_nhb_nd_est_did45,q_nhb_nd_est_did47,
                              q_nhb_nd_est_did50,q_nhb_nd_est_did51,q_nhb_nd_est_did53,
                              q_nhb_nd_est_did54,q_nhb_nd_est_did55)
rm(q_nhb_nd_est_did1,q_nhb_nd_est_did2,q_nhb_nd_est_did5,
   q_nhb_nd_est_did10,q_nhb_nd_est_did11,q_nhb_nd_est_did12,
   q_nhb_nd_est_did13,q_nhb_nd_est_did15,q_nhb_nd_est_did17,
   q_nhb_nd_est_did19,q_nhb_nd_est_did21,q_nhb_nd_est_did23,
   q_nhb_nd_est_did24,q_nhb_nd_est_did25,q_nhb_nd_est_did26,
   q_nhb_nd_est_did28,q_nhb_nd_est_did29,q_nhb_nd_est_did30,
   q_nhb_nd_est_did31,q_nhb_nd_est_did32,q_nhb_nd_est_did33,
   q_nhb_nd_est_did34,q_nhb_nd_est_did36,q_nhb_nd_est_did37,
   q_nhb_nd_est_did39,q_nhb_nd_est_did40,q_nhb_nd_est_did41,
   q_nhb_nd_est_did44,q_nhb_nd_est_did45,q_nhb_nd_est_did47,
   q_nhb_nd_est_did50,q_nhb_nd_est_did51,q_nhb_nd_est_did53,
   q_nhb_nd_est_did54,q_nhb_nd_est_did55)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_did_plot", i), synthdid_plot(q_nhb_nd_est_did_list[i]))
}
q_nhb_nd_est_did_plot_data_aux1 <- ggplot_build(q_nhb_nd_est_did_plot1)
q_nhb_nd_est_did_plot_data_aux2 <- ggplot_build(q_nhb_nd_est_did_plot2)
q_nhb_nd_est_did_plot_data_aux3 <- ggplot_build(q_nhb_nd_est_did_plot3)
q_nhb_nd_est_did_plot_data_aux4 <- ggplot_build(q_nhb_nd_est_did_plot4)
q_nhb_nd_est_did_plot_data_aux5 <- ggplot_build(q_nhb_nd_est_did_plot5)
q_nhb_nd_est_did_plot_data_aux6 <- ggplot_build(q_nhb_nd_est_did_plot6)
q_nhb_nd_est_did_plot_data_aux7 <- ggplot_build(q_nhb_nd_est_did_plot7)
q_nhb_nd_est_did_plot_data_aux8 <- ggplot_build(q_nhb_nd_est_did_plot8)
q_nhb_nd_est_did_plot_data_aux9 <- ggplot_build(q_nhb_nd_est_did_plot9)
q_nhb_nd_est_did_plot_data_aux10 <- ggplot_build(q_nhb_nd_est_did_plot10)
q_nhb_nd_est_did_plot_data_aux11 <- ggplot_build(q_nhb_nd_est_did_plot11)
q_nhb_nd_est_did_plot_data_aux12 <- ggplot_build(q_nhb_nd_est_did_plot12)
q_nhb_nd_est_did_plot_data_aux13 <- ggplot_build(q_nhb_nd_est_did_plot13)
q_nhb_nd_est_did_plot_data_aux14 <- ggplot_build(q_nhb_nd_est_did_plot14)
q_nhb_nd_est_did_plot_data_aux15 <- ggplot_build(q_nhb_nd_est_did_plot15)
q_nhb_nd_est_did_plot_data_aux16 <- ggplot_build(q_nhb_nd_est_did_plot16)
q_nhb_nd_est_did_plot_data_aux17 <- ggplot_build(q_nhb_nd_est_did_plot17)
q_nhb_nd_est_did_plot_data_aux18 <- ggplot_build(q_nhb_nd_est_did_plot18)
q_nhb_nd_est_did_plot_data_aux19 <- ggplot_build(q_nhb_nd_est_did_plot19)
q_nhb_nd_est_did_plot_data_aux20 <- ggplot_build(q_nhb_nd_est_did_plot20)
q_nhb_nd_est_did_plot_data_aux21 <- ggplot_build(q_nhb_nd_est_did_plot21)
q_nhb_nd_est_did_plot_data_aux22 <- ggplot_build(q_nhb_nd_est_did_plot22)
q_nhb_nd_est_did_plot_data_aux23 <- ggplot_build(q_nhb_nd_est_did_plot23)
q_nhb_nd_est_did_plot_data_aux24 <- ggplot_build(q_nhb_nd_est_did_plot24)
q_nhb_nd_est_did_plot_data_aux25 <- ggplot_build(q_nhb_nd_est_did_plot25)
q_nhb_nd_est_did_plot_data_aux26 <- ggplot_build(q_nhb_nd_est_did_plot26)
q_nhb_nd_est_did_plot_data_aux27 <- ggplot_build(q_nhb_nd_est_did_plot27)
q_nhb_nd_est_did_plot_data_aux28 <- ggplot_build(q_nhb_nd_est_did_plot28)
q_nhb_nd_est_did_plot_data_aux29 <- ggplot_build(q_nhb_nd_est_did_plot29)
q_nhb_nd_est_did_plot_data_aux30 <- ggplot_build(q_nhb_nd_est_did_plot30)
q_nhb_nd_est_did_plot_data_aux31 <- ggplot_build(q_nhb_nd_est_did_plot31)
q_nhb_nd_est_did_plot_data_aux32 <- ggplot_build(q_nhb_nd_est_did_plot32)
q_nhb_nd_est_did_plot_data_aux33 <- ggplot_build(q_nhb_nd_est_did_plot33)
q_nhb_nd_est_did_plot_data_aux34 <- ggplot_build(q_nhb_nd_est_did_plot34)
q_nhb_nd_est_did_plot_data_aux35 <- ggplot_build(q_nhb_nd_est_did_plot35)
q_nhb_nd_est_did_plot_data_aux_list <- list(q_nhb_nd_est_did_plot_data_aux1,q_nhb_nd_est_did_plot_data_aux2,q_nhb_nd_est_did_plot_data_aux3,
                                            q_nhb_nd_est_did_plot_data_aux4,q_nhb_nd_est_did_plot_data_aux5,q_nhb_nd_est_did_plot_data_aux6,
                                            q_nhb_nd_est_did_plot_data_aux7,q_nhb_nd_est_did_plot_data_aux8,q_nhb_nd_est_did_plot_data_aux9,
                                            q_nhb_nd_est_did_plot_data_aux10,q_nhb_nd_est_did_plot_data_aux11,q_nhb_nd_est_did_plot_data_aux12,
                                            q_nhb_nd_est_did_plot_data_aux13,q_nhb_nd_est_did_plot_data_aux14,q_nhb_nd_est_did_plot_data_aux15,
                                            q_nhb_nd_est_did_plot_data_aux16,q_nhb_nd_est_did_plot_data_aux17,q_nhb_nd_est_did_plot_data_aux18,
                                            q_nhb_nd_est_did_plot_data_aux19,q_nhb_nd_est_did_plot_data_aux20,q_nhb_nd_est_did_plot_data_aux21,
                                            q_nhb_nd_est_did_plot_data_aux22,q_nhb_nd_est_did_plot_data_aux23,q_nhb_nd_est_did_plot_data_aux24,
                                            q_nhb_nd_est_did_plot_data_aux25,q_nhb_nd_est_did_plot_data_aux26,q_nhb_nd_est_did_plot_data_aux27,
                                            q_nhb_nd_est_did_plot_data_aux28,q_nhb_nd_est_did_plot_data_aux29,q_nhb_nd_est_did_plot_data_aux30,
                                            q_nhb_nd_est_did_plot_data_aux31,q_nhb_nd_est_did_plot_data_aux32,q_nhb_nd_est_did_plot_data_aux33,
                                            q_nhb_nd_est_did_plot_data_aux34,q_nhb_nd_est_did_plot_data_aux35)
rm(q_nhb_nd_est_did_plot_data_aux1,q_nhb_nd_est_did_plot_data_aux2,q_nhb_nd_est_did_plot_data_aux3,
   q_nhb_nd_est_did_plot_data_aux4,q_nhb_nd_est_did_plot_data_aux5,q_nhb_nd_est_did_plot_data_aux6,
   q_nhb_nd_est_did_plot_data_aux7,q_nhb_nd_est_did_plot_data_aux8,q_nhb_nd_est_did_plot_data_aux9,
   q_nhb_nd_est_did_plot_data_aux10,q_nhb_nd_est_did_plot_data_aux11,q_nhb_nd_est_did_plot_data_aux12,
   q_nhb_nd_est_did_plot_data_aux13,q_nhb_nd_est_did_plot_data_aux14,q_nhb_nd_est_did_plot_data_aux15,
   q_nhb_nd_est_did_plot_data_aux16,q_nhb_nd_est_did_plot_data_aux17,q_nhb_nd_est_did_plot_data_aux18,
   q_nhb_nd_est_did_plot_data_aux19,q_nhb_nd_est_did_plot_data_aux20,q_nhb_nd_est_did_plot_data_aux21,
   q_nhb_nd_est_did_plot_data_aux22,q_nhb_nd_est_did_plot_data_aux23,q_nhb_nd_est_did_plot_data_aux24,
   q_nhb_nd_est_did_plot_data_aux25,q_nhb_nd_est_did_plot_data_aux26,q_nhb_nd_est_did_plot_data_aux27,
   q_nhb_nd_est_did_plot_data_aux28,q_nhb_nd_est_did_plot_data_aux29,q_nhb_nd_est_did_plot_data_aux30,
   q_nhb_nd_est_did_plot_data_aux31,q_nhb_nd_est_did_plot_data_aux32,q_nhb_nd_est_did_plot_data_aux33,
   q_nhb_nd_est_did_plot_data_aux34,q_nhb_nd_est_did_plot_data_aux35)
rm(q_nhb_nd_est_did_plot1,q_nhb_nd_est_did_plot2,q_nhb_nd_est_did_plot3,
   q_nhb_nd_est_did_plot4,q_nhb_nd_est_did_plot5,q_nhb_nd_est_did_plot6,
   q_nhb_nd_est_did_plot7,q_nhb_nd_est_did_plot8,q_nhb_nd_est_did_plot9,
   q_nhb_nd_est_did_plot10,q_nhb_nd_est_did_plot11,q_nhb_nd_est_did_plot12,
   q_nhb_nd_est_did_plot13,q_nhb_nd_est_did_plot14,q_nhb_nd_est_did_plot15,
   q_nhb_nd_est_did_plot16,q_nhb_nd_est_did_plot17,q_nhb_nd_est_did_plot18,
   q_nhb_nd_est_did_plot19,q_nhb_nd_est_did_plot20,q_nhb_nd_est_did_plot21,
   q_nhb_nd_est_did_plot22,q_nhb_nd_est_did_plot23,q_nhb_nd_est_did_plot24,
   q_nhb_nd_est_did_plot25,q_nhb_nd_est_did_plot26,q_nhb_nd_est_did_plot27,
   q_nhb_nd_est_did_plot28,q_nhb_nd_est_did_plot29,q_nhb_nd_est_did_plot30,
   q_nhb_nd_est_did_plot31,q_nhb_nd_est_did_plot32,q_nhb_nd_est_did_plot33,
   q_nhb_nd_est_did_plot34,q_nhb_nd_est_did_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_did_plot_data_long", i), data.frame(q_nhb_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_nd_est_did_plot_data_long_list <- list(q_nhb_nd_est_did_plot_data_long1,q_nhb_nd_est_did_plot_data_long2,q_nhb_nd_est_did_plot_data_long3,
                                             q_nhb_nd_est_did_plot_data_long4,q_nhb_nd_est_did_plot_data_long5,q_nhb_nd_est_did_plot_data_long6,
                                             q_nhb_nd_est_did_plot_data_long7,q_nhb_nd_est_did_plot_data_long8,q_nhb_nd_est_did_plot_data_long9,
                                             q_nhb_nd_est_did_plot_data_long10,q_nhb_nd_est_did_plot_data_long11,q_nhb_nd_est_did_plot_data_long12,
                                             q_nhb_nd_est_did_plot_data_long13,q_nhb_nd_est_did_plot_data_long14,q_nhb_nd_est_did_plot_data_long15,
                                             q_nhb_nd_est_did_plot_data_long16,q_nhb_nd_est_did_plot_data_long17,q_nhb_nd_est_did_plot_data_long18,
                                             q_nhb_nd_est_did_plot_data_long19,q_nhb_nd_est_did_plot_data_long20,q_nhb_nd_est_did_plot_data_long21,
                                             q_nhb_nd_est_did_plot_data_long22,q_nhb_nd_est_did_plot_data_long23,q_nhb_nd_est_did_plot_data_long24,
                                             q_nhb_nd_est_did_plot_data_long25,q_nhb_nd_est_did_plot_data_long26,q_nhb_nd_est_did_plot_data_long27,
                                             q_nhb_nd_est_did_plot_data_long28,q_nhb_nd_est_did_plot_data_long29,q_nhb_nd_est_did_plot_data_long30,
                                             q_nhb_nd_est_did_plot_data_long31,q_nhb_nd_est_did_plot_data_long32,q_nhb_nd_est_did_plot_data_long33,
                                             q_nhb_nd_est_did_plot_data_long34,q_nhb_nd_est_did_plot_data_long35)
rm(q_nhb_nd_est_did_plot_data_long1,q_nhb_nd_est_did_plot_data_long2,q_nhb_nd_est_did_plot_data_long3,
   q_nhb_nd_est_did_plot_data_long4,q_nhb_nd_est_did_plot_data_long5,q_nhb_nd_est_did_plot_data_long6,
   q_nhb_nd_est_did_plot_data_long7,q_nhb_nd_est_did_plot_data_long8,q_nhb_nd_est_did_plot_data_long9,
   q_nhb_nd_est_did_plot_data_long10,q_nhb_nd_est_did_plot_data_long11,q_nhb_nd_est_did_plot_data_long12,
   q_nhb_nd_est_did_plot_data_long13,q_nhb_nd_est_did_plot_data_long14,q_nhb_nd_est_did_plot_data_long15,
   q_nhb_nd_est_did_plot_data_long16,q_nhb_nd_est_did_plot_data_long17,q_nhb_nd_est_did_plot_data_long18,
   q_nhb_nd_est_did_plot_data_long19,q_nhb_nd_est_did_plot_data_long20,q_nhb_nd_est_did_plot_data_long21,
   q_nhb_nd_est_did_plot_data_long22,q_nhb_nd_est_did_plot_data_long23,q_nhb_nd_est_did_plot_data_long24,
   q_nhb_nd_est_did_plot_data_long25,q_nhb_nd_est_did_plot_data_long26,q_nhb_nd_est_did_plot_data_long27,
   q_nhb_nd_est_did_plot_data_long28,q_nhb_nd_est_did_plot_data_long29,q_nhb_nd_est_did_plot_data_long30,
   q_nhb_nd_est_did_plot_data_long31,q_nhb_nd_est_did_plot_data_long32,q_nhb_nd_est_did_plot_data_long33,
   q_nhb_nd_est_did_plot_data_long34,q_nhb_nd_est_did_plot_data_long35)
q_nhb_nd_est_did_plot_data_long_list <- lapply(q_nhb_nd_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_did_plot_data_wide", i), reshape(data=q_nhb_nd_est_did_plot_data_long_list[[i]],
                                                               idvar = "year",
                                                               v.names = "outcome",
                                                               timevar = "treated",
                                                               direction = "wide"))
}
q_nhb_nd_est_did_plot_data_wide_list <- list(q_nhb_nd_est_did_plot_data_wide1,q_nhb_nd_est_did_plot_data_wide2,q_nhb_nd_est_did_plot_data_wide3,
                                             q_nhb_nd_est_did_plot_data_wide4,q_nhb_nd_est_did_plot_data_wide5,q_nhb_nd_est_did_plot_data_wide6,
                                             q_nhb_nd_est_did_plot_data_wide7,q_nhb_nd_est_did_plot_data_wide8,q_nhb_nd_est_did_plot_data_wide9,
                                             q_nhb_nd_est_did_plot_data_wide10,q_nhb_nd_est_did_plot_data_wide11,q_nhb_nd_est_did_plot_data_wide12,
                                             q_nhb_nd_est_did_plot_data_wide13,q_nhb_nd_est_did_plot_data_wide14,q_nhb_nd_est_did_plot_data_wide15,
                                             q_nhb_nd_est_did_plot_data_wide16,q_nhb_nd_est_did_plot_data_wide17,q_nhb_nd_est_did_plot_data_wide18,
                                             q_nhb_nd_est_did_plot_data_wide19,q_nhb_nd_est_did_plot_data_wide20,q_nhb_nd_est_did_plot_data_wide21,
                                             q_nhb_nd_est_did_plot_data_wide22,q_nhb_nd_est_did_plot_data_wide23,q_nhb_nd_est_did_plot_data_wide24,
                                             q_nhb_nd_est_did_plot_data_wide25,q_nhb_nd_est_did_plot_data_wide26,q_nhb_nd_est_did_plot_data_wide27,
                                             q_nhb_nd_est_did_plot_data_wide28,q_nhb_nd_est_did_plot_data_wide29,q_nhb_nd_est_did_plot_data_wide30,
                                             q_nhb_nd_est_did_plot_data_wide31,q_nhb_nd_est_did_plot_data_wide32,q_nhb_nd_est_did_plot_data_wide33,
                                             q_nhb_nd_est_did_plot_data_wide34,q_nhb_nd_est_did_plot_data_wide35)
rm(q_nhb_nd_est_did_plot_data_wide1,q_nhb_nd_est_did_plot_data_wide2,q_nhb_nd_est_did_plot_data_wide3,
   q_nhb_nd_est_did_plot_data_wide4,q_nhb_nd_est_did_plot_data_wide5,q_nhb_nd_est_did_plot_data_wide6,
   q_nhb_nd_est_did_plot_data_wide7,q_nhb_nd_est_did_plot_data_wide8,q_nhb_nd_est_did_plot_data_wide9,
   q_nhb_nd_est_did_plot_data_wide10,q_nhb_nd_est_did_plot_data_wide11,q_nhb_nd_est_did_plot_data_wide12,
   q_nhb_nd_est_did_plot_data_wide13,q_nhb_nd_est_did_plot_data_wide14,q_nhb_nd_est_did_plot_data_wide15,
   q_nhb_nd_est_did_plot_data_wide16,q_nhb_nd_est_did_plot_data_wide17,q_nhb_nd_est_did_plot_data_wide18,
   q_nhb_nd_est_did_plot_data_wide19,q_nhb_nd_est_did_plot_data_wide20,q_nhb_nd_est_did_plot_data_wide21,
   q_nhb_nd_est_did_plot_data_wide22,q_nhb_nd_est_did_plot_data_wide23,q_nhb_nd_est_did_plot_data_wide24,
   q_nhb_nd_est_did_plot_data_wide25,q_nhb_nd_est_did_plot_data_wide26,q_nhb_nd_est_did_plot_data_wide27,
   q_nhb_nd_est_did_plot_data_wide28,q_nhb_nd_est_did_plot_data_wide29,q_nhb_nd_est_did_plot_data_wide30,
   q_nhb_nd_est_did_plot_data_wide31,q_nhb_nd_est_did_plot_data_wide32,q_nhb_nd_est_did_plot_data_wide33,
   q_nhb_nd_est_did_plot_data_wide34,q_nhb_nd_est_did_plot_data_wide35)
q_nhb_nd_est_did_plot_data_wide_list <- lapply(q_nhb_nd_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
q_nhb_nd_est_sc1 <- sc_estimate(setup_q_nhb_nd_list[[1]]$Y, setup_q_nhb_nd_list[[1]]$N0, setup_q_nhb_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_nd_est_sc2 <- sc_estimate(setup_q_nhb_nd_list[[2]]$Y, setup_q_nhb_nd_list[[2]]$N0, setup_q_nhb_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_nd_est_sc5 <- sc_estimate(setup_q_nhb_nd_list[[3]]$Y, setup_q_nhb_nd_list[[3]]$N0, setup_q_nhb_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_nd_est_sc10 <- sc_estimate(setup_q_nhb_nd_list[[4]]$Y, setup_q_nhb_nd_list[[4]]$N0, setup_q_nhb_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_nd_est_sc11 <- sc_estimate(setup_q_nhb_nd_list[[5]]$Y, setup_q_nhb_nd_list[[5]]$N0, setup_q_nhb_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_nd_est_sc12 <- sc_estimate(setup_q_nhb_nd_list[[6]]$Y, setup_q_nhb_nd_list[[6]]$N0, setup_q_nhb_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_nd_est_sc13 <- sc_estimate(setup_q_nhb_nd_list[[7]]$Y, setup_q_nhb_nd_list[[7]]$N0, setup_q_nhb_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_nd_est_sc15 <- sc_estimate(setup_q_nhb_nd_list[[8]]$Y, setup_q_nhb_nd_list[[8]]$N0, setup_q_nhb_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_nd_est_sc17 <- sc_estimate(setup_q_nhb_nd_list[[9]]$Y, setup_q_nhb_nd_list[[9]]$N0, setup_q_nhb_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_nd_est_sc19 <- sc_estimate(setup_q_nhb_nd_list[[10]]$Y, setup_q_nhb_nd_list[[10]]$N0, setup_q_nhb_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_nd_est_sc21 <- sc_estimate(setup_q_nhb_nd_list[[11]]$Y, setup_q_nhb_nd_list[[11]]$N0, setup_q_nhb_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_nd_est_sc23 <- sc_estimate(setup_q_nhb_nd_list[[12]]$Y, setup_q_nhb_nd_list[[12]]$N0, setup_q_nhb_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_nd_est_sc24 <- sc_estimate(setup_q_nhb_nd_list[[13]]$Y, setup_q_nhb_nd_list[[13]]$N0, setup_q_nhb_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_nd_est_sc25 <- sc_estimate(setup_q_nhb_nd_list[[14]]$Y, setup_q_nhb_nd_list[[14]]$N0, setup_q_nhb_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_nd_est_sc26 <- sc_estimate(setup_q_nhb_nd_list[[15]]$Y, setup_q_nhb_nd_list[[15]]$N0, setup_q_nhb_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_nd_est_sc28 <- sc_estimate(setup_q_nhb_nd_list[[16]]$Y, setup_q_nhb_nd_list[[16]]$N0, setup_q_nhb_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_nd_est_sc29 <- sc_estimate(setup_q_nhb_nd_list[[17]]$Y, setup_q_nhb_nd_list[[17]]$N0, setup_q_nhb_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_nd_est_sc30 <- sc_estimate(setup_q_nhb_nd_list[[18]]$Y, setup_q_nhb_nd_list[[18]]$N0, setup_q_nhb_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_nd_est_sc31 <- sc_estimate(setup_q_nhb_nd_list[[19]]$Y, setup_q_nhb_nd_list[[19]]$N0, setup_q_nhb_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_nd_est_sc32 <- sc_estimate(setup_q_nhb_nd_list[[20]]$Y, setup_q_nhb_nd_list[[20]]$N0, setup_q_nhb_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_nd_est_sc33 <- sc_estimate(setup_q_nhb_nd_list[[21]]$Y, setup_q_nhb_nd_list[[21]]$N0, setup_q_nhb_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_nd_est_sc34 <- sc_estimate(setup_q_nhb_nd_list[[22]]$Y, setup_q_nhb_nd_list[[22]]$N0, setup_q_nhb_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_nd_est_sc36 <- sc_estimate(setup_q_nhb_nd_list[[23]]$Y, setup_q_nhb_nd_list[[23]]$N0, setup_q_nhb_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_nd_est_sc37 <- sc_estimate(setup_q_nhb_nd_list[[24]]$Y, setup_q_nhb_nd_list[[24]]$N0, setup_q_nhb_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_nd_est_sc39 <- sc_estimate(setup_q_nhb_nd_list[[25]]$Y, setup_q_nhb_nd_list[[25]]$N0, setup_q_nhb_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_nd_est_sc40 <- sc_estimate(setup_q_nhb_nd_list[[26]]$Y, setup_q_nhb_nd_list[[26]]$N0, setup_q_nhb_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_nd_est_sc41 <- sc_estimate(setup_q_nhb_nd_list[[27]]$Y, setup_q_nhb_nd_list[[27]]$N0, setup_q_nhb_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_nd_est_sc44 <- sc_estimate(setup_q_nhb_nd_list[[28]]$Y, setup_q_nhb_nd_list[[28]]$N0, setup_q_nhb_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_nd_est_sc45 <- sc_estimate(setup_q_nhb_nd_list[[29]]$Y, setup_q_nhb_nd_list[[29]]$N0, setup_q_nhb_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_nd_est_sc47 <- sc_estimate(setup_q_nhb_nd_list[[30]]$Y, setup_q_nhb_nd_list[[30]]$N0, setup_q_nhb_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_nd_est_sc50 <- sc_estimate(setup_q_nhb_nd_list[[31]]$Y, setup_q_nhb_nd_list[[31]]$N0, setup_q_nhb_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_nd_est_sc51 <- sc_estimate(setup_q_nhb_nd_list[[32]]$Y, setup_q_nhb_nd_list[[32]]$N0, setup_q_nhb_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_nd_est_sc53 <- sc_estimate(setup_q_nhb_nd_list[[33]]$Y, setup_q_nhb_nd_list[[33]]$N0, setup_q_nhb_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_nd_est_sc54 <- sc_estimate(setup_q_nhb_nd_list[[34]]$Y, setup_q_nhb_nd_list[[34]]$N0, setup_q_nhb_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_nd_est_sc55 <- sc_estimate(setup_q_nhb_nd_list[[35]]$Y, setup_q_nhb_nd_list[[35]]$N0, setup_q_nhb_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_nd_est_sc_list <- list(q_nhb_nd_est_sc1,q_nhb_nd_est_sc2,q_nhb_nd_est_sc5,
                             q_nhb_nd_est_sc10,q_nhb_nd_est_sc11,q_nhb_nd_est_sc12,
                             q_nhb_nd_est_sc13,q_nhb_nd_est_sc15,q_nhb_nd_est_sc17,
                             q_nhb_nd_est_sc19,q_nhb_nd_est_sc21,q_nhb_nd_est_sc23,
                             q_nhb_nd_est_sc24,q_nhb_nd_est_sc25,q_nhb_nd_est_sc26,
                             q_nhb_nd_est_sc28,q_nhb_nd_est_sc29,q_nhb_nd_est_sc30,
                             q_nhb_nd_est_sc31,q_nhb_nd_est_sc32,q_nhb_nd_est_sc33,
                             q_nhb_nd_est_sc34,q_nhb_nd_est_sc36,q_nhb_nd_est_sc37,
                             q_nhb_nd_est_sc39,q_nhb_nd_est_sc40,q_nhb_nd_est_sc41,
                             q_nhb_nd_est_sc44,q_nhb_nd_est_sc45,q_nhb_nd_est_sc47,
                             q_nhb_nd_est_sc50,q_nhb_nd_est_sc51,q_nhb_nd_est_sc53,
                             q_nhb_nd_est_sc54,q_nhb_nd_est_sc55)
rm(q_nhb_nd_est_sc1,q_nhb_nd_est_sc2,q_nhb_nd_est_sc5,
   q_nhb_nd_est_sc10,q_nhb_nd_est_sc11,q_nhb_nd_est_sc12,
   q_nhb_nd_est_sc13,q_nhb_nd_est_sc15,q_nhb_nd_est_sc17,
   q_nhb_nd_est_sc19,q_nhb_nd_est_sc21,q_nhb_nd_est_sc23,
   q_nhb_nd_est_sc24,q_nhb_nd_est_sc25,q_nhb_nd_est_sc26,
   q_nhb_nd_est_sc28,q_nhb_nd_est_sc29,q_nhb_nd_est_sc30,
   q_nhb_nd_est_sc31,q_nhb_nd_est_sc32,q_nhb_nd_est_sc33,
   q_nhb_nd_est_sc34,q_nhb_nd_est_sc36,q_nhb_nd_est_sc37,
   q_nhb_nd_est_sc39,q_nhb_nd_est_sc40,q_nhb_nd_est_sc41,
   q_nhb_nd_est_sc44,q_nhb_nd_est_sc45,q_nhb_nd_est_sc47,
   q_nhb_nd_est_sc50,q_nhb_nd_est_sc51,q_nhb_nd_est_sc53,
   q_nhb_nd_est_sc54,q_nhb_nd_est_sc55)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sc_plot", i), synthdid_plot(q_nhb_nd_est_sc_list[i]))
}
q_nhb_nd_est_sc_plot_data_aux1 <- ggplot_build(q_nhb_nd_est_sc_plot1)
q_nhb_nd_est_sc_plot_data_aux2 <- ggplot_build(q_nhb_nd_est_sc_plot2)
q_nhb_nd_est_sc_plot_data_aux3 <- ggplot_build(q_nhb_nd_est_sc_plot3)
q_nhb_nd_est_sc_plot_data_aux4 <- ggplot_build(q_nhb_nd_est_sc_plot4)
q_nhb_nd_est_sc_plot_data_aux5 <- ggplot_build(q_nhb_nd_est_sc_plot5)
q_nhb_nd_est_sc_plot_data_aux6 <- ggplot_build(q_nhb_nd_est_sc_plot6)
q_nhb_nd_est_sc_plot_data_aux7 <- ggplot_build(q_nhb_nd_est_sc_plot7)
q_nhb_nd_est_sc_plot_data_aux8 <- ggplot_build(q_nhb_nd_est_sc_plot8)
q_nhb_nd_est_sc_plot_data_aux9 <- ggplot_build(q_nhb_nd_est_sc_plot9)
q_nhb_nd_est_sc_plot_data_aux10 <- ggplot_build(q_nhb_nd_est_sc_plot10)
q_nhb_nd_est_sc_plot_data_aux11 <- ggplot_build(q_nhb_nd_est_sc_plot11)
q_nhb_nd_est_sc_plot_data_aux12 <- ggplot_build(q_nhb_nd_est_sc_plot12)
q_nhb_nd_est_sc_plot_data_aux13 <- ggplot_build(q_nhb_nd_est_sc_plot13)
q_nhb_nd_est_sc_plot_data_aux14 <- ggplot_build(q_nhb_nd_est_sc_plot14)
q_nhb_nd_est_sc_plot_data_aux15 <- ggplot_build(q_nhb_nd_est_sc_plot15)
q_nhb_nd_est_sc_plot_data_aux16 <- ggplot_build(q_nhb_nd_est_sc_plot16)
q_nhb_nd_est_sc_plot_data_aux17 <- ggplot_build(q_nhb_nd_est_sc_plot17)
q_nhb_nd_est_sc_plot_data_aux18 <- ggplot_build(q_nhb_nd_est_sc_plot18)
q_nhb_nd_est_sc_plot_data_aux19 <- ggplot_build(q_nhb_nd_est_sc_plot19)
q_nhb_nd_est_sc_plot_data_aux20 <- ggplot_build(q_nhb_nd_est_sc_plot20)
q_nhb_nd_est_sc_plot_data_aux21 <- ggplot_build(q_nhb_nd_est_sc_plot21)
q_nhb_nd_est_sc_plot_data_aux22 <- ggplot_build(q_nhb_nd_est_sc_plot22)
q_nhb_nd_est_sc_plot_data_aux23 <- ggplot_build(q_nhb_nd_est_sc_plot23)
q_nhb_nd_est_sc_plot_data_aux24 <- ggplot_build(q_nhb_nd_est_sc_plot24)
q_nhb_nd_est_sc_plot_data_aux25 <- ggplot_build(q_nhb_nd_est_sc_plot25)
q_nhb_nd_est_sc_plot_data_aux26 <- ggplot_build(q_nhb_nd_est_sc_plot26)
q_nhb_nd_est_sc_plot_data_aux27 <- ggplot_build(q_nhb_nd_est_sc_plot27)
q_nhb_nd_est_sc_plot_data_aux28 <- ggplot_build(q_nhb_nd_est_sc_plot28)
q_nhb_nd_est_sc_plot_data_aux29 <- ggplot_build(q_nhb_nd_est_sc_plot29)
q_nhb_nd_est_sc_plot_data_aux30 <- ggplot_build(q_nhb_nd_est_sc_plot30)
q_nhb_nd_est_sc_plot_data_aux31 <- ggplot_build(q_nhb_nd_est_sc_plot31)
q_nhb_nd_est_sc_plot_data_aux32 <- ggplot_build(q_nhb_nd_est_sc_plot32)
q_nhb_nd_est_sc_plot_data_aux33 <- ggplot_build(q_nhb_nd_est_sc_plot33)
q_nhb_nd_est_sc_plot_data_aux34 <- ggplot_build(q_nhb_nd_est_sc_plot34)
q_nhb_nd_est_sc_plot_data_aux35 <- ggplot_build(q_nhb_nd_est_sc_plot35)
q_nhb_nd_est_sc_plot_data_aux_list <- list(q_nhb_nd_est_sc_plot_data_aux1,q_nhb_nd_est_sc_plot_data_aux2,q_nhb_nd_est_sc_plot_data_aux3,
                                           q_nhb_nd_est_sc_plot_data_aux4,q_nhb_nd_est_sc_plot_data_aux5,q_nhb_nd_est_sc_plot_data_aux6,
                                           q_nhb_nd_est_sc_plot_data_aux7,q_nhb_nd_est_sc_plot_data_aux8,q_nhb_nd_est_sc_plot_data_aux9,
                                           q_nhb_nd_est_sc_plot_data_aux10,q_nhb_nd_est_sc_plot_data_aux11,q_nhb_nd_est_sc_plot_data_aux12,
                                           q_nhb_nd_est_sc_plot_data_aux13,q_nhb_nd_est_sc_plot_data_aux14,q_nhb_nd_est_sc_plot_data_aux15,
                                           q_nhb_nd_est_sc_plot_data_aux16,q_nhb_nd_est_sc_plot_data_aux17,q_nhb_nd_est_sc_plot_data_aux18,
                                           q_nhb_nd_est_sc_plot_data_aux19,q_nhb_nd_est_sc_plot_data_aux20,q_nhb_nd_est_sc_plot_data_aux21,
                                           q_nhb_nd_est_sc_plot_data_aux22,q_nhb_nd_est_sc_plot_data_aux23,q_nhb_nd_est_sc_plot_data_aux24,
                                           q_nhb_nd_est_sc_plot_data_aux25,q_nhb_nd_est_sc_plot_data_aux26,q_nhb_nd_est_sc_plot_data_aux27,
                                           q_nhb_nd_est_sc_plot_data_aux28,q_nhb_nd_est_sc_plot_data_aux29,q_nhb_nd_est_sc_plot_data_aux30,
                                           q_nhb_nd_est_sc_plot_data_aux31,q_nhb_nd_est_sc_plot_data_aux32,q_nhb_nd_est_sc_plot_data_aux33,
                                           q_nhb_nd_est_sc_plot_data_aux34,q_nhb_nd_est_sc_plot_data_aux35)
rm(q_nhb_nd_est_sc_plot_data_aux1,q_nhb_nd_est_sc_plot_data_aux2,q_nhb_nd_est_sc_plot_data_aux3,
   q_nhb_nd_est_sc_plot_data_aux4,q_nhb_nd_est_sc_plot_data_aux5,q_nhb_nd_est_sc_plot_data_aux6,
   q_nhb_nd_est_sc_plot_data_aux7,q_nhb_nd_est_sc_plot_data_aux8,q_nhb_nd_est_sc_plot_data_aux9,
   q_nhb_nd_est_sc_plot_data_aux10,q_nhb_nd_est_sc_plot_data_aux11,q_nhb_nd_est_sc_plot_data_aux12,
   q_nhb_nd_est_sc_plot_data_aux13,q_nhb_nd_est_sc_plot_data_aux14,q_nhb_nd_est_sc_plot_data_aux15,
   q_nhb_nd_est_sc_plot_data_aux16,q_nhb_nd_est_sc_plot_data_aux17,q_nhb_nd_est_sc_plot_data_aux18,
   q_nhb_nd_est_sc_plot_data_aux19,q_nhb_nd_est_sc_plot_data_aux20,q_nhb_nd_est_sc_plot_data_aux21,
   q_nhb_nd_est_sc_plot_data_aux22,q_nhb_nd_est_sc_plot_data_aux23,q_nhb_nd_est_sc_plot_data_aux24,
   q_nhb_nd_est_sc_plot_data_aux25,q_nhb_nd_est_sc_plot_data_aux26,q_nhb_nd_est_sc_plot_data_aux27,
   q_nhb_nd_est_sc_plot_data_aux28,q_nhb_nd_est_sc_plot_data_aux29,q_nhb_nd_est_sc_plot_data_aux30,
   q_nhb_nd_est_sc_plot_data_aux31,q_nhb_nd_est_sc_plot_data_aux32,q_nhb_nd_est_sc_plot_data_aux33,
   q_nhb_nd_est_sc_plot_data_aux34,q_nhb_nd_est_sc_plot_data_aux35)
rm(q_nhb_nd_est_sc_plot1,q_nhb_nd_est_sc_plot2,q_nhb_nd_est_sc_plot3,
   q_nhb_nd_est_sc_plot4,q_nhb_nd_est_sc_plot5,q_nhb_nd_est_sc_plot6,
   q_nhb_nd_est_sc_plot7,q_nhb_nd_est_sc_plot8,q_nhb_nd_est_sc_plot9,
   q_nhb_nd_est_sc_plot10,q_nhb_nd_est_sc_plot11,q_nhb_nd_est_sc_plot12,
   q_nhb_nd_est_sc_plot13,q_nhb_nd_est_sc_plot14,q_nhb_nd_est_sc_plot15,
   q_nhb_nd_est_sc_plot16,q_nhb_nd_est_sc_plot17,q_nhb_nd_est_sc_plot18,
   q_nhb_nd_est_sc_plot19,q_nhb_nd_est_sc_plot20,q_nhb_nd_est_sc_plot21,
   q_nhb_nd_est_sc_plot22,q_nhb_nd_est_sc_plot23,q_nhb_nd_est_sc_plot24,
   q_nhb_nd_est_sc_plot25,q_nhb_nd_est_sc_plot26,q_nhb_nd_est_sc_plot27,
   q_nhb_nd_est_sc_plot28,q_nhb_nd_est_sc_plot29,q_nhb_nd_est_sc_plot30,
   q_nhb_nd_est_sc_plot31,q_nhb_nd_est_sc_plot32,q_nhb_nd_est_sc_plot33,
   q_nhb_nd_est_sc_plot34,q_nhb_nd_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sc_plot_data_long", i), data.frame(q_nhb_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_nd_est_sc_plot_data_long_list <- list(q_nhb_nd_est_sc_plot_data_long1,q_nhb_nd_est_sc_plot_data_long2,q_nhb_nd_est_sc_plot_data_long3,
                                            q_nhb_nd_est_sc_plot_data_long4,q_nhb_nd_est_sc_plot_data_long5,q_nhb_nd_est_sc_plot_data_long6,
                                            q_nhb_nd_est_sc_plot_data_long7,q_nhb_nd_est_sc_plot_data_long8,q_nhb_nd_est_sc_plot_data_long9,
                                            q_nhb_nd_est_sc_plot_data_long10,q_nhb_nd_est_sc_plot_data_long11,q_nhb_nd_est_sc_plot_data_long12,
                                            q_nhb_nd_est_sc_plot_data_long13,q_nhb_nd_est_sc_plot_data_long14,q_nhb_nd_est_sc_plot_data_long15,
                                            q_nhb_nd_est_sc_plot_data_long16,q_nhb_nd_est_sc_plot_data_long17,q_nhb_nd_est_sc_plot_data_long18,
                                            q_nhb_nd_est_sc_plot_data_long19,q_nhb_nd_est_sc_plot_data_long20,q_nhb_nd_est_sc_plot_data_long21,
                                            q_nhb_nd_est_sc_plot_data_long22,q_nhb_nd_est_sc_plot_data_long23,q_nhb_nd_est_sc_plot_data_long24,
                                            q_nhb_nd_est_sc_plot_data_long25,q_nhb_nd_est_sc_plot_data_long26,q_nhb_nd_est_sc_plot_data_long27,
                                            q_nhb_nd_est_sc_plot_data_long28,q_nhb_nd_est_sc_plot_data_long29,q_nhb_nd_est_sc_plot_data_long30,
                                            q_nhb_nd_est_sc_plot_data_long31,q_nhb_nd_est_sc_plot_data_long32,q_nhb_nd_est_sc_plot_data_long33,
                                            q_nhb_nd_est_sc_plot_data_long34,q_nhb_nd_est_sc_plot_data_long35)
rm(q_nhb_nd_est_sc_plot_data_long1,q_nhb_nd_est_sc_plot_data_long2,q_nhb_nd_est_sc_plot_data_long3,
   q_nhb_nd_est_sc_plot_data_long4,q_nhb_nd_est_sc_plot_data_long5,q_nhb_nd_est_sc_plot_data_long6,
   q_nhb_nd_est_sc_plot_data_long7,q_nhb_nd_est_sc_plot_data_long8,q_nhb_nd_est_sc_plot_data_long9,
   q_nhb_nd_est_sc_plot_data_long10,q_nhb_nd_est_sc_plot_data_long11,q_nhb_nd_est_sc_plot_data_long12,
   q_nhb_nd_est_sc_plot_data_long13,q_nhb_nd_est_sc_plot_data_long14,q_nhb_nd_est_sc_plot_data_long15,
   q_nhb_nd_est_sc_plot_data_long16,q_nhb_nd_est_sc_plot_data_long17,q_nhb_nd_est_sc_plot_data_long18,
   q_nhb_nd_est_sc_plot_data_long19,q_nhb_nd_est_sc_plot_data_long20,q_nhb_nd_est_sc_plot_data_long21,
   q_nhb_nd_est_sc_plot_data_long22,q_nhb_nd_est_sc_plot_data_long23,q_nhb_nd_est_sc_plot_data_long24,
   q_nhb_nd_est_sc_plot_data_long25,q_nhb_nd_est_sc_plot_data_long26,q_nhb_nd_est_sc_plot_data_long27,
   q_nhb_nd_est_sc_plot_data_long28,q_nhb_nd_est_sc_plot_data_long29,q_nhb_nd_est_sc_plot_data_long30,
   q_nhb_nd_est_sc_plot_data_long31,q_nhb_nd_est_sc_plot_data_long32,q_nhb_nd_est_sc_plot_data_long33,
   q_nhb_nd_est_sc_plot_data_long34,q_nhb_nd_est_sc_plot_data_long35)
q_nhb_nd_est_sc_plot_data_long_list <- lapply(q_nhb_nd_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sc_plot_data_wide", i), reshape(data=q_nhb_nd_est_sc_plot_data_long_list[[i]],
                                                              idvar = "year",
                                                              v.names = "outcome",
                                                              timevar = "treated",
                                                              direction = "wide"))
}
q_nhb_nd_est_sc_plot_data_wide_list <- list(q_nhb_nd_est_sc_plot_data_wide1,q_nhb_nd_est_sc_plot_data_wide2,q_nhb_nd_est_sc_plot_data_wide3,
                                            q_nhb_nd_est_sc_plot_data_wide4,q_nhb_nd_est_sc_plot_data_wide5,q_nhb_nd_est_sc_plot_data_wide6,
                                            q_nhb_nd_est_sc_plot_data_wide7,q_nhb_nd_est_sc_plot_data_wide8,q_nhb_nd_est_sc_plot_data_wide9,
                                            q_nhb_nd_est_sc_plot_data_wide10,q_nhb_nd_est_sc_plot_data_wide11,q_nhb_nd_est_sc_plot_data_wide12,
                                            q_nhb_nd_est_sc_plot_data_wide13,q_nhb_nd_est_sc_plot_data_wide14,q_nhb_nd_est_sc_plot_data_wide15,
                                            q_nhb_nd_est_sc_plot_data_wide16,q_nhb_nd_est_sc_plot_data_wide17,q_nhb_nd_est_sc_plot_data_wide18,
                                            q_nhb_nd_est_sc_plot_data_wide19,q_nhb_nd_est_sc_plot_data_wide20,q_nhb_nd_est_sc_plot_data_wide21,
                                            q_nhb_nd_est_sc_plot_data_wide22,q_nhb_nd_est_sc_plot_data_wide23,q_nhb_nd_est_sc_plot_data_wide24,
                                            q_nhb_nd_est_sc_plot_data_wide25,q_nhb_nd_est_sc_plot_data_wide26,q_nhb_nd_est_sc_plot_data_wide27,
                                            q_nhb_nd_est_sc_plot_data_wide28,q_nhb_nd_est_sc_plot_data_wide29,q_nhb_nd_est_sc_plot_data_wide30,
                                            q_nhb_nd_est_sc_plot_data_wide31,q_nhb_nd_est_sc_plot_data_wide32,q_nhb_nd_est_sc_plot_data_wide33,
                                            q_nhb_nd_est_sc_plot_data_wide34,q_nhb_nd_est_sc_plot_data_wide35)
rm(q_nhb_nd_est_sc_plot_data_wide1,q_nhb_nd_est_sc_plot_data_wide2,q_nhb_nd_est_sc_plot_data_wide3,
   q_nhb_nd_est_sc_plot_data_wide4,q_nhb_nd_est_sc_plot_data_wide5,q_nhb_nd_est_sc_plot_data_wide6,
   q_nhb_nd_est_sc_plot_data_wide7,q_nhb_nd_est_sc_plot_data_wide8,q_nhb_nd_est_sc_plot_data_wide9,
   q_nhb_nd_est_sc_plot_data_wide10,q_nhb_nd_est_sc_plot_data_wide11,q_nhb_nd_est_sc_plot_data_wide12,
   q_nhb_nd_est_sc_plot_data_wide13,q_nhb_nd_est_sc_plot_data_wide14,q_nhb_nd_est_sc_plot_data_wide15,
   q_nhb_nd_est_sc_plot_data_wide16,q_nhb_nd_est_sc_plot_data_wide17,q_nhb_nd_est_sc_plot_data_wide18,
   q_nhb_nd_est_sc_plot_data_wide19,q_nhb_nd_est_sc_plot_data_wide20,q_nhb_nd_est_sc_plot_data_wide21,
   q_nhb_nd_est_sc_plot_data_wide22,q_nhb_nd_est_sc_plot_data_wide23,q_nhb_nd_est_sc_plot_data_wide24,
   q_nhb_nd_est_sc_plot_data_wide25,q_nhb_nd_est_sc_plot_data_wide26,q_nhb_nd_est_sc_plot_data_wide27,
   q_nhb_nd_est_sc_plot_data_wide28,q_nhb_nd_est_sc_plot_data_wide29,q_nhb_nd_est_sc_plot_data_wide30,
   q_nhb_nd_est_sc_plot_data_wide31,q_nhb_nd_est_sc_plot_data_wide32,q_nhb_nd_est_sc_plot_data_wide33,
   q_nhb_nd_est_sc_plot_data_wide34,q_nhb_nd_est_sc_plot_data_wide35)
q_nhb_nd_est_sc_plot_data_wide_list <- lapply(q_nhb_nd_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
q_nhb_nd_est_sdid1 <- synthdid_estimate(setup_q_nhb_nd_list[[1]]$Y, setup_q_nhb_nd_list[[1]]$N0, setup_q_nhb_nd_list[[1]]$T0, X = covariates_acc_array_1)
q_nhb_nd_est_sdid2 <- synthdid_estimate(setup_q_nhb_nd_list[[2]]$Y, setup_q_nhb_nd_list[[2]]$N0, setup_q_nhb_nd_list[[2]]$T0, X = covariates_acc_array_2)
q_nhb_nd_est_sdid5 <- synthdid_estimate(setup_q_nhb_nd_list[[3]]$Y, setup_q_nhb_nd_list[[3]]$N0, setup_q_nhb_nd_list[[3]]$T0, X = covariates_acc_array_5)
q_nhb_nd_est_sdid10 <- synthdid_estimate(setup_q_nhb_nd_list[[4]]$Y, setup_q_nhb_nd_list[[4]]$N0, setup_q_nhb_nd_list[[4]]$T0, X = covariates_acc_array_10)
q_nhb_nd_est_sdid11 <- synthdid_estimate(setup_q_nhb_nd_list[[5]]$Y, setup_q_nhb_nd_list[[5]]$N0, setup_q_nhb_nd_list[[5]]$T0, X = covariates_acc_array_11)
q_nhb_nd_est_sdid12 <- synthdid_estimate(setup_q_nhb_nd_list[[6]]$Y, setup_q_nhb_nd_list[[6]]$N0, setup_q_nhb_nd_list[[6]]$T0, X = covariates_acc_array_12)
q_nhb_nd_est_sdid13 <- synthdid_estimate(setup_q_nhb_nd_list[[7]]$Y, setup_q_nhb_nd_list[[7]]$N0, setup_q_nhb_nd_list[[7]]$T0, X = covariates_acc_array_13)
q_nhb_nd_est_sdid15 <- synthdid_estimate(setup_q_nhb_nd_list[[8]]$Y, setup_q_nhb_nd_list[[8]]$N0, setup_q_nhb_nd_list[[8]]$T0, X = covariates_acc_array_15)
q_nhb_nd_est_sdid17 <- synthdid_estimate(setup_q_nhb_nd_list[[9]]$Y, setup_q_nhb_nd_list[[9]]$N0, setup_q_nhb_nd_list[[9]]$T0, X = covariates_acc_array_17)
q_nhb_nd_est_sdid19 <- synthdid_estimate(setup_q_nhb_nd_list[[10]]$Y, setup_q_nhb_nd_list[[10]]$N0, setup_q_nhb_nd_list[[10]]$T0, X = covariates_acc_array_19)
q_nhb_nd_est_sdid21 <- synthdid_estimate(setup_q_nhb_nd_list[[11]]$Y, setup_q_nhb_nd_list[[11]]$N0, setup_q_nhb_nd_list[[11]]$T0, X = covariates_acc_array_21)
q_nhb_nd_est_sdid23 <- synthdid_estimate(setup_q_nhb_nd_list[[12]]$Y, setup_q_nhb_nd_list[[12]]$N0, setup_q_nhb_nd_list[[12]]$T0, X = covariates_acc_array_23)
q_nhb_nd_est_sdid24 <- synthdid_estimate(setup_q_nhb_nd_list[[13]]$Y, setup_q_nhb_nd_list[[13]]$N0, setup_q_nhb_nd_list[[13]]$T0, X = covariates_acc_array_24)
q_nhb_nd_est_sdid25 <- synthdid_estimate(setup_q_nhb_nd_list[[14]]$Y, setup_q_nhb_nd_list[[14]]$N0, setup_q_nhb_nd_list[[14]]$T0, X = covariates_acc_array_25)
q_nhb_nd_est_sdid26 <- synthdid_estimate(setup_q_nhb_nd_list[[15]]$Y, setup_q_nhb_nd_list[[15]]$N0, setup_q_nhb_nd_list[[15]]$T0, X = covariates_acc_array_26)
q_nhb_nd_est_sdid28 <- synthdid_estimate(setup_q_nhb_nd_list[[16]]$Y, setup_q_nhb_nd_list[[16]]$N0, setup_q_nhb_nd_list[[16]]$T0, X = covariates_acc_array_28)
q_nhb_nd_est_sdid29 <- synthdid_estimate(setup_q_nhb_nd_list[[17]]$Y, setup_q_nhb_nd_list[[17]]$N0, setup_q_nhb_nd_list[[17]]$T0, X = covariates_acc_array_29)
q_nhb_nd_est_sdid30 <- synthdid_estimate(setup_q_nhb_nd_list[[18]]$Y, setup_q_nhb_nd_list[[18]]$N0, setup_q_nhb_nd_list[[18]]$T0, X = covariates_acc_array_30)
q_nhb_nd_est_sdid31 <- synthdid_estimate(setup_q_nhb_nd_list[[19]]$Y, setup_q_nhb_nd_list[[19]]$N0, setup_q_nhb_nd_list[[19]]$T0, X = covariates_acc_array_31)
q_nhb_nd_est_sdid32 <- synthdid_estimate(setup_q_nhb_nd_list[[20]]$Y, setup_q_nhb_nd_list[[20]]$N0, setup_q_nhb_nd_list[[20]]$T0, X = covariates_acc_array_32)
q_nhb_nd_est_sdid33 <- synthdid_estimate(setup_q_nhb_nd_list[[21]]$Y, setup_q_nhb_nd_list[[21]]$N0, setup_q_nhb_nd_list[[21]]$T0, X = covariates_acc_array_33)
q_nhb_nd_est_sdid34 <- synthdid_estimate(setup_q_nhb_nd_list[[22]]$Y, setup_q_nhb_nd_list[[22]]$N0, setup_q_nhb_nd_list[[22]]$T0, X = covariates_acc_array_34)
q_nhb_nd_est_sdid36 <- synthdid_estimate(setup_q_nhb_nd_list[[23]]$Y, setup_q_nhb_nd_list[[23]]$N0, setup_q_nhb_nd_list[[23]]$T0, X = covariates_acc_array_36)
q_nhb_nd_est_sdid37 <- synthdid_estimate(setup_q_nhb_nd_list[[24]]$Y, setup_q_nhb_nd_list[[24]]$N0, setup_q_nhb_nd_list[[24]]$T0, X = covariates_acc_array_37)
q_nhb_nd_est_sdid39 <- synthdid_estimate(setup_q_nhb_nd_list[[25]]$Y, setup_q_nhb_nd_list[[25]]$N0, setup_q_nhb_nd_list[[25]]$T0, X = covariates_acc_array_39)
q_nhb_nd_est_sdid40 <- synthdid_estimate(setup_q_nhb_nd_list[[26]]$Y, setup_q_nhb_nd_list[[26]]$N0, setup_q_nhb_nd_list[[26]]$T0, X = covariates_acc_array_40)
q_nhb_nd_est_sdid41 <- synthdid_estimate(setup_q_nhb_nd_list[[27]]$Y, setup_q_nhb_nd_list[[27]]$N0, setup_q_nhb_nd_list[[27]]$T0, X = covariates_acc_array_41)
q_nhb_nd_est_sdid44 <- synthdid_estimate(setup_q_nhb_nd_list[[28]]$Y, setup_q_nhb_nd_list[[28]]$N0, setup_q_nhb_nd_list[[28]]$T0, X = covariates_acc_array_44)
q_nhb_nd_est_sdid45 <- synthdid_estimate(setup_q_nhb_nd_list[[29]]$Y, setup_q_nhb_nd_list[[29]]$N0, setup_q_nhb_nd_list[[29]]$T0, X = covariates_acc_array_45)
q_nhb_nd_est_sdid47 <- synthdid_estimate(setup_q_nhb_nd_list[[30]]$Y, setup_q_nhb_nd_list[[30]]$N0, setup_q_nhb_nd_list[[30]]$T0, X = covariates_acc_array_47)
q_nhb_nd_est_sdid50 <- synthdid_estimate(setup_q_nhb_nd_list[[31]]$Y, setup_q_nhb_nd_list[[31]]$N0, setup_q_nhb_nd_list[[31]]$T0, X = covariates_acc_array_50)
q_nhb_nd_est_sdid51 <- synthdid_estimate(setup_q_nhb_nd_list[[32]]$Y, setup_q_nhb_nd_list[[32]]$N0, setup_q_nhb_nd_list[[32]]$T0, X = covariates_acc_array_51)
q_nhb_nd_est_sdid53 <- synthdid_estimate(setup_q_nhb_nd_list[[33]]$Y, setup_q_nhb_nd_list[[33]]$N0, setup_q_nhb_nd_list[[33]]$T0, X = covariates_acc_array_53)
q_nhb_nd_est_sdid54 <- synthdid_estimate(setup_q_nhb_nd_list[[34]]$Y, setup_q_nhb_nd_list[[34]]$N0, setup_q_nhb_nd_list[[34]]$T0, X = covariates_acc_array_54)
q_nhb_nd_est_sdid55 <- synthdid_estimate(setup_q_nhb_nd_list[[35]]$Y, setup_q_nhb_nd_list[[35]]$N0, setup_q_nhb_nd_list[[35]]$T0, X = covariates_acc_array_55)
q_nhb_nd_est_sdid_list <- list(q_nhb_nd_est_sdid1,q_nhb_nd_est_sdid2,q_nhb_nd_est_sdid5,
                               q_nhb_nd_est_sdid10,q_nhb_nd_est_sdid11,q_nhb_nd_est_sdid12,
                               q_nhb_nd_est_sdid13,q_nhb_nd_est_sdid15,q_nhb_nd_est_sdid17,
                               q_nhb_nd_est_sdid19,q_nhb_nd_est_sdid21,q_nhb_nd_est_sdid23,
                               q_nhb_nd_est_sdid24,q_nhb_nd_est_sdid25,q_nhb_nd_est_sdid26,
                               q_nhb_nd_est_sdid28,q_nhb_nd_est_sdid29,q_nhb_nd_est_sdid30,
                               q_nhb_nd_est_sdid31,q_nhb_nd_est_sdid32,q_nhb_nd_est_sdid33,
                               q_nhb_nd_est_sdid34,q_nhb_nd_est_sdid36,q_nhb_nd_est_sdid37,
                               q_nhb_nd_est_sdid39,q_nhb_nd_est_sdid40,q_nhb_nd_est_sdid41,
                               q_nhb_nd_est_sdid44,q_nhb_nd_est_sdid45,q_nhb_nd_est_sdid47,
                               q_nhb_nd_est_sdid50,q_nhb_nd_est_sdid51,q_nhb_nd_est_sdid53,
                               q_nhb_nd_est_sdid54,q_nhb_nd_est_sdid55)
rm(q_nhb_nd_est_sdid1,q_nhb_nd_est_sdid2,q_nhb_nd_est_sdid5,
   q_nhb_nd_est_sdid10,q_nhb_nd_est_sdid11,q_nhb_nd_est_sdid12,
   q_nhb_nd_est_sdid13,q_nhb_nd_est_sdid15,q_nhb_nd_est_sdid17,
   q_nhb_nd_est_sdid19,q_nhb_nd_est_sdid21,q_nhb_nd_est_sdid23,
   q_nhb_nd_est_sdid24,q_nhb_nd_est_sdid25,q_nhb_nd_est_sdid26,
   q_nhb_nd_est_sdid28,q_nhb_nd_est_sdid29,q_nhb_nd_est_sdid30,
   q_nhb_nd_est_sdid31,q_nhb_nd_est_sdid32,q_nhb_nd_est_sdid33,
   q_nhb_nd_est_sdid34,q_nhb_nd_est_sdid36,q_nhb_nd_est_sdid37,
   q_nhb_nd_est_sdid39,q_nhb_nd_est_sdid40,q_nhb_nd_est_sdid41,
   q_nhb_nd_est_sdid44,q_nhb_nd_est_sdid45,q_nhb_nd_est_sdid47,
   q_nhb_nd_est_sdid50,q_nhb_nd_est_sdid51,q_nhb_nd_est_sdid53,
   q_nhb_nd_est_sdid54,q_nhb_nd_est_sdid55)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sdid_plot", i), synthdid_plot(q_nhb_nd_est_sdid_list[i]))
}
q_nhb_nd_est_sdid_plot_data_aux1 <- ggplot_build(q_nhb_nd_est_sdid_plot1)
q_nhb_nd_est_sdid_plot_data_aux2 <- ggplot_build(q_nhb_nd_est_sdid_plot2)
q_nhb_nd_est_sdid_plot_data_aux3 <- ggplot_build(q_nhb_nd_est_sdid_plot3)
q_nhb_nd_est_sdid_plot_data_aux4 <- ggplot_build(q_nhb_nd_est_sdid_plot4)
q_nhb_nd_est_sdid_plot_data_aux5 <- ggplot_build(q_nhb_nd_est_sdid_plot5)
q_nhb_nd_est_sdid_plot_data_aux6 <- ggplot_build(q_nhb_nd_est_sdid_plot6)
q_nhb_nd_est_sdid_plot_data_aux7 <- ggplot_build(q_nhb_nd_est_sdid_plot7)
q_nhb_nd_est_sdid_plot_data_aux8 <- ggplot_build(q_nhb_nd_est_sdid_plot8)
q_nhb_nd_est_sdid_plot_data_aux9 <- ggplot_build(q_nhb_nd_est_sdid_plot9)
q_nhb_nd_est_sdid_plot_data_aux10 <- ggplot_build(q_nhb_nd_est_sdid_plot10)
q_nhb_nd_est_sdid_plot_data_aux11 <- ggplot_build(q_nhb_nd_est_sdid_plot11)
q_nhb_nd_est_sdid_plot_data_aux12 <- ggplot_build(q_nhb_nd_est_sdid_plot12)
q_nhb_nd_est_sdid_plot_data_aux13 <- ggplot_build(q_nhb_nd_est_sdid_plot13)
q_nhb_nd_est_sdid_plot_data_aux14 <- ggplot_build(q_nhb_nd_est_sdid_plot14)
q_nhb_nd_est_sdid_plot_data_aux15 <- ggplot_build(q_nhb_nd_est_sdid_plot15)
q_nhb_nd_est_sdid_plot_data_aux16 <- ggplot_build(q_nhb_nd_est_sdid_plot16)
q_nhb_nd_est_sdid_plot_data_aux17 <- ggplot_build(q_nhb_nd_est_sdid_plot17)
q_nhb_nd_est_sdid_plot_data_aux18 <- ggplot_build(q_nhb_nd_est_sdid_plot18)
q_nhb_nd_est_sdid_plot_data_aux19 <- ggplot_build(q_nhb_nd_est_sdid_plot19)
q_nhb_nd_est_sdid_plot_data_aux20 <- ggplot_build(q_nhb_nd_est_sdid_plot20)
q_nhb_nd_est_sdid_plot_data_aux21 <- ggplot_build(q_nhb_nd_est_sdid_plot21)
q_nhb_nd_est_sdid_plot_data_aux22 <- ggplot_build(q_nhb_nd_est_sdid_plot22)
q_nhb_nd_est_sdid_plot_data_aux23 <- ggplot_build(q_nhb_nd_est_sdid_plot23)
q_nhb_nd_est_sdid_plot_data_aux24 <- ggplot_build(q_nhb_nd_est_sdid_plot24)
q_nhb_nd_est_sdid_plot_data_aux25 <- ggplot_build(q_nhb_nd_est_sdid_plot25)
q_nhb_nd_est_sdid_plot_data_aux26 <- ggplot_build(q_nhb_nd_est_sdid_plot26)
q_nhb_nd_est_sdid_plot_data_aux27 <- ggplot_build(q_nhb_nd_est_sdid_plot27)
q_nhb_nd_est_sdid_plot_data_aux28 <- ggplot_build(q_nhb_nd_est_sdid_plot28)
q_nhb_nd_est_sdid_plot_data_aux29 <- ggplot_build(q_nhb_nd_est_sdid_plot29)
q_nhb_nd_est_sdid_plot_data_aux30 <- ggplot_build(q_nhb_nd_est_sdid_plot30)
q_nhb_nd_est_sdid_plot_data_aux31 <- ggplot_build(q_nhb_nd_est_sdid_plot31)
q_nhb_nd_est_sdid_plot_data_aux32 <- ggplot_build(q_nhb_nd_est_sdid_plot32)
q_nhb_nd_est_sdid_plot_data_aux33 <- ggplot_build(q_nhb_nd_est_sdid_plot33)
q_nhb_nd_est_sdid_plot_data_aux34 <- ggplot_build(q_nhb_nd_est_sdid_plot34)
q_nhb_nd_est_sdid_plot_data_aux35 <- ggplot_build(q_nhb_nd_est_sdid_plot35)
q_nhb_nd_est_sdid_plot_data_aux_list <- list(q_nhb_nd_est_sdid_plot_data_aux1,q_nhb_nd_est_sdid_plot_data_aux2,q_nhb_nd_est_sdid_plot_data_aux3,
                                             q_nhb_nd_est_sdid_plot_data_aux4,q_nhb_nd_est_sdid_plot_data_aux5,q_nhb_nd_est_sdid_plot_data_aux6,
                                             q_nhb_nd_est_sdid_plot_data_aux7,q_nhb_nd_est_sdid_plot_data_aux8,q_nhb_nd_est_sdid_plot_data_aux9,
                                             q_nhb_nd_est_sdid_plot_data_aux10,q_nhb_nd_est_sdid_plot_data_aux11,q_nhb_nd_est_sdid_plot_data_aux12,
                                             q_nhb_nd_est_sdid_plot_data_aux13,q_nhb_nd_est_sdid_plot_data_aux14,q_nhb_nd_est_sdid_plot_data_aux15,
                                             q_nhb_nd_est_sdid_plot_data_aux16,q_nhb_nd_est_sdid_plot_data_aux17,q_nhb_nd_est_sdid_plot_data_aux18,
                                             q_nhb_nd_est_sdid_plot_data_aux19,q_nhb_nd_est_sdid_plot_data_aux20,q_nhb_nd_est_sdid_plot_data_aux21,
                                             q_nhb_nd_est_sdid_plot_data_aux22,q_nhb_nd_est_sdid_plot_data_aux23,q_nhb_nd_est_sdid_plot_data_aux24,
                                             q_nhb_nd_est_sdid_plot_data_aux25,q_nhb_nd_est_sdid_plot_data_aux26,q_nhb_nd_est_sdid_plot_data_aux27,
                                             q_nhb_nd_est_sdid_plot_data_aux28,q_nhb_nd_est_sdid_plot_data_aux29,q_nhb_nd_est_sdid_plot_data_aux30,
                                             q_nhb_nd_est_sdid_plot_data_aux31,q_nhb_nd_est_sdid_plot_data_aux32,q_nhb_nd_est_sdid_plot_data_aux33,
                                             q_nhb_nd_est_sdid_plot_data_aux34,q_nhb_nd_est_sdid_plot_data_aux35)
rm(q_nhb_nd_est_sdid_plot_data_aux1,q_nhb_nd_est_sdid_plot_data_aux2,q_nhb_nd_est_sdid_plot_data_aux3,
   q_nhb_nd_est_sdid_plot_data_aux4,q_nhb_nd_est_sdid_plot_data_aux5,q_nhb_nd_est_sdid_plot_data_aux6,
   q_nhb_nd_est_sdid_plot_data_aux7,q_nhb_nd_est_sdid_plot_data_aux8,q_nhb_nd_est_sdid_plot_data_aux9,
   q_nhb_nd_est_sdid_plot_data_aux10,q_nhb_nd_est_sdid_plot_data_aux11,q_nhb_nd_est_sdid_plot_data_aux12,
   q_nhb_nd_est_sdid_plot_data_aux13,q_nhb_nd_est_sdid_plot_data_aux14,q_nhb_nd_est_sdid_plot_data_aux15,
   q_nhb_nd_est_sdid_plot_data_aux16,q_nhb_nd_est_sdid_plot_data_aux17,q_nhb_nd_est_sdid_plot_data_aux18,
   q_nhb_nd_est_sdid_plot_data_aux19,q_nhb_nd_est_sdid_plot_data_aux20,q_nhb_nd_est_sdid_plot_data_aux21,
   q_nhb_nd_est_sdid_plot_data_aux22,q_nhb_nd_est_sdid_plot_data_aux23,q_nhb_nd_est_sdid_plot_data_aux24,
   q_nhb_nd_est_sdid_plot_data_aux25,q_nhb_nd_est_sdid_plot_data_aux26,q_nhb_nd_est_sdid_plot_data_aux27,
   q_nhb_nd_est_sdid_plot_data_aux28,q_nhb_nd_est_sdid_plot_data_aux29,q_nhb_nd_est_sdid_plot_data_aux30,
   q_nhb_nd_est_sdid_plot_data_aux31,q_nhb_nd_est_sdid_plot_data_aux32,q_nhb_nd_est_sdid_plot_data_aux33,
   q_nhb_nd_est_sdid_plot_data_aux34,q_nhb_nd_est_sdid_plot_data_aux35)
rm(q_nhb_nd_est_sdid_plot1,q_nhb_nd_est_sdid_plot2,q_nhb_nd_est_sdid_plot3,
   q_nhb_nd_est_sdid_plot4,q_nhb_nd_est_sdid_plot5,q_nhb_nd_est_sdid_plot6,
   q_nhb_nd_est_sdid_plot7,q_nhb_nd_est_sdid_plot8,q_nhb_nd_est_sdid_plot9,
   q_nhb_nd_est_sdid_plot10,q_nhb_nd_est_sdid_plot11,q_nhb_nd_est_sdid_plot12,
   q_nhb_nd_est_sdid_plot13,q_nhb_nd_est_sdid_plot14,q_nhb_nd_est_sdid_plot15,
   q_nhb_nd_est_sdid_plot16,q_nhb_nd_est_sdid_plot17,q_nhb_nd_est_sdid_plot18,
   q_nhb_nd_est_sdid_plot19,q_nhb_nd_est_sdid_plot20,q_nhb_nd_est_sdid_plot21,
   q_nhb_nd_est_sdid_plot22,q_nhb_nd_est_sdid_plot23,q_nhb_nd_est_sdid_plot24,
   q_nhb_nd_est_sdid_plot25,q_nhb_nd_est_sdid_plot26,q_nhb_nd_est_sdid_plot27,
   q_nhb_nd_est_sdid_plot28,q_nhb_nd_est_sdid_plot29,q_nhb_nd_est_sdid_plot30,
   q_nhb_nd_est_sdid_plot31,q_nhb_nd_est_sdid_plot32,q_nhb_nd_est_sdid_plot33,
   q_nhb_nd_est_sdid_plot34,q_nhb_nd_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sdid_plot_data_long", i), data.frame(q_nhb_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, q_nhb_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, q_nhb_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
q_nhb_nd_est_sdid_plot_data_long_list <- list(q_nhb_nd_est_sdid_plot_data_long1,q_nhb_nd_est_sdid_plot_data_long2,q_nhb_nd_est_sdid_plot_data_long3,
                                              q_nhb_nd_est_sdid_plot_data_long4,q_nhb_nd_est_sdid_plot_data_long5,q_nhb_nd_est_sdid_plot_data_long6,
                                              q_nhb_nd_est_sdid_plot_data_long7,q_nhb_nd_est_sdid_plot_data_long8,q_nhb_nd_est_sdid_plot_data_long9,
                                              q_nhb_nd_est_sdid_plot_data_long10,q_nhb_nd_est_sdid_plot_data_long11,q_nhb_nd_est_sdid_plot_data_long12,
                                              q_nhb_nd_est_sdid_plot_data_long13,q_nhb_nd_est_sdid_plot_data_long14,q_nhb_nd_est_sdid_plot_data_long15,
                                              q_nhb_nd_est_sdid_plot_data_long16,q_nhb_nd_est_sdid_plot_data_long17,q_nhb_nd_est_sdid_plot_data_long18,
                                              q_nhb_nd_est_sdid_plot_data_long19,q_nhb_nd_est_sdid_plot_data_long20,q_nhb_nd_est_sdid_plot_data_long21,
                                              q_nhb_nd_est_sdid_plot_data_long22,q_nhb_nd_est_sdid_plot_data_long23,q_nhb_nd_est_sdid_plot_data_long24,
                                              q_nhb_nd_est_sdid_plot_data_long25,q_nhb_nd_est_sdid_plot_data_long26,q_nhb_nd_est_sdid_plot_data_long27,
                                              q_nhb_nd_est_sdid_plot_data_long28,q_nhb_nd_est_sdid_plot_data_long29,q_nhb_nd_est_sdid_plot_data_long30,
                                              q_nhb_nd_est_sdid_plot_data_long31,q_nhb_nd_est_sdid_plot_data_long32,q_nhb_nd_est_sdid_plot_data_long33,
                                              q_nhb_nd_est_sdid_plot_data_long34,q_nhb_nd_est_sdid_plot_data_long35)
rm(q_nhb_nd_est_sdid_plot_data_long1,q_nhb_nd_est_sdid_plot_data_long2,q_nhb_nd_est_sdid_plot_data_long3,
   q_nhb_nd_est_sdid_plot_data_long4,q_nhb_nd_est_sdid_plot_data_long5,q_nhb_nd_est_sdid_plot_data_long6,
   q_nhb_nd_est_sdid_plot_data_long7,q_nhb_nd_est_sdid_plot_data_long8,q_nhb_nd_est_sdid_plot_data_long9,
   q_nhb_nd_est_sdid_plot_data_long10,q_nhb_nd_est_sdid_plot_data_long11,q_nhb_nd_est_sdid_plot_data_long12,
   q_nhb_nd_est_sdid_plot_data_long13,q_nhb_nd_est_sdid_plot_data_long14,q_nhb_nd_est_sdid_plot_data_long15,
   q_nhb_nd_est_sdid_plot_data_long16,q_nhb_nd_est_sdid_plot_data_long17,q_nhb_nd_est_sdid_plot_data_long18,
   q_nhb_nd_est_sdid_plot_data_long19,q_nhb_nd_est_sdid_plot_data_long20,q_nhb_nd_est_sdid_plot_data_long21,
   q_nhb_nd_est_sdid_plot_data_long22,q_nhb_nd_est_sdid_plot_data_long23,q_nhb_nd_est_sdid_plot_data_long24,
   q_nhb_nd_est_sdid_plot_data_long25,q_nhb_nd_est_sdid_plot_data_long26,q_nhb_nd_est_sdid_plot_data_long27,
   q_nhb_nd_est_sdid_plot_data_long28,q_nhb_nd_est_sdid_plot_data_long29,q_nhb_nd_est_sdid_plot_data_long30,
   q_nhb_nd_est_sdid_plot_data_long31,q_nhb_nd_est_sdid_plot_data_long32,q_nhb_nd_est_sdid_plot_data_long33,
   q_nhb_nd_est_sdid_plot_data_long34,q_nhb_nd_est_sdid_plot_data_long35)
q_nhb_nd_est_sdid_plot_data_long_list <- lapply(q_nhb_nd_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("q_nhb_nd_est_sdid_plot_data_wide", i), reshape(data=q_nhb_nd_est_sdid_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
q_nhb_nd_est_sdid_plot_data_wide_list <- list(q_nhb_nd_est_sdid_plot_data_wide1,q_nhb_nd_est_sdid_plot_data_wide2,q_nhb_nd_est_sdid_plot_data_wide3,
                                              q_nhb_nd_est_sdid_plot_data_wide4,q_nhb_nd_est_sdid_plot_data_wide5,q_nhb_nd_est_sdid_plot_data_wide6,
                                              q_nhb_nd_est_sdid_plot_data_wide7,q_nhb_nd_est_sdid_plot_data_wide8,q_nhb_nd_est_sdid_plot_data_wide9,
                                              q_nhb_nd_est_sdid_plot_data_wide10,q_nhb_nd_est_sdid_plot_data_wide11,q_nhb_nd_est_sdid_plot_data_wide12,
                                              q_nhb_nd_est_sdid_plot_data_wide13,q_nhb_nd_est_sdid_plot_data_wide14,q_nhb_nd_est_sdid_plot_data_wide15,
                                              q_nhb_nd_est_sdid_plot_data_wide16,q_nhb_nd_est_sdid_plot_data_wide17,q_nhb_nd_est_sdid_plot_data_wide18,
                                              q_nhb_nd_est_sdid_plot_data_wide19,q_nhb_nd_est_sdid_plot_data_wide20,q_nhb_nd_est_sdid_plot_data_wide21,
                                              q_nhb_nd_est_sdid_plot_data_wide22,q_nhb_nd_est_sdid_plot_data_wide23,q_nhb_nd_est_sdid_plot_data_wide24,
                                              q_nhb_nd_est_sdid_plot_data_wide25,q_nhb_nd_est_sdid_plot_data_wide26,q_nhb_nd_est_sdid_plot_data_wide27,
                                              q_nhb_nd_est_sdid_plot_data_wide28,q_nhb_nd_est_sdid_plot_data_wide29,q_nhb_nd_est_sdid_plot_data_wide30,
                                              q_nhb_nd_est_sdid_plot_data_wide31,q_nhb_nd_est_sdid_plot_data_wide32,q_nhb_nd_est_sdid_plot_data_wide33,
                                              q_nhb_nd_est_sdid_plot_data_wide34,q_nhb_nd_est_sdid_plot_data_wide35)
rm(q_nhb_nd_est_sdid_plot_data_wide1,q_nhb_nd_est_sdid_plot_data_wide2,q_nhb_nd_est_sdid_plot_data_wide3,
   q_nhb_nd_est_sdid_plot_data_wide4,q_nhb_nd_est_sdid_plot_data_wide5,q_nhb_nd_est_sdid_plot_data_wide6,
   q_nhb_nd_est_sdid_plot_data_wide7,q_nhb_nd_est_sdid_plot_data_wide8,q_nhb_nd_est_sdid_plot_data_wide9,
   q_nhb_nd_est_sdid_plot_data_wide10,q_nhb_nd_est_sdid_plot_data_wide11,q_nhb_nd_est_sdid_plot_data_wide12,
   q_nhb_nd_est_sdid_plot_data_wide13,q_nhb_nd_est_sdid_plot_data_wide14,q_nhb_nd_est_sdid_plot_data_wide15,
   q_nhb_nd_est_sdid_plot_data_wide16,q_nhb_nd_est_sdid_plot_data_wide17,q_nhb_nd_est_sdid_plot_data_wide18,
   q_nhb_nd_est_sdid_plot_data_wide19,q_nhb_nd_est_sdid_plot_data_wide20,q_nhb_nd_est_sdid_plot_data_wide21,
   q_nhb_nd_est_sdid_plot_data_wide22,q_nhb_nd_est_sdid_plot_data_wide23,q_nhb_nd_est_sdid_plot_data_wide24,
   q_nhb_nd_est_sdid_plot_data_wide25,q_nhb_nd_est_sdid_plot_data_wide26,q_nhb_nd_est_sdid_plot_data_wide27,
   q_nhb_nd_est_sdid_plot_data_wide28,q_nhb_nd_est_sdid_plot_data_wide29,q_nhb_nd_est_sdid_plot_data_wide30,
   q_nhb_nd_est_sdid_plot_data_wide31,q_nhb_nd_est_sdid_plot_data_wide32,q_nhb_nd_est_sdid_plot_data_wide33,
   q_nhb_nd_est_sdid_plot_data_wide34,q_nhb_nd_est_sdid_plot_data_wide35)
q_nhb_nd_est_sdid_plot_data_wide_list <- lapply(q_nhb_nd_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
q_nhb_est_did_plot_data_wide_nd$did_facet_title <- "Diff-in-Diff"
q_nhb_est_sc_plot_data_wide_nd$sc_facet_title <- "Synthetic Control"
q_nhb_est_sdid_plot_data_wide_nd$sdid_facet_title <- "Synthetic Diff-in-Diff"
q_nhb_est_did_plot_data_wide_nd$diff_relative <- q_nhb_est_did_plot_data_wide_nd$diff - q_nhb_est_did_plot_data_wide_nd$diff[4]
for(i in 1:35) {
  q_nhb_nd_est_did_plot_data_wide_list[[i]]$diff_relative <- q_nhb_nd_est_did_plot_data_wide_list[[i]]$diff - q_nhb_nd_est_did_plot_data_wide_list[[i]]$diff[4]
}
q_nhb_nd_spag_did_plot <- ggplot(q_nhb_est_did_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Quantity of Nursing Home Beds \n (Per 100,000)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_nd_spag_sc_plot <- ggplot(q_nhb_est_sc_plot_data_wide_nd, aes(year,diff)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = q_nhb_nd_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "North Dakota"),data = q_nhb_est_sc_plot_data_wide_nd, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "North Dakota" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_est_sdid_plot_data_wide_nd$diff_relative <- q_nhb_est_sdid_plot_data_wide_nd$diff - q_nhb_est_sdid_plot_data_wide_nd$diff[4]
for(i in 1:35) {
  q_nhb_nd_est_sdid_plot_data_wide_list[[i]]$diff_relative <- q_nhb_nd_est_sdid_plot_data_wide_list[[i]]$diff - q_nhb_nd_est_sdid_plot_data_wide_list[[i]]$diff[4]
}
q_nhb_nd_spag_sdid_plot <- ggplot(q_nhb_est_sdid_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = q_nhb_nd_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
q_nhb_nd_est_did_vec <- c(q_nhb_est_did_nd)
for (i in 1:35) {
  q_nhb_nd_est_did_vec_aux <- q_nhb_nd_est_did_list[[i]][1]
  q_nhb_nd_est_did_vec <- c(q_nhb_nd_est_did_vec,q_nhb_nd_est_did_vec_aux)
}
q_nhb_nd_est_did_df <- data.frame(q_nhb_nd_est_did_vec)
q_nhb_nd_hist_did_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_nd_est_did_vec)) +
  geom_histogram(data = q_nhb_nd_est_did_df, aes(x = q_nhb_nd_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_nd_hist_did_plot1_ylim <- ggplot_build(q_nhb_nd_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_nd_hist_did_plot <- q_nhb_nd_hist_did_plot_aux +
  expand_limits(y=q_nhb_nd_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_nd_est_did_vec[1], mean(q_nhb_nd_est_did_vec[2:36])), xend = c(q_nhb_nd_est_did_vec[1],mean(q_nhb_nd_est_did_vec[2:36])), y = c(0,0), yend = c(q_nhb_nd_hist_did_plot1_ylim,q_nhb_nd_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_nd_est_did_vec[1], mean(q_nhb_nd_est_did_vec[2:36])), y = c(q_nhb_nd_hist_did_plot1_ylim,q_nhb_nd_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_nd_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_nd_est_did_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0,1), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_nd_est_sc_vec <- c(q_nhb_est_sc_nd)
for (i in 1:35) {
  q_nhb_nd_est_sc_vec_aux <- q_nhb_nd_est_sc_list[[i]][1]
  q_nhb_nd_est_sc_vec <- c(q_nhb_nd_est_sc_vec,q_nhb_nd_est_sc_vec_aux)
}
q_nhb_nd_est_sc_df <- data.frame(q_nhb_nd_est_sc_vec)
q_nhb_nd_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_nd_est_sc_vec)) +
  geom_histogram(data = q_nhb_nd_est_sc_df, aes(x = q_nhb_nd_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_nd_hist_sc_plot1_ylim <- ggplot_build(q_nhb_nd_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_nd_hist_sc_plot <- q_nhb_nd_hist_sc_plot_aux +
  expand_limits(y=q_nhb_nd_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_nd_est_sc_vec[1], mean(q_nhb_nd_est_sc_vec[2:36])), xend = c(q_nhb_nd_est_sc_vec[1],mean(q_nhb_nd_est_sc_vec[2:36])), y = c(0,0), yend = c(q_nhb_nd_hist_sc_plot1_ylim,q_nhb_nd_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_nd_est_sc_vec[1], mean(q_nhb_nd_est_sc_vec[2:36])), y = c(q_nhb_nd_hist_sc_plot1_ylim,q_nhb_nd_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_nd_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(q_nhb_nd_est_sc_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(1,0), color = c("#00BFC4","grey40"), size = c(2,2))

q_nhb_nd_est_sdid_vec <- c(q_nhb_est_sdid_nd)
for (i in 1:35) {
  q_nhb_nd_est_sdid_vec_aux <- q_nhb_nd_est_sdid_list[[i]][1]
  q_nhb_nd_est_sdid_vec <- c(q_nhb_nd_est_sdid_vec,q_nhb_nd_est_sdid_vec_aux)
}
q_nhb_nd_est_sdid_df <- data.frame(q_nhb_nd_est_sdid_vec)
q_nhb_nd_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = q_nhb_nd_est_sdid_vec)) +
  geom_histogram(data = q_nhb_nd_est_sdid_df, aes(x = q_nhb_nd_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
q_nhb_nd_hist_sdid_plot1_ylim <- ggplot_build(q_nhb_nd_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
q_nhb_nd_hist_sdid_plot <- q_nhb_nd_hist_sdid_plot_aux +
  expand_limits(y=q_nhb_nd_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(q_nhb_nd_est_sdid_vec[1], mean(q_nhb_nd_est_sdid_vec[2:36])), xend = c(q_nhb_nd_est_sdid_vec[1],mean(q_nhb_nd_est_sdid_vec[2:36])), y = c(0,0), yend = c(q_nhb_nd_hist_sdid_plot1_ylim,q_nhb_nd_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(q_nhb_nd_est_sdid_vec[1], mean(q_nhb_nd_est_sdid_vec[2:36])), y = c(q_nhb_nd_hist_sdid_plot1_ylim,q_nhb_nd_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(q_nhb_nd_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",signif(mean(q_nhb_nd_est_sdid_vec[2:36]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(0.1,0.9), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/q_nhb_spag_dist_plots_ND.pdf', paper = "USr", width = 10.9, height = 8.4)
(q_nhb_nd_spag_dist_plots_nd <- q_nhb_nd_spag_did_plot + q_nhb_nd_spag_sc_plot + q_nhb_nd_spag_sdid_plot + q_nhb_nd_hist_did_plot + q_nhb_nd_hist_sc_plot + q_nhb_nd_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Total Expenditure #####
### ND - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
tot_exp_nd_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id != 11))
tot_exp_nd_df$treated <- as.integer(ifelse(tot_exp_nd_df$name == "North Dakota" & tot_exp_nd_df$year >= 1995, 1, 0))
tot_exp_nd_df <- tot_exp_nd_df[order(tot_exp_nd_df$year, tot_exp_nd_df$treated_nd_aux, tot_exp_nd_df$name),]
tot_exp_nd_df <- subset(tot_exp_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, total_exp, treated))
setup_tot_exp_nd <- panel.matrices(tot_exp_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
tot_exp_est_did_nd <- did_estimate(setup_tot_exp_nd$Y, setup_tot_exp_nd$N0, setup_tot_exp_nd$T0, X = covariates_exp_nd_array)
tot_exp_est_did_plot_nd <- synthdid_plot(tot_exp_est_did_nd)
tot_exp_est_did_plot_data_aux_nd <- ggplot_build(tot_exp_est_did_plot_nd)
tot_exp_est_did_plot_data_long_nd <- data.frame(tot_exp_est_did_plot_data_aux_nd$data[[1]]$x, tot_exp_est_did_plot_data_aux_nd$data[[1]]$y, tot_exp_est_did_plot_data_aux_nd$data[[1]]$group)
colnames(tot_exp_est_did_plot_data_long_nd) <- c('year', 'outcome', 'treated')
tot_exp_est_did_plot_data_long_nd$treated <- tot_exp_est_did_plot_data_long_nd$treated - 1
tot_exp_est_did_plot_data_wide_nd <- reshape(data=tot_exp_est_did_plot_data_long_nd,
                                             idvar = "year",
                                             v.names = "outcome",
                                             timevar = "treated",
                                             direction = "wide")
tot_exp_est_did_plot_data_wide_nd$diff <- tot_exp_est_did_plot_data_wide_nd$outcome.1 - tot_exp_est_did_plot_data_wide_nd$outcome.0
# SC #
tot_exp_est_sc_nd <- sc_estimate(setup_tot_exp_nd$Y, setup_tot_exp_nd$N0, setup_tot_exp_nd$T0, X = covariates_exp_nd_array)
tot_exp_est_sc_plot_nd <- synthdid_plot(tot_exp_est_sc_nd)
tot_exp_est_sc_plot_data_aux_nd <- ggplot_build(tot_exp_est_sc_plot_nd)
tot_exp_est_sc_plot_data_long_nd <- data.frame(tot_exp_est_sc_plot_data_aux_nd$data[[1]]$x, tot_exp_est_sc_plot_data_aux_nd$data[[1]]$y, tot_exp_est_sc_plot_data_aux_nd$data[[1]]$group)
colnames(tot_exp_est_sc_plot_data_long_nd) <- c('year', 'outcome', 'treated')
tot_exp_est_sc_plot_data_long_nd$treated <- tot_exp_est_sc_plot_data_long_nd$treated - 1
tot_exp_est_sc_plot_data_wide_nd <- reshape(data=tot_exp_est_sc_plot_data_long_nd,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
tot_exp_est_sc_plot_data_wide_nd$diff <- tot_exp_est_sc_plot_data_wide_nd$outcome.1 - tot_exp_est_sc_plot_data_wide_nd$outcome.0
# SDID #
tot_exp_est_sdid_nd <- synthdid_estimate(setup_tot_exp_nd$Y, setup_tot_exp_nd$N0, setup_tot_exp_nd$T0, X = covariates_exp_nd_array)
tot_exp_est_sdid_plot_nd <- synthdid_plot(tot_exp_est_sdid_nd)
tot_exp_est_sdid_plot_data_aux_nd <- ggplot_build(tot_exp_est_sdid_plot_nd)
tot_exp_est_sdid_plot_data_long_nd <- data.frame(tot_exp_est_sdid_plot_data_aux_nd$data[[1]]$x, tot_exp_est_sdid_plot_data_aux_nd$data[[1]]$y, tot_exp_est_sdid_plot_data_aux_nd$data[[1]]$group)
colnames(tot_exp_est_sdid_plot_data_long_nd) <- c('year', 'outcome', 'treated')
tot_exp_est_sdid_plot_data_long_nd$treated <- tot_exp_est_sdid_plot_data_long_nd$treated - 1
tot_exp_est_sdid_plot_data_wide_nd <- reshape(data=tot_exp_est_sdid_plot_data_long_nd,
                                              idvar = "year",
                                              v.names = "outcome",
                                              timevar = "treated",
                                              direction = "wide")
tot_exp_est_sdid_plot_data_wide_nd$diff <- tot_exp_est_sdid_plot_data_wide_nd$outcome.1 - tot_exp_est_sdid_plot_data_wide_nd$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("tot_exp_nd_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
tot_exp_nd_df1$treated_aux <- ifelse(tot_exp_nd_df1$id == 1, 1, 0)
tot_exp_nd_df2$treated_aux <- ifelse(tot_exp_nd_df2$id == 2, 1, 0)
tot_exp_nd_df5$treated_aux <- ifelse(tot_exp_nd_df5$id == 5, 1, 0)
tot_exp_nd_df10$treated_aux <- ifelse(tot_exp_nd_df10$id == 10, 1, 0)
tot_exp_nd_df11$treated_aux <- ifelse(tot_exp_nd_df11$id == 11, 1, 0)
tot_exp_nd_df12$treated_aux <- ifelse(tot_exp_nd_df12$id == 12, 1, 0)
tot_exp_nd_df13$treated_aux <- ifelse(tot_exp_nd_df13$id == 13, 1, 0)
tot_exp_nd_df15$treated_aux <- ifelse(tot_exp_nd_df15$id == 15, 1, 0)
tot_exp_nd_df17$treated_aux <- ifelse(tot_exp_nd_df17$id == 17, 1, 0)
tot_exp_nd_df19$treated_aux <- ifelse(tot_exp_nd_df19$id == 19, 1, 0)
tot_exp_nd_df21$treated_aux <- ifelse(tot_exp_nd_df21$id == 21, 1, 0)
tot_exp_nd_df23$treated_aux <- ifelse(tot_exp_nd_df23$id == 23, 1, 0)
tot_exp_nd_df24$treated_aux <- ifelse(tot_exp_nd_df24$id == 24, 1, 0)
tot_exp_nd_df25$treated_aux <- ifelse(tot_exp_nd_df25$id == 25, 1, 0)
tot_exp_nd_df26$treated_aux <- ifelse(tot_exp_nd_df26$id == 26, 1, 0)
tot_exp_nd_df28$treated_aux <- ifelse(tot_exp_nd_df28$id == 28, 1, 0)
tot_exp_nd_df29$treated_aux <- ifelse(tot_exp_nd_df29$id == 29, 1, 0)
tot_exp_nd_df30$treated_aux <- ifelse(tot_exp_nd_df30$id == 30, 1, 0)
tot_exp_nd_df31$treated_aux <- ifelse(tot_exp_nd_df31$id == 31, 1, 0)
tot_exp_nd_df32$treated_aux <- ifelse(tot_exp_nd_df32$id == 32, 1, 0)
tot_exp_nd_df33$treated_aux <- ifelse(tot_exp_nd_df33$id == 33, 1, 0)
tot_exp_nd_df34$treated_aux <- ifelse(tot_exp_nd_df34$id == 34, 1, 0)
tot_exp_nd_df36$treated_aux <- ifelse(tot_exp_nd_df36$id == 36, 1, 0)
tot_exp_nd_df37$treated_aux <- ifelse(tot_exp_nd_df37$id == 37, 1, 0)
tot_exp_nd_df39$treated_aux <- ifelse(tot_exp_nd_df39$id == 39, 1, 0)
tot_exp_nd_df40$treated_aux <- ifelse(tot_exp_nd_df40$id == 40, 1, 0)
tot_exp_nd_df41$treated_aux <- ifelse(tot_exp_nd_df41$id == 41, 1, 0)
tot_exp_nd_df44$treated_aux <- ifelse(tot_exp_nd_df44$id == 44, 1, 0)
tot_exp_nd_df45$treated_aux <- ifelse(tot_exp_nd_df45$id == 45, 1, 0)
tot_exp_nd_df47$treated_aux <- ifelse(tot_exp_nd_df47$id == 47, 1, 0)
tot_exp_nd_df50$treated_aux <- ifelse(tot_exp_nd_df50$id == 50, 1, 0)
tot_exp_nd_df51$treated_aux <- ifelse(tot_exp_nd_df51$id == 51, 1, 0)
tot_exp_nd_df53$treated_aux <- ifelse(tot_exp_nd_df53$id == 53, 1, 0)
tot_exp_nd_df54$treated_aux <- ifelse(tot_exp_nd_df54$id == 54, 1, 0)
tot_exp_nd_df55$treated_aux <- ifelse(tot_exp_nd_df55$id == 55, 1, 0)
tot_exp_nd_df1$treated <- as.integer(ifelse(tot_exp_nd_df1$id == 1 & tot_exp_nd_df1$year >= 1995, 1, 0))
tot_exp_nd_df2$treated <- as.integer(ifelse(tot_exp_nd_df2$id == 2 & tot_exp_nd_df2$year >= 1995, 1, 0))
tot_exp_nd_df5$treated <- as.integer(ifelse(tot_exp_nd_df5$id == 5 & tot_exp_nd_df5$year >= 1995, 1, 0))
tot_exp_nd_df10$treated <- as.integer(ifelse(tot_exp_nd_df10$id == 10 & tot_exp_nd_df10$year >= 1995, 1, 0))
tot_exp_nd_df11$treated <- as.integer(ifelse(tot_exp_nd_df11$id == 11 & tot_exp_nd_df11$year >= 1995, 1, 0))
tot_exp_nd_df12$treated <- as.integer(ifelse(tot_exp_nd_df12$id == 12 & tot_exp_nd_df12$year >= 1995, 1, 0))
tot_exp_nd_df13$treated <- as.integer(ifelse(tot_exp_nd_df13$id == 13 & tot_exp_nd_df13$year >= 1995, 1, 0))
tot_exp_nd_df15$treated <- as.integer(ifelse(tot_exp_nd_df15$id == 15 & tot_exp_nd_df15$year >= 1995, 1, 0))
tot_exp_nd_df17$treated <- as.integer(ifelse(tot_exp_nd_df17$id == 17 & tot_exp_nd_df17$year >= 1995, 1, 0))
tot_exp_nd_df19$treated <- as.integer(ifelse(tot_exp_nd_df19$id == 19 & tot_exp_nd_df19$year >= 1995, 1, 0))
tot_exp_nd_df21$treated <- as.integer(ifelse(tot_exp_nd_df21$id == 21 & tot_exp_nd_df21$year >= 1995, 1, 0))
tot_exp_nd_df23$treated <- as.integer(ifelse(tot_exp_nd_df23$id == 23 & tot_exp_nd_df23$year >= 1995, 1, 0))
tot_exp_nd_df24$treated <- as.integer(ifelse(tot_exp_nd_df24$id == 24 & tot_exp_nd_df24$year >= 1995, 1, 0))
tot_exp_nd_df25$treated <- as.integer(ifelse(tot_exp_nd_df25$id == 25 & tot_exp_nd_df25$year >= 1995, 1, 0))
tot_exp_nd_df26$treated <- as.integer(ifelse(tot_exp_nd_df26$id == 26 & tot_exp_nd_df26$year >= 1995, 1, 0))
tot_exp_nd_df28$treated <- as.integer(ifelse(tot_exp_nd_df28$id == 28 & tot_exp_nd_df28$year >= 1995, 1, 0))
tot_exp_nd_df29$treated <- as.integer(ifelse(tot_exp_nd_df29$id == 29 & tot_exp_nd_df29$year >= 1995, 1, 0))
tot_exp_nd_df30$treated <- as.integer(ifelse(tot_exp_nd_df30$id == 30 & tot_exp_nd_df30$year >= 1995, 1, 0))
tot_exp_nd_df31$treated <- as.integer(ifelse(tot_exp_nd_df31$id == 31 & tot_exp_nd_df31$year >= 1995, 1, 0))
tot_exp_nd_df32$treated <- as.integer(ifelse(tot_exp_nd_df32$id == 32 & tot_exp_nd_df32$year >= 1995, 1, 0))
tot_exp_nd_df33$treated <- as.integer(ifelse(tot_exp_nd_df33$id == 33 & tot_exp_nd_df33$year >= 1995, 1, 0))
tot_exp_nd_df34$treated <- as.integer(ifelse(tot_exp_nd_df34$id == 34 & tot_exp_nd_df34$year >= 1995, 1, 0))
tot_exp_nd_df36$treated <- as.integer(ifelse(tot_exp_nd_df36$id == 36 & tot_exp_nd_df36$year >= 1995, 1, 0))
tot_exp_nd_df37$treated <- as.integer(ifelse(tot_exp_nd_df37$id == 37 & tot_exp_nd_df37$year >= 1995, 1, 0))
tot_exp_nd_df39$treated <- as.integer(ifelse(tot_exp_nd_df39$id == 39 & tot_exp_nd_df39$year >= 1995, 1, 0))
tot_exp_nd_df40$treated <- as.integer(ifelse(tot_exp_nd_df40$id == 40 & tot_exp_nd_df40$year >= 1995, 1, 0))
tot_exp_nd_df41$treated <- as.integer(ifelse(tot_exp_nd_df41$id == 41 & tot_exp_nd_df41$year >= 1995, 1, 0))
tot_exp_nd_df44$treated <- as.integer(ifelse(tot_exp_nd_df44$id == 44 & tot_exp_nd_df44$year >= 1995, 1, 0))
tot_exp_nd_df45$treated <- as.integer(ifelse(tot_exp_nd_df45$id == 45 & tot_exp_nd_df45$year >= 1995, 1, 0))
tot_exp_nd_df47$treated <- as.integer(ifelse(tot_exp_nd_df47$id == 47 & tot_exp_nd_df47$year >= 1995, 1, 0))
tot_exp_nd_df50$treated <- as.integer(ifelse(tot_exp_nd_df50$id == 50 & tot_exp_nd_df50$year >= 1995, 1, 0))
tot_exp_nd_df51$treated <- as.integer(ifelse(tot_exp_nd_df51$id == 51 & tot_exp_nd_df51$year >= 1995, 1, 0))
tot_exp_nd_df53$treated <- as.integer(ifelse(tot_exp_nd_df53$id == 53 & tot_exp_nd_df53$year >= 1995, 1, 0))
tot_exp_nd_df54$treated <- as.integer(ifelse(tot_exp_nd_df54$id == 54 & tot_exp_nd_df54$year >= 1995, 1, 0))
tot_exp_nd_df55$treated <- as.integer(ifelse(tot_exp_nd_df55$id == 55 & tot_exp_nd_df55$year >= 1995, 1, 0))
tot_exp_nd_df_list <- list(tot_exp_nd_df1,tot_exp_nd_df2,tot_exp_nd_df5,
                           tot_exp_nd_df10,tot_exp_nd_df11,tot_exp_nd_df12,
                           tot_exp_nd_df13,tot_exp_nd_df15,tot_exp_nd_df17,
                           tot_exp_nd_df19,tot_exp_nd_df21,tot_exp_nd_df23,
                           tot_exp_nd_df24,tot_exp_nd_df25,tot_exp_nd_df26,
                           tot_exp_nd_df28,tot_exp_nd_df29,tot_exp_nd_df30,
                           tot_exp_nd_df31,tot_exp_nd_df32,tot_exp_nd_df33,
                           tot_exp_nd_df34,tot_exp_nd_df36,tot_exp_nd_df37,
                           tot_exp_nd_df39,tot_exp_nd_df40,tot_exp_nd_df41,
                           tot_exp_nd_df44,tot_exp_nd_df45,tot_exp_nd_df47,
                           tot_exp_nd_df50,tot_exp_nd_df51,tot_exp_nd_df53,
                           tot_exp_nd_df54,tot_exp_nd_df55)
rm(tot_exp_nd_df1,tot_exp_nd_df2,tot_exp_nd_df5,
   tot_exp_nd_df10,tot_exp_nd_df11,tot_exp_nd_df12,
   tot_exp_nd_df13,tot_exp_nd_df15,tot_exp_nd_df17,
   tot_exp_nd_df19,tot_exp_nd_df21,tot_exp_nd_df23,
   tot_exp_nd_df24,tot_exp_nd_df25,tot_exp_nd_df26,
   tot_exp_nd_df28,tot_exp_nd_df29,tot_exp_nd_df30,
   tot_exp_nd_df31,tot_exp_nd_df32,tot_exp_nd_df33,
   tot_exp_nd_df34,tot_exp_nd_df36,tot_exp_nd_df37,
   tot_exp_nd_df39,tot_exp_nd_df40,tot_exp_nd_df41,
   tot_exp_nd_df44,tot_exp_nd_df45,tot_exp_nd_df47,
   tot_exp_nd_df50,tot_exp_nd_df51,tot_exp_nd_df53,
   tot_exp_nd_df54,tot_exp_nd_df55)
tot_exp_nd_df_list <- lapply(tot_exp_nd_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
tot_exp_nd_df_list <- lapply(tot_exp_nd_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, total_exp, treated)))
}
)
setup_tot_exp_nd1 <- panel.matrices(tot_exp_nd_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd2 <- panel.matrices(tot_exp_nd_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd5 <- panel.matrices(tot_exp_nd_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd10 <- panel.matrices(tot_exp_nd_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd11 <- panel.matrices(tot_exp_nd_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd12 <- panel.matrices(tot_exp_nd_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd13 <- panel.matrices(tot_exp_nd_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd15 <- panel.matrices(tot_exp_nd_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd17 <- panel.matrices(tot_exp_nd_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd19 <- panel.matrices(tot_exp_nd_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd21 <- panel.matrices(tot_exp_nd_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd23 <- panel.matrices(tot_exp_nd_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd24 <- panel.matrices(tot_exp_nd_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd25 <- panel.matrices(tot_exp_nd_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd26 <- panel.matrices(tot_exp_nd_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd28 <- panel.matrices(tot_exp_nd_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd29 <- panel.matrices(tot_exp_nd_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd30 <- panel.matrices(tot_exp_nd_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd31 <- panel.matrices(tot_exp_nd_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd32 <- panel.matrices(tot_exp_nd_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd33 <- panel.matrices(tot_exp_nd_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd34 <- panel.matrices(tot_exp_nd_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd36 <- panel.matrices(tot_exp_nd_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd37 <- panel.matrices(tot_exp_nd_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd39 <- panel.matrices(tot_exp_nd_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd40 <- panel.matrices(tot_exp_nd_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd41 <- panel.matrices(tot_exp_nd_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd44 <- panel.matrices(tot_exp_nd_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd45 <- panel.matrices(tot_exp_nd_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd47 <- panel.matrices(tot_exp_nd_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd50 <- panel.matrices(tot_exp_nd_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd51 <- panel.matrices(tot_exp_nd_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd53 <- panel.matrices(tot_exp_nd_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd54 <- panel.matrices(tot_exp_nd_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd55 <- panel.matrices(tot_exp_nd_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_tot_exp_nd_list <- list(setup_tot_exp_nd1,setup_tot_exp_nd2,setup_tot_exp_nd5,
                              setup_tot_exp_nd10,setup_tot_exp_nd11,setup_tot_exp_nd12,
                              setup_tot_exp_nd13,setup_tot_exp_nd15,setup_tot_exp_nd17,
                              setup_tot_exp_nd19,setup_tot_exp_nd21,setup_tot_exp_nd23,
                              setup_tot_exp_nd24,setup_tot_exp_nd25,setup_tot_exp_nd26,
                              setup_tot_exp_nd28,setup_tot_exp_nd29,setup_tot_exp_nd30,
                              setup_tot_exp_nd31,setup_tot_exp_nd32,setup_tot_exp_nd33,
                              setup_tot_exp_nd34,setup_tot_exp_nd36,setup_tot_exp_nd37,
                              setup_tot_exp_nd39,setup_tot_exp_nd40,setup_tot_exp_nd41,
                              setup_tot_exp_nd44,setup_tot_exp_nd45,setup_tot_exp_nd47,
                              setup_tot_exp_nd50,setup_tot_exp_nd51,setup_tot_exp_nd53,
                              setup_tot_exp_nd54,setup_tot_exp_nd55)
rm(setup_tot_exp_nd1,setup_tot_exp_nd2,setup_tot_exp_nd5,
   setup_tot_exp_nd10,setup_tot_exp_nd11,setup_tot_exp_nd12,
   setup_tot_exp_nd13,setup_tot_exp_nd15,setup_tot_exp_nd17,
   setup_tot_exp_nd19,setup_tot_exp_nd21,setup_tot_exp_nd23,
   setup_tot_exp_nd24,setup_tot_exp_nd25,setup_tot_exp_nd26,
   setup_tot_exp_nd28,setup_tot_exp_nd29,setup_tot_exp_nd30,
   setup_tot_exp_nd31,setup_tot_exp_nd32,setup_tot_exp_nd33,
   setup_tot_exp_nd34,setup_tot_exp_nd36,setup_tot_exp_nd37,
   setup_tot_exp_nd39,setup_tot_exp_nd40,setup_tot_exp_nd41,
   setup_tot_exp_nd44,setup_tot_exp_nd45,setup_tot_exp_nd47,
   setup_tot_exp_nd50,setup_tot_exp_nd51,setup_tot_exp_nd53,
   setup_tot_exp_nd54,setup_tot_exp_nd55)
# DID #
tot_exp_nd_est_did1 <- did_estimate(setup_tot_exp_nd_list[[1]]$Y, setup_tot_exp_nd_list[[1]]$N0, setup_tot_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_nd_est_did2 <- did_estimate(setup_tot_exp_nd_list[[2]]$Y, setup_tot_exp_nd_list[[2]]$N0, setup_tot_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_nd_est_did5 <- did_estimate(setup_tot_exp_nd_list[[3]]$Y, setup_tot_exp_nd_list[[3]]$N0, setup_tot_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_nd_est_did10 <- did_estimate(setup_tot_exp_nd_list[[4]]$Y, setup_tot_exp_nd_list[[4]]$N0, setup_tot_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_nd_est_did11 <- did_estimate(setup_tot_exp_nd_list[[5]]$Y, setup_tot_exp_nd_list[[5]]$N0, setup_tot_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_nd_est_did12 <- did_estimate(setup_tot_exp_nd_list[[6]]$Y, setup_tot_exp_nd_list[[6]]$N0, setup_tot_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_nd_est_did13 <- did_estimate(setup_tot_exp_nd_list[[7]]$Y, setup_tot_exp_nd_list[[7]]$N0, setup_tot_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_nd_est_did15 <- did_estimate(setup_tot_exp_nd_list[[8]]$Y, setup_tot_exp_nd_list[[8]]$N0, setup_tot_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_nd_est_did17 <- did_estimate(setup_tot_exp_nd_list[[9]]$Y, setup_tot_exp_nd_list[[9]]$N0, setup_tot_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_nd_est_did19 <- did_estimate(setup_tot_exp_nd_list[[10]]$Y, setup_tot_exp_nd_list[[10]]$N0, setup_tot_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_nd_est_did21 <- did_estimate(setup_tot_exp_nd_list[[11]]$Y, setup_tot_exp_nd_list[[11]]$N0, setup_tot_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_nd_est_did23 <- did_estimate(setup_tot_exp_nd_list[[12]]$Y, setup_tot_exp_nd_list[[12]]$N0, setup_tot_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_nd_est_did24 <- did_estimate(setup_tot_exp_nd_list[[13]]$Y, setup_tot_exp_nd_list[[13]]$N0, setup_tot_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_nd_est_did25 <- did_estimate(setup_tot_exp_nd_list[[14]]$Y, setup_tot_exp_nd_list[[14]]$N0, setup_tot_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_nd_est_did26 <- did_estimate(setup_tot_exp_nd_list[[15]]$Y, setup_tot_exp_nd_list[[15]]$N0, setup_tot_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_nd_est_did28 <- did_estimate(setup_tot_exp_nd_list[[16]]$Y, setup_tot_exp_nd_list[[16]]$N0, setup_tot_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_nd_est_did29 <- did_estimate(setup_tot_exp_nd_list[[17]]$Y, setup_tot_exp_nd_list[[17]]$N0, setup_tot_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_nd_est_did30 <- did_estimate(setup_tot_exp_nd_list[[18]]$Y, setup_tot_exp_nd_list[[18]]$N0, setup_tot_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_nd_est_did31 <- did_estimate(setup_tot_exp_nd_list[[19]]$Y, setup_tot_exp_nd_list[[19]]$N0, setup_tot_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_nd_est_did32 <- did_estimate(setup_tot_exp_nd_list[[20]]$Y, setup_tot_exp_nd_list[[20]]$N0, setup_tot_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_nd_est_did33 <- did_estimate(setup_tot_exp_nd_list[[21]]$Y, setup_tot_exp_nd_list[[21]]$N0, setup_tot_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_nd_est_did34 <- did_estimate(setup_tot_exp_nd_list[[22]]$Y, setup_tot_exp_nd_list[[22]]$N0, setup_tot_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_nd_est_did36 <- did_estimate(setup_tot_exp_nd_list[[23]]$Y, setup_tot_exp_nd_list[[23]]$N0, setup_tot_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_nd_est_did37 <- did_estimate(setup_tot_exp_nd_list[[24]]$Y, setup_tot_exp_nd_list[[24]]$N0, setup_tot_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_nd_est_did39 <- did_estimate(setup_tot_exp_nd_list[[25]]$Y, setup_tot_exp_nd_list[[25]]$N0, setup_tot_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_nd_est_did40 <- did_estimate(setup_tot_exp_nd_list[[26]]$Y, setup_tot_exp_nd_list[[26]]$N0, setup_tot_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_nd_est_did41 <- did_estimate(setup_tot_exp_nd_list[[27]]$Y, setup_tot_exp_nd_list[[27]]$N0, setup_tot_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_nd_est_did44 <- did_estimate(setup_tot_exp_nd_list[[28]]$Y, setup_tot_exp_nd_list[[28]]$N0, setup_tot_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_nd_est_did45 <- did_estimate(setup_tot_exp_nd_list[[29]]$Y, setup_tot_exp_nd_list[[29]]$N0, setup_tot_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_nd_est_did47 <- did_estimate(setup_tot_exp_nd_list[[30]]$Y, setup_tot_exp_nd_list[[30]]$N0, setup_tot_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_nd_est_did50 <- did_estimate(setup_tot_exp_nd_list[[31]]$Y, setup_tot_exp_nd_list[[31]]$N0, setup_tot_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_nd_est_did51 <- did_estimate(setup_tot_exp_nd_list[[32]]$Y, setup_tot_exp_nd_list[[32]]$N0, setup_tot_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_nd_est_did53 <- did_estimate(setup_tot_exp_nd_list[[33]]$Y, setup_tot_exp_nd_list[[33]]$N0, setup_tot_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_nd_est_did54 <- did_estimate(setup_tot_exp_nd_list[[34]]$Y, setup_tot_exp_nd_list[[34]]$N0, setup_tot_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_nd_est_did55 <- did_estimate(setup_tot_exp_nd_list[[35]]$Y, setup_tot_exp_nd_list[[35]]$N0, setup_tot_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_nd_est_did_list <- list(tot_exp_nd_est_did1,tot_exp_nd_est_did2,tot_exp_nd_est_did5,
                                tot_exp_nd_est_did10,tot_exp_nd_est_did11,tot_exp_nd_est_did12,
                                tot_exp_nd_est_did13,tot_exp_nd_est_did15,tot_exp_nd_est_did17,
                                tot_exp_nd_est_did19,tot_exp_nd_est_did21,tot_exp_nd_est_did23,
                                tot_exp_nd_est_did24,tot_exp_nd_est_did25,tot_exp_nd_est_did26,
                                tot_exp_nd_est_did28,tot_exp_nd_est_did29,tot_exp_nd_est_did30,
                                tot_exp_nd_est_did31,tot_exp_nd_est_did32,tot_exp_nd_est_did33,
                                tot_exp_nd_est_did34,tot_exp_nd_est_did36,tot_exp_nd_est_did37,
                                tot_exp_nd_est_did39,tot_exp_nd_est_did40,tot_exp_nd_est_did41,
                                tot_exp_nd_est_did44,tot_exp_nd_est_did45,tot_exp_nd_est_did47,
                                tot_exp_nd_est_did50,tot_exp_nd_est_did51,tot_exp_nd_est_did53,
                                tot_exp_nd_est_did54,tot_exp_nd_est_did55)
rm(tot_exp_nd_est_did1,tot_exp_nd_est_did2,tot_exp_nd_est_did5,
   tot_exp_nd_est_did10,tot_exp_nd_est_did11,tot_exp_nd_est_did12,
   tot_exp_nd_est_did13,tot_exp_nd_est_did15,tot_exp_nd_est_did17,
   tot_exp_nd_est_did19,tot_exp_nd_est_did21,tot_exp_nd_est_did23,
   tot_exp_nd_est_did24,tot_exp_nd_est_did25,tot_exp_nd_est_did26,
   tot_exp_nd_est_did28,tot_exp_nd_est_did29,tot_exp_nd_est_did30,
   tot_exp_nd_est_did31,tot_exp_nd_est_did32,tot_exp_nd_est_did33,
   tot_exp_nd_est_did34,tot_exp_nd_est_did36,tot_exp_nd_est_did37,
   tot_exp_nd_est_did39,tot_exp_nd_est_did40,tot_exp_nd_est_did41,
   tot_exp_nd_est_did44,tot_exp_nd_est_did45,tot_exp_nd_est_did47,
   tot_exp_nd_est_did50,tot_exp_nd_est_did51,tot_exp_nd_est_did53,
   tot_exp_nd_est_did54,tot_exp_nd_est_did55)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_did_plot", i), synthdid_plot(tot_exp_nd_est_did_list[i]))
}
tot_exp_nd_est_did_plot_data_aux1 <- ggplot_build(tot_exp_nd_est_did_plot1)
tot_exp_nd_est_did_plot_data_aux2 <- ggplot_build(tot_exp_nd_est_did_plot2)
tot_exp_nd_est_did_plot_data_aux3 <- ggplot_build(tot_exp_nd_est_did_plot3)
tot_exp_nd_est_did_plot_data_aux4 <- ggplot_build(tot_exp_nd_est_did_plot4)
tot_exp_nd_est_did_plot_data_aux5 <- ggplot_build(tot_exp_nd_est_did_plot5)
tot_exp_nd_est_did_plot_data_aux6 <- ggplot_build(tot_exp_nd_est_did_plot6)
tot_exp_nd_est_did_plot_data_aux7 <- ggplot_build(tot_exp_nd_est_did_plot7)
tot_exp_nd_est_did_plot_data_aux8 <- ggplot_build(tot_exp_nd_est_did_plot8)
tot_exp_nd_est_did_plot_data_aux9 <- ggplot_build(tot_exp_nd_est_did_plot9)
tot_exp_nd_est_did_plot_data_aux10 <- ggplot_build(tot_exp_nd_est_did_plot10)
tot_exp_nd_est_did_plot_data_aux11 <- ggplot_build(tot_exp_nd_est_did_plot11)
tot_exp_nd_est_did_plot_data_aux12 <- ggplot_build(tot_exp_nd_est_did_plot12)
tot_exp_nd_est_did_plot_data_aux13 <- ggplot_build(tot_exp_nd_est_did_plot13)
tot_exp_nd_est_did_plot_data_aux14 <- ggplot_build(tot_exp_nd_est_did_plot14)
tot_exp_nd_est_did_plot_data_aux15 <- ggplot_build(tot_exp_nd_est_did_plot15)
tot_exp_nd_est_did_plot_data_aux16 <- ggplot_build(tot_exp_nd_est_did_plot16)
tot_exp_nd_est_did_plot_data_aux17 <- ggplot_build(tot_exp_nd_est_did_plot17)
tot_exp_nd_est_did_plot_data_aux18 <- ggplot_build(tot_exp_nd_est_did_plot18)
tot_exp_nd_est_did_plot_data_aux19 <- ggplot_build(tot_exp_nd_est_did_plot19)
tot_exp_nd_est_did_plot_data_aux20 <- ggplot_build(tot_exp_nd_est_did_plot20)
tot_exp_nd_est_did_plot_data_aux21 <- ggplot_build(tot_exp_nd_est_did_plot21)
tot_exp_nd_est_did_plot_data_aux22 <- ggplot_build(tot_exp_nd_est_did_plot22)
tot_exp_nd_est_did_plot_data_aux23 <- ggplot_build(tot_exp_nd_est_did_plot23)
tot_exp_nd_est_did_plot_data_aux24 <- ggplot_build(tot_exp_nd_est_did_plot24)
tot_exp_nd_est_did_plot_data_aux25 <- ggplot_build(tot_exp_nd_est_did_plot25)
tot_exp_nd_est_did_plot_data_aux26 <- ggplot_build(tot_exp_nd_est_did_plot26)
tot_exp_nd_est_did_plot_data_aux27 <- ggplot_build(tot_exp_nd_est_did_plot27)
tot_exp_nd_est_did_plot_data_aux28 <- ggplot_build(tot_exp_nd_est_did_plot28)
tot_exp_nd_est_did_plot_data_aux29 <- ggplot_build(tot_exp_nd_est_did_plot29)
tot_exp_nd_est_did_plot_data_aux30 <- ggplot_build(tot_exp_nd_est_did_plot30)
tot_exp_nd_est_did_plot_data_aux31 <- ggplot_build(tot_exp_nd_est_did_plot31)
tot_exp_nd_est_did_plot_data_aux32 <- ggplot_build(tot_exp_nd_est_did_plot32)
tot_exp_nd_est_did_plot_data_aux33 <- ggplot_build(tot_exp_nd_est_did_plot33)
tot_exp_nd_est_did_plot_data_aux34 <- ggplot_build(tot_exp_nd_est_did_plot34)
tot_exp_nd_est_did_plot_data_aux35 <- ggplot_build(tot_exp_nd_est_did_plot35)
tot_exp_nd_est_did_plot_data_aux_list <- list(tot_exp_nd_est_did_plot_data_aux1,tot_exp_nd_est_did_plot_data_aux2,tot_exp_nd_est_did_plot_data_aux3,
                                              tot_exp_nd_est_did_plot_data_aux4,tot_exp_nd_est_did_plot_data_aux5,tot_exp_nd_est_did_plot_data_aux6,
                                              tot_exp_nd_est_did_plot_data_aux7,tot_exp_nd_est_did_plot_data_aux8,tot_exp_nd_est_did_plot_data_aux9,
                                              tot_exp_nd_est_did_plot_data_aux10,tot_exp_nd_est_did_plot_data_aux11,tot_exp_nd_est_did_plot_data_aux12,
                                              tot_exp_nd_est_did_plot_data_aux13,tot_exp_nd_est_did_plot_data_aux14,tot_exp_nd_est_did_plot_data_aux15,
                                              tot_exp_nd_est_did_plot_data_aux16,tot_exp_nd_est_did_plot_data_aux17,tot_exp_nd_est_did_plot_data_aux18,
                                              tot_exp_nd_est_did_plot_data_aux19,tot_exp_nd_est_did_plot_data_aux20,tot_exp_nd_est_did_plot_data_aux21,
                                              tot_exp_nd_est_did_plot_data_aux22,tot_exp_nd_est_did_plot_data_aux23,tot_exp_nd_est_did_plot_data_aux24,
                                              tot_exp_nd_est_did_plot_data_aux25,tot_exp_nd_est_did_plot_data_aux26,tot_exp_nd_est_did_plot_data_aux27,
                                              tot_exp_nd_est_did_plot_data_aux28,tot_exp_nd_est_did_plot_data_aux29,tot_exp_nd_est_did_plot_data_aux30,
                                              tot_exp_nd_est_did_plot_data_aux31,tot_exp_nd_est_did_plot_data_aux32,tot_exp_nd_est_did_plot_data_aux33,
                                              tot_exp_nd_est_did_plot_data_aux34,tot_exp_nd_est_did_plot_data_aux35)
rm(tot_exp_nd_est_did_plot_data_aux1,tot_exp_nd_est_did_plot_data_aux2,tot_exp_nd_est_did_plot_data_aux3,
   tot_exp_nd_est_did_plot_data_aux4,tot_exp_nd_est_did_plot_data_aux5,tot_exp_nd_est_did_plot_data_aux6,
   tot_exp_nd_est_did_plot_data_aux7,tot_exp_nd_est_did_plot_data_aux8,tot_exp_nd_est_did_plot_data_aux9,
   tot_exp_nd_est_did_plot_data_aux10,tot_exp_nd_est_did_plot_data_aux11,tot_exp_nd_est_did_plot_data_aux12,
   tot_exp_nd_est_did_plot_data_aux13,tot_exp_nd_est_did_plot_data_aux14,tot_exp_nd_est_did_plot_data_aux15,
   tot_exp_nd_est_did_plot_data_aux16,tot_exp_nd_est_did_plot_data_aux17,tot_exp_nd_est_did_plot_data_aux18,
   tot_exp_nd_est_did_plot_data_aux19,tot_exp_nd_est_did_plot_data_aux20,tot_exp_nd_est_did_plot_data_aux21,
   tot_exp_nd_est_did_plot_data_aux22,tot_exp_nd_est_did_plot_data_aux23,tot_exp_nd_est_did_plot_data_aux24,
   tot_exp_nd_est_did_plot_data_aux25,tot_exp_nd_est_did_plot_data_aux26,tot_exp_nd_est_did_plot_data_aux27,
   tot_exp_nd_est_did_plot_data_aux28,tot_exp_nd_est_did_plot_data_aux29,tot_exp_nd_est_did_plot_data_aux30,
   tot_exp_nd_est_did_plot_data_aux31,tot_exp_nd_est_did_plot_data_aux32,tot_exp_nd_est_did_plot_data_aux33,
   tot_exp_nd_est_did_plot_data_aux34,tot_exp_nd_est_did_plot_data_aux35)
rm(tot_exp_nd_est_did_plot1,tot_exp_nd_est_did_plot2,tot_exp_nd_est_did_plot3,
   tot_exp_nd_est_did_plot4,tot_exp_nd_est_did_plot5,tot_exp_nd_est_did_plot6,
   tot_exp_nd_est_did_plot7,tot_exp_nd_est_did_plot8,tot_exp_nd_est_did_plot9,
   tot_exp_nd_est_did_plot10,tot_exp_nd_est_did_plot11,tot_exp_nd_est_did_plot12,
   tot_exp_nd_est_did_plot13,tot_exp_nd_est_did_plot14,tot_exp_nd_est_did_plot15,
   tot_exp_nd_est_did_plot16,tot_exp_nd_est_did_plot17,tot_exp_nd_est_did_plot18,
   tot_exp_nd_est_did_plot19,tot_exp_nd_est_did_plot20,tot_exp_nd_est_did_plot21,
   tot_exp_nd_est_did_plot22,tot_exp_nd_est_did_plot23,tot_exp_nd_est_did_plot24,
   tot_exp_nd_est_did_plot25,tot_exp_nd_est_did_plot26,tot_exp_nd_est_did_plot27,
   tot_exp_nd_est_did_plot28,tot_exp_nd_est_did_plot29,tot_exp_nd_est_did_plot30,
   tot_exp_nd_est_did_plot31,tot_exp_nd_est_did_plot32,tot_exp_nd_est_did_plot33,
   tot_exp_nd_est_did_plot34,tot_exp_nd_est_did_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_did_plot_data_long", i), data.frame(tot_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_nd_est_did_plot_data_long_list <- list(tot_exp_nd_est_did_plot_data_long1,tot_exp_nd_est_did_plot_data_long2,tot_exp_nd_est_did_plot_data_long3,
                                               tot_exp_nd_est_did_plot_data_long4,tot_exp_nd_est_did_plot_data_long5,tot_exp_nd_est_did_plot_data_long6,
                                               tot_exp_nd_est_did_plot_data_long7,tot_exp_nd_est_did_plot_data_long8,tot_exp_nd_est_did_plot_data_long9,
                                               tot_exp_nd_est_did_plot_data_long10,tot_exp_nd_est_did_plot_data_long11,tot_exp_nd_est_did_plot_data_long12,
                                               tot_exp_nd_est_did_plot_data_long13,tot_exp_nd_est_did_plot_data_long14,tot_exp_nd_est_did_plot_data_long15,
                                               tot_exp_nd_est_did_plot_data_long16,tot_exp_nd_est_did_plot_data_long17,tot_exp_nd_est_did_plot_data_long18,
                                               tot_exp_nd_est_did_plot_data_long19,tot_exp_nd_est_did_plot_data_long20,tot_exp_nd_est_did_plot_data_long21,
                                               tot_exp_nd_est_did_plot_data_long22,tot_exp_nd_est_did_plot_data_long23,tot_exp_nd_est_did_plot_data_long24,
                                               tot_exp_nd_est_did_plot_data_long25,tot_exp_nd_est_did_plot_data_long26,tot_exp_nd_est_did_plot_data_long27,
                                               tot_exp_nd_est_did_plot_data_long28,tot_exp_nd_est_did_plot_data_long29,tot_exp_nd_est_did_plot_data_long30,
                                               tot_exp_nd_est_did_plot_data_long31,tot_exp_nd_est_did_plot_data_long32,tot_exp_nd_est_did_plot_data_long33,
                                               tot_exp_nd_est_did_plot_data_long34,tot_exp_nd_est_did_plot_data_long35)
rm(tot_exp_nd_est_did_plot_data_long1,tot_exp_nd_est_did_plot_data_long2,tot_exp_nd_est_did_plot_data_long3,
   tot_exp_nd_est_did_plot_data_long4,tot_exp_nd_est_did_plot_data_long5,tot_exp_nd_est_did_plot_data_long6,
   tot_exp_nd_est_did_plot_data_long7,tot_exp_nd_est_did_plot_data_long8,tot_exp_nd_est_did_plot_data_long9,
   tot_exp_nd_est_did_plot_data_long10,tot_exp_nd_est_did_plot_data_long11,tot_exp_nd_est_did_plot_data_long12,
   tot_exp_nd_est_did_plot_data_long13,tot_exp_nd_est_did_plot_data_long14,tot_exp_nd_est_did_plot_data_long15,
   tot_exp_nd_est_did_plot_data_long16,tot_exp_nd_est_did_plot_data_long17,tot_exp_nd_est_did_plot_data_long18,
   tot_exp_nd_est_did_plot_data_long19,tot_exp_nd_est_did_plot_data_long20,tot_exp_nd_est_did_plot_data_long21,
   tot_exp_nd_est_did_plot_data_long22,tot_exp_nd_est_did_plot_data_long23,tot_exp_nd_est_did_plot_data_long24,
   tot_exp_nd_est_did_plot_data_long25,tot_exp_nd_est_did_plot_data_long26,tot_exp_nd_est_did_plot_data_long27,
   tot_exp_nd_est_did_plot_data_long28,tot_exp_nd_est_did_plot_data_long29,tot_exp_nd_est_did_plot_data_long30,
   tot_exp_nd_est_did_plot_data_long31,tot_exp_nd_est_did_plot_data_long32,tot_exp_nd_est_did_plot_data_long33,
   tot_exp_nd_est_did_plot_data_long34,tot_exp_nd_est_did_plot_data_long35)
tot_exp_nd_est_did_plot_data_long_list <- lapply(tot_exp_nd_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_did_plot_data_wide", i), reshape(data=tot_exp_nd_est_did_plot_data_long_list[[i]],
                                                                 idvar = "year",
                                                                 v.names = "outcome",
                                                                 timevar = "treated",
                                                                 direction = "wide"))
}
tot_exp_nd_est_did_plot_data_wide_list <- list(tot_exp_nd_est_did_plot_data_wide1,tot_exp_nd_est_did_plot_data_wide2,tot_exp_nd_est_did_plot_data_wide3,
                                               tot_exp_nd_est_did_plot_data_wide4,tot_exp_nd_est_did_plot_data_wide5,tot_exp_nd_est_did_plot_data_wide6,
                                               tot_exp_nd_est_did_plot_data_wide7,tot_exp_nd_est_did_plot_data_wide8,tot_exp_nd_est_did_plot_data_wide9,
                                               tot_exp_nd_est_did_plot_data_wide10,tot_exp_nd_est_did_plot_data_wide11,tot_exp_nd_est_did_plot_data_wide12,
                                               tot_exp_nd_est_did_plot_data_wide13,tot_exp_nd_est_did_plot_data_wide14,tot_exp_nd_est_did_plot_data_wide15,
                                               tot_exp_nd_est_did_plot_data_wide16,tot_exp_nd_est_did_plot_data_wide17,tot_exp_nd_est_did_plot_data_wide18,
                                               tot_exp_nd_est_did_plot_data_wide19,tot_exp_nd_est_did_plot_data_wide20,tot_exp_nd_est_did_plot_data_wide21,
                                               tot_exp_nd_est_did_plot_data_wide22,tot_exp_nd_est_did_plot_data_wide23,tot_exp_nd_est_did_plot_data_wide24,
                                               tot_exp_nd_est_did_plot_data_wide25,tot_exp_nd_est_did_plot_data_wide26,tot_exp_nd_est_did_plot_data_wide27,
                                               tot_exp_nd_est_did_plot_data_wide28,tot_exp_nd_est_did_plot_data_wide29,tot_exp_nd_est_did_plot_data_wide30,
                                               tot_exp_nd_est_did_plot_data_wide31,tot_exp_nd_est_did_plot_data_wide32,tot_exp_nd_est_did_plot_data_wide33,
                                               tot_exp_nd_est_did_plot_data_wide34,tot_exp_nd_est_did_plot_data_wide35)
rm(tot_exp_nd_est_did_plot_data_wide1,tot_exp_nd_est_did_plot_data_wide2,tot_exp_nd_est_did_plot_data_wide3,
   tot_exp_nd_est_did_plot_data_wide4,tot_exp_nd_est_did_plot_data_wide5,tot_exp_nd_est_did_plot_data_wide6,
   tot_exp_nd_est_did_plot_data_wide7,tot_exp_nd_est_did_plot_data_wide8,tot_exp_nd_est_did_plot_data_wide9,
   tot_exp_nd_est_did_plot_data_wide10,tot_exp_nd_est_did_plot_data_wide11,tot_exp_nd_est_did_plot_data_wide12,
   tot_exp_nd_est_did_plot_data_wide13,tot_exp_nd_est_did_plot_data_wide14,tot_exp_nd_est_did_plot_data_wide15,
   tot_exp_nd_est_did_plot_data_wide16,tot_exp_nd_est_did_plot_data_wide17,tot_exp_nd_est_did_plot_data_wide18,
   tot_exp_nd_est_did_plot_data_wide19,tot_exp_nd_est_did_plot_data_wide20,tot_exp_nd_est_did_plot_data_wide21,
   tot_exp_nd_est_did_plot_data_wide22,tot_exp_nd_est_did_plot_data_wide23,tot_exp_nd_est_did_plot_data_wide24,
   tot_exp_nd_est_did_plot_data_wide25,tot_exp_nd_est_did_plot_data_wide26,tot_exp_nd_est_did_plot_data_wide27,
   tot_exp_nd_est_did_plot_data_wide28,tot_exp_nd_est_did_plot_data_wide29,tot_exp_nd_est_did_plot_data_wide30,
   tot_exp_nd_est_did_plot_data_wide31,tot_exp_nd_est_did_plot_data_wide32,tot_exp_nd_est_did_plot_data_wide33,
   tot_exp_nd_est_did_plot_data_wide34,tot_exp_nd_est_did_plot_data_wide35)
tot_exp_nd_est_did_plot_data_wide_list <- lapply(tot_exp_nd_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
tot_exp_nd_est_sc1 <- sc_estimate(setup_tot_exp_nd_list[[1]]$Y, setup_tot_exp_nd_list[[1]]$N0, setup_tot_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_nd_est_sc2 <- sc_estimate(setup_tot_exp_nd_list[[2]]$Y, setup_tot_exp_nd_list[[2]]$N0, setup_tot_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_nd_est_sc5 <- sc_estimate(setup_tot_exp_nd_list[[3]]$Y, setup_tot_exp_nd_list[[3]]$N0, setup_tot_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_nd_est_sc10 <- sc_estimate(setup_tot_exp_nd_list[[4]]$Y, setup_tot_exp_nd_list[[4]]$N0, setup_tot_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_nd_est_sc11 <- sc_estimate(setup_tot_exp_nd_list[[5]]$Y, setup_tot_exp_nd_list[[5]]$N0, setup_tot_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_nd_est_sc12 <- sc_estimate(setup_tot_exp_nd_list[[6]]$Y, setup_tot_exp_nd_list[[6]]$N0, setup_tot_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_nd_est_sc13 <- sc_estimate(setup_tot_exp_nd_list[[7]]$Y, setup_tot_exp_nd_list[[7]]$N0, setup_tot_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_nd_est_sc15 <- sc_estimate(setup_tot_exp_nd_list[[8]]$Y, setup_tot_exp_nd_list[[8]]$N0, setup_tot_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_nd_est_sc17 <- sc_estimate(setup_tot_exp_nd_list[[9]]$Y, setup_tot_exp_nd_list[[9]]$N0, setup_tot_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_nd_est_sc19 <- sc_estimate(setup_tot_exp_nd_list[[10]]$Y, setup_tot_exp_nd_list[[10]]$N0, setup_tot_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_nd_est_sc21 <- sc_estimate(setup_tot_exp_nd_list[[11]]$Y, setup_tot_exp_nd_list[[11]]$N0, setup_tot_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_nd_est_sc23 <- sc_estimate(setup_tot_exp_nd_list[[12]]$Y, setup_tot_exp_nd_list[[12]]$N0, setup_tot_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_nd_est_sc24 <- sc_estimate(setup_tot_exp_nd_list[[13]]$Y, setup_tot_exp_nd_list[[13]]$N0, setup_tot_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_nd_est_sc25 <- sc_estimate(setup_tot_exp_nd_list[[14]]$Y, setup_tot_exp_nd_list[[14]]$N0, setup_tot_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_nd_est_sc26 <- sc_estimate(setup_tot_exp_nd_list[[15]]$Y, setup_tot_exp_nd_list[[15]]$N0, setup_tot_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_nd_est_sc28 <- sc_estimate(setup_tot_exp_nd_list[[16]]$Y, setup_tot_exp_nd_list[[16]]$N0, setup_tot_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_nd_est_sc29 <- sc_estimate(setup_tot_exp_nd_list[[17]]$Y, setup_tot_exp_nd_list[[17]]$N0, setup_tot_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_nd_est_sc30 <- sc_estimate(setup_tot_exp_nd_list[[18]]$Y, setup_tot_exp_nd_list[[18]]$N0, setup_tot_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_nd_est_sc31 <- sc_estimate(setup_tot_exp_nd_list[[19]]$Y, setup_tot_exp_nd_list[[19]]$N0, setup_tot_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_nd_est_sc32 <- sc_estimate(setup_tot_exp_nd_list[[20]]$Y, setup_tot_exp_nd_list[[20]]$N0, setup_tot_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_nd_est_sc33 <- sc_estimate(setup_tot_exp_nd_list[[21]]$Y, setup_tot_exp_nd_list[[21]]$N0, setup_tot_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_nd_est_sc34 <- sc_estimate(setup_tot_exp_nd_list[[22]]$Y, setup_tot_exp_nd_list[[22]]$N0, setup_tot_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_nd_est_sc36 <- sc_estimate(setup_tot_exp_nd_list[[23]]$Y, setup_tot_exp_nd_list[[23]]$N0, setup_tot_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_nd_est_sc37 <- sc_estimate(setup_tot_exp_nd_list[[24]]$Y, setup_tot_exp_nd_list[[24]]$N0, setup_tot_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_nd_est_sc39 <- sc_estimate(setup_tot_exp_nd_list[[25]]$Y, setup_tot_exp_nd_list[[25]]$N0, setup_tot_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_nd_est_sc40 <- sc_estimate(setup_tot_exp_nd_list[[26]]$Y, setup_tot_exp_nd_list[[26]]$N0, setup_tot_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_nd_est_sc41 <- sc_estimate(setup_tot_exp_nd_list[[27]]$Y, setup_tot_exp_nd_list[[27]]$N0, setup_tot_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_nd_est_sc44 <- sc_estimate(setup_tot_exp_nd_list[[28]]$Y, setup_tot_exp_nd_list[[28]]$N0, setup_tot_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_nd_est_sc45 <- sc_estimate(setup_tot_exp_nd_list[[29]]$Y, setup_tot_exp_nd_list[[29]]$N0, setup_tot_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_nd_est_sc47 <- sc_estimate(setup_tot_exp_nd_list[[30]]$Y, setup_tot_exp_nd_list[[30]]$N0, setup_tot_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_nd_est_sc50 <- sc_estimate(setup_tot_exp_nd_list[[31]]$Y, setup_tot_exp_nd_list[[31]]$N0, setup_tot_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_nd_est_sc51 <- sc_estimate(setup_tot_exp_nd_list[[32]]$Y, setup_tot_exp_nd_list[[32]]$N0, setup_tot_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_nd_est_sc53 <- sc_estimate(setup_tot_exp_nd_list[[33]]$Y, setup_tot_exp_nd_list[[33]]$N0, setup_tot_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_nd_est_sc54 <- sc_estimate(setup_tot_exp_nd_list[[34]]$Y, setup_tot_exp_nd_list[[34]]$N0, setup_tot_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_nd_est_sc55 <- sc_estimate(setup_tot_exp_nd_list[[35]]$Y, setup_tot_exp_nd_list[[35]]$N0, setup_tot_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_nd_est_sc_list <- list(tot_exp_nd_est_sc1,tot_exp_nd_est_sc2,tot_exp_nd_est_sc5,
                               tot_exp_nd_est_sc10,tot_exp_nd_est_sc11,tot_exp_nd_est_sc12,
                               tot_exp_nd_est_sc13,tot_exp_nd_est_sc15,tot_exp_nd_est_sc17,
                               tot_exp_nd_est_sc19,tot_exp_nd_est_sc21,tot_exp_nd_est_sc23,
                               tot_exp_nd_est_sc24,tot_exp_nd_est_sc25,tot_exp_nd_est_sc26,
                               tot_exp_nd_est_sc28,tot_exp_nd_est_sc29,tot_exp_nd_est_sc30,
                               tot_exp_nd_est_sc31,tot_exp_nd_est_sc32,tot_exp_nd_est_sc33,
                               tot_exp_nd_est_sc34,tot_exp_nd_est_sc36,tot_exp_nd_est_sc37,
                               tot_exp_nd_est_sc39,tot_exp_nd_est_sc40,tot_exp_nd_est_sc41,
                               tot_exp_nd_est_sc44,tot_exp_nd_est_sc45,tot_exp_nd_est_sc47,
                               tot_exp_nd_est_sc50,tot_exp_nd_est_sc51,tot_exp_nd_est_sc53,
                               tot_exp_nd_est_sc54,tot_exp_nd_est_sc55)
rm(tot_exp_nd_est_sc1,tot_exp_nd_est_sc2,tot_exp_nd_est_sc5,
   tot_exp_nd_est_sc10,tot_exp_nd_est_sc11,tot_exp_nd_est_sc12,
   tot_exp_nd_est_sc13,tot_exp_nd_est_sc15,tot_exp_nd_est_sc17,
   tot_exp_nd_est_sc19,tot_exp_nd_est_sc21,tot_exp_nd_est_sc23,
   tot_exp_nd_est_sc24,tot_exp_nd_est_sc25,tot_exp_nd_est_sc26,
   tot_exp_nd_est_sc28,tot_exp_nd_est_sc29,tot_exp_nd_est_sc30,
   tot_exp_nd_est_sc31,tot_exp_nd_est_sc32,tot_exp_nd_est_sc33,
   tot_exp_nd_est_sc34,tot_exp_nd_est_sc36,tot_exp_nd_est_sc37,
   tot_exp_nd_est_sc39,tot_exp_nd_est_sc40,tot_exp_nd_est_sc41,
   tot_exp_nd_est_sc44,tot_exp_nd_est_sc45,tot_exp_nd_est_sc47,
   tot_exp_nd_est_sc50,tot_exp_nd_est_sc51,tot_exp_nd_est_sc53,
   tot_exp_nd_est_sc54,tot_exp_nd_est_sc55)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sc_plot", i), synthdid_plot(tot_exp_nd_est_sc_list[i]))
}
tot_exp_nd_est_sc_plot_data_aux1 <- ggplot_build(tot_exp_nd_est_sc_plot1)
tot_exp_nd_est_sc_plot_data_aux2 <- ggplot_build(tot_exp_nd_est_sc_plot2)
tot_exp_nd_est_sc_plot_data_aux3 <- ggplot_build(tot_exp_nd_est_sc_plot3)
tot_exp_nd_est_sc_plot_data_aux4 <- ggplot_build(tot_exp_nd_est_sc_plot4)
tot_exp_nd_est_sc_plot_data_aux5 <- ggplot_build(tot_exp_nd_est_sc_plot5)
tot_exp_nd_est_sc_plot_data_aux6 <- ggplot_build(tot_exp_nd_est_sc_plot6)
tot_exp_nd_est_sc_plot_data_aux7 <- ggplot_build(tot_exp_nd_est_sc_plot7)
tot_exp_nd_est_sc_plot_data_aux8 <- ggplot_build(tot_exp_nd_est_sc_plot8)
tot_exp_nd_est_sc_plot_data_aux9 <- ggplot_build(tot_exp_nd_est_sc_plot9)
tot_exp_nd_est_sc_plot_data_aux10 <- ggplot_build(tot_exp_nd_est_sc_plot10)
tot_exp_nd_est_sc_plot_data_aux11 <- ggplot_build(tot_exp_nd_est_sc_plot11)
tot_exp_nd_est_sc_plot_data_aux12 <- ggplot_build(tot_exp_nd_est_sc_plot12)
tot_exp_nd_est_sc_plot_data_aux13 <- ggplot_build(tot_exp_nd_est_sc_plot13)
tot_exp_nd_est_sc_plot_data_aux14 <- ggplot_build(tot_exp_nd_est_sc_plot14)
tot_exp_nd_est_sc_plot_data_aux15 <- ggplot_build(tot_exp_nd_est_sc_plot15)
tot_exp_nd_est_sc_plot_data_aux16 <- ggplot_build(tot_exp_nd_est_sc_plot16)
tot_exp_nd_est_sc_plot_data_aux17 <- ggplot_build(tot_exp_nd_est_sc_plot17)
tot_exp_nd_est_sc_plot_data_aux18 <- ggplot_build(tot_exp_nd_est_sc_plot18)
tot_exp_nd_est_sc_plot_data_aux19 <- ggplot_build(tot_exp_nd_est_sc_plot19)
tot_exp_nd_est_sc_plot_data_aux20 <- ggplot_build(tot_exp_nd_est_sc_plot20)
tot_exp_nd_est_sc_plot_data_aux21 <- ggplot_build(tot_exp_nd_est_sc_plot21)
tot_exp_nd_est_sc_plot_data_aux22 <- ggplot_build(tot_exp_nd_est_sc_plot22)
tot_exp_nd_est_sc_plot_data_aux23 <- ggplot_build(tot_exp_nd_est_sc_plot23)
tot_exp_nd_est_sc_plot_data_aux24 <- ggplot_build(tot_exp_nd_est_sc_plot24)
tot_exp_nd_est_sc_plot_data_aux25 <- ggplot_build(tot_exp_nd_est_sc_plot25)
tot_exp_nd_est_sc_plot_data_aux26 <- ggplot_build(tot_exp_nd_est_sc_plot26)
tot_exp_nd_est_sc_plot_data_aux27 <- ggplot_build(tot_exp_nd_est_sc_plot27)
tot_exp_nd_est_sc_plot_data_aux28 <- ggplot_build(tot_exp_nd_est_sc_plot28)
tot_exp_nd_est_sc_plot_data_aux29 <- ggplot_build(tot_exp_nd_est_sc_plot29)
tot_exp_nd_est_sc_plot_data_aux30 <- ggplot_build(tot_exp_nd_est_sc_plot30)
tot_exp_nd_est_sc_plot_data_aux31 <- ggplot_build(tot_exp_nd_est_sc_plot31)
tot_exp_nd_est_sc_plot_data_aux32 <- ggplot_build(tot_exp_nd_est_sc_plot32)
tot_exp_nd_est_sc_plot_data_aux33 <- ggplot_build(tot_exp_nd_est_sc_plot33)
tot_exp_nd_est_sc_plot_data_aux34 <- ggplot_build(tot_exp_nd_est_sc_plot34)
tot_exp_nd_est_sc_plot_data_aux35 <- ggplot_build(tot_exp_nd_est_sc_plot35)
tot_exp_nd_est_sc_plot_data_aux_list <- list(tot_exp_nd_est_sc_plot_data_aux1,tot_exp_nd_est_sc_plot_data_aux2,tot_exp_nd_est_sc_plot_data_aux3,
                                             tot_exp_nd_est_sc_plot_data_aux4,tot_exp_nd_est_sc_plot_data_aux5,tot_exp_nd_est_sc_plot_data_aux6,
                                             tot_exp_nd_est_sc_plot_data_aux7,tot_exp_nd_est_sc_plot_data_aux8,tot_exp_nd_est_sc_plot_data_aux9,
                                             tot_exp_nd_est_sc_plot_data_aux10,tot_exp_nd_est_sc_plot_data_aux11,tot_exp_nd_est_sc_plot_data_aux12,
                                             tot_exp_nd_est_sc_plot_data_aux13,tot_exp_nd_est_sc_plot_data_aux14,tot_exp_nd_est_sc_plot_data_aux15,
                                             tot_exp_nd_est_sc_plot_data_aux16,tot_exp_nd_est_sc_plot_data_aux17,tot_exp_nd_est_sc_plot_data_aux18,
                                             tot_exp_nd_est_sc_plot_data_aux19,tot_exp_nd_est_sc_plot_data_aux20,tot_exp_nd_est_sc_plot_data_aux21,
                                             tot_exp_nd_est_sc_plot_data_aux22,tot_exp_nd_est_sc_plot_data_aux23,tot_exp_nd_est_sc_plot_data_aux24,
                                             tot_exp_nd_est_sc_plot_data_aux25,tot_exp_nd_est_sc_plot_data_aux26,tot_exp_nd_est_sc_plot_data_aux27,
                                             tot_exp_nd_est_sc_plot_data_aux28,tot_exp_nd_est_sc_plot_data_aux29,tot_exp_nd_est_sc_plot_data_aux30,
                                             tot_exp_nd_est_sc_plot_data_aux31,tot_exp_nd_est_sc_plot_data_aux32,tot_exp_nd_est_sc_plot_data_aux33,
                                             tot_exp_nd_est_sc_plot_data_aux34,tot_exp_nd_est_sc_plot_data_aux35)
rm(tot_exp_nd_est_sc_plot_data_aux1,tot_exp_nd_est_sc_plot_data_aux2,tot_exp_nd_est_sc_plot_data_aux3,
   tot_exp_nd_est_sc_plot_data_aux4,tot_exp_nd_est_sc_plot_data_aux5,tot_exp_nd_est_sc_plot_data_aux6,
   tot_exp_nd_est_sc_plot_data_aux7,tot_exp_nd_est_sc_plot_data_aux8,tot_exp_nd_est_sc_plot_data_aux9,
   tot_exp_nd_est_sc_plot_data_aux10,tot_exp_nd_est_sc_plot_data_aux11,tot_exp_nd_est_sc_plot_data_aux12,
   tot_exp_nd_est_sc_plot_data_aux13,tot_exp_nd_est_sc_plot_data_aux14,tot_exp_nd_est_sc_plot_data_aux15,
   tot_exp_nd_est_sc_plot_data_aux16,tot_exp_nd_est_sc_plot_data_aux17,tot_exp_nd_est_sc_plot_data_aux18,
   tot_exp_nd_est_sc_plot_data_aux19,tot_exp_nd_est_sc_plot_data_aux20,tot_exp_nd_est_sc_plot_data_aux21,
   tot_exp_nd_est_sc_plot_data_aux22,tot_exp_nd_est_sc_plot_data_aux23,tot_exp_nd_est_sc_plot_data_aux24,
   tot_exp_nd_est_sc_plot_data_aux25,tot_exp_nd_est_sc_plot_data_aux26,tot_exp_nd_est_sc_plot_data_aux27,
   tot_exp_nd_est_sc_plot_data_aux28,tot_exp_nd_est_sc_plot_data_aux29,tot_exp_nd_est_sc_plot_data_aux30,
   tot_exp_nd_est_sc_plot_data_aux31,tot_exp_nd_est_sc_plot_data_aux32,tot_exp_nd_est_sc_plot_data_aux33,
   tot_exp_nd_est_sc_plot_data_aux34,tot_exp_nd_est_sc_plot_data_aux35)
rm(tot_exp_nd_est_sc_plot1,tot_exp_nd_est_sc_plot2,tot_exp_nd_est_sc_plot3,
   tot_exp_nd_est_sc_plot4,tot_exp_nd_est_sc_plot5,tot_exp_nd_est_sc_plot6,
   tot_exp_nd_est_sc_plot7,tot_exp_nd_est_sc_plot8,tot_exp_nd_est_sc_plot9,
   tot_exp_nd_est_sc_plot10,tot_exp_nd_est_sc_plot11,tot_exp_nd_est_sc_plot12,
   tot_exp_nd_est_sc_plot13,tot_exp_nd_est_sc_plot14,tot_exp_nd_est_sc_plot15,
   tot_exp_nd_est_sc_plot16,tot_exp_nd_est_sc_plot17,tot_exp_nd_est_sc_plot18,
   tot_exp_nd_est_sc_plot19,tot_exp_nd_est_sc_plot20,tot_exp_nd_est_sc_plot21,
   tot_exp_nd_est_sc_plot22,tot_exp_nd_est_sc_plot23,tot_exp_nd_est_sc_plot24,
   tot_exp_nd_est_sc_plot25,tot_exp_nd_est_sc_plot26,tot_exp_nd_est_sc_plot27,
   tot_exp_nd_est_sc_plot28,tot_exp_nd_est_sc_plot29,tot_exp_nd_est_sc_plot30,
   tot_exp_nd_est_sc_plot31,tot_exp_nd_est_sc_plot32,tot_exp_nd_est_sc_plot33,
   tot_exp_nd_est_sc_plot34,tot_exp_nd_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sc_plot_data_long", i), data.frame(tot_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_nd_est_sc_plot_data_long_list <- list(tot_exp_nd_est_sc_plot_data_long1,tot_exp_nd_est_sc_plot_data_long2,tot_exp_nd_est_sc_plot_data_long3,
                                              tot_exp_nd_est_sc_plot_data_long4,tot_exp_nd_est_sc_plot_data_long5,tot_exp_nd_est_sc_plot_data_long6,
                                              tot_exp_nd_est_sc_plot_data_long7,tot_exp_nd_est_sc_plot_data_long8,tot_exp_nd_est_sc_plot_data_long9,
                                              tot_exp_nd_est_sc_plot_data_long10,tot_exp_nd_est_sc_plot_data_long11,tot_exp_nd_est_sc_plot_data_long12,
                                              tot_exp_nd_est_sc_plot_data_long13,tot_exp_nd_est_sc_plot_data_long14,tot_exp_nd_est_sc_plot_data_long15,
                                              tot_exp_nd_est_sc_plot_data_long16,tot_exp_nd_est_sc_plot_data_long17,tot_exp_nd_est_sc_plot_data_long18,
                                              tot_exp_nd_est_sc_plot_data_long19,tot_exp_nd_est_sc_plot_data_long20,tot_exp_nd_est_sc_plot_data_long21,
                                              tot_exp_nd_est_sc_plot_data_long22,tot_exp_nd_est_sc_plot_data_long23,tot_exp_nd_est_sc_plot_data_long24,
                                              tot_exp_nd_est_sc_plot_data_long25,tot_exp_nd_est_sc_plot_data_long26,tot_exp_nd_est_sc_plot_data_long27,
                                              tot_exp_nd_est_sc_plot_data_long28,tot_exp_nd_est_sc_plot_data_long29,tot_exp_nd_est_sc_plot_data_long30,
                                              tot_exp_nd_est_sc_plot_data_long31,tot_exp_nd_est_sc_plot_data_long32,tot_exp_nd_est_sc_plot_data_long33,
                                              tot_exp_nd_est_sc_plot_data_long34,tot_exp_nd_est_sc_plot_data_long35)
rm(tot_exp_nd_est_sc_plot_data_long1,tot_exp_nd_est_sc_plot_data_long2,tot_exp_nd_est_sc_plot_data_long3,
   tot_exp_nd_est_sc_plot_data_long4,tot_exp_nd_est_sc_plot_data_long5,tot_exp_nd_est_sc_plot_data_long6,
   tot_exp_nd_est_sc_plot_data_long7,tot_exp_nd_est_sc_plot_data_long8,tot_exp_nd_est_sc_plot_data_long9,
   tot_exp_nd_est_sc_plot_data_long10,tot_exp_nd_est_sc_plot_data_long11,tot_exp_nd_est_sc_plot_data_long12,
   tot_exp_nd_est_sc_plot_data_long13,tot_exp_nd_est_sc_plot_data_long14,tot_exp_nd_est_sc_plot_data_long15,
   tot_exp_nd_est_sc_plot_data_long16,tot_exp_nd_est_sc_plot_data_long17,tot_exp_nd_est_sc_plot_data_long18,
   tot_exp_nd_est_sc_plot_data_long19,tot_exp_nd_est_sc_plot_data_long20,tot_exp_nd_est_sc_plot_data_long21,
   tot_exp_nd_est_sc_plot_data_long22,tot_exp_nd_est_sc_plot_data_long23,tot_exp_nd_est_sc_plot_data_long24,
   tot_exp_nd_est_sc_plot_data_long25,tot_exp_nd_est_sc_plot_data_long26,tot_exp_nd_est_sc_plot_data_long27,
   tot_exp_nd_est_sc_plot_data_long28,tot_exp_nd_est_sc_plot_data_long29,tot_exp_nd_est_sc_plot_data_long30,
   tot_exp_nd_est_sc_plot_data_long31,tot_exp_nd_est_sc_plot_data_long32,tot_exp_nd_est_sc_plot_data_long33,
   tot_exp_nd_est_sc_plot_data_long34,tot_exp_nd_est_sc_plot_data_long35)
tot_exp_nd_est_sc_plot_data_long_list <- lapply(tot_exp_nd_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sc_plot_data_wide", i), reshape(data=tot_exp_nd_est_sc_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
tot_exp_nd_est_sc_plot_data_wide_list <- list(tot_exp_nd_est_sc_plot_data_wide1,tot_exp_nd_est_sc_plot_data_wide2,tot_exp_nd_est_sc_plot_data_wide3,
                                              tot_exp_nd_est_sc_plot_data_wide4,tot_exp_nd_est_sc_plot_data_wide5,tot_exp_nd_est_sc_plot_data_wide6,
                                              tot_exp_nd_est_sc_plot_data_wide7,tot_exp_nd_est_sc_plot_data_wide8,tot_exp_nd_est_sc_plot_data_wide9,
                                              tot_exp_nd_est_sc_plot_data_wide10,tot_exp_nd_est_sc_plot_data_wide11,tot_exp_nd_est_sc_plot_data_wide12,
                                              tot_exp_nd_est_sc_plot_data_wide13,tot_exp_nd_est_sc_plot_data_wide14,tot_exp_nd_est_sc_plot_data_wide15,
                                              tot_exp_nd_est_sc_plot_data_wide16,tot_exp_nd_est_sc_plot_data_wide17,tot_exp_nd_est_sc_plot_data_wide18,
                                              tot_exp_nd_est_sc_plot_data_wide19,tot_exp_nd_est_sc_plot_data_wide20,tot_exp_nd_est_sc_plot_data_wide21,
                                              tot_exp_nd_est_sc_plot_data_wide22,tot_exp_nd_est_sc_plot_data_wide23,tot_exp_nd_est_sc_plot_data_wide24,
                                              tot_exp_nd_est_sc_plot_data_wide25,tot_exp_nd_est_sc_plot_data_wide26,tot_exp_nd_est_sc_plot_data_wide27,
                                              tot_exp_nd_est_sc_plot_data_wide28,tot_exp_nd_est_sc_plot_data_wide29,tot_exp_nd_est_sc_plot_data_wide30,
                                              tot_exp_nd_est_sc_plot_data_wide31,tot_exp_nd_est_sc_plot_data_wide32,tot_exp_nd_est_sc_plot_data_wide33,
                                              tot_exp_nd_est_sc_plot_data_wide34,tot_exp_nd_est_sc_plot_data_wide35)
rm(tot_exp_nd_est_sc_plot_data_wide1,tot_exp_nd_est_sc_plot_data_wide2,tot_exp_nd_est_sc_plot_data_wide3,
   tot_exp_nd_est_sc_plot_data_wide4,tot_exp_nd_est_sc_plot_data_wide5,tot_exp_nd_est_sc_plot_data_wide6,
   tot_exp_nd_est_sc_plot_data_wide7,tot_exp_nd_est_sc_plot_data_wide8,tot_exp_nd_est_sc_plot_data_wide9,
   tot_exp_nd_est_sc_plot_data_wide10,tot_exp_nd_est_sc_plot_data_wide11,tot_exp_nd_est_sc_plot_data_wide12,
   tot_exp_nd_est_sc_plot_data_wide13,tot_exp_nd_est_sc_plot_data_wide14,tot_exp_nd_est_sc_plot_data_wide15,
   tot_exp_nd_est_sc_plot_data_wide16,tot_exp_nd_est_sc_plot_data_wide17,tot_exp_nd_est_sc_plot_data_wide18,
   tot_exp_nd_est_sc_plot_data_wide19,tot_exp_nd_est_sc_plot_data_wide20,tot_exp_nd_est_sc_plot_data_wide21,
   tot_exp_nd_est_sc_plot_data_wide22,tot_exp_nd_est_sc_plot_data_wide23,tot_exp_nd_est_sc_plot_data_wide24,
   tot_exp_nd_est_sc_plot_data_wide25,tot_exp_nd_est_sc_plot_data_wide26,tot_exp_nd_est_sc_plot_data_wide27,
   tot_exp_nd_est_sc_plot_data_wide28,tot_exp_nd_est_sc_plot_data_wide29,tot_exp_nd_est_sc_plot_data_wide30,
   tot_exp_nd_est_sc_plot_data_wide31,tot_exp_nd_est_sc_plot_data_wide32,tot_exp_nd_est_sc_plot_data_wide33,
   tot_exp_nd_est_sc_plot_data_wide34,tot_exp_nd_est_sc_plot_data_wide35)
tot_exp_nd_est_sc_plot_data_wide_list <- lapply(tot_exp_nd_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
tot_exp_nd_est_sdid1 <- synthdid_estimate(setup_tot_exp_nd_list[[1]]$Y, setup_tot_exp_nd_list[[1]]$N0, setup_tot_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
tot_exp_nd_est_sdid2 <- synthdid_estimate(setup_tot_exp_nd_list[[2]]$Y, setup_tot_exp_nd_list[[2]]$N0, setup_tot_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
tot_exp_nd_est_sdid5 <- synthdid_estimate(setup_tot_exp_nd_list[[3]]$Y, setup_tot_exp_nd_list[[3]]$N0, setup_tot_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
tot_exp_nd_est_sdid10 <- synthdid_estimate(setup_tot_exp_nd_list[[4]]$Y, setup_tot_exp_nd_list[[4]]$N0, setup_tot_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
tot_exp_nd_est_sdid11 <- synthdid_estimate(setup_tot_exp_nd_list[[5]]$Y, setup_tot_exp_nd_list[[5]]$N0, setup_tot_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
tot_exp_nd_est_sdid12 <- synthdid_estimate(setup_tot_exp_nd_list[[6]]$Y, setup_tot_exp_nd_list[[6]]$N0, setup_tot_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
tot_exp_nd_est_sdid13 <- synthdid_estimate(setup_tot_exp_nd_list[[7]]$Y, setup_tot_exp_nd_list[[7]]$N0, setup_tot_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
tot_exp_nd_est_sdid15 <- synthdid_estimate(setup_tot_exp_nd_list[[8]]$Y, setup_tot_exp_nd_list[[8]]$N0, setup_tot_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
tot_exp_nd_est_sdid17 <- synthdid_estimate(setup_tot_exp_nd_list[[9]]$Y, setup_tot_exp_nd_list[[9]]$N0, setup_tot_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
tot_exp_nd_est_sdid19 <- synthdid_estimate(setup_tot_exp_nd_list[[10]]$Y, setup_tot_exp_nd_list[[10]]$N0, setup_tot_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
tot_exp_nd_est_sdid21 <- synthdid_estimate(setup_tot_exp_nd_list[[11]]$Y, setup_tot_exp_nd_list[[11]]$N0, setup_tot_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
tot_exp_nd_est_sdid23 <- synthdid_estimate(setup_tot_exp_nd_list[[12]]$Y, setup_tot_exp_nd_list[[12]]$N0, setup_tot_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
tot_exp_nd_est_sdid24 <- synthdid_estimate(setup_tot_exp_nd_list[[13]]$Y, setup_tot_exp_nd_list[[13]]$N0, setup_tot_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
tot_exp_nd_est_sdid25 <- synthdid_estimate(setup_tot_exp_nd_list[[14]]$Y, setup_tot_exp_nd_list[[14]]$N0, setup_tot_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
tot_exp_nd_est_sdid26 <- synthdid_estimate(setup_tot_exp_nd_list[[15]]$Y, setup_tot_exp_nd_list[[15]]$N0, setup_tot_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
tot_exp_nd_est_sdid28 <- synthdid_estimate(setup_tot_exp_nd_list[[16]]$Y, setup_tot_exp_nd_list[[16]]$N0, setup_tot_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
tot_exp_nd_est_sdid29 <- synthdid_estimate(setup_tot_exp_nd_list[[17]]$Y, setup_tot_exp_nd_list[[17]]$N0, setup_tot_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
tot_exp_nd_est_sdid30 <- synthdid_estimate(setup_tot_exp_nd_list[[18]]$Y, setup_tot_exp_nd_list[[18]]$N0, setup_tot_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
tot_exp_nd_est_sdid31 <- synthdid_estimate(setup_tot_exp_nd_list[[19]]$Y, setup_tot_exp_nd_list[[19]]$N0, setup_tot_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
tot_exp_nd_est_sdid32 <- synthdid_estimate(setup_tot_exp_nd_list[[20]]$Y, setup_tot_exp_nd_list[[20]]$N0, setup_tot_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
tot_exp_nd_est_sdid33 <- synthdid_estimate(setup_tot_exp_nd_list[[21]]$Y, setup_tot_exp_nd_list[[21]]$N0, setup_tot_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
tot_exp_nd_est_sdid34 <- synthdid_estimate(setup_tot_exp_nd_list[[22]]$Y, setup_tot_exp_nd_list[[22]]$N0, setup_tot_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
tot_exp_nd_est_sdid36 <- synthdid_estimate(setup_tot_exp_nd_list[[23]]$Y, setup_tot_exp_nd_list[[23]]$N0, setup_tot_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
tot_exp_nd_est_sdid37 <- synthdid_estimate(setup_tot_exp_nd_list[[24]]$Y, setup_tot_exp_nd_list[[24]]$N0, setup_tot_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
tot_exp_nd_est_sdid39 <- synthdid_estimate(setup_tot_exp_nd_list[[25]]$Y, setup_tot_exp_nd_list[[25]]$N0, setup_tot_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
tot_exp_nd_est_sdid40 <- synthdid_estimate(setup_tot_exp_nd_list[[26]]$Y, setup_tot_exp_nd_list[[26]]$N0, setup_tot_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
tot_exp_nd_est_sdid41 <- synthdid_estimate(setup_tot_exp_nd_list[[27]]$Y, setup_tot_exp_nd_list[[27]]$N0, setup_tot_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
tot_exp_nd_est_sdid44 <- synthdid_estimate(setup_tot_exp_nd_list[[28]]$Y, setup_tot_exp_nd_list[[28]]$N0, setup_tot_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
tot_exp_nd_est_sdid45 <- synthdid_estimate(setup_tot_exp_nd_list[[29]]$Y, setup_tot_exp_nd_list[[29]]$N0, setup_tot_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
tot_exp_nd_est_sdid47 <- synthdid_estimate(setup_tot_exp_nd_list[[30]]$Y, setup_tot_exp_nd_list[[30]]$N0, setup_tot_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
tot_exp_nd_est_sdid50 <- synthdid_estimate(setup_tot_exp_nd_list[[31]]$Y, setup_tot_exp_nd_list[[31]]$N0, setup_tot_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
tot_exp_nd_est_sdid51 <- synthdid_estimate(setup_tot_exp_nd_list[[32]]$Y, setup_tot_exp_nd_list[[32]]$N0, setup_tot_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
tot_exp_nd_est_sdid53 <- synthdid_estimate(setup_tot_exp_nd_list[[33]]$Y, setup_tot_exp_nd_list[[33]]$N0, setup_tot_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
tot_exp_nd_est_sdid54 <- synthdid_estimate(setup_tot_exp_nd_list[[34]]$Y, setup_tot_exp_nd_list[[34]]$N0, setup_tot_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
tot_exp_nd_est_sdid55 <- synthdid_estimate(setup_tot_exp_nd_list[[35]]$Y, setup_tot_exp_nd_list[[35]]$N0, setup_tot_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
tot_exp_nd_est_sdid_list <- list(tot_exp_nd_est_sdid1,tot_exp_nd_est_sdid2,tot_exp_nd_est_sdid5,
                                 tot_exp_nd_est_sdid10,tot_exp_nd_est_sdid11,tot_exp_nd_est_sdid12,
                                 tot_exp_nd_est_sdid13,tot_exp_nd_est_sdid15,tot_exp_nd_est_sdid17,
                                 tot_exp_nd_est_sdid19,tot_exp_nd_est_sdid21,tot_exp_nd_est_sdid23,
                                 tot_exp_nd_est_sdid24,tot_exp_nd_est_sdid25,tot_exp_nd_est_sdid26,
                                 tot_exp_nd_est_sdid28,tot_exp_nd_est_sdid29,tot_exp_nd_est_sdid30,
                                 tot_exp_nd_est_sdid31,tot_exp_nd_est_sdid32,tot_exp_nd_est_sdid33,
                                 tot_exp_nd_est_sdid34,tot_exp_nd_est_sdid36,tot_exp_nd_est_sdid37,
                                 tot_exp_nd_est_sdid39,tot_exp_nd_est_sdid40,tot_exp_nd_est_sdid41,
                                 tot_exp_nd_est_sdid44,tot_exp_nd_est_sdid45,tot_exp_nd_est_sdid47,
                                 tot_exp_nd_est_sdid50,tot_exp_nd_est_sdid51,tot_exp_nd_est_sdid53,
                                 tot_exp_nd_est_sdid54,tot_exp_nd_est_sdid55)
rm(tot_exp_nd_est_sdid1,tot_exp_nd_est_sdid2,tot_exp_nd_est_sdid5,
   tot_exp_nd_est_sdid10,tot_exp_nd_est_sdid11,tot_exp_nd_est_sdid12,
   tot_exp_nd_est_sdid13,tot_exp_nd_est_sdid15,tot_exp_nd_est_sdid17,
   tot_exp_nd_est_sdid19,tot_exp_nd_est_sdid21,tot_exp_nd_est_sdid23,
   tot_exp_nd_est_sdid24,tot_exp_nd_est_sdid25,tot_exp_nd_est_sdid26,
   tot_exp_nd_est_sdid28,tot_exp_nd_est_sdid29,tot_exp_nd_est_sdid30,
   tot_exp_nd_est_sdid31,tot_exp_nd_est_sdid32,tot_exp_nd_est_sdid33,
   tot_exp_nd_est_sdid34,tot_exp_nd_est_sdid36,tot_exp_nd_est_sdid37,
   tot_exp_nd_est_sdid39,tot_exp_nd_est_sdid40,tot_exp_nd_est_sdid41,
   tot_exp_nd_est_sdid44,tot_exp_nd_est_sdid45,tot_exp_nd_est_sdid47,
   tot_exp_nd_est_sdid50,tot_exp_nd_est_sdid51,tot_exp_nd_est_sdid53,
   tot_exp_nd_est_sdid54,tot_exp_nd_est_sdid55)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sdid_plot", i), synthdid_plot(tot_exp_nd_est_sdid_list[i]))
}
tot_exp_nd_est_sdid_plot_data_aux1 <- ggplot_build(tot_exp_nd_est_sdid_plot1)
tot_exp_nd_est_sdid_plot_data_aux2 <- ggplot_build(tot_exp_nd_est_sdid_plot2)
tot_exp_nd_est_sdid_plot_data_aux3 <- ggplot_build(tot_exp_nd_est_sdid_plot3)
tot_exp_nd_est_sdid_plot_data_aux4 <- ggplot_build(tot_exp_nd_est_sdid_plot4)
tot_exp_nd_est_sdid_plot_data_aux5 <- ggplot_build(tot_exp_nd_est_sdid_plot5)
tot_exp_nd_est_sdid_plot_data_aux6 <- ggplot_build(tot_exp_nd_est_sdid_plot6)
tot_exp_nd_est_sdid_plot_data_aux7 <- ggplot_build(tot_exp_nd_est_sdid_plot7)
tot_exp_nd_est_sdid_plot_data_aux8 <- ggplot_build(tot_exp_nd_est_sdid_plot8)
tot_exp_nd_est_sdid_plot_data_aux9 <- ggplot_build(tot_exp_nd_est_sdid_plot9)
tot_exp_nd_est_sdid_plot_data_aux10 <- ggplot_build(tot_exp_nd_est_sdid_plot10)
tot_exp_nd_est_sdid_plot_data_aux11 <- ggplot_build(tot_exp_nd_est_sdid_plot11)
tot_exp_nd_est_sdid_plot_data_aux12 <- ggplot_build(tot_exp_nd_est_sdid_plot12)
tot_exp_nd_est_sdid_plot_data_aux13 <- ggplot_build(tot_exp_nd_est_sdid_plot13)
tot_exp_nd_est_sdid_plot_data_aux14 <- ggplot_build(tot_exp_nd_est_sdid_plot14)
tot_exp_nd_est_sdid_plot_data_aux15 <- ggplot_build(tot_exp_nd_est_sdid_plot15)
tot_exp_nd_est_sdid_plot_data_aux16 <- ggplot_build(tot_exp_nd_est_sdid_plot16)
tot_exp_nd_est_sdid_plot_data_aux17 <- ggplot_build(tot_exp_nd_est_sdid_plot17)
tot_exp_nd_est_sdid_plot_data_aux18 <- ggplot_build(tot_exp_nd_est_sdid_plot18)
tot_exp_nd_est_sdid_plot_data_aux19 <- ggplot_build(tot_exp_nd_est_sdid_plot19)
tot_exp_nd_est_sdid_plot_data_aux20 <- ggplot_build(tot_exp_nd_est_sdid_plot20)
tot_exp_nd_est_sdid_plot_data_aux21 <- ggplot_build(tot_exp_nd_est_sdid_plot21)
tot_exp_nd_est_sdid_plot_data_aux22 <- ggplot_build(tot_exp_nd_est_sdid_plot22)
tot_exp_nd_est_sdid_plot_data_aux23 <- ggplot_build(tot_exp_nd_est_sdid_plot23)
tot_exp_nd_est_sdid_plot_data_aux24 <- ggplot_build(tot_exp_nd_est_sdid_plot24)
tot_exp_nd_est_sdid_plot_data_aux25 <- ggplot_build(tot_exp_nd_est_sdid_plot25)
tot_exp_nd_est_sdid_plot_data_aux26 <- ggplot_build(tot_exp_nd_est_sdid_plot26)
tot_exp_nd_est_sdid_plot_data_aux27 <- ggplot_build(tot_exp_nd_est_sdid_plot27)
tot_exp_nd_est_sdid_plot_data_aux28 <- ggplot_build(tot_exp_nd_est_sdid_plot28)
tot_exp_nd_est_sdid_plot_data_aux29 <- ggplot_build(tot_exp_nd_est_sdid_plot29)
tot_exp_nd_est_sdid_plot_data_aux30 <- ggplot_build(tot_exp_nd_est_sdid_plot30)
tot_exp_nd_est_sdid_plot_data_aux31 <- ggplot_build(tot_exp_nd_est_sdid_plot31)
tot_exp_nd_est_sdid_plot_data_aux32 <- ggplot_build(tot_exp_nd_est_sdid_plot32)
tot_exp_nd_est_sdid_plot_data_aux33 <- ggplot_build(tot_exp_nd_est_sdid_plot33)
tot_exp_nd_est_sdid_plot_data_aux34 <- ggplot_build(tot_exp_nd_est_sdid_plot34)
tot_exp_nd_est_sdid_plot_data_aux35 <- ggplot_build(tot_exp_nd_est_sdid_plot35)
tot_exp_nd_est_sdid_plot_data_aux_list <- list(tot_exp_nd_est_sdid_plot_data_aux1,tot_exp_nd_est_sdid_plot_data_aux2,tot_exp_nd_est_sdid_plot_data_aux3,
                                               tot_exp_nd_est_sdid_plot_data_aux4,tot_exp_nd_est_sdid_plot_data_aux5,tot_exp_nd_est_sdid_plot_data_aux6,
                                               tot_exp_nd_est_sdid_plot_data_aux7,tot_exp_nd_est_sdid_plot_data_aux8,tot_exp_nd_est_sdid_plot_data_aux9,
                                               tot_exp_nd_est_sdid_plot_data_aux10,tot_exp_nd_est_sdid_plot_data_aux11,tot_exp_nd_est_sdid_plot_data_aux12,
                                               tot_exp_nd_est_sdid_plot_data_aux13,tot_exp_nd_est_sdid_plot_data_aux14,tot_exp_nd_est_sdid_plot_data_aux15,
                                               tot_exp_nd_est_sdid_plot_data_aux16,tot_exp_nd_est_sdid_plot_data_aux17,tot_exp_nd_est_sdid_plot_data_aux18,
                                               tot_exp_nd_est_sdid_plot_data_aux19,tot_exp_nd_est_sdid_plot_data_aux20,tot_exp_nd_est_sdid_plot_data_aux21,
                                               tot_exp_nd_est_sdid_plot_data_aux22,tot_exp_nd_est_sdid_plot_data_aux23,tot_exp_nd_est_sdid_plot_data_aux24,
                                               tot_exp_nd_est_sdid_plot_data_aux25,tot_exp_nd_est_sdid_plot_data_aux26,tot_exp_nd_est_sdid_plot_data_aux27,
                                               tot_exp_nd_est_sdid_plot_data_aux28,tot_exp_nd_est_sdid_plot_data_aux29,tot_exp_nd_est_sdid_plot_data_aux30,
                                               tot_exp_nd_est_sdid_plot_data_aux31,tot_exp_nd_est_sdid_plot_data_aux32,tot_exp_nd_est_sdid_plot_data_aux33,
                                               tot_exp_nd_est_sdid_plot_data_aux34,tot_exp_nd_est_sdid_plot_data_aux35)
rm(tot_exp_nd_est_sdid_plot_data_aux1,tot_exp_nd_est_sdid_plot_data_aux2,tot_exp_nd_est_sdid_plot_data_aux3,
   tot_exp_nd_est_sdid_plot_data_aux4,tot_exp_nd_est_sdid_plot_data_aux5,tot_exp_nd_est_sdid_plot_data_aux6,
   tot_exp_nd_est_sdid_plot_data_aux7,tot_exp_nd_est_sdid_plot_data_aux8,tot_exp_nd_est_sdid_plot_data_aux9,
   tot_exp_nd_est_sdid_plot_data_aux10,tot_exp_nd_est_sdid_plot_data_aux11,tot_exp_nd_est_sdid_plot_data_aux12,
   tot_exp_nd_est_sdid_plot_data_aux13,tot_exp_nd_est_sdid_plot_data_aux14,tot_exp_nd_est_sdid_plot_data_aux15,
   tot_exp_nd_est_sdid_plot_data_aux16,tot_exp_nd_est_sdid_plot_data_aux17,tot_exp_nd_est_sdid_plot_data_aux18,
   tot_exp_nd_est_sdid_plot_data_aux19,tot_exp_nd_est_sdid_plot_data_aux20,tot_exp_nd_est_sdid_plot_data_aux21,
   tot_exp_nd_est_sdid_plot_data_aux22,tot_exp_nd_est_sdid_plot_data_aux23,tot_exp_nd_est_sdid_plot_data_aux24,
   tot_exp_nd_est_sdid_plot_data_aux25,tot_exp_nd_est_sdid_plot_data_aux26,tot_exp_nd_est_sdid_plot_data_aux27,
   tot_exp_nd_est_sdid_plot_data_aux28,tot_exp_nd_est_sdid_plot_data_aux29,tot_exp_nd_est_sdid_plot_data_aux30,
   tot_exp_nd_est_sdid_plot_data_aux31,tot_exp_nd_est_sdid_plot_data_aux32,tot_exp_nd_est_sdid_plot_data_aux33,
   tot_exp_nd_est_sdid_plot_data_aux34,tot_exp_nd_est_sdid_plot_data_aux35)
rm(tot_exp_nd_est_sdid_plot1,tot_exp_nd_est_sdid_plot2,tot_exp_nd_est_sdid_plot3,
   tot_exp_nd_est_sdid_plot4,tot_exp_nd_est_sdid_plot5,tot_exp_nd_est_sdid_plot6,
   tot_exp_nd_est_sdid_plot7,tot_exp_nd_est_sdid_plot8,tot_exp_nd_est_sdid_plot9,
   tot_exp_nd_est_sdid_plot10,tot_exp_nd_est_sdid_plot11,tot_exp_nd_est_sdid_plot12,
   tot_exp_nd_est_sdid_plot13,tot_exp_nd_est_sdid_plot14,tot_exp_nd_est_sdid_plot15,
   tot_exp_nd_est_sdid_plot16,tot_exp_nd_est_sdid_plot17,tot_exp_nd_est_sdid_plot18,
   tot_exp_nd_est_sdid_plot19,tot_exp_nd_est_sdid_plot20,tot_exp_nd_est_sdid_plot21,
   tot_exp_nd_est_sdid_plot22,tot_exp_nd_est_sdid_plot23,tot_exp_nd_est_sdid_plot24,
   tot_exp_nd_est_sdid_plot25,tot_exp_nd_est_sdid_plot26,tot_exp_nd_est_sdid_plot27,
   tot_exp_nd_est_sdid_plot28,tot_exp_nd_est_sdid_plot29,tot_exp_nd_est_sdid_plot30,
   tot_exp_nd_est_sdid_plot31,tot_exp_nd_est_sdid_plot32,tot_exp_nd_est_sdid_plot33,
   tot_exp_nd_est_sdid_plot34,tot_exp_nd_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sdid_plot_data_long", i), data.frame(tot_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, tot_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, tot_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
tot_exp_nd_est_sdid_plot_data_long_list <- list(tot_exp_nd_est_sdid_plot_data_long1,tot_exp_nd_est_sdid_plot_data_long2,tot_exp_nd_est_sdid_plot_data_long3,
                                                tot_exp_nd_est_sdid_plot_data_long4,tot_exp_nd_est_sdid_plot_data_long5,tot_exp_nd_est_sdid_plot_data_long6,
                                                tot_exp_nd_est_sdid_plot_data_long7,tot_exp_nd_est_sdid_plot_data_long8,tot_exp_nd_est_sdid_plot_data_long9,
                                                tot_exp_nd_est_sdid_plot_data_long10,tot_exp_nd_est_sdid_plot_data_long11,tot_exp_nd_est_sdid_plot_data_long12,
                                                tot_exp_nd_est_sdid_plot_data_long13,tot_exp_nd_est_sdid_plot_data_long14,tot_exp_nd_est_sdid_plot_data_long15,
                                                tot_exp_nd_est_sdid_plot_data_long16,tot_exp_nd_est_sdid_plot_data_long17,tot_exp_nd_est_sdid_plot_data_long18,
                                                tot_exp_nd_est_sdid_plot_data_long19,tot_exp_nd_est_sdid_plot_data_long20,tot_exp_nd_est_sdid_plot_data_long21,
                                                tot_exp_nd_est_sdid_plot_data_long22,tot_exp_nd_est_sdid_plot_data_long23,tot_exp_nd_est_sdid_plot_data_long24,
                                                tot_exp_nd_est_sdid_plot_data_long25,tot_exp_nd_est_sdid_plot_data_long26,tot_exp_nd_est_sdid_plot_data_long27,
                                                tot_exp_nd_est_sdid_plot_data_long28,tot_exp_nd_est_sdid_plot_data_long29,tot_exp_nd_est_sdid_plot_data_long30,
                                                tot_exp_nd_est_sdid_plot_data_long31,tot_exp_nd_est_sdid_plot_data_long32,tot_exp_nd_est_sdid_plot_data_long33,
                                                tot_exp_nd_est_sdid_plot_data_long34,tot_exp_nd_est_sdid_plot_data_long35)
rm(tot_exp_nd_est_sdid_plot_data_long1,tot_exp_nd_est_sdid_plot_data_long2,tot_exp_nd_est_sdid_plot_data_long3,
   tot_exp_nd_est_sdid_plot_data_long4,tot_exp_nd_est_sdid_plot_data_long5,tot_exp_nd_est_sdid_plot_data_long6,
   tot_exp_nd_est_sdid_plot_data_long7,tot_exp_nd_est_sdid_plot_data_long8,tot_exp_nd_est_sdid_plot_data_long9,
   tot_exp_nd_est_sdid_plot_data_long10,tot_exp_nd_est_sdid_plot_data_long11,tot_exp_nd_est_sdid_plot_data_long12,
   tot_exp_nd_est_sdid_plot_data_long13,tot_exp_nd_est_sdid_plot_data_long14,tot_exp_nd_est_sdid_plot_data_long15,
   tot_exp_nd_est_sdid_plot_data_long16,tot_exp_nd_est_sdid_plot_data_long17,tot_exp_nd_est_sdid_plot_data_long18,
   tot_exp_nd_est_sdid_plot_data_long19,tot_exp_nd_est_sdid_plot_data_long20,tot_exp_nd_est_sdid_plot_data_long21,
   tot_exp_nd_est_sdid_plot_data_long22,tot_exp_nd_est_sdid_plot_data_long23,tot_exp_nd_est_sdid_plot_data_long24,
   tot_exp_nd_est_sdid_plot_data_long25,tot_exp_nd_est_sdid_plot_data_long26,tot_exp_nd_est_sdid_plot_data_long27,
   tot_exp_nd_est_sdid_plot_data_long28,tot_exp_nd_est_sdid_plot_data_long29,tot_exp_nd_est_sdid_plot_data_long30,
   tot_exp_nd_est_sdid_plot_data_long31,tot_exp_nd_est_sdid_plot_data_long32,tot_exp_nd_est_sdid_plot_data_long33,
   tot_exp_nd_est_sdid_plot_data_long34,tot_exp_nd_est_sdid_plot_data_long35)
tot_exp_nd_est_sdid_plot_data_long_list <- lapply(tot_exp_nd_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("tot_exp_nd_est_sdid_plot_data_wide", i), reshape(data=tot_exp_nd_est_sdid_plot_data_long_list[[i]],
                                                                  idvar = "year",
                                                                  v.names = "outcome",
                                                                  timevar = "treated",
                                                                  direction = "wide"))
}
tot_exp_nd_est_sdid_plot_data_wide_list <- list(tot_exp_nd_est_sdid_plot_data_wide1,tot_exp_nd_est_sdid_plot_data_wide2,tot_exp_nd_est_sdid_plot_data_wide3,
                                                tot_exp_nd_est_sdid_plot_data_wide4,tot_exp_nd_est_sdid_plot_data_wide5,tot_exp_nd_est_sdid_plot_data_wide6,
                                                tot_exp_nd_est_sdid_plot_data_wide7,tot_exp_nd_est_sdid_plot_data_wide8,tot_exp_nd_est_sdid_plot_data_wide9,
                                                tot_exp_nd_est_sdid_plot_data_wide10,tot_exp_nd_est_sdid_plot_data_wide11,tot_exp_nd_est_sdid_plot_data_wide12,
                                                tot_exp_nd_est_sdid_plot_data_wide13,tot_exp_nd_est_sdid_plot_data_wide14,tot_exp_nd_est_sdid_plot_data_wide15,
                                                tot_exp_nd_est_sdid_plot_data_wide16,tot_exp_nd_est_sdid_plot_data_wide17,tot_exp_nd_est_sdid_plot_data_wide18,
                                                tot_exp_nd_est_sdid_plot_data_wide19,tot_exp_nd_est_sdid_plot_data_wide20,tot_exp_nd_est_sdid_plot_data_wide21,
                                                tot_exp_nd_est_sdid_plot_data_wide22,tot_exp_nd_est_sdid_plot_data_wide23,tot_exp_nd_est_sdid_plot_data_wide24,
                                                tot_exp_nd_est_sdid_plot_data_wide25,tot_exp_nd_est_sdid_plot_data_wide26,tot_exp_nd_est_sdid_plot_data_wide27,
                                                tot_exp_nd_est_sdid_plot_data_wide28,tot_exp_nd_est_sdid_plot_data_wide29,tot_exp_nd_est_sdid_plot_data_wide30,
                                                tot_exp_nd_est_sdid_plot_data_wide31,tot_exp_nd_est_sdid_plot_data_wide32,tot_exp_nd_est_sdid_plot_data_wide33,
                                                tot_exp_nd_est_sdid_plot_data_wide34,tot_exp_nd_est_sdid_plot_data_wide35)
rm(tot_exp_nd_est_sdid_plot_data_wide1,tot_exp_nd_est_sdid_plot_data_wide2,tot_exp_nd_est_sdid_plot_data_wide3,
   tot_exp_nd_est_sdid_plot_data_wide4,tot_exp_nd_est_sdid_plot_data_wide5,tot_exp_nd_est_sdid_plot_data_wide6,
   tot_exp_nd_est_sdid_plot_data_wide7,tot_exp_nd_est_sdid_plot_data_wide8,tot_exp_nd_est_sdid_plot_data_wide9,
   tot_exp_nd_est_sdid_plot_data_wide10,tot_exp_nd_est_sdid_plot_data_wide11,tot_exp_nd_est_sdid_plot_data_wide12,
   tot_exp_nd_est_sdid_plot_data_wide13,tot_exp_nd_est_sdid_plot_data_wide14,tot_exp_nd_est_sdid_plot_data_wide15,
   tot_exp_nd_est_sdid_plot_data_wide16,tot_exp_nd_est_sdid_plot_data_wide17,tot_exp_nd_est_sdid_plot_data_wide18,
   tot_exp_nd_est_sdid_plot_data_wide19,tot_exp_nd_est_sdid_plot_data_wide20,tot_exp_nd_est_sdid_plot_data_wide21,
   tot_exp_nd_est_sdid_plot_data_wide22,tot_exp_nd_est_sdid_plot_data_wide23,tot_exp_nd_est_sdid_plot_data_wide24,
   tot_exp_nd_est_sdid_plot_data_wide25,tot_exp_nd_est_sdid_plot_data_wide26,tot_exp_nd_est_sdid_plot_data_wide27,
   tot_exp_nd_est_sdid_plot_data_wide28,tot_exp_nd_est_sdid_plot_data_wide29,tot_exp_nd_est_sdid_plot_data_wide30,
   tot_exp_nd_est_sdid_plot_data_wide31,tot_exp_nd_est_sdid_plot_data_wide32,tot_exp_nd_est_sdid_plot_data_wide33,
   tot_exp_nd_est_sdid_plot_data_wide34,tot_exp_nd_est_sdid_plot_data_wide35)
tot_exp_nd_est_sdid_plot_data_wide_list <- lapply(tot_exp_nd_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
tot_exp_est_did_plot_data_wide_nd$did_facet_title <- "Diff-in-Diff"
tot_exp_est_sc_plot_data_wide_nd$sc_facet_title <- "Synthetic Control"
tot_exp_est_sdid_plot_data_wide_nd$sdid_facet_title <- "Synthetic Diff-in-Diff"
tot_exp_est_did_plot_data_wide_nd$diff_relative <- tot_exp_est_did_plot_data_wide_nd$diff - tot_exp_est_did_plot_data_wide_nd$diff[15]
for(i in 1:35) {
  tot_exp_nd_est_did_plot_data_wide_list[[i]]$diff_relative <- tot_exp_nd_est_did_plot_data_wide_list[[i]]$diff - tot_exp_nd_est_did_plot_data_wide_list[[i]]$diff[15]
}
tot_exp_nd_spag_did_plot <- ggplot(tot_exp_est_did_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Total Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_nd_spag_sc_plot <- ggplot(tot_exp_est_sc_plot_data_wide_nd, aes(year,diff)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = tot_exp_nd_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "North Dakota"),data = tot_exp_est_sc_plot_data_wide_nd, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "North Dakota" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_est_sdid_plot_data_wide_nd$diff_relative <- tot_exp_est_sdid_plot_data_wide_nd$diff - tot_exp_est_sdid_plot_data_wide_nd$diff[15]
for(i in 1:35) {
  tot_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff_relative <- tot_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff - tot_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff[15]
}
tot_exp_nd_spag_sdid_plot <- ggplot(tot_exp_est_sdid_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = tot_exp_nd_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
tot_exp_nd_est_did_vec <- c(tot_exp_est_did_nd)
for (i in c(1:4,6:35)) {
  tot_exp_nd_est_did_vec_aux <- tot_exp_nd_est_did_list[[i]][1]
  tot_exp_nd_est_did_vec <- c(tot_exp_nd_est_did_vec,tot_exp_nd_est_did_vec_aux)
}
tot_exp_nd_est_did_df <- data.frame(tot_exp_nd_est_did_vec)
tot_exp_nd_hist_did_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_nd_est_did_vec)) +
  geom_histogram(data = tot_exp_nd_est_did_df, aes(x = tot_exp_nd_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_nd_hist_did_plot1_ylim <- ggplot_build(tot_exp_nd_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_nd_hist_did_plot <- tot_exp_nd_hist_did_plot_aux +
  expand_limits(y=tot_exp_nd_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_nd_est_did_vec[1], mean(tot_exp_nd_est_did_vec[2:35])), xend = c(tot_exp_nd_est_did_vec[1],mean(tot_exp_nd_est_did_vec[2:35])), y = c(0,0), yend = c(tot_exp_nd_hist_did_plot1_ylim,tot_exp_nd_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_nd_est_did_vec[1], mean(tot_exp_nd_est_did_vec[2:35])), y = c(tot_exp_nd_hist_did_plot1_ylim,tot_exp_nd_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_nd_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_nd_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_nd_est_sc_vec <- c(tot_exp_est_sc_nd)
for (i in c(1:4,6:35)) {
  tot_exp_nd_est_sc_vec_aux <- tot_exp_nd_est_sc_list[[i]][1]
  tot_exp_nd_est_sc_vec <- c(tot_exp_nd_est_sc_vec,tot_exp_nd_est_sc_vec_aux)
}
tot_exp_nd_est_sc_df <- data.frame(tot_exp_nd_est_sc_vec)
tot_exp_nd_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_nd_est_sc_vec)) +
  geom_histogram(data = tot_exp_nd_est_sc_df, aes(x = tot_exp_nd_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_nd_hist_sc_plot1_ylim <- ggplot_build(tot_exp_nd_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_nd_hist_sc_plot <- tot_exp_nd_hist_sc_plot_aux +
  expand_limits(y=tot_exp_nd_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_nd_est_sc_vec[1], mean(tot_exp_nd_est_sc_vec[2:35])), xend = c(tot_exp_nd_est_sc_vec[1],mean(tot_exp_nd_est_sc_vec[2:35])), y = c(0,0), yend = c(tot_exp_nd_hist_sc_plot1_ylim,tot_exp_nd_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_nd_est_sc_vec[1], mean(tot_exp_nd_est_sc_vec[2:35])), y = c(tot_exp_nd_hist_sc_plot1_ylim,tot_exp_nd_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_nd_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_nd_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), color = c("#00BFC4","grey40"), size = c(2,2))

tot_exp_nd_est_sdid_vec <- c(tot_exp_est_sdid_nd)
for (i in c(1:4,6:35)) {
  tot_exp_nd_est_sdid_vec_aux <- tot_exp_nd_est_sdid_list[[i]][1]
  tot_exp_nd_est_sdid_vec <- c(tot_exp_nd_est_sdid_vec,tot_exp_nd_est_sdid_vec_aux)
}
tot_exp_nd_est_sdid_df <- data.frame(tot_exp_nd_est_sdid_vec)
tot_exp_nd_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = tot_exp_nd_est_sdid_vec)) +
  geom_histogram(data = tot_exp_nd_est_sdid_df, aes(x = tot_exp_nd_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
tot_exp_nd_hist_sdid_plot1_ylim <- ggplot_build(tot_exp_nd_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
tot_exp_nd_hist_sdid_plot <- tot_exp_nd_hist_sdid_plot_aux +
  expand_limits(y=tot_exp_nd_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(tot_exp_nd_est_sdid_vec[1], mean(tot_exp_nd_est_sdid_vec[2:35])), xend = c(tot_exp_nd_est_sdid_vec[1],mean(tot_exp_nd_est_sdid_vec[2:35])), y = c(0,0), yend = c(tot_exp_nd_hist_sdid_plot1_ylim,tot_exp_nd_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(tot_exp_nd_est_sdid_vec[1], mean(tot_exp_nd_est_sdid_vec[2:35])), y = c(tot_exp_nd_hist_sdid_plot1_ylim,tot_exp_nd_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(tot_exp_nd_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(tot_exp_nd_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.25,.75), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/tot_exp_spag_dist_plots_ND.pdf', paper = "USr", width = 10.9, height = 8.4)
(tot_exp_nd_spag_dist_plots_nd <- tot_exp_nd_spag_did_plot + tot_exp_nd_spag_sc_plot + tot_exp_nd_spag_sdid_plot + tot_exp_nd_hist_did_plot + tot_exp_nd_hist_sc_plot + tot_exp_nd_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


##### Medicaid Expenditure #####
### ND - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to actual treated state and control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
med_exp_nd_df <- as.data.frame(subset(CON_Expenditure, code == 10 & id !=11))
med_exp_nd_df$treated <- as.integer(ifelse(med_exp_nd_df$name == "North Dakota" & med_exp_nd_df$year >= 1995, 1, 0))
med_exp_nd_df <- med_exp_nd_df[order(med_exp_nd_df$year, med_exp_nd_df$treated_nd_aux, med_exp_nd_df$name),]
med_exp_nd_df <- subset(med_exp_nd_df, alwaysconpa == 1 | name == "North Dakota", select=c(name, year, medicaid_exp, treated))
setup_med_exp_nd <- panel.matrices(med_exp_nd_df, unit = 1, time = 2, outcome = 3, treatment = 4)
# DID #
med_exp_est_did_nd <- did_estimate(setup_med_exp_nd$Y, setup_med_exp_nd$N0, setup_med_exp_nd$T0, X = covariates_exp_nd_array)
med_exp_est_did_plot_nd <- synthdid_plot(med_exp_est_did_nd)
med_exp_est_did_plot_data_aux_nd <- ggplot_build(med_exp_est_did_plot_nd)
med_exp_est_did_plot_data_long_nd <- data.frame(med_exp_est_did_plot_data_aux_nd$data[[1]]$x, med_exp_est_did_plot_data_aux_nd$data[[1]]$y, med_exp_est_did_plot_data_aux_nd$data[[1]]$group)
colnames(med_exp_est_did_plot_data_long_nd) <- c('year', 'outcome', 'treated')
med_exp_est_did_plot_data_long_nd$treated <- med_exp_est_did_plot_data_long_nd$treated - 1
med_exp_est_did_plot_data_wide_nd <- reshape(data=med_exp_est_did_plot_data_long_nd,
                                             idvar = "year",
                                             v.names = "outcome",
                                             timevar = "treated",
                                             direction = "wide")
med_exp_est_did_plot_data_wide_nd$diff <- med_exp_est_did_plot_data_wide_nd$outcome.1 - med_exp_est_did_plot_data_wide_nd$outcome.0
# SC #
med_exp_est_sc_nd <- sc_estimate(setup_med_exp_nd$Y, setup_med_exp_nd$N0, setup_med_exp_nd$T0, X = covariates_exp_nd_array)
med_exp_est_sc_plot_nd <- synthdid_plot(med_exp_est_sc_nd)
med_exp_est_sc_plot_data_aux_nd <- ggplot_build(med_exp_est_sc_plot_nd)
med_exp_est_sc_plot_data_long_nd <- data.frame(med_exp_est_sc_plot_data_aux_nd$data[[1]]$x, med_exp_est_sc_plot_data_aux_nd$data[[1]]$y, med_exp_est_sc_plot_data_aux_nd$data[[1]]$group)
colnames(med_exp_est_sc_plot_data_long_nd) <- c('year', 'outcome', 'treated')
med_exp_est_sc_plot_data_long_nd$treated <- med_exp_est_sc_plot_data_long_nd$treated - 1
med_exp_est_sc_plot_data_wide_nd <- reshape(data=med_exp_est_sc_plot_data_long_nd,
                                            idvar = "year",
                                            v.names = "outcome",
                                            timevar = "treated",
                                            direction = "wide")
med_exp_est_sc_plot_data_wide_nd$diff <- med_exp_est_sc_plot_data_wide_nd$outcome.1 - med_exp_est_sc_plot_data_wide_nd$outcome.0
# SDID #
med_exp_est_sdid_nd <- synthdid_estimate(setup_med_exp_nd$Y, setup_med_exp_nd$N0, setup_med_exp_nd$T0, X = covariates_exp_nd_array)
med_exp_est_sdid_plot_nd <- synthdid_plot(med_exp_est_sdid_nd)
med_exp_est_sdid_plot_data_aux_nd <- ggplot_build(med_exp_est_sdid_plot_nd)
med_exp_est_sdid_plot_data_long_nd <- data.frame(med_exp_est_sdid_plot_data_aux_nd$data[[1]]$x, med_exp_est_sdid_plot_data_aux_nd$data[[1]]$y, med_exp_est_sdid_plot_data_aux_nd$data[[1]]$group)
colnames(med_exp_est_sdid_plot_data_long_nd) <- c('year', 'outcome', 'treated')
med_exp_est_sdid_plot_data_long_nd$treated <- med_exp_est_sdid_plot_data_long_nd$treated - 1
med_exp_est_sdid_plot_data_wide_nd <- reshape(data=med_exp_est_sdid_plot_data_long_nd,
                                              idvar = "year",
                                              v.names = "outcome",
                                              timevar = "treated",
                                              direction = "wide")
med_exp_est_sdid_plot_data_wide_nd$diff <- med_exp_est_sdid_plot_data_wide_nd$outcome.1 - med_exp_est_sdid_plot_data_wide_nd$outcome.0
### Control States - Get DID, SC, and SDID estimates, as well as a data set with difference in outcomes for spaghetti graphs ###
# Restrict data to "placebo treated" state and other control states by expenditure type (code = 10 for nursing home care), and get in panel form for synthdid #
for(i in unique(controls.df$id)) {
  assign(paste0("med_exp_nd_df", i), subset(CON_Expenditure, alwaysconpa == 1 & code == 10))
}
med_exp_nd_df1$treated_aux <- ifelse(med_exp_nd_df1$id == 1, 1, 0)
med_exp_nd_df2$treated_aux <- ifelse(med_exp_nd_df2$id == 2, 1, 0)
med_exp_nd_df5$treated_aux <- ifelse(med_exp_nd_df5$id == 5, 1, 0)
med_exp_nd_df10$treated_aux <- ifelse(med_exp_nd_df10$id == 10, 1, 0)
med_exp_nd_df11$treated_aux <- ifelse(med_exp_nd_df11$id == 11, 1, 0)
med_exp_nd_df12$treated_aux <- ifelse(med_exp_nd_df12$id == 12, 1, 0)
med_exp_nd_df13$treated_aux <- ifelse(med_exp_nd_df13$id == 13, 1, 0)
med_exp_nd_df15$treated_aux <- ifelse(med_exp_nd_df15$id == 15, 1, 0)
med_exp_nd_df17$treated_aux <- ifelse(med_exp_nd_df17$id == 17, 1, 0)
med_exp_nd_df19$treated_aux <- ifelse(med_exp_nd_df19$id == 19, 1, 0)
med_exp_nd_df21$treated_aux <- ifelse(med_exp_nd_df21$id == 21, 1, 0)
med_exp_nd_df23$treated_aux <- ifelse(med_exp_nd_df23$id == 23, 1, 0)
med_exp_nd_df24$treated_aux <- ifelse(med_exp_nd_df24$id == 24, 1, 0)
med_exp_nd_df25$treated_aux <- ifelse(med_exp_nd_df25$id == 25, 1, 0)
med_exp_nd_df26$treated_aux <- ifelse(med_exp_nd_df26$id == 26, 1, 0)
med_exp_nd_df28$treated_aux <- ifelse(med_exp_nd_df28$id == 28, 1, 0)
med_exp_nd_df29$treated_aux <- ifelse(med_exp_nd_df29$id == 29, 1, 0)
med_exp_nd_df30$treated_aux <- ifelse(med_exp_nd_df30$id == 30, 1, 0)
med_exp_nd_df31$treated_aux <- ifelse(med_exp_nd_df31$id == 31, 1, 0)
med_exp_nd_df32$treated_aux <- ifelse(med_exp_nd_df32$id == 32, 1, 0)
med_exp_nd_df33$treated_aux <- ifelse(med_exp_nd_df33$id == 33, 1, 0)
med_exp_nd_df34$treated_aux <- ifelse(med_exp_nd_df34$id == 34, 1, 0)
med_exp_nd_df36$treated_aux <- ifelse(med_exp_nd_df36$id == 36, 1, 0)
med_exp_nd_df37$treated_aux <- ifelse(med_exp_nd_df37$id == 37, 1, 0)
med_exp_nd_df39$treated_aux <- ifelse(med_exp_nd_df39$id == 39, 1, 0)
med_exp_nd_df40$treated_aux <- ifelse(med_exp_nd_df40$id == 40, 1, 0)
med_exp_nd_df41$treated_aux <- ifelse(med_exp_nd_df41$id == 41, 1, 0)
med_exp_nd_df44$treated_aux <- ifelse(med_exp_nd_df44$id == 44, 1, 0)
med_exp_nd_df45$treated_aux <- ifelse(med_exp_nd_df45$id == 45, 1, 0)
med_exp_nd_df47$treated_aux <- ifelse(med_exp_nd_df47$id == 47, 1, 0)
med_exp_nd_df50$treated_aux <- ifelse(med_exp_nd_df50$id == 50, 1, 0)
med_exp_nd_df51$treated_aux <- ifelse(med_exp_nd_df51$id == 51, 1, 0)
med_exp_nd_df53$treated_aux <- ifelse(med_exp_nd_df53$id == 53, 1, 0)
med_exp_nd_df54$treated_aux <- ifelse(med_exp_nd_df54$id == 54, 1, 0)
med_exp_nd_df55$treated_aux <- ifelse(med_exp_nd_df55$id == 55, 1, 0)
med_exp_nd_df1$treated <- as.integer(ifelse(med_exp_nd_df1$id == 1 & med_exp_nd_df1$year >= 1995, 1, 0))
med_exp_nd_df2$treated <- as.integer(ifelse(med_exp_nd_df2$id == 2 & med_exp_nd_df2$year >= 1995, 1, 0))
med_exp_nd_df5$treated <- as.integer(ifelse(med_exp_nd_df5$id == 5 & med_exp_nd_df5$year >= 1995, 1, 0))
med_exp_nd_df10$treated <- as.integer(ifelse(med_exp_nd_df10$id == 10 & med_exp_nd_df10$year >= 1995, 1, 0))
med_exp_nd_df11$treated <- as.integer(ifelse(med_exp_nd_df11$id == 11 & med_exp_nd_df11$year >= 1995, 1, 0))
med_exp_nd_df12$treated <- as.integer(ifelse(med_exp_nd_df12$id == 12 & med_exp_nd_df12$year >= 1995, 1, 0))
med_exp_nd_df13$treated <- as.integer(ifelse(med_exp_nd_df13$id == 13 & med_exp_nd_df13$year >= 1995, 1, 0))
med_exp_nd_df15$treated <- as.integer(ifelse(med_exp_nd_df15$id == 15 & med_exp_nd_df15$year >= 1995, 1, 0))
med_exp_nd_df17$treated <- as.integer(ifelse(med_exp_nd_df17$id == 17 & med_exp_nd_df17$year >= 1995, 1, 0))
med_exp_nd_df19$treated <- as.integer(ifelse(med_exp_nd_df19$id == 19 & med_exp_nd_df19$year >= 1995, 1, 0))
med_exp_nd_df21$treated <- as.integer(ifelse(med_exp_nd_df21$id == 21 & med_exp_nd_df21$year >= 1995, 1, 0))
med_exp_nd_df23$treated <- as.integer(ifelse(med_exp_nd_df23$id == 23 & med_exp_nd_df23$year >= 1995, 1, 0))
med_exp_nd_df24$treated <- as.integer(ifelse(med_exp_nd_df24$id == 24 & med_exp_nd_df24$year >= 1995, 1, 0))
med_exp_nd_df25$treated <- as.integer(ifelse(med_exp_nd_df25$id == 25 & med_exp_nd_df25$year >= 1995, 1, 0))
med_exp_nd_df26$treated <- as.integer(ifelse(med_exp_nd_df26$id == 26 & med_exp_nd_df26$year >= 1995, 1, 0))
med_exp_nd_df28$treated <- as.integer(ifelse(med_exp_nd_df28$id == 28 & med_exp_nd_df28$year >= 1995, 1, 0))
med_exp_nd_df29$treated <- as.integer(ifelse(med_exp_nd_df29$id == 29 & med_exp_nd_df29$year >= 1995, 1, 0))
med_exp_nd_df30$treated <- as.integer(ifelse(med_exp_nd_df30$id == 30 & med_exp_nd_df30$year >= 1995, 1, 0))
med_exp_nd_df31$treated <- as.integer(ifelse(med_exp_nd_df31$id == 31 & med_exp_nd_df31$year >= 1995, 1, 0))
med_exp_nd_df32$treated <- as.integer(ifelse(med_exp_nd_df32$id == 32 & med_exp_nd_df32$year >= 1995, 1, 0))
med_exp_nd_df33$treated <- as.integer(ifelse(med_exp_nd_df33$id == 33 & med_exp_nd_df33$year >= 1995, 1, 0))
med_exp_nd_df34$treated <- as.integer(ifelse(med_exp_nd_df34$id == 34 & med_exp_nd_df34$year >= 1995, 1, 0))
med_exp_nd_df36$treated <- as.integer(ifelse(med_exp_nd_df36$id == 36 & med_exp_nd_df36$year >= 1995, 1, 0))
med_exp_nd_df37$treated <- as.integer(ifelse(med_exp_nd_df37$id == 37 & med_exp_nd_df37$year >= 1995, 1, 0))
med_exp_nd_df39$treated <- as.integer(ifelse(med_exp_nd_df39$id == 39 & med_exp_nd_df39$year >= 1995, 1, 0))
med_exp_nd_df40$treated <- as.integer(ifelse(med_exp_nd_df40$id == 40 & med_exp_nd_df40$year >= 1995, 1, 0))
med_exp_nd_df41$treated <- as.integer(ifelse(med_exp_nd_df41$id == 41 & med_exp_nd_df41$year >= 1995, 1, 0))
med_exp_nd_df44$treated <- as.integer(ifelse(med_exp_nd_df44$id == 44 & med_exp_nd_df44$year >= 1995, 1, 0))
med_exp_nd_df45$treated <- as.integer(ifelse(med_exp_nd_df45$id == 45 & med_exp_nd_df45$year >= 1995, 1, 0))
med_exp_nd_df47$treated <- as.integer(ifelse(med_exp_nd_df47$id == 47 & med_exp_nd_df47$year >= 1995, 1, 0))
med_exp_nd_df50$treated <- as.integer(ifelse(med_exp_nd_df50$id == 50 & med_exp_nd_df50$year >= 1995, 1, 0))
med_exp_nd_df51$treated <- as.integer(ifelse(med_exp_nd_df51$id == 51 & med_exp_nd_df51$year >= 1995, 1, 0))
med_exp_nd_df53$treated <- as.integer(ifelse(med_exp_nd_df53$id == 53 & med_exp_nd_df53$year >= 1995, 1, 0))
med_exp_nd_df54$treated <- as.integer(ifelse(med_exp_nd_df54$id == 54 & med_exp_nd_df54$year >= 1995, 1, 0))
med_exp_nd_df55$treated <- as.integer(ifelse(med_exp_nd_df55$id == 55 & med_exp_nd_df55$year >= 1995, 1, 0))
med_exp_nd_df_list <- list(med_exp_nd_df1,med_exp_nd_df2,med_exp_nd_df5,
                           med_exp_nd_df10,med_exp_nd_df11,med_exp_nd_df12,
                           med_exp_nd_df13,med_exp_nd_df15,med_exp_nd_df17,
                           med_exp_nd_df19,med_exp_nd_df21,med_exp_nd_df23,
                           med_exp_nd_df24,med_exp_nd_df25,med_exp_nd_df26,
                           med_exp_nd_df28,med_exp_nd_df29,med_exp_nd_df30,
                           med_exp_nd_df31,med_exp_nd_df32,med_exp_nd_df33,
                           med_exp_nd_df34,med_exp_nd_df36,med_exp_nd_df37,
                           med_exp_nd_df39,med_exp_nd_df40,med_exp_nd_df41,
                           med_exp_nd_df44,med_exp_nd_df45,med_exp_nd_df47,
                           med_exp_nd_df50,med_exp_nd_df51,med_exp_nd_df53,
                           med_exp_nd_df54,med_exp_nd_df55)
rm(med_exp_nd_df1,med_exp_nd_df2,med_exp_nd_df5,
   med_exp_nd_df10,med_exp_nd_df11,med_exp_nd_df12,
   med_exp_nd_df13,med_exp_nd_df15,med_exp_nd_df17,
   med_exp_nd_df19,med_exp_nd_df21,med_exp_nd_df23,
   med_exp_nd_df24,med_exp_nd_df25,med_exp_nd_df26,
   med_exp_nd_df28,med_exp_nd_df29,med_exp_nd_df30,
   med_exp_nd_df31,med_exp_nd_df32,med_exp_nd_df33,
   med_exp_nd_df34,med_exp_nd_df36,med_exp_nd_df37,
   med_exp_nd_df39,med_exp_nd_df40,med_exp_nd_df41,
   med_exp_nd_df44,med_exp_nd_df45,med_exp_nd_df47,
   med_exp_nd_df50,med_exp_nd_df51,med_exp_nd_df53,
   med_exp_nd_df54,med_exp_nd_df55)
med_exp_nd_df_list <- lapply(med_exp_nd_df_list, function(x) {
  x <- x[order(x$year, x$treated_aux, x$name),]
  return(x)
}
)
med_exp_nd_df_list <- lapply(med_exp_nd_df_list, function(x) {
  data.frame(subset(x, alwaysconpa == 1, select=c(name, year, medicaid_exp, treated)))
}
)
setup_med_exp_nd1 <- panel.matrices(med_exp_nd_df_list[[1]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd2 <- panel.matrices(med_exp_nd_df_list[[2]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd5 <- panel.matrices(med_exp_nd_df_list[[3]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd10 <- panel.matrices(med_exp_nd_df_list[[4]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd11 <- panel.matrices(med_exp_nd_df_list[[5]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd12 <- panel.matrices(med_exp_nd_df_list[[6]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd13 <- panel.matrices(med_exp_nd_df_list[[7]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd15 <- panel.matrices(med_exp_nd_df_list[[8]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd17 <- panel.matrices(med_exp_nd_df_list[[9]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd19 <- panel.matrices(med_exp_nd_df_list[[10]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd21 <- panel.matrices(med_exp_nd_df_list[[11]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd23 <- panel.matrices(med_exp_nd_df_list[[12]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd24 <- panel.matrices(med_exp_nd_df_list[[13]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd25 <- panel.matrices(med_exp_nd_df_list[[14]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd26 <- panel.matrices(med_exp_nd_df_list[[15]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd28 <- panel.matrices(med_exp_nd_df_list[[16]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd29 <- panel.matrices(med_exp_nd_df_list[[17]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd30 <- panel.matrices(med_exp_nd_df_list[[18]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd31 <- panel.matrices(med_exp_nd_df_list[[19]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd32 <- panel.matrices(med_exp_nd_df_list[[20]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd33 <- panel.matrices(med_exp_nd_df_list[[21]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd34 <- panel.matrices(med_exp_nd_df_list[[22]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd36 <- panel.matrices(med_exp_nd_df_list[[23]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd37 <- panel.matrices(med_exp_nd_df_list[[24]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd39 <- panel.matrices(med_exp_nd_df_list[[25]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd40 <- panel.matrices(med_exp_nd_df_list[[26]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd41 <- panel.matrices(med_exp_nd_df_list[[27]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd44 <- panel.matrices(med_exp_nd_df_list[[28]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd45 <- panel.matrices(med_exp_nd_df_list[[29]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd47 <- panel.matrices(med_exp_nd_df_list[[30]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd50 <- panel.matrices(med_exp_nd_df_list[[31]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd51 <- panel.matrices(med_exp_nd_df_list[[32]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd53 <- panel.matrices(med_exp_nd_df_list[[33]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd54 <- panel.matrices(med_exp_nd_df_list[[34]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd55 <- panel.matrices(med_exp_nd_df_list[[35]], unit = 1, time = 2, outcome = 3, treatment = 4)
setup_med_exp_nd_list <- list(setup_med_exp_nd1,setup_med_exp_nd2,setup_med_exp_nd5,
                              setup_med_exp_nd10,setup_med_exp_nd11,setup_med_exp_nd12,
                              setup_med_exp_nd13,setup_med_exp_nd15,setup_med_exp_nd17,
                              setup_med_exp_nd19,setup_med_exp_nd21,setup_med_exp_nd23,
                              setup_med_exp_nd24,setup_med_exp_nd25,setup_med_exp_nd26,
                              setup_med_exp_nd28,setup_med_exp_nd29,setup_med_exp_nd30,
                              setup_med_exp_nd31,setup_med_exp_nd32,setup_med_exp_nd33,
                              setup_med_exp_nd34,setup_med_exp_nd36,setup_med_exp_nd37,
                              setup_med_exp_nd39,setup_med_exp_nd40,setup_med_exp_nd41,
                              setup_med_exp_nd44,setup_med_exp_nd45,setup_med_exp_nd47,
                              setup_med_exp_nd50,setup_med_exp_nd51,setup_med_exp_nd53,
                              setup_med_exp_nd54,setup_med_exp_nd55)
rm(setup_med_exp_nd1,setup_med_exp_nd2,setup_med_exp_nd5,
   setup_med_exp_nd10,setup_med_exp_nd11,setup_med_exp_nd12,
   setup_med_exp_nd13,setup_med_exp_nd15,setup_med_exp_nd17,
   setup_med_exp_nd19,setup_med_exp_nd21,setup_med_exp_nd23,
   setup_med_exp_nd24,setup_med_exp_nd25,setup_med_exp_nd26,
   setup_med_exp_nd28,setup_med_exp_nd29,setup_med_exp_nd30,
   setup_med_exp_nd31,setup_med_exp_nd32,setup_med_exp_nd33,
   setup_med_exp_nd34,setup_med_exp_nd36,setup_med_exp_nd37,
   setup_med_exp_nd39,setup_med_exp_nd40,setup_med_exp_nd41,
   setup_med_exp_nd44,setup_med_exp_nd45,setup_med_exp_nd47,
   setup_med_exp_nd50,setup_med_exp_nd51,setup_med_exp_nd53,
   setup_med_exp_nd54,setup_med_exp_nd55)
# DID #
med_exp_nd_est_did1 <- did_estimate(setup_med_exp_nd_list[[1]]$Y, setup_med_exp_nd_list[[1]]$N0, setup_med_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_nd_est_did2 <- did_estimate(setup_med_exp_nd_list[[2]]$Y, setup_med_exp_nd_list[[2]]$N0, setup_med_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_nd_est_did5 <- did_estimate(setup_med_exp_nd_list[[3]]$Y, setup_med_exp_nd_list[[3]]$N0, setup_med_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_nd_est_did10 <- did_estimate(setup_med_exp_nd_list[[4]]$Y, setup_med_exp_nd_list[[4]]$N0, setup_med_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_nd_est_did11 <- did_estimate(setup_med_exp_nd_list[[5]]$Y, setup_med_exp_nd_list[[5]]$N0, setup_med_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_nd_est_did12 <- did_estimate(setup_med_exp_nd_list[[6]]$Y, setup_med_exp_nd_list[[6]]$N0, setup_med_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_nd_est_did13 <- did_estimate(setup_med_exp_nd_list[[7]]$Y, setup_med_exp_nd_list[[7]]$N0, setup_med_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_nd_est_did15 <- did_estimate(setup_med_exp_nd_list[[8]]$Y, setup_med_exp_nd_list[[8]]$N0, setup_med_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_nd_est_did17 <- did_estimate(setup_med_exp_nd_list[[9]]$Y, setup_med_exp_nd_list[[9]]$N0, setup_med_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_nd_est_did19 <- did_estimate(setup_med_exp_nd_list[[10]]$Y, setup_med_exp_nd_list[[10]]$N0, setup_med_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_nd_est_did21 <- did_estimate(setup_med_exp_nd_list[[11]]$Y, setup_med_exp_nd_list[[11]]$N0, setup_med_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_nd_est_did23 <- did_estimate(setup_med_exp_nd_list[[12]]$Y, setup_med_exp_nd_list[[12]]$N0, setup_med_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_nd_est_did24 <- did_estimate(setup_med_exp_nd_list[[13]]$Y, setup_med_exp_nd_list[[13]]$N0, setup_med_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_nd_est_did25 <- did_estimate(setup_med_exp_nd_list[[14]]$Y, setup_med_exp_nd_list[[14]]$N0, setup_med_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_nd_est_did26 <- did_estimate(setup_med_exp_nd_list[[15]]$Y, setup_med_exp_nd_list[[15]]$N0, setup_med_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_nd_est_did28 <- did_estimate(setup_med_exp_nd_list[[16]]$Y, setup_med_exp_nd_list[[16]]$N0, setup_med_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_nd_est_did29 <- did_estimate(setup_med_exp_nd_list[[17]]$Y, setup_med_exp_nd_list[[17]]$N0, setup_med_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_nd_est_did30 <- did_estimate(setup_med_exp_nd_list[[18]]$Y, setup_med_exp_nd_list[[18]]$N0, setup_med_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_nd_est_did31 <- did_estimate(setup_med_exp_nd_list[[19]]$Y, setup_med_exp_nd_list[[19]]$N0, setup_med_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_nd_est_did32 <- did_estimate(setup_med_exp_nd_list[[20]]$Y, setup_med_exp_nd_list[[20]]$N0, setup_med_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_nd_est_did33 <- did_estimate(setup_med_exp_nd_list[[21]]$Y, setup_med_exp_nd_list[[21]]$N0, setup_med_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_nd_est_did34 <- did_estimate(setup_med_exp_nd_list[[22]]$Y, setup_med_exp_nd_list[[22]]$N0, setup_med_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_nd_est_did36 <- did_estimate(setup_med_exp_nd_list[[23]]$Y, setup_med_exp_nd_list[[23]]$N0, setup_med_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_nd_est_did37 <- did_estimate(setup_med_exp_nd_list[[24]]$Y, setup_med_exp_nd_list[[24]]$N0, setup_med_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_nd_est_did39 <- did_estimate(setup_med_exp_nd_list[[25]]$Y, setup_med_exp_nd_list[[25]]$N0, setup_med_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_nd_est_did40 <- did_estimate(setup_med_exp_nd_list[[26]]$Y, setup_med_exp_nd_list[[26]]$N0, setup_med_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_nd_est_did41 <- did_estimate(setup_med_exp_nd_list[[27]]$Y, setup_med_exp_nd_list[[27]]$N0, setup_med_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_nd_est_did44 <- did_estimate(setup_med_exp_nd_list[[28]]$Y, setup_med_exp_nd_list[[28]]$N0, setup_med_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_nd_est_did45 <- did_estimate(setup_med_exp_nd_list[[29]]$Y, setup_med_exp_nd_list[[29]]$N0, setup_med_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_nd_est_did47 <- did_estimate(setup_med_exp_nd_list[[30]]$Y, setup_med_exp_nd_list[[30]]$N0, setup_med_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_nd_est_did50 <- did_estimate(setup_med_exp_nd_list[[31]]$Y, setup_med_exp_nd_list[[31]]$N0, setup_med_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_nd_est_did51 <- did_estimate(setup_med_exp_nd_list[[32]]$Y, setup_med_exp_nd_list[[32]]$N0, setup_med_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_nd_est_did53 <- did_estimate(setup_med_exp_nd_list[[33]]$Y, setup_med_exp_nd_list[[33]]$N0, setup_med_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_nd_est_did54 <- did_estimate(setup_med_exp_nd_list[[34]]$Y, setup_med_exp_nd_list[[34]]$N0, setup_med_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_nd_est_did55 <- did_estimate(setup_med_exp_nd_list[[35]]$Y, setup_med_exp_nd_list[[35]]$N0, setup_med_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_nd_est_did_list <- list(med_exp_nd_est_did1,med_exp_nd_est_did2,med_exp_nd_est_did5,
                                med_exp_nd_est_did10,med_exp_nd_est_did11,med_exp_nd_est_did12,
                                med_exp_nd_est_did13,med_exp_nd_est_did15,med_exp_nd_est_did17,
                                med_exp_nd_est_did19,med_exp_nd_est_did21,med_exp_nd_est_did23,
                                med_exp_nd_est_did24,med_exp_nd_est_did25,med_exp_nd_est_did26,
                                med_exp_nd_est_did28,med_exp_nd_est_did29,med_exp_nd_est_did30,
                                med_exp_nd_est_did31,med_exp_nd_est_did32,med_exp_nd_est_did33,
                                med_exp_nd_est_did34,med_exp_nd_est_did36,med_exp_nd_est_did37,
                                med_exp_nd_est_did39,med_exp_nd_est_did40,med_exp_nd_est_did41,
                                med_exp_nd_est_did44,med_exp_nd_est_did45,med_exp_nd_est_did47,
                                med_exp_nd_est_did50,med_exp_nd_est_did51,med_exp_nd_est_did53,
                                med_exp_nd_est_did54,med_exp_nd_est_did55)
rm(med_exp_nd_est_did1,med_exp_nd_est_did2,med_exp_nd_est_did5,
   med_exp_nd_est_did10,med_exp_nd_est_did11,med_exp_nd_est_did12,
   med_exp_nd_est_did13,med_exp_nd_est_did15,med_exp_nd_est_did17,
   med_exp_nd_est_did19,med_exp_nd_est_did21,med_exp_nd_est_did23,
   med_exp_nd_est_did24,med_exp_nd_est_did25,med_exp_nd_est_did26,
   med_exp_nd_est_did28,med_exp_nd_est_did29,med_exp_nd_est_did30,
   med_exp_nd_est_did31,med_exp_nd_est_did32,med_exp_nd_est_did33,
   med_exp_nd_est_did34,med_exp_nd_est_did36,med_exp_nd_est_did37,
   med_exp_nd_est_did39,med_exp_nd_est_did40,med_exp_nd_est_did41,
   med_exp_nd_est_did44,med_exp_nd_est_did45,med_exp_nd_est_did47,
   med_exp_nd_est_did50,med_exp_nd_est_did51,med_exp_nd_est_did53,
   med_exp_nd_est_did54,med_exp_nd_est_did55)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_did_plot", i), synthdid_plot(med_exp_nd_est_did_list[i]))
}
med_exp_nd_est_did_plot_data_aux1 <- ggplot_build(med_exp_nd_est_did_plot1)
med_exp_nd_est_did_plot_data_aux2 <- ggplot_build(med_exp_nd_est_did_plot2)
med_exp_nd_est_did_plot_data_aux3 <- ggplot_build(med_exp_nd_est_did_plot3)
med_exp_nd_est_did_plot_data_aux4 <- ggplot_build(med_exp_nd_est_did_plot4)
med_exp_nd_est_did_plot_data_aux5 <- ggplot_build(med_exp_nd_est_did_plot5)
med_exp_nd_est_did_plot_data_aux6 <- ggplot_build(med_exp_nd_est_did_plot6)
med_exp_nd_est_did_plot_data_aux7 <- ggplot_build(med_exp_nd_est_did_plot7)
med_exp_nd_est_did_plot_data_aux8 <- ggplot_build(med_exp_nd_est_did_plot8)
med_exp_nd_est_did_plot_data_aux9 <- ggplot_build(med_exp_nd_est_did_plot9)
med_exp_nd_est_did_plot_data_aux10 <- ggplot_build(med_exp_nd_est_did_plot10)
med_exp_nd_est_did_plot_data_aux11 <- ggplot_build(med_exp_nd_est_did_plot11)
med_exp_nd_est_did_plot_data_aux12 <- ggplot_build(med_exp_nd_est_did_plot12)
med_exp_nd_est_did_plot_data_aux13 <- ggplot_build(med_exp_nd_est_did_plot13)
med_exp_nd_est_did_plot_data_aux14 <- ggplot_build(med_exp_nd_est_did_plot14)
med_exp_nd_est_did_plot_data_aux15 <- ggplot_build(med_exp_nd_est_did_plot15)
med_exp_nd_est_did_plot_data_aux16 <- ggplot_build(med_exp_nd_est_did_plot16)
med_exp_nd_est_did_plot_data_aux17 <- ggplot_build(med_exp_nd_est_did_plot17)
med_exp_nd_est_did_plot_data_aux18 <- ggplot_build(med_exp_nd_est_did_plot18)
med_exp_nd_est_did_plot_data_aux19 <- ggplot_build(med_exp_nd_est_did_plot19)
med_exp_nd_est_did_plot_data_aux20 <- ggplot_build(med_exp_nd_est_did_plot20)
med_exp_nd_est_did_plot_data_aux21 <- ggplot_build(med_exp_nd_est_did_plot21)
med_exp_nd_est_did_plot_data_aux22 <- ggplot_build(med_exp_nd_est_did_plot22)
med_exp_nd_est_did_plot_data_aux23 <- ggplot_build(med_exp_nd_est_did_plot23)
med_exp_nd_est_did_plot_data_aux24 <- ggplot_build(med_exp_nd_est_did_plot24)
med_exp_nd_est_did_plot_data_aux25 <- ggplot_build(med_exp_nd_est_did_plot25)
med_exp_nd_est_did_plot_data_aux26 <- ggplot_build(med_exp_nd_est_did_plot26)
med_exp_nd_est_did_plot_data_aux27 <- ggplot_build(med_exp_nd_est_did_plot27)
med_exp_nd_est_did_plot_data_aux28 <- ggplot_build(med_exp_nd_est_did_plot28)
med_exp_nd_est_did_plot_data_aux29 <- ggplot_build(med_exp_nd_est_did_plot29)
med_exp_nd_est_did_plot_data_aux30 <- ggplot_build(med_exp_nd_est_did_plot30)
med_exp_nd_est_did_plot_data_aux31 <- ggplot_build(med_exp_nd_est_did_plot31)
med_exp_nd_est_did_plot_data_aux32 <- ggplot_build(med_exp_nd_est_did_plot32)
med_exp_nd_est_did_plot_data_aux33 <- ggplot_build(med_exp_nd_est_did_plot33)
med_exp_nd_est_did_plot_data_aux34 <- ggplot_build(med_exp_nd_est_did_plot34)
med_exp_nd_est_did_plot_data_aux35 <- ggplot_build(med_exp_nd_est_did_plot35)
med_exp_nd_est_did_plot_data_aux_list <- list(med_exp_nd_est_did_plot_data_aux1,med_exp_nd_est_did_plot_data_aux2,med_exp_nd_est_did_plot_data_aux3,
                                              med_exp_nd_est_did_plot_data_aux4,med_exp_nd_est_did_plot_data_aux5,med_exp_nd_est_did_plot_data_aux6,
                                              med_exp_nd_est_did_plot_data_aux7,med_exp_nd_est_did_plot_data_aux8,med_exp_nd_est_did_plot_data_aux9,
                                              med_exp_nd_est_did_plot_data_aux10,med_exp_nd_est_did_plot_data_aux11,med_exp_nd_est_did_plot_data_aux12,
                                              med_exp_nd_est_did_plot_data_aux13,med_exp_nd_est_did_plot_data_aux14,med_exp_nd_est_did_plot_data_aux15,
                                              med_exp_nd_est_did_plot_data_aux16,med_exp_nd_est_did_plot_data_aux17,med_exp_nd_est_did_plot_data_aux18,
                                              med_exp_nd_est_did_plot_data_aux19,med_exp_nd_est_did_plot_data_aux20,med_exp_nd_est_did_plot_data_aux21,
                                              med_exp_nd_est_did_plot_data_aux22,med_exp_nd_est_did_plot_data_aux23,med_exp_nd_est_did_plot_data_aux24,
                                              med_exp_nd_est_did_plot_data_aux25,med_exp_nd_est_did_plot_data_aux26,med_exp_nd_est_did_plot_data_aux27,
                                              med_exp_nd_est_did_plot_data_aux28,med_exp_nd_est_did_plot_data_aux29,med_exp_nd_est_did_plot_data_aux30,
                                              med_exp_nd_est_did_plot_data_aux31,med_exp_nd_est_did_plot_data_aux32,med_exp_nd_est_did_plot_data_aux33,
                                              med_exp_nd_est_did_plot_data_aux34,med_exp_nd_est_did_plot_data_aux35)
rm(med_exp_nd_est_did_plot_data_aux1,med_exp_nd_est_did_plot_data_aux2,med_exp_nd_est_did_plot_data_aux3,
   med_exp_nd_est_did_plot_data_aux4,med_exp_nd_est_did_plot_data_aux5,med_exp_nd_est_did_plot_data_aux6,
   med_exp_nd_est_did_plot_data_aux7,med_exp_nd_est_did_plot_data_aux8,med_exp_nd_est_did_plot_data_aux9,
   med_exp_nd_est_did_plot_data_aux10,med_exp_nd_est_did_plot_data_aux11,med_exp_nd_est_did_plot_data_aux12,
   med_exp_nd_est_did_plot_data_aux13,med_exp_nd_est_did_plot_data_aux14,med_exp_nd_est_did_plot_data_aux15,
   med_exp_nd_est_did_plot_data_aux16,med_exp_nd_est_did_plot_data_aux17,med_exp_nd_est_did_plot_data_aux18,
   med_exp_nd_est_did_plot_data_aux19,med_exp_nd_est_did_plot_data_aux20,med_exp_nd_est_did_plot_data_aux21,
   med_exp_nd_est_did_plot_data_aux22,med_exp_nd_est_did_plot_data_aux23,med_exp_nd_est_did_plot_data_aux24,
   med_exp_nd_est_did_plot_data_aux25,med_exp_nd_est_did_plot_data_aux26,med_exp_nd_est_did_plot_data_aux27,
   med_exp_nd_est_did_plot_data_aux28,med_exp_nd_est_did_plot_data_aux29,med_exp_nd_est_did_plot_data_aux30,
   med_exp_nd_est_did_plot_data_aux31,med_exp_nd_est_did_plot_data_aux32,med_exp_nd_est_did_plot_data_aux33,
   med_exp_nd_est_did_plot_data_aux34,med_exp_nd_est_did_plot_data_aux35)
rm(med_exp_nd_est_did_plot1,med_exp_nd_est_did_plot2,med_exp_nd_est_did_plot3,
   med_exp_nd_est_did_plot4,med_exp_nd_est_did_plot5,med_exp_nd_est_did_plot6,
   med_exp_nd_est_did_plot7,med_exp_nd_est_did_plot8,med_exp_nd_est_did_plot9,
   med_exp_nd_est_did_plot10,med_exp_nd_est_did_plot11,med_exp_nd_est_did_plot12,
   med_exp_nd_est_did_plot13,med_exp_nd_est_did_plot14,med_exp_nd_est_did_plot15,
   med_exp_nd_est_did_plot16,med_exp_nd_est_did_plot17,med_exp_nd_est_did_plot18,
   med_exp_nd_est_did_plot19,med_exp_nd_est_did_plot20,med_exp_nd_est_did_plot21,
   med_exp_nd_est_did_plot22,med_exp_nd_est_did_plot23,med_exp_nd_est_did_plot24,
   med_exp_nd_est_did_plot25,med_exp_nd_est_did_plot26,med_exp_nd_est_did_plot27,
   med_exp_nd_est_did_plot28,med_exp_nd_est_did_plot29,med_exp_nd_est_did_plot30,
   med_exp_nd_est_did_plot31,med_exp_nd_est_did_plot32,med_exp_nd_est_did_plot33,
   med_exp_nd_est_did_plot34,med_exp_nd_est_did_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_did_plot_data_long", i), data.frame(med_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_nd_est_did_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_nd_est_did_plot_data_long_list <- list(med_exp_nd_est_did_plot_data_long1,med_exp_nd_est_did_plot_data_long2,med_exp_nd_est_did_plot_data_long3,
                                               med_exp_nd_est_did_plot_data_long4,med_exp_nd_est_did_plot_data_long5,med_exp_nd_est_did_plot_data_long6,
                                               med_exp_nd_est_did_plot_data_long7,med_exp_nd_est_did_plot_data_long8,med_exp_nd_est_did_plot_data_long9,
                                               med_exp_nd_est_did_plot_data_long10,med_exp_nd_est_did_plot_data_long11,med_exp_nd_est_did_plot_data_long12,
                                               med_exp_nd_est_did_plot_data_long13,med_exp_nd_est_did_plot_data_long14,med_exp_nd_est_did_plot_data_long15,
                                               med_exp_nd_est_did_plot_data_long16,med_exp_nd_est_did_plot_data_long17,med_exp_nd_est_did_plot_data_long18,
                                               med_exp_nd_est_did_plot_data_long19,med_exp_nd_est_did_plot_data_long20,med_exp_nd_est_did_plot_data_long21,
                                               med_exp_nd_est_did_plot_data_long22,med_exp_nd_est_did_plot_data_long23,med_exp_nd_est_did_plot_data_long24,
                                               med_exp_nd_est_did_plot_data_long25,med_exp_nd_est_did_plot_data_long26,med_exp_nd_est_did_plot_data_long27,
                                               med_exp_nd_est_did_plot_data_long28,med_exp_nd_est_did_plot_data_long29,med_exp_nd_est_did_plot_data_long30,
                                               med_exp_nd_est_did_plot_data_long31,med_exp_nd_est_did_plot_data_long32,med_exp_nd_est_did_plot_data_long33,
                                               med_exp_nd_est_did_plot_data_long34,med_exp_nd_est_did_plot_data_long35)
rm(med_exp_nd_est_did_plot_data_long1,med_exp_nd_est_did_plot_data_long2,med_exp_nd_est_did_plot_data_long3,
   med_exp_nd_est_did_plot_data_long4,med_exp_nd_est_did_plot_data_long5,med_exp_nd_est_did_plot_data_long6,
   med_exp_nd_est_did_plot_data_long7,med_exp_nd_est_did_plot_data_long8,med_exp_nd_est_did_plot_data_long9,
   med_exp_nd_est_did_plot_data_long10,med_exp_nd_est_did_plot_data_long11,med_exp_nd_est_did_plot_data_long12,
   med_exp_nd_est_did_plot_data_long13,med_exp_nd_est_did_plot_data_long14,med_exp_nd_est_did_plot_data_long15,
   med_exp_nd_est_did_plot_data_long16,med_exp_nd_est_did_plot_data_long17,med_exp_nd_est_did_plot_data_long18,
   med_exp_nd_est_did_plot_data_long19,med_exp_nd_est_did_plot_data_long20,med_exp_nd_est_did_plot_data_long21,
   med_exp_nd_est_did_plot_data_long22,med_exp_nd_est_did_plot_data_long23,med_exp_nd_est_did_plot_data_long24,
   med_exp_nd_est_did_plot_data_long25,med_exp_nd_est_did_plot_data_long26,med_exp_nd_est_did_plot_data_long27,
   med_exp_nd_est_did_plot_data_long28,med_exp_nd_est_did_plot_data_long29,med_exp_nd_est_did_plot_data_long30,
   med_exp_nd_est_did_plot_data_long31,med_exp_nd_est_did_plot_data_long32,med_exp_nd_est_did_plot_data_long33,
   med_exp_nd_est_did_plot_data_long34,med_exp_nd_est_did_plot_data_long35)
med_exp_nd_est_did_plot_data_long_list <- lapply(med_exp_nd_est_did_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_did_plot_data_wide", i), reshape(data=med_exp_nd_est_did_plot_data_long_list[[i]],
                                                                 idvar = "year",
                                                                 v.names = "outcome",
                                                                 timevar = "treated",
                                                                 direction = "wide"))
}
med_exp_nd_est_did_plot_data_wide_list <- list(med_exp_nd_est_did_plot_data_wide1,med_exp_nd_est_did_plot_data_wide2,med_exp_nd_est_did_plot_data_wide3,
                                               med_exp_nd_est_did_plot_data_wide4,med_exp_nd_est_did_plot_data_wide5,med_exp_nd_est_did_plot_data_wide6,
                                               med_exp_nd_est_did_plot_data_wide7,med_exp_nd_est_did_plot_data_wide8,med_exp_nd_est_did_plot_data_wide9,
                                               med_exp_nd_est_did_plot_data_wide10,med_exp_nd_est_did_plot_data_wide11,med_exp_nd_est_did_plot_data_wide12,
                                               med_exp_nd_est_did_plot_data_wide13,med_exp_nd_est_did_plot_data_wide14,med_exp_nd_est_did_plot_data_wide15,
                                               med_exp_nd_est_did_plot_data_wide16,med_exp_nd_est_did_plot_data_wide17,med_exp_nd_est_did_plot_data_wide18,
                                               med_exp_nd_est_did_plot_data_wide19,med_exp_nd_est_did_plot_data_wide20,med_exp_nd_est_did_plot_data_wide21,
                                               med_exp_nd_est_did_plot_data_wide22,med_exp_nd_est_did_plot_data_wide23,med_exp_nd_est_did_plot_data_wide24,
                                               med_exp_nd_est_did_plot_data_wide25,med_exp_nd_est_did_plot_data_wide26,med_exp_nd_est_did_plot_data_wide27,
                                               med_exp_nd_est_did_plot_data_wide28,med_exp_nd_est_did_plot_data_wide29,med_exp_nd_est_did_plot_data_wide30,
                                               med_exp_nd_est_did_plot_data_wide31,med_exp_nd_est_did_plot_data_wide32,med_exp_nd_est_did_plot_data_wide33,
                                               med_exp_nd_est_did_plot_data_wide34,med_exp_nd_est_did_plot_data_wide35)
rm(med_exp_nd_est_did_plot_data_wide1,med_exp_nd_est_did_plot_data_wide2,med_exp_nd_est_did_plot_data_wide3,
   med_exp_nd_est_did_plot_data_wide4,med_exp_nd_est_did_plot_data_wide5,med_exp_nd_est_did_plot_data_wide6,
   med_exp_nd_est_did_plot_data_wide7,med_exp_nd_est_did_plot_data_wide8,med_exp_nd_est_did_plot_data_wide9,
   med_exp_nd_est_did_plot_data_wide10,med_exp_nd_est_did_plot_data_wide11,med_exp_nd_est_did_plot_data_wide12,
   med_exp_nd_est_did_plot_data_wide13,med_exp_nd_est_did_plot_data_wide14,med_exp_nd_est_did_plot_data_wide15,
   med_exp_nd_est_did_plot_data_wide16,med_exp_nd_est_did_plot_data_wide17,med_exp_nd_est_did_plot_data_wide18,
   med_exp_nd_est_did_plot_data_wide19,med_exp_nd_est_did_plot_data_wide20,med_exp_nd_est_did_plot_data_wide21,
   med_exp_nd_est_did_plot_data_wide22,med_exp_nd_est_did_plot_data_wide23,med_exp_nd_est_did_plot_data_wide24,
   med_exp_nd_est_did_plot_data_wide25,med_exp_nd_est_did_plot_data_wide26,med_exp_nd_est_did_plot_data_wide27,
   med_exp_nd_est_did_plot_data_wide28,med_exp_nd_est_did_plot_data_wide29,med_exp_nd_est_did_plot_data_wide30,
   med_exp_nd_est_did_plot_data_wide31,med_exp_nd_est_did_plot_data_wide32,med_exp_nd_est_did_plot_data_wide33,
   med_exp_nd_est_did_plot_data_wide34,med_exp_nd_est_did_plot_data_wide35)
med_exp_nd_est_did_plot_data_wide_list <- lapply(med_exp_nd_est_did_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SC #
med_exp_nd_est_sc1 <- sc_estimate(setup_med_exp_nd_list[[1]]$Y, setup_med_exp_nd_list[[1]]$N0, setup_med_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_nd_est_sc2 <- sc_estimate(setup_med_exp_nd_list[[2]]$Y, setup_med_exp_nd_list[[2]]$N0, setup_med_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_nd_est_sc5 <- sc_estimate(setup_med_exp_nd_list[[3]]$Y, setup_med_exp_nd_list[[3]]$N0, setup_med_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_nd_est_sc10 <- sc_estimate(setup_med_exp_nd_list[[4]]$Y, setup_med_exp_nd_list[[4]]$N0, setup_med_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_nd_est_sc11 <- sc_estimate(setup_med_exp_nd_list[[5]]$Y, setup_med_exp_nd_list[[5]]$N0, setup_med_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_nd_est_sc12 <- sc_estimate(setup_med_exp_nd_list[[6]]$Y, setup_med_exp_nd_list[[6]]$N0, setup_med_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_nd_est_sc13 <- sc_estimate(setup_med_exp_nd_list[[7]]$Y, setup_med_exp_nd_list[[7]]$N0, setup_med_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_nd_est_sc15 <- sc_estimate(setup_med_exp_nd_list[[8]]$Y, setup_med_exp_nd_list[[8]]$N0, setup_med_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_nd_est_sc17 <- sc_estimate(setup_med_exp_nd_list[[9]]$Y, setup_med_exp_nd_list[[9]]$N0, setup_med_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_nd_est_sc19 <- sc_estimate(setup_med_exp_nd_list[[10]]$Y, setup_med_exp_nd_list[[10]]$N0, setup_med_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_nd_est_sc21 <- sc_estimate(setup_med_exp_nd_list[[11]]$Y, setup_med_exp_nd_list[[11]]$N0, setup_med_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_nd_est_sc23 <- sc_estimate(setup_med_exp_nd_list[[12]]$Y, setup_med_exp_nd_list[[12]]$N0, setup_med_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_nd_est_sc24 <- sc_estimate(setup_med_exp_nd_list[[13]]$Y, setup_med_exp_nd_list[[13]]$N0, setup_med_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_nd_est_sc25 <- sc_estimate(setup_med_exp_nd_list[[14]]$Y, setup_med_exp_nd_list[[14]]$N0, setup_med_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_nd_est_sc26 <- sc_estimate(setup_med_exp_nd_list[[15]]$Y, setup_med_exp_nd_list[[15]]$N0, setup_med_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_nd_est_sc28 <- sc_estimate(setup_med_exp_nd_list[[16]]$Y, setup_med_exp_nd_list[[16]]$N0, setup_med_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_nd_est_sc29 <- sc_estimate(setup_med_exp_nd_list[[17]]$Y, setup_med_exp_nd_list[[17]]$N0, setup_med_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_nd_est_sc30 <- sc_estimate(setup_med_exp_nd_list[[18]]$Y, setup_med_exp_nd_list[[18]]$N0, setup_med_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_nd_est_sc31 <- sc_estimate(setup_med_exp_nd_list[[19]]$Y, setup_med_exp_nd_list[[19]]$N0, setup_med_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_nd_est_sc32 <- sc_estimate(setup_med_exp_nd_list[[20]]$Y, setup_med_exp_nd_list[[20]]$N0, setup_med_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_nd_est_sc33 <- sc_estimate(setup_med_exp_nd_list[[21]]$Y, setup_med_exp_nd_list[[21]]$N0, setup_med_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_nd_est_sc34 <- sc_estimate(setup_med_exp_nd_list[[22]]$Y, setup_med_exp_nd_list[[22]]$N0, setup_med_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_nd_est_sc36 <- sc_estimate(setup_med_exp_nd_list[[23]]$Y, setup_med_exp_nd_list[[23]]$N0, setup_med_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_nd_est_sc37 <- sc_estimate(setup_med_exp_nd_list[[24]]$Y, setup_med_exp_nd_list[[24]]$N0, setup_med_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_nd_est_sc39 <- sc_estimate(setup_med_exp_nd_list[[25]]$Y, setup_med_exp_nd_list[[25]]$N0, setup_med_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_nd_est_sc40 <- sc_estimate(setup_med_exp_nd_list[[26]]$Y, setup_med_exp_nd_list[[26]]$N0, setup_med_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_nd_est_sc41 <- sc_estimate(setup_med_exp_nd_list[[27]]$Y, setup_med_exp_nd_list[[27]]$N0, setup_med_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_nd_est_sc44 <- sc_estimate(setup_med_exp_nd_list[[28]]$Y, setup_med_exp_nd_list[[28]]$N0, setup_med_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_nd_est_sc45 <- sc_estimate(setup_med_exp_nd_list[[29]]$Y, setup_med_exp_nd_list[[29]]$N0, setup_med_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_nd_est_sc47 <- sc_estimate(setup_med_exp_nd_list[[30]]$Y, setup_med_exp_nd_list[[30]]$N0, setup_med_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_nd_est_sc50 <- sc_estimate(setup_med_exp_nd_list[[31]]$Y, setup_med_exp_nd_list[[31]]$N0, setup_med_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_nd_est_sc51 <- sc_estimate(setup_med_exp_nd_list[[32]]$Y, setup_med_exp_nd_list[[32]]$N0, setup_med_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_nd_est_sc53 <- sc_estimate(setup_med_exp_nd_list[[33]]$Y, setup_med_exp_nd_list[[33]]$N0, setup_med_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_nd_est_sc54 <- sc_estimate(setup_med_exp_nd_list[[34]]$Y, setup_med_exp_nd_list[[34]]$N0, setup_med_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_nd_est_sc55 <- sc_estimate(setup_med_exp_nd_list[[35]]$Y, setup_med_exp_nd_list[[35]]$N0, setup_med_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_nd_est_sc_list <- list(med_exp_nd_est_sc1,med_exp_nd_est_sc2,med_exp_nd_est_sc5,
                               med_exp_nd_est_sc10,med_exp_nd_est_sc11,med_exp_nd_est_sc12,
                               med_exp_nd_est_sc13,med_exp_nd_est_sc15,med_exp_nd_est_sc17,
                               med_exp_nd_est_sc19,med_exp_nd_est_sc21,med_exp_nd_est_sc23,
                               med_exp_nd_est_sc24,med_exp_nd_est_sc25,med_exp_nd_est_sc26,
                               med_exp_nd_est_sc28,med_exp_nd_est_sc29,med_exp_nd_est_sc30,
                               med_exp_nd_est_sc31,med_exp_nd_est_sc32,med_exp_nd_est_sc33,
                               med_exp_nd_est_sc34,med_exp_nd_est_sc36,med_exp_nd_est_sc37,
                               med_exp_nd_est_sc39,med_exp_nd_est_sc40,med_exp_nd_est_sc41,
                               med_exp_nd_est_sc44,med_exp_nd_est_sc45,med_exp_nd_est_sc47,
                               med_exp_nd_est_sc50,med_exp_nd_est_sc51,med_exp_nd_est_sc53,
                               med_exp_nd_est_sc54,med_exp_nd_est_sc55)
rm(med_exp_nd_est_sc1,med_exp_nd_est_sc2,med_exp_nd_est_sc5,
   med_exp_nd_est_sc10,med_exp_nd_est_sc11,med_exp_nd_est_sc12,
   med_exp_nd_est_sc13,med_exp_nd_est_sc15,med_exp_nd_est_sc17,
   med_exp_nd_est_sc19,med_exp_nd_est_sc21,med_exp_nd_est_sc23,
   med_exp_nd_est_sc24,med_exp_nd_est_sc25,med_exp_nd_est_sc26,
   med_exp_nd_est_sc28,med_exp_nd_est_sc29,med_exp_nd_est_sc30,
   med_exp_nd_est_sc31,med_exp_nd_est_sc32,med_exp_nd_est_sc33,
   med_exp_nd_est_sc34,med_exp_nd_est_sc36,med_exp_nd_est_sc37,
   med_exp_nd_est_sc39,med_exp_nd_est_sc40,med_exp_nd_est_sc41,
   med_exp_nd_est_sc44,med_exp_nd_est_sc45,med_exp_nd_est_sc47,
   med_exp_nd_est_sc50,med_exp_nd_est_sc51,med_exp_nd_est_sc53,
   med_exp_nd_est_sc54,med_exp_nd_est_sc55)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sc_plot", i), synthdid_plot(med_exp_nd_est_sc_list[i]))
}
med_exp_nd_est_sc_plot_data_aux1 <- ggplot_build(med_exp_nd_est_sc_plot1)
med_exp_nd_est_sc_plot_data_aux2 <- ggplot_build(med_exp_nd_est_sc_plot2)
med_exp_nd_est_sc_plot_data_aux3 <- ggplot_build(med_exp_nd_est_sc_plot3)
med_exp_nd_est_sc_plot_data_aux4 <- ggplot_build(med_exp_nd_est_sc_plot4)
med_exp_nd_est_sc_plot_data_aux5 <- ggplot_build(med_exp_nd_est_sc_plot5)
med_exp_nd_est_sc_plot_data_aux6 <- ggplot_build(med_exp_nd_est_sc_plot6)
med_exp_nd_est_sc_plot_data_aux7 <- ggplot_build(med_exp_nd_est_sc_plot7)
med_exp_nd_est_sc_plot_data_aux8 <- ggplot_build(med_exp_nd_est_sc_plot8)
med_exp_nd_est_sc_plot_data_aux9 <- ggplot_build(med_exp_nd_est_sc_plot9)
med_exp_nd_est_sc_plot_data_aux10 <- ggplot_build(med_exp_nd_est_sc_plot10)
med_exp_nd_est_sc_plot_data_aux11 <- ggplot_build(med_exp_nd_est_sc_plot11)
med_exp_nd_est_sc_plot_data_aux12 <- ggplot_build(med_exp_nd_est_sc_plot12)
med_exp_nd_est_sc_plot_data_aux13 <- ggplot_build(med_exp_nd_est_sc_plot13)
med_exp_nd_est_sc_plot_data_aux14 <- ggplot_build(med_exp_nd_est_sc_plot14)
med_exp_nd_est_sc_plot_data_aux15 <- ggplot_build(med_exp_nd_est_sc_plot15)
med_exp_nd_est_sc_plot_data_aux16 <- ggplot_build(med_exp_nd_est_sc_plot16)
med_exp_nd_est_sc_plot_data_aux17 <- ggplot_build(med_exp_nd_est_sc_plot17)
med_exp_nd_est_sc_plot_data_aux18 <- ggplot_build(med_exp_nd_est_sc_plot18)
med_exp_nd_est_sc_plot_data_aux19 <- ggplot_build(med_exp_nd_est_sc_plot19)
med_exp_nd_est_sc_plot_data_aux20 <- ggplot_build(med_exp_nd_est_sc_plot20)
med_exp_nd_est_sc_plot_data_aux21 <- ggplot_build(med_exp_nd_est_sc_plot21)
med_exp_nd_est_sc_plot_data_aux22 <- ggplot_build(med_exp_nd_est_sc_plot22)
med_exp_nd_est_sc_plot_data_aux23 <- ggplot_build(med_exp_nd_est_sc_plot23)
med_exp_nd_est_sc_plot_data_aux24 <- ggplot_build(med_exp_nd_est_sc_plot24)
med_exp_nd_est_sc_plot_data_aux25 <- ggplot_build(med_exp_nd_est_sc_plot25)
med_exp_nd_est_sc_plot_data_aux26 <- ggplot_build(med_exp_nd_est_sc_plot26)
med_exp_nd_est_sc_plot_data_aux27 <- ggplot_build(med_exp_nd_est_sc_plot27)
med_exp_nd_est_sc_plot_data_aux28 <- ggplot_build(med_exp_nd_est_sc_plot28)
med_exp_nd_est_sc_plot_data_aux29 <- ggplot_build(med_exp_nd_est_sc_plot29)
med_exp_nd_est_sc_plot_data_aux30 <- ggplot_build(med_exp_nd_est_sc_plot30)
med_exp_nd_est_sc_plot_data_aux31 <- ggplot_build(med_exp_nd_est_sc_plot31)
med_exp_nd_est_sc_plot_data_aux32 <- ggplot_build(med_exp_nd_est_sc_plot32)
med_exp_nd_est_sc_plot_data_aux33 <- ggplot_build(med_exp_nd_est_sc_plot33)
med_exp_nd_est_sc_plot_data_aux34 <- ggplot_build(med_exp_nd_est_sc_plot34)
med_exp_nd_est_sc_plot_data_aux35 <- ggplot_build(med_exp_nd_est_sc_plot35)
med_exp_nd_est_sc_plot_data_aux_list <- list(med_exp_nd_est_sc_plot_data_aux1,med_exp_nd_est_sc_plot_data_aux2,med_exp_nd_est_sc_plot_data_aux3,
                                             med_exp_nd_est_sc_plot_data_aux4,med_exp_nd_est_sc_plot_data_aux5,med_exp_nd_est_sc_plot_data_aux6,
                                             med_exp_nd_est_sc_plot_data_aux7,med_exp_nd_est_sc_plot_data_aux8,med_exp_nd_est_sc_plot_data_aux9,
                                             med_exp_nd_est_sc_plot_data_aux10,med_exp_nd_est_sc_plot_data_aux11,med_exp_nd_est_sc_plot_data_aux12,
                                             med_exp_nd_est_sc_plot_data_aux13,med_exp_nd_est_sc_plot_data_aux14,med_exp_nd_est_sc_plot_data_aux15,
                                             med_exp_nd_est_sc_plot_data_aux16,med_exp_nd_est_sc_plot_data_aux17,med_exp_nd_est_sc_plot_data_aux18,
                                             med_exp_nd_est_sc_plot_data_aux19,med_exp_nd_est_sc_plot_data_aux20,med_exp_nd_est_sc_plot_data_aux21,
                                             med_exp_nd_est_sc_plot_data_aux22,med_exp_nd_est_sc_plot_data_aux23,med_exp_nd_est_sc_plot_data_aux24,
                                             med_exp_nd_est_sc_plot_data_aux25,med_exp_nd_est_sc_plot_data_aux26,med_exp_nd_est_sc_plot_data_aux27,
                                             med_exp_nd_est_sc_plot_data_aux28,med_exp_nd_est_sc_plot_data_aux29,med_exp_nd_est_sc_plot_data_aux30,
                                             med_exp_nd_est_sc_plot_data_aux31,med_exp_nd_est_sc_plot_data_aux32,med_exp_nd_est_sc_plot_data_aux33,
                                             med_exp_nd_est_sc_plot_data_aux34,med_exp_nd_est_sc_plot_data_aux35)
rm(med_exp_nd_est_sc_plot_data_aux1,med_exp_nd_est_sc_plot_data_aux2,med_exp_nd_est_sc_plot_data_aux3,
   med_exp_nd_est_sc_plot_data_aux4,med_exp_nd_est_sc_plot_data_aux5,med_exp_nd_est_sc_plot_data_aux6,
   med_exp_nd_est_sc_plot_data_aux7,med_exp_nd_est_sc_plot_data_aux8,med_exp_nd_est_sc_plot_data_aux9,
   med_exp_nd_est_sc_plot_data_aux10,med_exp_nd_est_sc_plot_data_aux11,med_exp_nd_est_sc_plot_data_aux12,
   med_exp_nd_est_sc_plot_data_aux13,med_exp_nd_est_sc_plot_data_aux14,med_exp_nd_est_sc_plot_data_aux15,
   med_exp_nd_est_sc_plot_data_aux16,med_exp_nd_est_sc_plot_data_aux17,med_exp_nd_est_sc_plot_data_aux18,
   med_exp_nd_est_sc_plot_data_aux19,med_exp_nd_est_sc_plot_data_aux20,med_exp_nd_est_sc_plot_data_aux21,
   med_exp_nd_est_sc_plot_data_aux22,med_exp_nd_est_sc_plot_data_aux23,med_exp_nd_est_sc_plot_data_aux24,
   med_exp_nd_est_sc_plot_data_aux25,med_exp_nd_est_sc_plot_data_aux26,med_exp_nd_est_sc_plot_data_aux27,
   med_exp_nd_est_sc_plot_data_aux28,med_exp_nd_est_sc_plot_data_aux29,med_exp_nd_est_sc_plot_data_aux30,
   med_exp_nd_est_sc_plot_data_aux31,med_exp_nd_est_sc_plot_data_aux32,med_exp_nd_est_sc_plot_data_aux33,
   med_exp_nd_est_sc_plot_data_aux34,med_exp_nd_est_sc_plot_data_aux35)
rm(med_exp_nd_est_sc_plot1,med_exp_nd_est_sc_plot2,med_exp_nd_est_sc_plot3,
   med_exp_nd_est_sc_plot4,med_exp_nd_est_sc_plot5,med_exp_nd_est_sc_plot6,
   med_exp_nd_est_sc_plot7,med_exp_nd_est_sc_plot8,med_exp_nd_est_sc_plot9,
   med_exp_nd_est_sc_plot10,med_exp_nd_est_sc_plot11,med_exp_nd_est_sc_plot12,
   med_exp_nd_est_sc_plot13,med_exp_nd_est_sc_plot14,med_exp_nd_est_sc_plot15,
   med_exp_nd_est_sc_plot16,med_exp_nd_est_sc_plot17,med_exp_nd_est_sc_plot18,
   med_exp_nd_est_sc_plot19,med_exp_nd_est_sc_plot20,med_exp_nd_est_sc_plot21,
   med_exp_nd_est_sc_plot22,med_exp_nd_est_sc_plot23,med_exp_nd_est_sc_plot24,
   med_exp_nd_est_sc_plot25,med_exp_nd_est_sc_plot26,med_exp_nd_est_sc_plot27,
   med_exp_nd_est_sc_plot28,med_exp_nd_est_sc_plot29,med_exp_nd_est_sc_plot30,
   med_exp_nd_est_sc_plot31,med_exp_nd_est_sc_plot32,med_exp_nd_est_sc_plot33,
   med_exp_nd_est_sc_plot34,med_exp_nd_est_sc_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sc_plot_data_long", i), data.frame(med_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_nd_est_sc_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_nd_est_sc_plot_data_long_list <- list(med_exp_nd_est_sc_plot_data_long1,med_exp_nd_est_sc_plot_data_long2,med_exp_nd_est_sc_plot_data_long3,
                                              med_exp_nd_est_sc_plot_data_long4,med_exp_nd_est_sc_plot_data_long5,med_exp_nd_est_sc_plot_data_long6,
                                              med_exp_nd_est_sc_plot_data_long7,med_exp_nd_est_sc_plot_data_long8,med_exp_nd_est_sc_plot_data_long9,
                                              med_exp_nd_est_sc_plot_data_long10,med_exp_nd_est_sc_plot_data_long11,med_exp_nd_est_sc_plot_data_long12,
                                              med_exp_nd_est_sc_plot_data_long13,med_exp_nd_est_sc_plot_data_long14,med_exp_nd_est_sc_plot_data_long15,
                                              med_exp_nd_est_sc_plot_data_long16,med_exp_nd_est_sc_plot_data_long17,med_exp_nd_est_sc_plot_data_long18,
                                              med_exp_nd_est_sc_plot_data_long19,med_exp_nd_est_sc_plot_data_long20,med_exp_nd_est_sc_plot_data_long21,
                                              med_exp_nd_est_sc_plot_data_long22,med_exp_nd_est_sc_plot_data_long23,med_exp_nd_est_sc_plot_data_long24,
                                              med_exp_nd_est_sc_plot_data_long25,med_exp_nd_est_sc_plot_data_long26,med_exp_nd_est_sc_plot_data_long27,
                                              med_exp_nd_est_sc_plot_data_long28,med_exp_nd_est_sc_plot_data_long29,med_exp_nd_est_sc_plot_data_long30,
                                              med_exp_nd_est_sc_plot_data_long31,med_exp_nd_est_sc_plot_data_long32,med_exp_nd_est_sc_plot_data_long33,
                                              med_exp_nd_est_sc_plot_data_long34,med_exp_nd_est_sc_plot_data_long35)
rm(med_exp_nd_est_sc_plot_data_long1,med_exp_nd_est_sc_plot_data_long2,med_exp_nd_est_sc_plot_data_long3,
   med_exp_nd_est_sc_plot_data_long4,med_exp_nd_est_sc_plot_data_long5,med_exp_nd_est_sc_plot_data_long6,
   med_exp_nd_est_sc_plot_data_long7,med_exp_nd_est_sc_plot_data_long8,med_exp_nd_est_sc_plot_data_long9,
   med_exp_nd_est_sc_plot_data_long10,med_exp_nd_est_sc_plot_data_long11,med_exp_nd_est_sc_plot_data_long12,
   med_exp_nd_est_sc_plot_data_long13,med_exp_nd_est_sc_plot_data_long14,med_exp_nd_est_sc_plot_data_long15,
   med_exp_nd_est_sc_plot_data_long16,med_exp_nd_est_sc_plot_data_long17,med_exp_nd_est_sc_plot_data_long18,
   med_exp_nd_est_sc_plot_data_long19,med_exp_nd_est_sc_plot_data_long20,med_exp_nd_est_sc_plot_data_long21,
   med_exp_nd_est_sc_plot_data_long22,med_exp_nd_est_sc_plot_data_long23,med_exp_nd_est_sc_plot_data_long24,
   med_exp_nd_est_sc_plot_data_long25,med_exp_nd_est_sc_plot_data_long26,med_exp_nd_est_sc_plot_data_long27,
   med_exp_nd_est_sc_plot_data_long28,med_exp_nd_est_sc_plot_data_long29,med_exp_nd_est_sc_plot_data_long30,
   med_exp_nd_est_sc_plot_data_long31,med_exp_nd_est_sc_plot_data_long32,med_exp_nd_est_sc_plot_data_long33,
   med_exp_nd_est_sc_plot_data_long34,med_exp_nd_est_sc_plot_data_long35)
med_exp_nd_est_sc_plot_data_long_list <- lapply(med_exp_nd_est_sc_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sc_plot_data_wide", i), reshape(data=med_exp_nd_est_sc_plot_data_long_list[[i]],
                                                                idvar = "year",
                                                                v.names = "outcome",
                                                                timevar = "treated",
                                                                direction = "wide"))
}
med_exp_nd_est_sc_plot_data_wide_list <- list(med_exp_nd_est_sc_plot_data_wide1,med_exp_nd_est_sc_plot_data_wide2,med_exp_nd_est_sc_plot_data_wide3,
                                              med_exp_nd_est_sc_plot_data_wide4,med_exp_nd_est_sc_plot_data_wide5,med_exp_nd_est_sc_plot_data_wide6,
                                              med_exp_nd_est_sc_plot_data_wide7,med_exp_nd_est_sc_plot_data_wide8,med_exp_nd_est_sc_plot_data_wide9,
                                              med_exp_nd_est_sc_plot_data_wide10,med_exp_nd_est_sc_plot_data_wide11,med_exp_nd_est_sc_plot_data_wide12,
                                              med_exp_nd_est_sc_plot_data_wide13,med_exp_nd_est_sc_plot_data_wide14,med_exp_nd_est_sc_plot_data_wide15,
                                              med_exp_nd_est_sc_plot_data_wide16,med_exp_nd_est_sc_plot_data_wide17,med_exp_nd_est_sc_plot_data_wide18,
                                              med_exp_nd_est_sc_plot_data_wide19,med_exp_nd_est_sc_plot_data_wide20,med_exp_nd_est_sc_plot_data_wide21,
                                              med_exp_nd_est_sc_plot_data_wide22,med_exp_nd_est_sc_plot_data_wide23,med_exp_nd_est_sc_plot_data_wide24,
                                              med_exp_nd_est_sc_plot_data_wide25,med_exp_nd_est_sc_plot_data_wide26,med_exp_nd_est_sc_plot_data_wide27,
                                              med_exp_nd_est_sc_plot_data_wide28,med_exp_nd_est_sc_plot_data_wide29,med_exp_nd_est_sc_plot_data_wide30,
                                              med_exp_nd_est_sc_plot_data_wide31,med_exp_nd_est_sc_plot_data_wide32,med_exp_nd_est_sc_plot_data_wide33,
                                              med_exp_nd_est_sc_plot_data_wide34,med_exp_nd_est_sc_plot_data_wide35)
rm(med_exp_nd_est_sc_plot_data_wide1,med_exp_nd_est_sc_plot_data_wide2,med_exp_nd_est_sc_plot_data_wide3,
   med_exp_nd_est_sc_plot_data_wide4,med_exp_nd_est_sc_plot_data_wide5,med_exp_nd_est_sc_plot_data_wide6,
   med_exp_nd_est_sc_plot_data_wide7,med_exp_nd_est_sc_plot_data_wide8,med_exp_nd_est_sc_plot_data_wide9,
   med_exp_nd_est_sc_plot_data_wide10,med_exp_nd_est_sc_plot_data_wide11,med_exp_nd_est_sc_plot_data_wide12,
   med_exp_nd_est_sc_plot_data_wide13,med_exp_nd_est_sc_plot_data_wide14,med_exp_nd_est_sc_plot_data_wide15,
   med_exp_nd_est_sc_plot_data_wide16,med_exp_nd_est_sc_plot_data_wide17,med_exp_nd_est_sc_plot_data_wide18,
   med_exp_nd_est_sc_plot_data_wide19,med_exp_nd_est_sc_plot_data_wide20,med_exp_nd_est_sc_plot_data_wide21,
   med_exp_nd_est_sc_plot_data_wide22,med_exp_nd_est_sc_plot_data_wide23,med_exp_nd_est_sc_plot_data_wide24,
   med_exp_nd_est_sc_plot_data_wide25,med_exp_nd_est_sc_plot_data_wide26,med_exp_nd_est_sc_plot_data_wide27,
   med_exp_nd_est_sc_plot_data_wide28,med_exp_nd_est_sc_plot_data_wide29,med_exp_nd_est_sc_plot_data_wide30,
   med_exp_nd_est_sc_plot_data_wide31,med_exp_nd_est_sc_plot_data_wide32,med_exp_nd_est_sc_plot_data_wide33,
   med_exp_nd_est_sc_plot_data_wide34,med_exp_nd_est_sc_plot_data_wide35)
med_exp_nd_est_sc_plot_data_wide_list <- lapply(med_exp_nd_est_sc_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)
# SDID #
med_exp_nd_est_sdid1 <- synthdid_estimate(setup_med_exp_nd_list[[1]]$Y, setup_med_exp_nd_list[[1]]$N0, setup_med_exp_nd_list[[1]]$T0, X = covariates_exp_array_1)
med_exp_nd_est_sdid2 <- synthdid_estimate(setup_med_exp_nd_list[[2]]$Y, setup_med_exp_nd_list[[2]]$N0, setup_med_exp_nd_list[[2]]$T0, X = covariates_exp_array_2)
med_exp_nd_est_sdid5 <- synthdid_estimate(setup_med_exp_nd_list[[3]]$Y, setup_med_exp_nd_list[[3]]$N0, setup_med_exp_nd_list[[3]]$T0, X = covariates_exp_array_5)
med_exp_nd_est_sdid10 <- synthdid_estimate(setup_med_exp_nd_list[[4]]$Y, setup_med_exp_nd_list[[4]]$N0, setup_med_exp_nd_list[[4]]$T0, X = covariates_exp_array_10)
med_exp_nd_est_sdid11 <- synthdid_estimate(setup_med_exp_nd_list[[5]]$Y, setup_med_exp_nd_list[[5]]$N0, setup_med_exp_nd_list[[5]]$T0, X = covariates_exp_array_11)
med_exp_nd_est_sdid12 <- synthdid_estimate(setup_med_exp_nd_list[[6]]$Y, setup_med_exp_nd_list[[6]]$N0, setup_med_exp_nd_list[[6]]$T0, X = covariates_exp_array_12)
med_exp_nd_est_sdid13 <- synthdid_estimate(setup_med_exp_nd_list[[7]]$Y, setup_med_exp_nd_list[[7]]$N0, setup_med_exp_nd_list[[7]]$T0, X = covariates_exp_array_13)
med_exp_nd_est_sdid15 <- synthdid_estimate(setup_med_exp_nd_list[[8]]$Y, setup_med_exp_nd_list[[8]]$N0, setup_med_exp_nd_list[[8]]$T0, X = covariates_exp_array_15)
med_exp_nd_est_sdid17 <- synthdid_estimate(setup_med_exp_nd_list[[9]]$Y, setup_med_exp_nd_list[[9]]$N0, setup_med_exp_nd_list[[9]]$T0, X = covariates_exp_array_17)
med_exp_nd_est_sdid19 <- synthdid_estimate(setup_med_exp_nd_list[[10]]$Y, setup_med_exp_nd_list[[10]]$N0, setup_med_exp_nd_list[[10]]$T0, X = covariates_exp_array_19)
med_exp_nd_est_sdid21 <- synthdid_estimate(setup_med_exp_nd_list[[11]]$Y, setup_med_exp_nd_list[[11]]$N0, setup_med_exp_nd_list[[11]]$T0, X = covariates_exp_array_21)
med_exp_nd_est_sdid23 <- synthdid_estimate(setup_med_exp_nd_list[[12]]$Y, setup_med_exp_nd_list[[12]]$N0, setup_med_exp_nd_list[[12]]$T0, X = covariates_exp_array_23)
med_exp_nd_est_sdid24 <- synthdid_estimate(setup_med_exp_nd_list[[13]]$Y, setup_med_exp_nd_list[[13]]$N0, setup_med_exp_nd_list[[13]]$T0, X = covariates_exp_array_24)
med_exp_nd_est_sdid25 <- synthdid_estimate(setup_med_exp_nd_list[[14]]$Y, setup_med_exp_nd_list[[14]]$N0, setup_med_exp_nd_list[[14]]$T0, X = covariates_exp_array_25)
med_exp_nd_est_sdid26 <- synthdid_estimate(setup_med_exp_nd_list[[15]]$Y, setup_med_exp_nd_list[[15]]$N0, setup_med_exp_nd_list[[15]]$T0, X = covariates_exp_array_26)
med_exp_nd_est_sdid28 <- synthdid_estimate(setup_med_exp_nd_list[[16]]$Y, setup_med_exp_nd_list[[16]]$N0, setup_med_exp_nd_list[[16]]$T0, X = covariates_exp_array_28)
med_exp_nd_est_sdid29 <- synthdid_estimate(setup_med_exp_nd_list[[17]]$Y, setup_med_exp_nd_list[[17]]$N0, setup_med_exp_nd_list[[17]]$T0, X = covariates_exp_array_29)
med_exp_nd_est_sdid30 <- synthdid_estimate(setup_med_exp_nd_list[[18]]$Y, setup_med_exp_nd_list[[18]]$N0, setup_med_exp_nd_list[[18]]$T0, X = covariates_exp_array_30)
med_exp_nd_est_sdid31 <- synthdid_estimate(setup_med_exp_nd_list[[19]]$Y, setup_med_exp_nd_list[[19]]$N0, setup_med_exp_nd_list[[19]]$T0, X = covariates_exp_array_31)
med_exp_nd_est_sdid32 <- synthdid_estimate(setup_med_exp_nd_list[[20]]$Y, setup_med_exp_nd_list[[20]]$N0, setup_med_exp_nd_list[[20]]$T0, X = covariates_exp_array_32)
med_exp_nd_est_sdid33 <- synthdid_estimate(setup_med_exp_nd_list[[21]]$Y, setup_med_exp_nd_list[[21]]$N0, setup_med_exp_nd_list[[21]]$T0, X = covariates_exp_array_33)
med_exp_nd_est_sdid34 <- synthdid_estimate(setup_med_exp_nd_list[[22]]$Y, setup_med_exp_nd_list[[22]]$N0, setup_med_exp_nd_list[[22]]$T0, X = covariates_exp_array_34)
med_exp_nd_est_sdid36 <- synthdid_estimate(setup_med_exp_nd_list[[23]]$Y, setup_med_exp_nd_list[[23]]$N0, setup_med_exp_nd_list[[23]]$T0, X = covariates_exp_array_36)
med_exp_nd_est_sdid37 <- synthdid_estimate(setup_med_exp_nd_list[[24]]$Y, setup_med_exp_nd_list[[24]]$N0, setup_med_exp_nd_list[[24]]$T0, X = covariates_exp_array_37)
med_exp_nd_est_sdid39 <- synthdid_estimate(setup_med_exp_nd_list[[25]]$Y, setup_med_exp_nd_list[[25]]$N0, setup_med_exp_nd_list[[25]]$T0, X = covariates_exp_array_39)
med_exp_nd_est_sdid40 <- synthdid_estimate(setup_med_exp_nd_list[[26]]$Y, setup_med_exp_nd_list[[26]]$N0, setup_med_exp_nd_list[[26]]$T0, X = covariates_exp_array_40)
med_exp_nd_est_sdid41 <- synthdid_estimate(setup_med_exp_nd_list[[27]]$Y, setup_med_exp_nd_list[[27]]$N0, setup_med_exp_nd_list[[27]]$T0, X = covariates_exp_array_41)
med_exp_nd_est_sdid44 <- synthdid_estimate(setup_med_exp_nd_list[[28]]$Y, setup_med_exp_nd_list[[28]]$N0, setup_med_exp_nd_list[[28]]$T0, X = covariates_exp_array_44)
med_exp_nd_est_sdid45 <- synthdid_estimate(setup_med_exp_nd_list[[29]]$Y, setup_med_exp_nd_list[[29]]$N0, setup_med_exp_nd_list[[29]]$T0, X = covariates_exp_array_45)
med_exp_nd_est_sdid47 <- synthdid_estimate(setup_med_exp_nd_list[[30]]$Y, setup_med_exp_nd_list[[30]]$N0, setup_med_exp_nd_list[[30]]$T0, X = covariates_exp_array_47)
med_exp_nd_est_sdid50 <- synthdid_estimate(setup_med_exp_nd_list[[31]]$Y, setup_med_exp_nd_list[[31]]$N0, setup_med_exp_nd_list[[31]]$T0, X = covariates_exp_array_50)
med_exp_nd_est_sdid51 <- synthdid_estimate(setup_med_exp_nd_list[[32]]$Y, setup_med_exp_nd_list[[32]]$N0, setup_med_exp_nd_list[[32]]$T0, X = covariates_exp_array_51)
med_exp_nd_est_sdid53 <- synthdid_estimate(setup_med_exp_nd_list[[33]]$Y, setup_med_exp_nd_list[[33]]$N0, setup_med_exp_nd_list[[33]]$T0, X = covariates_exp_array_53)
med_exp_nd_est_sdid54 <- synthdid_estimate(setup_med_exp_nd_list[[34]]$Y, setup_med_exp_nd_list[[34]]$N0, setup_med_exp_nd_list[[34]]$T0, X = covariates_exp_array_54)
med_exp_nd_est_sdid55 <- synthdid_estimate(setup_med_exp_nd_list[[35]]$Y, setup_med_exp_nd_list[[35]]$N0, setup_med_exp_nd_list[[35]]$T0, X = covariates_exp_array_55)
med_exp_nd_est_sdid_list <- list(med_exp_nd_est_sdid1,med_exp_nd_est_sdid2,med_exp_nd_est_sdid5,
                                 med_exp_nd_est_sdid10,med_exp_nd_est_sdid11,med_exp_nd_est_sdid12,
                                 med_exp_nd_est_sdid13,med_exp_nd_est_sdid15,med_exp_nd_est_sdid17,
                                 med_exp_nd_est_sdid19,med_exp_nd_est_sdid21,med_exp_nd_est_sdid23,
                                 med_exp_nd_est_sdid24,med_exp_nd_est_sdid25,med_exp_nd_est_sdid26,
                                 med_exp_nd_est_sdid28,med_exp_nd_est_sdid29,med_exp_nd_est_sdid30,
                                 med_exp_nd_est_sdid31,med_exp_nd_est_sdid32,med_exp_nd_est_sdid33,
                                 med_exp_nd_est_sdid34,med_exp_nd_est_sdid36,med_exp_nd_est_sdid37,
                                 med_exp_nd_est_sdid39,med_exp_nd_est_sdid40,med_exp_nd_est_sdid41,
                                 med_exp_nd_est_sdid44,med_exp_nd_est_sdid45,med_exp_nd_est_sdid47,
                                 med_exp_nd_est_sdid50,med_exp_nd_est_sdid51,med_exp_nd_est_sdid53,
                                 med_exp_nd_est_sdid54,med_exp_nd_est_sdid55)
rm(med_exp_nd_est_sdid1,med_exp_nd_est_sdid2,med_exp_nd_est_sdid5,
   med_exp_nd_est_sdid10,med_exp_nd_est_sdid11,med_exp_nd_est_sdid12,
   med_exp_nd_est_sdid13,med_exp_nd_est_sdid15,med_exp_nd_est_sdid17,
   med_exp_nd_est_sdid19,med_exp_nd_est_sdid21,med_exp_nd_est_sdid23,
   med_exp_nd_est_sdid24,med_exp_nd_est_sdid25,med_exp_nd_est_sdid26,
   med_exp_nd_est_sdid28,med_exp_nd_est_sdid29,med_exp_nd_est_sdid30,
   med_exp_nd_est_sdid31,med_exp_nd_est_sdid32,med_exp_nd_est_sdid33,
   med_exp_nd_est_sdid34,med_exp_nd_est_sdid36,med_exp_nd_est_sdid37,
   med_exp_nd_est_sdid39,med_exp_nd_est_sdid40,med_exp_nd_est_sdid41,
   med_exp_nd_est_sdid44,med_exp_nd_est_sdid45,med_exp_nd_est_sdid47,
   med_exp_nd_est_sdid50,med_exp_nd_est_sdid51,med_exp_nd_est_sdid53,
   med_exp_nd_est_sdid54,med_exp_nd_est_sdid55)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sdid_plot", i), synthdid_plot(med_exp_nd_est_sdid_list[i]))
}
med_exp_nd_est_sdid_plot_data_aux1 <- ggplot_build(med_exp_nd_est_sdid_plot1)
med_exp_nd_est_sdid_plot_data_aux2 <- ggplot_build(med_exp_nd_est_sdid_plot2)
med_exp_nd_est_sdid_plot_data_aux3 <- ggplot_build(med_exp_nd_est_sdid_plot3)
med_exp_nd_est_sdid_plot_data_aux4 <- ggplot_build(med_exp_nd_est_sdid_plot4)
med_exp_nd_est_sdid_plot_data_aux5 <- ggplot_build(med_exp_nd_est_sdid_plot5)
med_exp_nd_est_sdid_plot_data_aux6 <- ggplot_build(med_exp_nd_est_sdid_plot6)
med_exp_nd_est_sdid_plot_data_aux7 <- ggplot_build(med_exp_nd_est_sdid_plot7)
med_exp_nd_est_sdid_plot_data_aux8 <- ggplot_build(med_exp_nd_est_sdid_plot8)
med_exp_nd_est_sdid_plot_data_aux9 <- ggplot_build(med_exp_nd_est_sdid_plot9)
med_exp_nd_est_sdid_plot_data_aux10 <- ggplot_build(med_exp_nd_est_sdid_plot10)
med_exp_nd_est_sdid_plot_data_aux11 <- ggplot_build(med_exp_nd_est_sdid_plot11)
med_exp_nd_est_sdid_plot_data_aux12 <- ggplot_build(med_exp_nd_est_sdid_plot12)
med_exp_nd_est_sdid_plot_data_aux13 <- ggplot_build(med_exp_nd_est_sdid_plot13)
med_exp_nd_est_sdid_plot_data_aux14 <- ggplot_build(med_exp_nd_est_sdid_plot14)
med_exp_nd_est_sdid_plot_data_aux15 <- ggplot_build(med_exp_nd_est_sdid_plot15)
med_exp_nd_est_sdid_plot_data_aux16 <- ggplot_build(med_exp_nd_est_sdid_plot16)
med_exp_nd_est_sdid_plot_data_aux17 <- ggplot_build(med_exp_nd_est_sdid_plot17)
med_exp_nd_est_sdid_plot_data_aux18 <- ggplot_build(med_exp_nd_est_sdid_plot18)
med_exp_nd_est_sdid_plot_data_aux19 <- ggplot_build(med_exp_nd_est_sdid_plot19)
med_exp_nd_est_sdid_plot_data_aux20 <- ggplot_build(med_exp_nd_est_sdid_plot20)
med_exp_nd_est_sdid_plot_data_aux21 <- ggplot_build(med_exp_nd_est_sdid_plot21)
med_exp_nd_est_sdid_plot_data_aux22 <- ggplot_build(med_exp_nd_est_sdid_plot22)
med_exp_nd_est_sdid_plot_data_aux23 <- ggplot_build(med_exp_nd_est_sdid_plot23)
med_exp_nd_est_sdid_plot_data_aux24 <- ggplot_build(med_exp_nd_est_sdid_plot24)
med_exp_nd_est_sdid_plot_data_aux25 <- ggplot_build(med_exp_nd_est_sdid_plot25)
med_exp_nd_est_sdid_plot_data_aux26 <- ggplot_build(med_exp_nd_est_sdid_plot26)
med_exp_nd_est_sdid_plot_data_aux27 <- ggplot_build(med_exp_nd_est_sdid_plot27)
med_exp_nd_est_sdid_plot_data_aux28 <- ggplot_build(med_exp_nd_est_sdid_plot28)
med_exp_nd_est_sdid_plot_data_aux29 <- ggplot_build(med_exp_nd_est_sdid_plot29)
med_exp_nd_est_sdid_plot_data_aux30 <- ggplot_build(med_exp_nd_est_sdid_plot30)
med_exp_nd_est_sdid_plot_data_aux31 <- ggplot_build(med_exp_nd_est_sdid_plot31)
med_exp_nd_est_sdid_plot_data_aux32 <- ggplot_build(med_exp_nd_est_sdid_plot32)
med_exp_nd_est_sdid_plot_data_aux33 <- ggplot_build(med_exp_nd_est_sdid_plot33)
med_exp_nd_est_sdid_plot_data_aux34 <- ggplot_build(med_exp_nd_est_sdid_plot34)
med_exp_nd_est_sdid_plot_data_aux35 <- ggplot_build(med_exp_nd_est_sdid_plot35)
med_exp_nd_est_sdid_plot_data_aux_list <- list(med_exp_nd_est_sdid_plot_data_aux1,med_exp_nd_est_sdid_plot_data_aux2,med_exp_nd_est_sdid_plot_data_aux3,
                                               med_exp_nd_est_sdid_plot_data_aux4,med_exp_nd_est_sdid_plot_data_aux5,med_exp_nd_est_sdid_plot_data_aux6,
                                               med_exp_nd_est_sdid_plot_data_aux7,med_exp_nd_est_sdid_plot_data_aux8,med_exp_nd_est_sdid_plot_data_aux9,
                                               med_exp_nd_est_sdid_plot_data_aux10,med_exp_nd_est_sdid_plot_data_aux11,med_exp_nd_est_sdid_plot_data_aux12,
                                               med_exp_nd_est_sdid_plot_data_aux13,med_exp_nd_est_sdid_plot_data_aux14,med_exp_nd_est_sdid_plot_data_aux15,
                                               med_exp_nd_est_sdid_plot_data_aux16,med_exp_nd_est_sdid_plot_data_aux17,med_exp_nd_est_sdid_plot_data_aux18,
                                               med_exp_nd_est_sdid_plot_data_aux19,med_exp_nd_est_sdid_plot_data_aux20,med_exp_nd_est_sdid_plot_data_aux21,
                                               med_exp_nd_est_sdid_plot_data_aux22,med_exp_nd_est_sdid_plot_data_aux23,med_exp_nd_est_sdid_plot_data_aux24,
                                               med_exp_nd_est_sdid_plot_data_aux25,med_exp_nd_est_sdid_plot_data_aux26,med_exp_nd_est_sdid_plot_data_aux27,
                                               med_exp_nd_est_sdid_plot_data_aux28,med_exp_nd_est_sdid_plot_data_aux29,med_exp_nd_est_sdid_plot_data_aux30,
                                               med_exp_nd_est_sdid_plot_data_aux31,med_exp_nd_est_sdid_plot_data_aux32,med_exp_nd_est_sdid_plot_data_aux33,
                                               med_exp_nd_est_sdid_plot_data_aux34,med_exp_nd_est_sdid_plot_data_aux35)
rm(med_exp_nd_est_sdid_plot_data_aux1,med_exp_nd_est_sdid_plot_data_aux2,med_exp_nd_est_sdid_plot_data_aux3,
   med_exp_nd_est_sdid_plot_data_aux4,med_exp_nd_est_sdid_plot_data_aux5,med_exp_nd_est_sdid_plot_data_aux6,
   med_exp_nd_est_sdid_plot_data_aux7,med_exp_nd_est_sdid_plot_data_aux8,med_exp_nd_est_sdid_plot_data_aux9,
   med_exp_nd_est_sdid_plot_data_aux10,med_exp_nd_est_sdid_plot_data_aux11,med_exp_nd_est_sdid_plot_data_aux12,
   med_exp_nd_est_sdid_plot_data_aux13,med_exp_nd_est_sdid_plot_data_aux14,med_exp_nd_est_sdid_plot_data_aux15,
   med_exp_nd_est_sdid_plot_data_aux16,med_exp_nd_est_sdid_plot_data_aux17,med_exp_nd_est_sdid_plot_data_aux18,
   med_exp_nd_est_sdid_plot_data_aux19,med_exp_nd_est_sdid_plot_data_aux20,med_exp_nd_est_sdid_plot_data_aux21,
   med_exp_nd_est_sdid_plot_data_aux22,med_exp_nd_est_sdid_plot_data_aux23,med_exp_nd_est_sdid_plot_data_aux24,
   med_exp_nd_est_sdid_plot_data_aux25,med_exp_nd_est_sdid_plot_data_aux26,med_exp_nd_est_sdid_plot_data_aux27,
   med_exp_nd_est_sdid_plot_data_aux28,med_exp_nd_est_sdid_plot_data_aux29,med_exp_nd_est_sdid_plot_data_aux30,
   med_exp_nd_est_sdid_plot_data_aux31,med_exp_nd_est_sdid_plot_data_aux32,med_exp_nd_est_sdid_plot_data_aux33,
   med_exp_nd_est_sdid_plot_data_aux34,med_exp_nd_est_sdid_plot_data_aux35)
rm(med_exp_nd_est_sdid_plot1,med_exp_nd_est_sdid_plot2,med_exp_nd_est_sdid_plot3,
   med_exp_nd_est_sdid_plot4,med_exp_nd_est_sdid_plot5,med_exp_nd_est_sdid_plot6,
   med_exp_nd_est_sdid_plot7,med_exp_nd_est_sdid_plot8,med_exp_nd_est_sdid_plot9,
   med_exp_nd_est_sdid_plot10,med_exp_nd_est_sdid_plot11,med_exp_nd_est_sdid_plot12,
   med_exp_nd_est_sdid_plot13,med_exp_nd_est_sdid_plot14,med_exp_nd_est_sdid_plot15,
   med_exp_nd_est_sdid_plot16,med_exp_nd_est_sdid_plot17,med_exp_nd_est_sdid_plot18,
   med_exp_nd_est_sdid_plot19,med_exp_nd_est_sdid_plot20,med_exp_nd_est_sdid_plot21,
   med_exp_nd_est_sdid_plot22,med_exp_nd_est_sdid_plot23,med_exp_nd_est_sdid_plot24,
   med_exp_nd_est_sdid_plot25,med_exp_nd_est_sdid_plot26,med_exp_nd_est_sdid_plot27,
   med_exp_nd_est_sdid_plot28,med_exp_nd_est_sdid_plot29,med_exp_nd_est_sdid_plot30,
   med_exp_nd_est_sdid_plot31,med_exp_nd_est_sdid_plot32,med_exp_nd_est_sdid_plot33,
   med_exp_nd_est_sdid_plot34,med_exp_nd_est_sdid_plot35)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sdid_plot_data_long", i), data.frame(med_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$x, med_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$y, med_exp_nd_est_sdid_plot_data_aux_list[[i]]$data[[1]]$group))
}
med_exp_nd_est_sdid_plot_data_long_list <- list(med_exp_nd_est_sdid_plot_data_long1,med_exp_nd_est_sdid_plot_data_long2,med_exp_nd_est_sdid_plot_data_long3,
                                                med_exp_nd_est_sdid_plot_data_long4,med_exp_nd_est_sdid_plot_data_long5,med_exp_nd_est_sdid_plot_data_long6,
                                                med_exp_nd_est_sdid_plot_data_long7,med_exp_nd_est_sdid_plot_data_long8,med_exp_nd_est_sdid_plot_data_long9,
                                                med_exp_nd_est_sdid_plot_data_long10,med_exp_nd_est_sdid_plot_data_long11,med_exp_nd_est_sdid_plot_data_long12,
                                                med_exp_nd_est_sdid_plot_data_long13,med_exp_nd_est_sdid_plot_data_long14,med_exp_nd_est_sdid_plot_data_long15,
                                                med_exp_nd_est_sdid_plot_data_long16,med_exp_nd_est_sdid_plot_data_long17,med_exp_nd_est_sdid_plot_data_long18,
                                                med_exp_nd_est_sdid_plot_data_long19,med_exp_nd_est_sdid_plot_data_long20,med_exp_nd_est_sdid_plot_data_long21,
                                                med_exp_nd_est_sdid_plot_data_long22,med_exp_nd_est_sdid_plot_data_long23,med_exp_nd_est_sdid_plot_data_long24,
                                                med_exp_nd_est_sdid_plot_data_long25,med_exp_nd_est_sdid_plot_data_long26,med_exp_nd_est_sdid_plot_data_long27,
                                                med_exp_nd_est_sdid_plot_data_long28,med_exp_nd_est_sdid_plot_data_long29,med_exp_nd_est_sdid_plot_data_long30,
                                                med_exp_nd_est_sdid_plot_data_long31,med_exp_nd_est_sdid_plot_data_long32,med_exp_nd_est_sdid_plot_data_long33,
                                                med_exp_nd_est_sdid_plot_data_long34,med_exp_nd_est_sdid_plot_data_long35)
rm(med_exp_nd_est_sdid_plot_data_long1,med_exp_nd_est_sdid_plot_data_long2,med_exp_nd_est_sdid_plot_data_long3,
   med_exp_nd_est_sdid_plot_data_long4,med_exp_nd_est_sdid_plot_data_long5,med_exp_nd_est_sdid_plot_data_long6,
   med_exp_nd_est_sdid_plot_data_long7,med_exp_nd_est_sdid_plot_data_long8,med_exp_nd_est_sdid_plot_data_long9,
   med_exp_nd_est_sdid_plot_data_long10,med_exp_nd_est_sdid_plot_data_long11,med_exp_nd_est_sdid_plot_data_long12,
   med_exp_nd_est_sdid_plot_data_long13,med_exp_nd_est_sdid_plot_data_long14,med_exp_nd_est_sdid_plot_data_long15,
   med_exp_nd_est_sdid_plot_data_long16,med_exp_nd_est_sdid_plot_data_long17,med_exp_nd_est_sdid_plot_data_long18,
   med_exp_nd_est_sdid_plot_data_long19,med_exp_nd_est_sdid_plot_data_long20,med_exp_nd_est_sdid_plot_data_long21,
   med_exp_nd_est_sdid_plot_data_long22,med_exp_nd_est_sdid_plot_data_long23,med_exp_nd_est_sdid_plot_data_long24,
   med_exp_nd_est_sdid_plot_data_long25,med_exp_nd_est_sdid_plot_data_long26,med_exp_nd_est_sdid_plot_data_long27,
   med_exp_nd_est_sdid_plot_data_long28,med_exp_nd_est_sdid_plot_data_long29,med_exp_nd_est_sdid_plot_data_long30,
   med_exp_nd_est_sdid_plot_data_long31,med_exp_nd_est_sdid_plot_data_long32,med_exp_nd_est_sdid_plot_data_long33,
   med_exp_nd_est_sdid_plot_data_long34,med_exp_nd_est_sdid_plot_data_long35)
med_exp_nd_est_sdid_plot_data_long_list <- lapply(med_exp_nd_est_sdid_plot_data_long_list, function(x) {
  colnames(x) <- c('year', 'outcome', 'treated')  
  x$treated <- x$treated - 1
  return(x)
}
)
for(i in 1:35) {
  assign(paste0("med_exp_nd_est_sdid_plot_data_wide", i), reshape(data=med_exp_nd_est_sdid_plot_data_long_list[[i]],
                                                                  idvar = "year",
                                                                  v.names = "outcome",
                                                                  timevar = "treated",
                                                                  direction = "wide"))
}
med_exp_nd_est_sdid_plot_data_wide_list <- list(med_exp_nd_est_sdid_plot_data_wide1,med_exp_nd_est_sdid_plot_data_wide2,med_exp_nd_est_sdid_plot_data_wide3,
                                                med_exp_nd_est_sdid_plot_data_wide4,med_exp_nd_est_sdid_plot_data_wide5,med_exp_nd_est_sdid_plot_data_wide6,
                                                med_exp_nd_est_sdid_plot_data_wide7,med_exp_nd_est_sdid_plot_data_wide8,med_exp_nd_est_sdid_plot_data_wide9,
                                                med_exp_nd_est_sdid_plot_data_wide10,med_exp_nd_est_sdid_plot_data_wide11,med_exp_nd_est_sdid_plot_data_wide12,
                                                med_exp_nd_est_sdid_plot_data_wide13,med_exp_nd_est_sdid_plot_data_wide14,med_exp_nd_est_sdid_plot_data_wide15,
                                                med_exp_nd_est_sdid_plot_data_wide16,med_exp_nd_est_sdid_plot_data_wide17,med_exp_nd_est_sdid_plot_data_wide18,
                                                med_exp_nd_est_sdid_plot_data_wide19,med_exp_nd_est_sdid_plot_data_wide20,med_exp_nd_est_sdid_plot_data_wide21,
                                                med_exp_nd_est_sdid_plot_data_wide22,med_exp_nd_est_sdid_plot_data_wide23,med_exp_nd_est_sdid_plot_data_wide24,
                                                med_exp_nd_est_sdid_plot_data_wide25,med_exp_nd_est_sdid_plot_data_wide26,med_exp_nd_est_sdid_plot_data_wide27,
                                                med_exp_nd_est_sdid_plot_data_wide28,med_exp_nd_est_sdid_plot_data_wide29,med_exp_nd_est_sdid_plot_data_wide30,
                                                med_exp_nd_est_sdid_plot_data_wide31,med_exp_nd_est_sdid_plot_data_wide32,med_exp_nd_est_sdid_plot_data_wide33,
                                                med_exp_nd_est_sdid_plot_data_wide34,med_exp_nd_est_sdid_plot_data_wide35)
rm(med_exp_nd_est_sdid_plot_data_wide1,med_exp_nd_est_sdid_plot_data_wide2,med_exp_nd_est_sdid_plot_data_wide3,
   med_exp_nd_est_sdid_plot_data_wide4,med_exp_nd_est_sdid_plot_data_wide5,med_exp_nd_est_sdid_plot_data_wide6,
   med_exp_nd_est_sdid_plot_data_wide7,med_exp_nd_est_sdid_plot_data_wide8,med_exp_nd_est_sdid_plot_data_wide9,
   med_exp_nd_est_sdid_plot_data_wide10,med_exp_nd_est_sdid_plot_data_wide11,med_exp_nd_est_sdid_plot_data_wide12,
   med_exp_nd_est_sdid_plot_data_wide13,med_exp_nd_est_sdid_plot_data_wide14,med_exp_nd_est_sdid_plot_data_wide15,
   med_exp_nd_est_sdid_plot_data_wide16,med_exp_nd_est_sdid_plot_data_wide17,med_exp_nd_est_sdid_plot_data_wide18,
   med_exp_nd_est_sdid_plot_data_wide19,med_exp_nd_est_sdid_plot_data_wide20,med_exp_nd_est_sdid_plot_data_wide21,
   med_exp_nd_est_sdid_plot_data_wide22,med_exp_nd_est_sdid_plot_data_wide23,med_exp_nd_est_sdid_plot_data_wide24,
   med_exp_nd_est_sdid_plot_data_wide25,med_exp_nd_est_sdid_plot_data_wide26,med_exp_nd_est_sdid_plot_data_wide27,
   med_exp_nd_est_sdid_plot_data_wide28,med_exp_nd_est_sdid_plot_data_wide29,med_exp_nd_est_sdid_plot_data_wide30,
   med_exp_nd_est_sdid_plot_data_wide31,med_exp_nd_est_sdid_plot_data_wide32,med_exp_nd_est_sdid_plot_data_wide33,
   med_exp_nd_est_sdid_plot_data_wide34,med_exp_nd_est_sdid_plot_data_wide35)
med_exp_nd_est_sdid_plot_data_wide_list <- lapply(med_exp_nd_est_sdid_plot_data_wide_list, function(x) {
  x$diff <- x$outcome.1 - x$outcome.0
  return(x)
}
)

##### Spaghetti and Placebo Distribution Plots #####
# Spaghetti plots #
med_exp_est_did_plot_data_wide_nd$did_facet_title <- "Diff-in-Diff"
med_exp_est_sc_plot_data_wide_nd$sc_facet_title <- "Synthetic Control"
med_exp_est_sdid_plot_data_wide_nd$sdid_facet_title <- "Synthetic Diff-in-Diff"
med_exp_est_did_plot_data_wide_nd$diff_relative <- med_exp_est_did_plot_data_wide_nd$diff - med_exp_est_did_plot_data_wide_nd$diff[15]
for(i in 1:35) {
  med_exp_nd_est_did_plot_data_wide_list[[i]]$diff_relative <- med_exp_nd_est_did_plot_data_wide_list[[i]]$diff - med_exp_nd_est_did_plot_data_wide_list[[i]]$diff[15]
}
med_exp_nd_spag_did_plot <- ggplot(med_exp_est_did_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_did_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  labs(y= "Gap in Medicaid Expenditure \n (Per Capita)") +
  facet_grid(. ~ did_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size=8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_nd_spag_sc_plot <- ggplot(med_exp_est_sc_plot_data_wide_nd, aes(year,diff)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sc_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(aes(y = diff, color = "Placebos"),data = med_exp_nd_est_sc_plot_data_wide_list[[35]], alpha = 0.4) +
  geom_line(aes(y = diff, color = "North Dakota"),data = med_exp_est_sc_plot_data_wide_nd, size = 1.25) +
  scale_color_manual(values = c("Placebos" = "#F8766D", "North Dakota" = "#00BFC4")) +
  labs(x= "Year") +
  facet_grid(. ~ sc_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size=8),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        legend.position='top', 
        legend.text = element_text(size=8.5),
        legend.direction='horizontal',
        legend.key = element_blank(),
        legend.title = element_blank(),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_est_sdid_plot_data_wide_nd$diff_relative <- med_exp_est_sdid_plot_data_wide_nd$diff - med_exp_est_sdid_plot_data_wide_nd$diff[15]
for(i in 1:35) {
  med_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff_relative <- med_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff - med_exp_nd_est_sdid_plot_data_wide_list[[i]]$diff[15]
}
med_exp_nd_spag_sdid_plot <- ggplot(med_exp_est_sdid_plot_data_wide_nd, aes(year,diff_relative)) +
  geom_vline(xintercept = 1994, size = .75, color = "grey70", alpha = 0.75) +
  geom_hline(yintercept = 0, size = .75, color = "grey70", alpha = 0.75) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[1]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[2]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[3]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[4]], color = "#F8766D", alpha = 0.4) +
  #geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[5]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[6]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[7]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[8]], color = "#F8766D", alpha = 0.4) +    
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[9]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[10]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[11]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[12]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[13]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[14]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[15]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[16]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[17]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[18]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[19]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[20]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[21]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[22]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[23]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[24]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[25]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[26]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[27]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[28]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[29]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[30]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[31]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[32]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[33]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[34]], color = "#F8766D", alpha = 0.4) +
  geom_line(data = med_exp_nd_est_sdid_plot_data_wide_list[[35]], color = "#F8766D", alpha = 0.4) +
  geom_line(size = 1.25, color = "#00BFC4") +
  facet_grid(. ~ sdid_facet_title) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
# Placebo Distribution Plots #
med_exp_nd_est_did_vec <- c(med_exp_est_did_nd)
for (i in c(1:4,6:35)) {
  med_exp_nd_est_did_vec_aux <- med_exp_nd_est_did_list[[i]][1]
  med_exp_nd_est_did_vec <- c(med_exp_nd_est_did_vec,med_exp_nd_est_did_vec_aux)
}
med_exp_nd_est_did_df <- data.frame(med_exp_nd_est_did_vec)
med_exp_nd_hist_did_plot_aux <- ggplot(data = NULL, aes(x = med_exp_nd_est_did_vec)) +
  geom_histogram(data = med_exp_nd_est_did_df, aes(x = med_exp_nd_est_did_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(y= "Frequency") +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_nd_hist_did_plot1_ylim <- ggplot_build(med_exp_nd_hist_did_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_nd_hist_did_plot <- med_exp_nd_hist_did_plot_aux +
  expand_limits(y=med_exp_nd_hist_did_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_nd_est_did_vec[1], mean(med_exp_nd_est_did_vec[2:35])), xend = c(med_exp_nd_est_did_vec[1],mean(med_exp_nd_est_did_vec[2:35])), y = c(0,0), yend = c(med_exp_nd_hist_did_plot1_ylim,med_exp_nd_hist_did_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_nd_est_did_vec[1], mean(med_exp_nd_est_did_vec[2:35])), y = c(med_exp_nd_hist_did_plot1_ylim,med_exp_nd_hist_did_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_nd_est_did_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_nd_est_did_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.15,.5), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_nd_est_sc_vec <- c(med_exp_est_sc_nd)
for (i in c(1:4,6:35)) {
  med_exp_nd_est_sc_vec_aux <- med_exp_nd_est_sc_list[[i]][1]
  med_exp_nd_est_sc_vec <- c(med_exp_nd_est_sc_vec,med_exp_nd_est_sc_vec_aux)
}
med_exp_nd_est_sc_df <- data.frame(med_exp_nd_est_sc_vec)
med_exp_nd_hist_sc_plot_aux <- ggplot(data = NULL, aes(x = med_exp_nd_est_sc_vec)) +
  geom_histogram(data = med_exp_nd_est_sc_df, aes(x = med_exp_nd_est_sc_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  labs(x= expression("Average Treatment Effect"~(hat(tau)))) +  
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size=8),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_nd_hist_sc_plot1_ylim <- ggplot_build(med_exp_nd_hist_sc_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_nd_hist_sc_plot <- med_exp_nd_hist_sc_plot_aux +
  expand_limits(y=med_exp_nd_hist_sc_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_nd_est_sc_vec[1], mean(med_exp_nd_est_sc_vec[2:35])), xend = c(med_exp_nd_est_sc_vec[1],mean(med_exp_nd_est_sc_vec[2:35])), y = c(0,0), yend = c(med_exp_nd_hist_sc_plot1_ylim,med_exp_nd_hist_sc_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_nd_est_sc_vec[1], mean(med_exp_nd_est_sc_vec[2:35])), y = c(med_exp_nd_hist_sc_plot1_ylim,med_exp_nd_hist_sc_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_nd_est_sc_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_nd_est_sc_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.1,.5), color = c("#00BFC4","grey40"), size = c(2,2))

med_exp_nd_est_sdid_vec <- c(med_exp_est_sdid_nd)
for (i in c(1:4,6:35)) {
  med_exp_nd_est_sdid_vec_aux <- med_exp_nd_est_sdid_list[[i]][1]
  med_exp_nd_est_sdid_vec <- c(med_exp_nd_est_sdid_vec,med_exp_nd_est_sdid_vec_aux)
}
med_exp_nd_est_sdid_df <- data.frame(med_exp_nd_est_sdid_vec)
med_exp_nd_hist_sdid_plot_aux <- ggplot(data = NULL, aes(x = med_exp_nd_est_sdid_vec)) +
  geom_histogram(data = med_exp_nd_est_sdid_df, aes(x = med_exp_nd_est_sdid_vec, y = ..count..) ,alpha = .5, color = "#F8766D", fill = "#F8766D", bins = 25) +
  theme(aspect.ratio=1,
        panel.spacing.x=unit(1, "lines"),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(), 
        panel.grid.major.y = element_line(size=.25, color='grey90'),
        panel.grid.minor.y = element_blank(),
        axis.text.x = element_text(angle = 45, hjust=1, size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        strip.background = element_rect(fill="grey70", size=1),
        strip.text = element_text(size=8, face="bold", color = "white"),
        axis.ticks = element_line(color = "grey70"),
        panel.border = element_rect(color = "grey70", fill = NA, size = 0.5)
  )
med_exp_nd_hist_sdid_plot1_ylim <- ggplot_build(med_exp_nd_hist_sdid_plot_aux)$layout$panel_scales_y[[1]]$range$range[2]
med_exp_nd_hist_sdid_plot <- med_exp_nd_hist_sdid_plot_aux +
  expand_limits(y=med_exp_nd_hist_sdid_plot1_ylim*1.025) +
  geom_segment(aes(x = c(med_exp_nd_est_sdid_vec[1], mean(med_exp_nd_est_sdid_vec[2:35])), xend = c(med_exp_nd_est_sdid_vec[1],mean(med_exp_nd_est_sdid_vec[2:35])), y = c(0,0), yend = c(med_exp_nd_hist_sdid_plot1_ylim,med_exp_nd_hist_sdid_plot1_ylim)),
               color = c("#00BFC4","grey50"), alpha = c(.75,.75), size = c(.75,.75)) +
  geom_text(aes(x = c(med_exp_nd_est_sdid_vec[1], mean(med_exp_nd_est_sdid_vec[2:35])), y = c(med_exp_nd_hist_sdid_plot1_ylim,med_exp_nd_hist_sdid_plot1_ylim), label = c(paste0("hat(tau)[tr]==",round(med_exp_nd_est_sdid_vec[1], 2)),paste0("bar(tau)[controls]==",round(mean(med_exp_nd_est_sdid_vec[2:35]),2)))),
            parse = TRUE, vjust = c(-.3,-.5), hjust = c(.1,.5), color = c("#00BFC4","grey40"), size = c(2,2))
pdf(file='SynthDID_Figs_and_Tables/med_exp_spag_dist_plots_ND.pdf', paper = "USr", width = 10.9, height = 8.4)
(med_exp_nd_spag_dist_plots_nd <- med_exp_nd_spag_did_plot + med_exp_nd_spag_sc_plot + med_exp_nd_spag_sdid_plot + med_exp_nd_hist_did_plot + med_exp_nd_hist_sc_plot + med_exp_nd_hist_sdid_plot + plot_layout(ncol = 3))
dev.off()


